[0m10:14:56.041675 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:14:56.052771 | 31478922-bc41-4f1c-b14b-c95579c0c79a ==============================
[0m10:14:56.052771 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:14:56.053432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:56.181035 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m10:14:56.182896 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m10:14:56.187214 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7d5vkgc7'
[0m10:14:56.188743 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m10:14:56.190925 [debug] [MainThread]: Creating symlink to local dependency.
[0m10:14:56.191352 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m10:14:56.192226 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19279355, "process_user_time": 1.01585, "process_kernel_time": 0.090075, "process_mem_max_rss": "106156", "process_in_blocks": "888", "process_out_blocks": "11"}
[0m10:14:56.194709 [debug] [MainThread]: Command `dbt deps` succeeded at 10:14:56.194576 after 0.20 seconds
[0m10:14:56.195369 [debug] [MainThread]: Flushing usage events
[0m10:14:58.249441 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:14:58.254719 | ff09b312-bdd1-4f95-aa6f-6d39cf0096f4 ==============================
[0m10:14:58.254719 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:14:58.255375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:58.440443 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:14:58.456425 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:14:58.637450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:58.638938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:58.877912 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:14:58.879802 [info ] [MainThread]: 
[0m10:14:58.880360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:58.881234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:14:58.916368 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:14:58.920756 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:14:58.923824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:58.933692 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m10:14:58.934803 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:14:58.935582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m10:14:58.936134 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m10:14:58.940507 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:14:58.940905 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m10:14:58.941227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:58.945393 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:14:58.946020 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:14:58.946442 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m10:14:58.947307 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:14:58.948247 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m10:14:58.948686 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:14:58.949064 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m10:14:58.949908 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m10:14:58.950321 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m10:14:58.954843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m10:14:58.955388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:14:58.961493 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:14:58.961823 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:14:58.962116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:58.959687 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:14:58.962759 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:14:58.963328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:58.967525 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:14:58.968079 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:14:58.968402 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:14:58.969108 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:14:58.969452 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:14:58.968715 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:14:58.972483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:14:58.972746 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:14:58.973852 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:14:58.974777 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:14:58.975195 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:14:58.975471 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:14:59.017757 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:59.018288 [debug] [MainThread]: On master: BEGIN
[0m10:14:59.018727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:04.022606 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m10:15:04.023590 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:04.024240 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:15:04.031031 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:15:04.032700 [debug] [MainThread]: On master: ROLLBACK
[0m10:15:04.034863 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:04.035452 [debug] [MainThread]: On master: BEGIN
[0m10:15:04.036101 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:15:04.036632 [debug] [MainThread]: On master: COMMIT
[0m10:15:04.037146 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:04.037575 [debug] [MainThread]: On master: COMMIT
[0m10:15:04.038199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:15:04.038689 [debug] [MainThread]: On master: Close
[0m10:15:04.039556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:04.041831 [info ] [MainThread]: 
[0m10:15:04.052967 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m10:15:04.053742 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m10:15:04.054382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m10:15:04.054850 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m10:15:04.055262 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m10:15:04.081129 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:15:04.081764 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m10:15:04.082149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:04.087921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:15:04.088524 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:15:04.089003 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m10:15:04.091385 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m10:15:04.157187 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:15:04.161394 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m10:15:04.163730 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m10:15:04.168630 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m10:15:04.183346 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m10:15:04.183825 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:15:04.184181 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m10:15:04.185073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:15:04.186729 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m10:15:04.188095 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.13s]
[0m10:15:04.188647 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m10:15:04.189930 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:04.190397 [debug] [MainThread]: On master: BEGIN
[0m10:15:04.190858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:04.197527 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:15:04.202851 [debug] [MainThread]: On master: COMMIT
[0m10:15:04.206848 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:04.208918 [debug] [MainThread]: On master: COMMIT
[0m10:15:04.209476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:15:04.209825 [debug] [MainThread]: On master: Close
[0m10:15:04.210340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:04.210663 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m10:15:04.213123 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:15:04.213510 [info ] [MainThread]: 
[0m10:15:04.216813 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m10:15:04.217546 [debug] [MainThread]: Command end result
[0m10:15:04.278883 [info ] [MainThread]: 
[0m10:15:04.279944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:04.280468 [info ] [MainThread]: 
[0m10:15:04.281233 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:15:04.282019 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.0875163, "process_user_time": 1.630258, "process_kernel_time": 0.092525, "process_mem_max_rss": "106380", "process_in_blocks": "16", "process_out_blocks": "2374"}
[0m10:15:04.283232 [debug] [MainThread]: Command `dbt seed` succeeded at 10:15:04.283155 after 6.09 seconds
[0m10:15:04.283838 [debug] [MainThread]: Flushing usage events
[0m10:15:55.510378 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:15:55.504401 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:15:55.521375 | 69f33f54-532b-4b96-9085-210801235052 ==============================
[0m10:15:55.521375 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:15:55.522063 | 025623b7-3d55-47bd-aa5b-49fda83880d1 ==============================
[0m10:15:55.522063 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:15:55.524754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.523003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.538516 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:15:55.549203 | 40959595-cd93-45a8-8a29-a89367d56e1d ==============================
[0m10:15:55.549203 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:15:55.552626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.545138 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:15:55.560469 | 79cd8dc8-a63c-4deb-a3bf-395e18ef18c4 ==============================
[0m10:15:55.560469 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:15:55.561908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.560299 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:15:55.567834 | 170b17b3-0a6b-4c52-aea6-994c28c03139 ==============================
[0m10:15:55.567834 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:15:55.570005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.613000 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:15:55.621919 | 730fca87-5366-418b-a598-8389f862bd14 ==============================
[0m10:15:55.621919 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:15:55.622772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.629819 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:15:55.638798 | fcdd8583-4398-40d1-af0b-03742cf7f768 ==============================
[0m10:15:55.638798 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:15:55.640317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m10:15:55.764914 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:15:55.772715 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:15:55.773558 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:15:55.793177 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:15:55.817074 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:15:55.825484 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:15:55.845476 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:15:55.882095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:15:55.888171 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:15:55.903753 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:15:55.924207 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:15:55.933883 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:15:55.953243 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:15:55.968301 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:55.969767 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:15:55.974902 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:15:55.978481 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:55.981056 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:15:55.994450 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:55.996231 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:15:56.033873 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:56.034875 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:15:56.067147 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:56.067916 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:15:56.079256 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:56.080626 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:15:56.092638 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:15:56.093837 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:15:57.804722 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:15:57.806405 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:15:57.808045 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:15:57.809857 [info ] [MainThread]: 
[0m10:15:57.814382 [info ] [MainThread]: 
[0m10:15:57.813392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:57.812182 [info ] [MainThread]: 
[0m10:15:57.815255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:57.815730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:15:57.816647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:15:57.816742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:57.825581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:15:57.846592 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:15:57.848378 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:15:57.849409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.854733 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:15:57.856423 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:15:57.857765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.862462 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:15:57.864431 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:15:57.865545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.868055 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.019 seconds
[0m10:15:57.871243 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:15:57.877156 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.020 seconds
[0m10:15:57.877977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m10:15:57.878620 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:15:57.880013 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m10:15:57.880732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m10:15:57.881073 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m10:15:57.882639 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m10:15:57.886467 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.885162 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:15:57.888636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m10:15:57.890006 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.887964 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m10:15:57.889492 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:15:57.889990 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m10:15:57.890889 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m10:15:57.891272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.892100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.892978 [info ] [MainThread]: 
[0m10:15:57.895277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:57.896310 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.896955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:15:57.897411 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m10:15:57.897773 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:15:57.899541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.899929 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.900665 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m10:15:57.902219 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:15:57.903893 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:15:57.904825 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.904095 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:15:57.905853 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:15:57.906715 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:15:57.906371 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.907322 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.908010 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m10:15:57.908094 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:15:57.908509 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m10:15:57.908936 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m10:15:57.909257 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:15:57.909635 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:15:57.910476 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:15:57.911548 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:15:57.911630 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.912533 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:15:57.914324 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:15:57.914048 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:15:57.914599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m10:15:57.915323 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:15:57.915925 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m10:15:57.916089 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m10:15:57.916764 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m10:15:57.916303 [info ] [MainThread]: 
[0m10:15:57.917923 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m10:15:57.918761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:57.915350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:15:57.925061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m10:15:57.920991 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:57.923897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:15:57.925960 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:15:57.926703 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:15:57.927372 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:15:57.928160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.928729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.923286 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:15:57.924139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m10:15:57.932004 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:15:57.935655 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:15:57.935813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.936295 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:57.936602 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:15:57.937324 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:15:57.925194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:15:57.925699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:15:57.939333 [info ] [MainThread]: 
[0m10:15:57.941457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:57.938696 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:57.941632 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m10:15:57.942414 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m10:15:57.942890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:15:57.941794 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:15:57.940519 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:15:57.942578 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:15:57.943211 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:57.944592 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:15:57.944831 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:15:57.943840 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:15:57.945590 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:15:57.946622 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:15:57.946310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.944228 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:15:57.948426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.944591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.950204 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:15:57.946856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.953841 [info ] [MainThread]: 
[0m10:15:57.954315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:15:57.954961 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:15:57.955470 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:57.955330 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:15:57.961017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:15:57.956900 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:15:57.960906 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:15:57.959920 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:15:57.965359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.965027 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:57.955560 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:15:57.966492 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:15:57.965977 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:57.969133 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:15:57.965696 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:15:57.969546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.968553 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:15:57.970768 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:15:57.971094 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:15:57.971570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.971378 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m10:15:57.971355 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:15:57.972658 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:15:57.972904 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:15:57.972295 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:15:57.973286 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:15:57.973331 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:15:57.973924 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:15:57.974352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.974742 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:15:57.978608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:15:57.981320 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:57.982331 [debug] [MainThread]: On master: BEGIN
[0m10:15:57.979200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:15:57.984832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:57.984520 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:57.986717 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:15:57.987177 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:15:57.987807 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:15:57.987725 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:15:57.988538 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:15:57.988206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:57.989097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.988804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:57.990832 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:15:57.991342 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:57.991860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:15:57.994495 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m10:15:57.994615 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:15:57.999209 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:15:57.999712 [debug] [MainThread]: On master: ROLLBACK
[0m10:15:58.000312 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:58.000714 [debug] [MainThread]: On master: BEGIN
[0m10:15:58.001306 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:15:58.001781 [debug] [MainThread]: On master: COMMIT
[0m10:15:58.002146 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:58.002450 [debug] [MainThread]: On master: COMMIT
[0m10:15:58.002858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:15:58.003294 [debug] [MainThread]: On master: Close
[0m10:15:58.003899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:15:58.004197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:15:58.004922 [info ] [MainThread]: 
[0m10:15:58.004807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:15:58.009859 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:15:58.012080 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:58.013377 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:15:58.012894 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:15:58.013875 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m10:15:58.014254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:58.013823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:58.014574 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m10:15:58.016044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m10:15:58.016782 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m10:15:58.019427 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:15:58.019856 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:15:58.020229 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:15:58.022289 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:15:58.023624 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:15:58.024363 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:15:58.025134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m10:15:58.033433 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m10:15:58.060819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m10:15:58.062376 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:15:58.062797 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m10:15:58.063189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:02.940632 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m10:16:02.944544 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:02.947218 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:02.950351 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:02.951750 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:16:02.954804 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:02.954580 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m10:16:02.955633 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:02.955626 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:02.955104 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:02.956483 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:02.957241 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:02.959602 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:16:02.961310 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:02.959921 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:02.962366 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:02.961868 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:02.963542 [debug] [MainThread]: On master: BEGIN
[0m10:16:02.963070 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:02.964243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:02.965110 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:02.971975 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:02.972164 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m10:16:02.974210 [debug] [MainThread]: On master: BEGIN
[0m10:16:02.974018 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m10:16:02.974938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:02.974607 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:02.975088 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:02.978428 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:02.979109 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:02.981334 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:16:02.981646 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:02.983409 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m10:16:02.984296 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:16:02.985231 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:02.983123 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:02.985703 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:02.984534 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:02.986929 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:02.986843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:02.986256 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:02.991878 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:16:02.991665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:16:02.992792 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m10:16:02.993557 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:02.993343 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m10:16:02.994606 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:02.994109 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:02.994743 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:02.996277 [debug] [MainThread]: On master: BEGIN
[0m10:16:02.996712 [debug] [MainThread]: On master: BEGIN
[0m10:16:02.994727 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:02.996668 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:02.997325 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:02.997342 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:02.997755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:02.998357 [debug] [MainThread]: On master: COMMIT
[0m10:16:02.999595 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:02.999552 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:02.992600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:16:03.003099 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.004085 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:16:03.004436 [debug] [MainThread]: On master: Close
[0m10:16:03.004963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:03.002504 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:03.006121 [info ] [MainThread]: 
[0m10:16:03.005532 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:03.007083 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:03.006526 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:02.999935 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:16:03.007673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:03.008268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:03.007174 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:03.009014 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:03.009659 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:03.010089 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:03.016056 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.016165 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:16:03.017209 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:03.016846 [debug] [MainThread]: On master: BEGIN
[0m10:16:03.016923 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m10:16:03.017687 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:03.017755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:03.017859 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:03.018731 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:03.019387 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m10:16:03.019917 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:03.020161 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m10:16:03.021162 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:03.021587 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:03.021806 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:03.021762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m10:16:03.022647 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:03.023231 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.023236 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:03.023264 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m10:16:03.023901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:03.024153 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:03.026443 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:16:03.027820 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:03.028413 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.028838 [debug] [MainThread]: On master: BEGIN
[0m10:16:03.029531 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:03.029821 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.030071 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.030415 [debug] [MainThread]: On master: BEGIN
[0m10:16:03.030529 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.030724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m10:16:03.030859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:03.030945 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.032298 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:03.032712 [debug] [MainThread]: On master: Close
[0m10:16:03.032695 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m10:16:03.033355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:03.035043 [info ] [MainThread]: 
[0m10:16:03.035557 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:03.036359 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.037202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:03.042205 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:16:03.044092 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m10:16:03.045438 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m10:16:03.045582 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:03.046295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m10:16:03.048119 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m10:16:03.046690 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.052143 [debug] [MainThread]: On master: BEGIN
[0m10:16:03.053302 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:16:03.053762 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.054191 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.054588 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.055048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:03.055466 [debug] [MainThread]: On master: Close
[0m10:16:03.056060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:03.056664 [info ] [MainThread]: 
[0m10:16:03.057526 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m10:16:03.061574 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m10:16:03.063409 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m10:16:03.063888 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:16:03.064382 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m10:16:03.065470 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m10:16:03.063133 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m10:16:03.064483 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m10:16:03.068258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:03.068343 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:16:03.068719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m10:16:03.069194 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m10:16:03.069370 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m10:16:03.071623 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:16:03.079448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:03.079871 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:16:03.079948 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:16:03.080417 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m10:16:03.080540 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m10:16:03.081086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:03.081874 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:16:03.083152 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m10:16:03.087088 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:16:03.087169 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m10:16:03.087524 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m10:16:03.091320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:03.091914 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m10:16:03.093202 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:16:03.095126 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m10:16:03.096546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:03.097634 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m10:16:03.098765 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m10:16:03.099172 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m10:16:03.099545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:03.102812 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m10:16:03.104702 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m10:16:03.105103 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:16:03.105417 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m10:16:03.106188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:16:03.108498 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:16:03.110502 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m10:16:03.111884 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:03.112582 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m10:16:03.114894 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m10:16:03.116637 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 5.10s]
[0m10:16:03.115599 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m10:16:03.117613 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m10:16:03.118874 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:16:03.119404 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m10:16:03.119357 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.119563 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:16:03.119902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:03.120195 [debug] [MainThread]: On master: BEGIN
[0m10:16:03.120551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:03.120564 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m10:16:03.121253 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:03.123272 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m10:16:03.124645 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m10:16:03.124616 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:16:03.125338 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m10:16:03.125620 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.126103 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.126687 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.126717 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.127142 [debug] [MainThread]: On master: BEGIN
[0m10:16:03.127213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:03.127535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:03.127846 [debug] [MainThread]: On master: Close
[0m10:16:03.128705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:03.129156 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:16:03.129784 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m10:16:03.131191 [info ] [MainThread]: 
[0m10:16:03.131608 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m10:16:03.132278 [debug] [MainThread]: Command end result
[0m10:16:03.132640 [info ] [MainThread]: 
[0m10:16:03.133521 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:16:03.133267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:03.135172 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.137106 [info ] [MainThread]: 
[0m10:16:03.137872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:03.137524 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:03.139059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.670062, "process_user_time": 3.492311, "process_kernel_time": 0.25055, "process_mem_max_rss": "112868", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m10:16:03.139398 [debug] [MainThread]: On master: COMMIT
[0m10:16:03.140203 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:03.140090 after 7.67 seconds
[0m10:16:03.141279 [debug] [MainThread]: Flushing usage events
[0m10:16:03.140828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:03.141754 [debug] [MainThread]: On master: Close
[0m10:16:03.144322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:03.146206 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m10:16:03.146527 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:16:03.146844 [info ] [MainThread]: 
[0m10:16:03.147230 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m10:16:03.147864 [debug] [MainThread]: Command end result
[0m10:16:03.150117 [info ] [MainThread]: 
[0m10:16:03.150672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:03.152750 [info ] [MainThread]: 
[0m10:16:03.157828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:03.158989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.734637, "process_user_time": 3.512229, "process_kernel_time": 0.222786, "process_mem_max_rss": "112788", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m10:16:03.160249 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:03.160148 after 7.74 seconds
[0m10:16:03.162416 [debug] [MainThread]: Flushing usage events
[0m10:16:05.925610 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:05.931106 | 8b4434f2-736f-4885-a644-1dcf89f6cc24 ==============================
[0m10:16:05.931106 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:05.931886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:05.979361 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:06.004590 | f9c63daa-fefa-428e-b0f8-d7438e6aa1a3 ==============================
[0m10:16:06.004590 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:06.012161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:06.046897 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:06.053378 | e36cb2af-8541-4cbd-a952-0b972a22ceb7 ==============================
[0m10:16:06.053378 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:06.054495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:06.208606 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:06.213504 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:06.228354 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:06.231453 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:06.251528 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:06.270984 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:06.438853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:06.439586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:06.444556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:06.445535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:06.466386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:06.467037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:06.521282 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:06.523602 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:06.525214 [info ] [MainThread]: 
[0m10:16:06.526509 [info ] [MainThread]: 
[0m10:16:06.525905 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:06.527179 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:06.527058 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:06.528570 [info ] [MainThread]: 
[0m10:16:06.529201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:06.528988 [debug] [MainThread]: Command end result
[0m10:16:06.530291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:06.530827 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6530424, "process_user_time": 1.414144, "process_kernel_time": 0.086885, "process_mem_max_rss": "97592", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:06.532381 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:06.532297 after 0.65 seconds
[0m10:16:06.531796 [debug] [MainThread]: Command end result
[0m10:16:06.532719 [debug] [MainThread]: Flushing usage events
[0m10:16:06.533358 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.63496125, "process_user_time": 1.437497, "process_kernel_time": 0.084263, "process_mem_max_rss": "97508", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:06.535565 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:06.535212 after 0.64 seconds
[0m10:16:06.540421 [debug] [MainThread]: Flushing usage events
[0m10:16:06.564443 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:06.568231 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:06.570028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:06.590476 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m10:16:06.592955 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:06.608243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:16:06.616730 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:06.619193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:16:06.620809 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:06.625085 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:06.627396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:06.631112 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:06.631748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:06.640288 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:16:06.641008 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:06.643383 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:06.647738 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:16:06.652206 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:06.652781 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:07.978761 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m10:16:07.980538 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:07.981337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:07.986125 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m10:16:07.992938 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:07.993958 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:07.994780 [debug] [MainThread]: On master: BEGIN
[0m10:16:07.995890 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:07.996620 [debug] [MainThread]: On master: COMMIT
[0m10:16:07.997559 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.003023 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.005152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:08.006240 [debug] [MainThread]: On master: Close
[0m10:16:08.007834 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:08.009772 [info ] [MainThread]: 
[0m10:16:08.013723 [debug] [MainThread]: SQL status: BEGIN in 5.015 seconds
[0m10:16:08.016694 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.017665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:08.022765 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m10:16:08.026073 [debug] [ThreadPool]: SQL status: BEGIN in 5.017 seconds
[0m10:16:08.028162 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:08.029724 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:08.030411 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:08.030952 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m10:16:08.031289 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.032738 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m10:16:08.032698 [debug] [MainThread]: On master: BEGIN
[0m10:16:08.034847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m10:16:08.036123 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m10:16:08.035368 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:16:08.040589 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:08.041569 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:16:08.041854 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:08.044846 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.045911 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.047447 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.048474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m10:16:08.049618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:08.050556 [debug] [MainThread]: On master: Close
[0m10:16:08.052929 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m10:16:08.053596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:08.057238 [info ] [MainThread]: 
[0m10:16:08.057905 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.059870 [debug] [MainThread]: On master: BEGIN
[0m10:16:08.061546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:08.072080 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m10:16:08.072767 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:16:08.073439 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m10:16:08.077099 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.078306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m10:16:08.079922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:08.081377 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m10:16:08.084071 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m10:16:08.086800 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:08.088708 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.090402 [debug] [MainThread]: On master: BEGIN
[0m10:16:08.094249 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:16:08.096327 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.098360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m10:16:08.098892 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.099337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m10:16:08.102349 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.104485 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:08.107249 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m10:16:08.106281 [debug] [MainThread]: On master: Close
[0m10:16:08.105971 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:16:08.114436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:08.115526 [info ] [MainThread]: 
[0m10:16:08.115375 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m10:16:08.116557 [debug] [Thread-1 (]: SQL status: BEGIN in 5.016 seconds
[0m10:16:08.118642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:08.119872 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m10:16:08.122291 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname, countryname, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m10:16:08.127180 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m10:16:08.129109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:16:08.128857 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m10:16:08.130816 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:16:08.132626 [debug] [Thread-1 (]: SQL status: BEGIN in 5.011 seconds
[0m10:16:08.134978 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m10:16:08.135136 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:16:08.135269 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m10:16:08.136688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m10:16:08.136627 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m10:16:08.138169 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m10:16:08.140611 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:16:08.142649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:16:08.145881 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m10:16:08.150787 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m10:16:08.152845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:16:08.155919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m10:16:08.158089 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:16:08.158361 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m10:16:08.159566 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m10:16:08.160837 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:16:08.161910 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m10:16:08.162569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:16:08.163656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:16:08.176132 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m10:16:08.177572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m10:16:08.180612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m10:16:08.181224 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m10:16:08.181401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:16:08.181565 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m10:16:08.182165 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:16:08.182457 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m10:16:08.182765 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m10:16:08.182489 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m10:16:08.183216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:08.183391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:08.183612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:16:08.184062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:08.184392 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m10:16:08.186712 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:08.190770 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m10:16:08.191713 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m10:16:08.193334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:16:08.196596 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:16:08.197021 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m10:16:08.197457 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m10:16:08.197610 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m10:16:08.198390 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:16:08.199770 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:16:08.202204 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:16:08.202309 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m10:16:08.202197 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m10:16:08.202541 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m10:16:08.202892 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m10:16:08.203737 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:16:08.203359 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:08.205829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:08.208933 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m10:16:08.209068 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:16:08.210297 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m10:16:08.209815 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:16:08.211851 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m10:16:08.212421 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.16s]
[0m10:16:08.212838 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m10:16:08.212763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:16:08.213101 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m10:16:08.213183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:08.213485 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m10:16:08.215426 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m10:16:08.217493 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m10:16:08.218745 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.217489 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 5.15s]
[0m10:16:08.219660 [debug] [MainThread]: On master: BEGIN
[0m10:16:08.220461 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m10:16:08.220354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:08.221203 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.222210 [debug] [MainThread]: On master: BEGIN
[0m10:16:08.222941 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:08.223131 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.223629 [debug] [MainThread]: On master: BEGIN
[0m10:16:08.225396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:08.226341 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:16:08.227108 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.227407 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:16:08.227856 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.227988 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.228412 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.228677 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.229299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:08.229170 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m10:16:08.229370 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.229725 [debug] [MainThread]: On master: Close
[0m10:16:08.229913 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:16:08.230086 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:08.230323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:08.230609 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m10:16:08.230665 [debug] [MainThread]: On master: Close
[0m10:16:08.230821 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m10:16:08.231392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:08.231524 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:08.231893 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:16:08.231925 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:08.232148 [info ] [MainThread]: 
[0m10:16:08.232469 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m10:16:08.233065 [info ] [MainThread]: 
[0m10:16:08.232977 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m10:16:08.233868 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.42 seconds (10.42s).
[0m10:16:08.234261 [debug] [MainThread]: Command end result
[0m10:16:08.234694 [info ] [MainThread]: 
[0m10:16:08.234773 [debug] [MainThread]: Command end result
[0m10:16:08.235387 [info ] [MainThread]: 
[0m10:16:08.235455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:08.236068 [info ] [MainThread]: 
[0m10:16:08.236142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:08.236889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:08.237143 [info ] [MainThread]: 
[0m10:16:08.237734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:08.238417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.671408, "process_user_time": 3.551235, "process_kernel_time": 0.282251, "process_mem_max_rss": "112780", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m10:16:08.239111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.782371, "process_user_time": 3.709542, "process_kernel_time": 0.20269, "process_mem_max_rss": "112476", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m10:16:08.239388 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:08.239272 after 12.67 seconds
[0m10:16:08.239937 [debug] [MainThread]: Flushing usage events
[0m10:16:08.240109 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:08.240030 after 12.78 seconds
[0m10:16:08.240084 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m10:16:08.240726 [debug] [MainThread]: Flushing usage events
[0m10:16:08.248990 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:16:08.257459 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m10:16:08.259270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:08.263363 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m10:16:08.271611 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m10:16:08.273678 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m10:16:08.287100 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.294444 [debug] [MainThread]: On master: BEGIN
[0m10:16:08.301337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:08.317589 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:16:08.321114 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.326364 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:08.326860 [debug] [MainThread]: On master: COMMIT
[0m10:16:08.327493 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:08.328075 [debug] [MainThread]: On master: Close
[0m10:16:08.333877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:08.334593 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m10:16:08.335402 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:08.336098 [info ] [MainThread]: 
[0m10:16:08.339315 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m10:16:08.341082 [debug] [MainThread]: Command end result
[0m10:16:08.341767 [info ] [MainThread]: 
[0m10:16:08.342740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:08.343617 [info ] [MainThread]: 
[0m10:16:08.344455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:08.346657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.910149, "process_user_time": 3.622922, "process_kernel_time": 0.250809, "process_mem_max_rss": "112668", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m10:16:08.347661 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:08.347529 after 12.91 seconds
[0m10:16:08.348442 [debug] [MainThread]: Flushing usage events
[0m10:16:10.999724 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:16:11.000363 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:11.005218 | b1a81334-681b-45f6-a3e7-8420d06299b8 ==============================
[0m10:16:11.005218 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:16:11.005612 | 55d0db0b-63ab-4c49-85a2-3c9fd2f6c11d ==============================
[0m10:16:11.005612 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:11.006672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:11.006548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m10:16:11.004754 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:16:11.004765 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:11.012394 | 8329e092-8240-4663-9d7d-9c274a221d8b ==============================
[0m10:16:11.012394 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:16:11.012384 | 14c94daf-4127-4c9a-a457-2e968f49ad74 ==============================
[0m10:16:11.012384 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:11.013744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:11.013709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:11.232475 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:11.242963 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:11.247120 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:11.258881 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:11.263213 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:11.271947 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:11.286195 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:11.286473 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:11.446794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:11.447420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:11.460055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:11.460636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:11.466398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:11.466906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:11.466871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:11.467480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:11.500183 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:11.501929 [info ] [MainThread]: 
[0m10:16:11.502742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:11.503645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:11.524786 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:11.527102 [info ] [MainThread]: 
[0m10:16:11.527693 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:11.530147 [debug] [MainThread]: Command end result
[0m10:16:11.531080 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.56188416, "process_user_time": 1.375653, "process_kernel_time": 0.116991, "process_mem_max_rss": "97580", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:11.531709 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:11.531587 after 0.56 seconds
[0m10:16:11.532168 [debug] [MainThread]: Flushing usage events
[0m10:16:11.537783 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:11.538432 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:11.543959 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:11.544841 [info ] [MainThread]: 
[0m10:16:11.546664 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:11.546098 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:11.544312 [info ] [MainThread]: 
[0m10:16:11.554275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:11.551042 [debug] [MainThread]: Command end result
[0m10:16:11.558070 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:11.560115 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59199476, "process_user_time": 1.4078, "process_kernel_time": 0.090956, "process_mem_max_rss": "97764", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:11.564727 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:11.564514 after 0.60 seconds
[0m10:16:11.565364 [debug] [MainThread]: Command end result
[0m10:16:11.569406 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6090367, "process_user_time": 1.390958, "process_kernel_time": 0.112807, "process_mem_max_rss": "97724", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:11.569186 [debug] [MainThread]: Flushing usage events
[0m10:16:11.570013 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:11.569889 after 0.61 seconds
[0m10:16:11.570493 [debug] [MainThread]: Flushing usage events
[0m10:16:11.575263 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.021 seconds
[0m10:16:11.580443 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:11.597688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:16:11.608269 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:11.608841 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:11.609257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:16:11.609699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:11.611665 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:11.612397 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:11.612721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:11.624527 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:16:11.625537 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:16:11.625839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:11.626414 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:11.626940 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:11.627425 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:11.630920 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m10:16:11.631305 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:16:11.634540 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:11.632667 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:11.635863 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:11.636416 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:11.644144 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.644791 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.645456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:11.646541 [debug] [ThreadPool]: SQL status: BEGIN in 5.019 seconds
[0m10:16:11.647964 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:11.648617 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:11.650875 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m10:16:11.653210 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:11.652308 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:16:11.653773 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:11.653747 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.655541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:11.661349 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m10:16:11.662774 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:11.663459 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.663102 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.663869 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.664181 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.664599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:11.664881 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:11.665770 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.666420 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.666756 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.667425 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:11.668969 [debug] [MainThread]: On master: Close
[0m10:16:11.669499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:11.670347 [info ] [MainThread]: 
[0m10:16:11.672482 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:16:11.676310 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.676893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:11.678779 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m10:16:11.679475 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m10:16:11.680264 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m10:16:11.680697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m10:16:11.682071 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:11.682725 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.682432 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m10:16:11.683152 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.684041 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:11.684499 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.684813 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.685149 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.685592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:11.685955 [debug] [MainThread]: On master: Close
[0m10:16:11.686685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:11.687484 [info ] [MainThread]: 
[0m10:16:11.691025 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m10:16:11.693667 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m10:16:11.697888 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m10:16:11.699327 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m10:16:11.702312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m10:16:11.702735 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m10:16:11.710513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m10:16:11.711867 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m10:16:11.724450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m10:16:11.728877 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:16:11.729394 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m10:16:11.729802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:11.743057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m10:16:11.744678 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:16:11.745213 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m10:16:11.745676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:11.750522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:16:11.751279 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:16:11.751735 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m10:16:11.753439 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:16:11.758985 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:16:11.759766 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m10:16:11.760449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:11.771800 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m10:16:11.772581 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:16:11.773130 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m10:16:11.774211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:11.779726 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m10:16:11.783272 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:16:11.783714 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m10:16:11.784353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:11.787457 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m10:16:11.789252 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m10:16:11.790012 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m10:16:11.791692 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.792337 [debug] [MainThread]: On master: BEGIN
[0m10:16:11.792924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:11.797599 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:11.798204 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.798645 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:11.799122 [debug] [MainThread]: On master: COMMIT
[0m10:16:11.799818 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:11.800310 [debug] [MainThread]: On master: Close
[0m10:16:11.801391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:11.802084 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m10:16:11.802762 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:11.803309 [info ] [MainThread]: 
[0m10:16:11.803916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m10:16:11.804801 [debug] [MainThread]: Command end result
[0m10:16:11.805241 [info ] [MainThread]: 
[0m10:16:11.805758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:11.806139 [info ] [MainThread]: 
[0m10:16:11.806678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:11.807803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8638945, "process_user_time": 1.604454, "process_kernel_time": 0.097452, "process_mem_max_rss": "106596", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:16:11.808594 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:11.808491 after 5.86 seconds
[0m10:16:11.809123 [debug] [MainThread]: Flushing usage events
[0m10:16:13.221848 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m10:16:13.223309 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:16:13.223902 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m10:16:13.233082 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m10:16:13.237385 [debug] [MainThread]: On master: COMMIT
[0m10:16:13.240321 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:13.240825 [debug] [MainThread]: On master: COMMIT
[0m10:16:13.241381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:13.241980 [debug] [MainThread]: On master: Close
[0m10:16:13.243203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:13.244481 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m10:16:13.245669 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:16:13.246725 [info ] [MainThread]: 
[0m10:16:13.248565 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m10:16:13.251113 [debug] [MainThread]: Command end result
[0m10:16:13.251915 [info ] [MainThread]: 
[0m10:16:13.252795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:13.253449 [info ] [MainThread]: 
[0m10:16:13.254255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:13.257193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.71974, "process_user_time": 3.586224, "process_kernel_time": 0.233683, "process_mem_max_rss": "112552", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m10:16:13.258515 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:13.258415 after 17.72 seconds
[0m10:16:13.259152 [debug] [MainThread]: Flushing usage events
[0m10:16:13.561748 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.337 seconds
[0m10:16:13.584424 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:16:13.588074 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:16:13.590339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:16:13.600281 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:13.609870 | 79bbaf5a-ec16-4dcc-afec-dd8ad3db7777 ==============================
[0m10:16:13.609870 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:13.610645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m10:16:13.612594 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m10:16:13.608818 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:16:13.614268 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:16:13.616137 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT


============================== 10:16:13.616533 | 7c4e4052-7dee-4731-b648-0c583e6f65b6 ==============================
[0m10:16:13.616533 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:13.617749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:13.626529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:16:13.649705 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m10:16:13.683520 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:16:13.686097 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m10:16:13.689540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:16:13.696211 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m10:16:13.715156 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 5.56s]
[0m10:16:13.718743 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m10:16:13.727095 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:13.728545 [debug] [MainThread]: On master: BEGIN
[0m10:16:13.729611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:13.860163 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:13.897269 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:13.923471 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:13.943638 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:14.245510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:14.246157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:14.256281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:14.256940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:14.321525 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:14.323197 [info ] [MainThread]: 
[0m10:16:14.323838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:14.324968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:14.325875 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:14.327564 [info ] [MainThread]: 
[0m10:16:14.328047 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:14.330425 [debug] [MainThread]: Command end result
[0m10:16:14.332954 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8010325, "process_user_time": 1.536384, "process_kernel_time": 0.115818, "process_mem_max_rss": "97340", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:14.333651 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:14.333548 after 0.80 seconds
[0m10:16:14.334180 [debug] [MainThread]: Flushing usage events
[0m10:16:14.359879 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:14.362428 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:14.363222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:14.370098 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m10:16:14.373217 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:14.388593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:16:14.398770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:16:14.409760 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:14.415184 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:14.412149 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:14.423035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:14.424058 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:14.427091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:14.435440 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:16:14.436336 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:14.443887 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:14.440586 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:16:14.448793 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:14.456487 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:14.450645 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:16:14.457752 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:14.460391 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m10:16:14.463162 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:14.464531 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:14.468103 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:14.473835 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:14.475112 [debug] [MainThread]: On master: BEGIN
[0m10:16:14.479351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:15.957341 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:15.962692 | 1fcb8fb4-872d-4adb-8aa4-ad4f74585799 ==============================
[0m10:16:15.962692 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:15.963388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'send_anonymous_usage_stats': 'True'}
[0m10:16:15.964718 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:15.971447 | 1177d990-59fe-40f4-b313-51e3c05f4bf6 ==============================
[0m10:16:15.971447 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:15.973667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:16.167450 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:16.190716 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:16.205470 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:16.220451 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:16.375681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:16.376354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:16.391817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:16.397122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:16.449613 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:16.451189 [info ] [MainThread]: 
[0m10:16:16.454087 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:16.455673 [debug] [MainThread]: Command end result
[0m10:16:16.456537 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5378358, "process_user_time": 1.307994, "process_kernel_time": 0.084386, "process_mem_max_rss": "98060", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:16.457219 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:16.457809 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:16.457711 after 0.54 seconds
[0m10:16:16.459192 [info ] [MainThread]: 
[0m10:16:16.459725 [debug] [MainThread]: Flushing usage events
[0m10:16:16.460785 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:16.462066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:16.495573 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:16.498141 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:16.498713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:16.507889 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m10:16:16.509207 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:16.513799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:16:16.514488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:16:16.521491 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:16.521942 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:16.522427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:16.519599 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:16.523474 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:16.523803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:16.527885 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:16:16.528758 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:16.529198 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:16:16.529797 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:16.530069 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:16.529514 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:16.532066 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:16.533260 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:16.532278 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m10:16:16.534544 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:16.533721 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:16.534957 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:16.547063 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.550052 [debug] [MainThread]: On master: BEGIN
[0m10:16:16.550456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:16.734757 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m10:16:16.735901 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:16:16.736472 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m10:16:16.738988 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:16:16.747691 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:16:16.748176 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m10:16:16.749021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:16.763241 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m10:16:16.764167 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:16:16.765604 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m10:16:16.766930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:16.772268 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m10:16:16.775743 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:16:16.776165 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m10:16:16.776729 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:16.779250 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m10:16:16.780971 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.10s]
[0m10:16:16.781984 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m10:16:16.783609 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:16.784045 [debug] [MainThread]: On master: BEGIN
[0m10:16:16.784441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:18.736225 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m10:16:18.738565 [debug] [MainThread]: On master: COMMIT
[0m10:16:18.739111 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:18.739588 [debug] [MainThread]: On master: COMMIT
[0m10:16:18.740145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:18.744074 [debug] [MainThread]: On master: Close
[0m10:16:18.746285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:18.748235 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m10:16:18.749196 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:18.749954 [info ] [MainThread]: 
[0m10:16:18.752404 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.81 seconds (20.81s).
[0m10:16:18.753532 [debug] [MainThread]: Command end result
[0m10:16:18.754780 [info ] [MainThread]: 
[0m10:16:18.756376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:18.757145 [info ] [MainThread]: 
[0m10:16:18.758528 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:18.760586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.298248, "process_user_time": 3.737364, "process_kernel_time": 0.235577, "process_mem_max_rss": "112524", "process_out_blocks": "1192", "process_in_blocks": "0"}
[0m10:16:18.762260 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:18.762155 after 23.30 seconds
[0m10:16:18.763044 [debug] [MainThread]: Flushing usage events
[0m10:16:19.486760 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m10:16:19.490180 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:19.493663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:19.497943 [debug] [MainThread]: SQL status: SELECT 8 in 0.003 seconds
[0m10:16:19.500957 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:19.501652 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:19.502206 [debug] [MainThread]: On master: BEGIN
[0m10:16:19.504096 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:19.506698 [debug] [MainThread]: On master: COMMIT
[0m10:16:19.511292 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:19.514515 [debug] [MainThread]: On master: COMMIT
[0m10:16:19.518307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:19.519938 [debug] [MainThread]: On master: Close
[0m10:16:19.521428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:19.528540 [info ] [MainThread]: 
[0m10:16:19.537812 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m10:16:19.542391 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m10:16:19.543124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m10:16:19.543657 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m10:16:19.552137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m10:16:19.553377 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m10:16:19.586580 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m10:16:19.599372 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:16:19.607280 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m10:16:19.618767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:19.641085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:16:19.648307 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:16:19.662910 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m10:16:19.665954 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m10:16:19.672284 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:16:19.672745 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m10:16:19.673386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:19.689350 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m10:16:19.690466 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:16:19.691590 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m10:16:19.693049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:19.703694 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m10:16:19.712571 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:16:19.714232 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m10:16:19.714824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:16:19.717167 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m10:16:19.718844 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.17s]
[0m10:16:19.720260 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m10:16:19.725248 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:19.729837 [debug] [MainThread]: On master: BEGIN
[0m10:16:19.730270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:19.735127 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:19.735719 [debug] [MainThread]: On master: COMMIT
[0m10:16:19.736208 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:19.736634 [debug] [MainThread]: On master: COMMIT
[0m10:16:19.737124 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:19.737509 [debug] [MainThread]: On master: Close
[0m10:16:19.738015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:19.738382 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:19.738712 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m10:16:19.739242 [info ] [MainThread]: 
[0m10:16:19.739805 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m10:16:19.740643 [debug] [MainThread]: Command end result
[0m10:16:19.741040 [info ] [MainThread]: 
[0m10:16:19.741546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:19.741905 [info ] [MainThread]: 
[0m10:16:19.742422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:19.743539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.213559, "process_user_time": 1.764111, "process_kernel_time": 0.106197, "process_mem_max_rss": "106176", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:16:19.744249 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:19.744158 after 6.21 seconds
[0m10:16:19.744773 [debug] [MainThread]: Flushing usage events
[0m10:16:21.095492 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:21.100549 | 650bc914-32b8-4af7-acb3-54e3ce1bb0bd ==============================
[0m10:16:21.100549 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:21.101294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:21.311886 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:21.333520 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:21.531509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:21.532138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:21.556470 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m10:16:21.558167 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:21.561250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:21.564186 [debug] [MainThread]: SQL status: SELECT 8 in 0.002 seconds
[0m10:16:21.570312 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:21.574077 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:21.574513 [debug] [MainThread]: On master: BEGIN
[0m10:16:21.578305 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:21.578714 [debug] [MainThread]: On master: COMMIT
[0m10:16:21.579055 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:21.582988 [debug] [MainThread]: On master: COMMIT
[0m10:16:21.584134 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:16:21.586443 [debug] [MainThread]: On master: Close
[0m10:16:21.588753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:21.590225 [info ] [MainThread]: 
[0m10:16:21.598461 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m10:16:21.599359 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m10:16:21.600169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m10:16:21.600775 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m10:16:21.609439 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m10:16:21.611008 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m10:16:21.621750 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:21.624734 [info ] [MainThread]: 
[0m10:16:21.629071 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:21.630894 [debug] [MainThread]: Command end result
[0m10:16:21.631732 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.584267, "process_user_time": 1.344084, "process_kernel_time": 0.102387, "process_mem_max_rss": "97612", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:21.632430 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:21.632331 after 0.59 seconds
[0m10:16:21.633013 [debug] [MainThread]: Flushing usage events
[0m10:16:21.645614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m10:16:21.653121 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:16:21.653627 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m10:16:21.654081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:21.660536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:16:21.664136 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:16:21.664647 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m10:16:21.666430 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:16:21.676093 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:16:21.680157 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m10:16:21.680908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:21.692257 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m10:16:21.698403 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:16:21.699061 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m10:16:21.707877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:16:21.725657 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m10:16:21.729187 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:16:21.733546 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m10:16:21.750197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m10:16:21.756366 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m10:16:21.761616 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:16:21.768672 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m10:16:21.782133 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:21.783402 [debug] [MainThread]: On master: BEGIN
[0m10:16:21.784413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:21.791017 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m10:16:21.792669 [debug] [MainThread]: On master: COMMIT
[0m10:16:21.795526 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:21.796045 [debug] [MainThread]: On master: COMMIT
[0m10:16:21.796657 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:16:21.797681 [debug] [MainThread]: On master: COMMIT
[0m10:16:21.797296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:21.798137 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:21.798486 [debug] [MainThread]: On master: Close
[0m10:16:21.798837 [debug] [MainThread]: On master: COMMIT
[0m10:16:21.799928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:21.800885 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m10:16:21.800587 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:21.801565 [debug] [MainThread]: On master: Close
[0m10:16:21.801284 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:21.803305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:21.802530 [info ] [MainThread]: 
[0m10:16:21.803856 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m10:16:21.805873 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:21.806606 [info ] [MainThread]: 
[0m10:16:21.804807 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m10:16:21.807134 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m10:16:21.808291 [debug] [MainThread]: Command end result
[0m10:16:21.808985 [debug] [MainThread]: Command end result
[0m10:16:21.809419 [info ] [MainThread]: 
[0m10:16:21.809870 [info ] [MainThread]: 
[0m10:16:21.810515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:21.811142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:21.811642 [info ] [MainThread]: 
[0m10:16:21.812417 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:21.812027 [info ] [MainThread]: 
[0m10:16:21.814978 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:21.814603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.851523, "process_user_time": 1.591513, "process_kernel_time": 0.111649, "process_mem_max_rss": "106012", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m10:16:21.816515 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:21.816377 after 10.85 seconds
[0m10:16:21.816480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8928385, "process_user_time": 1.500182, "process_kernel_time": 0.076828, "process_mem_max_rss": "106176", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:16:21.817398 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:21.817310 after 5.89 seconds
[0m10:16:21.818003 [debug] [MainThread]: Flushing usage events
[0m10:16:21.818550 [debug] [MainThread]: Flushing usage events
[0m10:16:22.190306 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:22.196065 | 35401cdf-2642-4769-97e9-8133a12540f3 ==============================
[0m10:16:22.196065 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:22.196799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:22.460688 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:22.486120 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:22.825355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:22.826169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:22.899704 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:22.904166 [info ] [MainThread]: 
[0m10:16:22.904718 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:22.906457 [debug] [MainThread]: Command end result
[0m10:16:22.911063 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7643086, "process_user_time": 1.538556, "process_kernel_time": 0.096916, "process_mem_max_rss": "97792", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:22.911814 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:22.911708 after 0.77 seconds
[0m10:16:22.912336 [debug] [MainThread]: Flushing usage events
[0m10:16:23.775448 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:23.780990 | 7fe2b6d4-1e95-4488-9682-913bf2a9cc99 ==============================
[0m10:16:23.780990 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:23.782072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:16:23.778885 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:23.787217 | 53728d90-78b1-4c9f-95a2-7310cd1f9826 ==============================
[0m10:16:23.787217 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:23.787921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:23.821960 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:23.827046 | 4ccbf96b-bbc9-483a-bd26-5a6d32a0b6c4 ==============================
[0m10:16:23.827046 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:23.827853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:23.887485 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:23.894386 | cb93b364-98e0-4ed5-8952-2994b65445a3 ==============================
[0m10:16:23.894386 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:23.895318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:23.964339 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:23.966375 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:23.982219 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:23.987935 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:24.005686 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:24.032462 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:24.089750 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:24.116282 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:24.270759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:24.271251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:24.272694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:24.272203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:24.386217 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:24.390834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:24.391847 [info ] [MainThread]: 
[0m10:16:24.392905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:24.392299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:24.396482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:24.429410 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:24.431403 [info ] [MainThread]: 
[0m10:16:24.432009 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:24.433948 [debug] [MainThread]: Command end result
[0m10:16:24.433878 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:24.435021 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6978355, "process_user_time": 1.443851, "process_kernel_time": 0.100309, "process_mem_max_rss": "97508", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:24.434868 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:24.435604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:24.435682 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:24.435579 after 0.70 seconds
[0m10:16:24.436685 [debug] [MainThread]: Flushing usage events
[0m10:16:24.439769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:24.440849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:24.445565 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m10:16:24.447421 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:24.457372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:16:24.458150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:16:24.464178 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:24.466554 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:24.467535 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:24.468105 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:24.471132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:24.469692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:24.477443 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:16:24.478434 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:24.479314 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:24.482467 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:24.483703 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:24.484269 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:24.488628 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:24.490260 [info ] [MainThread]: 
[0m10:16:24.490856 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:24.492687 [debug] [MainThread]: Command end result
[0m10:16:24.493540 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.71432555, "process_user_time": 1.418698, "process_kernel_time": 0.090812, "process_mem_max_rss": "97344", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:24.494296 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:24.494143 after 0.72 seconds
[0m10:16:24.494842 [debug] [MainThread]: Flushing usage events
[0m10:16:24.512514 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:24.514616 [info ] [MainThread]: 
[0m10:16:24.515411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:24.516327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:24.547814 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:24.548469 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:24.549033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:24.556594 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m10:16:24.561402 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:24.568294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:16:24.569117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:16:24.577359 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:24.579950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:24.581251 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:24.582636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:24.582153 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:24.583557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:24.589213 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:16:24.589849 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:24.590793 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:24.590260 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:16:24.593136 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:24.593489 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:24.596881 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:24.598373 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:24.599268 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:24.600680 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m10:16:24.601756 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:24.602221 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:24.608161 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:24.608568 [debug] [MainThread]: On master: BEGIN
[0m10:16:24.608912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:29.485759 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m10:16:29.488768 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:29.489344 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:29.492836 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m10:16:29.495816 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:29.496406 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:29.516558 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.517197 [debug] [MainThread]: On master: BEGIN
[0m10:16:29.517703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:29.526053 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:16:29.526895 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.527434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:29.533175 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m10:16:29.538480 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:29.539170 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.545291 [debug] [MainThread]: On master: BEGIN
[0m10:16:29.547888 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:29.549068 [debug] [MainThread]: On master: COMMIT
[0m10:16:29.549554 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.549961 [debug] [MainThread]: On master: COMMIT
[0m10:16:29.550459 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:29.550893 [debug] [MainThread]: On master: Close
[0m10:16:29.552102 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:29.555846 [info ] [MainThread]: 
[0m10:16:29.562691 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m10:16:29.563430 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m10:16:29.564032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m10:16:29.564396 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m10:16:29.571414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m10:16:29.573098 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m10:16:29.607760 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m10:16:29.610741 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:16:29.612940 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m10:16:29.613303 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m10:16:29.613874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:29.614194 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.615423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:29.618506 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m10:16:29.620878 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:29.621357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:16:29.621717 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.622314 [debug] [MainThread]: On master: BEGIN
[0m10:16:29.622601 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:16:29.623150 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m10:16:29.623477 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:29.623921 [debug] [MainThread]: On master: COMMIT
[0m10:16:29.624333 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.624732 [debug] [MainThread]: On master: COMMIT
[0m10:16:29.625369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:29.625871 [debug] [MainThread]: On master: Close
[0m10:16:29.626158 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m10:16:29.626536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:29.627087 [info ] [MainThread]: 
[0m10:16:29.633776 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:16:29.634386 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m10:16:29.634891 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m10:16:29.635680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:29.635463 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m10:16:29.640212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m10:16:29.640681 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m10:16:29.647818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m10:16:29.649251 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m10:16:29.649874 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m10:16:29.651275 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:16:29.653613 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m10:16:29.657725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:29.663640 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m10:16:29.667912 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:16:29.672212 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m10:16:29.672824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:16:29.675032 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m10:16:29.676468 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.11s]
[0m10:16:29.677064 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m10:16:29.678202 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.678563 [debug] [MainThread]: On master: BEGIN
[0m10:16:29.678876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:29.681658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m10:16:29.682754 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:16:29.683339 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:16:29.683631 [debug] [MainThread]: On master: COMMIT
[0m10:16:29.684015 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m10:16:29.684321 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:29.684645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:29.684962 [debug] [MainThread]: On master: COMMIT
[0m10:16:29.686838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:29.689012 [debug] [MainThread]: On master: Close
[0m10:16:29.689868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:29.690386 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m10:16:29.690840 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:29.693221 [info ] [MainThread]: 
[0m10:16:29.697782 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m10:16:29.699604 [debug] [MainThread]: Command end result
[0m10:16:29.700893 [info ] [MainThread]: 
[0m10:16:29.702095 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:29.702814 [info ] [MainThread]: 
[0m10:16:29.703631 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:29.706235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.978798, "process_user_time": 1.660041, "process_kernel_time": 0.123154, "process_mem_max_rss": "106356", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:16:29.709575 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:29.709388 after 5.98 seconds
[0m10:16:29.710327 [debug] [MainThread]: Flushing usage events
[0m10:16:32.176760 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:32.181801 | eef495d0-48b1-4bb2-b66c-40665e36a9dc ==============================
[0m10:16:32.181801 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:32.185942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:32.186672 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:32.195266 | 60a30146-ca01-4252-9209-9e3134a8035d ==============================
[0m10:16:32.195266 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:32.195886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:32.374122 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:32.390049 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:32.401152 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:32.425064 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:32.564307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:32.564857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:32.615440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:32.618422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:32.631379 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:32.634229 [info ] [MainThread]: 
[0m10:16:32.636266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:32.637977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:32.668482 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:32.669861 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:32.671959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:32.678483 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m10:16:32.679622 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:32.684126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:16:32.684714 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:32.687726 [info ] [MainThread]: 
[0m10:16:32.688941 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:32.690543 [debug] [MainThread]: Command end result
[0m10:16:32.691293 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.54997456, "process_user_time": 1.257235, "process_kernel_time": 0.071126, "process_mem_max_rss": "97288", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:32.691903 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:32.691805 after 0.55 seconds
[0m10:16:32.684757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:16:32.692338 [debug] [MainThread]: Flushing usage events
[0m10:16:32.691334 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:32.694197 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:32.695709 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:32.696380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:32.695071 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:32.702833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:32.707191 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:16:32.708307 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:32.708864 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:32.707953 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:16:32.709396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:32.709806 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:32.710926 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:32.712155 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:32.712464 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m10:16:32.714024 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:32.712898 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:32.714458 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:32.720459 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:32.726842 [debug] [MainThread]: On master: BEGIN
[0m10:16:32.727226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:34.693114 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m10:16:34.696604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:16:34.698813 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_id, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m10:16:34.706536 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.007 seconds
[0m10:16:34.712296 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:16:34.712789 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m10:16:34.713446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:34.728591 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m10:16:34.729160 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:16:34.729632 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m10:16:34.730952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:34.736050 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m10:16:34.739455 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:16:34.739840 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m10:16:34.740499 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:16:34.743631 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m10:16:34.746145 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 5.10s]
[0m10:16:34.748140 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m10:16:34.749386 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:34.750059 [debug] [MainThread]: On master: BEGIN
[0m10:16:34.754808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:34.759521 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:34.761887 [debug] [MainThread]: On master: COMMIT
[0m10:16:34.762288 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:34.763060 [debug] [MainThread]: On master: COMMIT
[0m10:16:34.763567 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:34.765241 [debug] [MainThread]: On master: Close
[0m10:16:34.765711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:34.766079 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m10:16:34.766421 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:34.766815 [info ] [MainThread]: 
[0m10:16:34.767275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m10:16:34.768120 [debug] [MainThread]: Command end result
[0m10:16:34.769955 [info ] [MainThread]: 
[0m10:16:34.770429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:34.773932 [info ] [MainThread]: 
[0m10:16:34.777038 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:34.777991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.943369, "process_user_time": 1.589087, "process_kernel_time": 0.104585, "process_mem_max_rss": "106060", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:16:34.778604 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:34.778522 after 10.94 seconds
[0m10:16:34.779051 [debug] [MainThread]: Flushing usage events
[0m10:16:37.260509 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:37.304722 | b90d7165-b9f8-42d5-b0b4-70791550b901 ==============================
[0m10:16:37.304722 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:37.322182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m10:16:37.526380 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:37.550155 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:37.732067 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m10:16:37.732905 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:37.733864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:37.737573 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m10:16:37.745310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:37.745641 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:37.746027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:37.746624 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:37.747047 [debug] [MainThread]: On master: BEGIN
[0m10:16:37.747632 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:37.748113 [debug] [MainThread]: On master: COMMIT
[0m10:16:37.748500 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:37.748841 [debug] [MainThread]: On master: COMMIT
[0m10:16:37.749261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:37.749605 [debug] [MainThread]: On master: Close
[0m10:16:37.750160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:37.750692 [info ] [MainThread]: 
[0m10:16:37.757465 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m10:16:37.763010 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m10:16:37.765060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m10:16:37.765509 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m10:16:37.781580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m10:16:37.785251 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m10:16:37.828492 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:37.827152 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m10:16:37.832660 [info ] [MainThread]: 
[0m10:16:37.834085 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:37.838027 [debug] [MainThread]: Command end result
[0m10:16:37.839287 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:16:37.842185 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6357122, "process_user_time": 1.329351, "process_kernel_time": 0.076364, "process_mem_max_rss": "97504", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:37.843146 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m10:16:37.846144 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:37.845671 after 0.64 seconds
[0m10:16:37.847702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:37.849314 [debug] [MainThread]: Flushing usage events
[0m10:16:37.861408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:16:37.862995 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:16:37.863510 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m10:16:37.868560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:16:37.878023 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:16:37.879992 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m10:16:37.880672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:16:37.891459 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m10:16:37.891860 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:16:37.892201 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m10:16:37.893473 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:16:37.898316 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m10:16:37.901514 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:16:37.901922 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m10:16:37.902453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:16:37.904432 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m10:16:37.905966 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m10:16:37.906930 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m10:16:37.909540 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:37.910128 [debug] [MainThread]: On master: BEGIN
[0m10:16:37.910834 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:37.915437 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:37.916110 [debug] [MainThread]: On master: COMMIT
[0m10:16:37.916493 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:37.916864 [debug] [MainThread]: On master: COMMIT
[0m10:16:37.917331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:37.917751 [debug] [MainThread]: On master: Close
[0m10:16:37.918331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:37.918746 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:37.919089 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m10:16:37.919479 [info ] [MainThread]: 
[0m10:16:37.919888 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.28 seconds (5.28s).
[0m10:16:37.920559 [debug] [MainThread]: Command end result
[0m10:16:37.920943 [info ] [MainThread]: 
[0m10:16:37.921380 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:37.921711 [info ] [MainThread]: 
[0m10:16:37.922090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:37.923024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.782014, "process_user_time": 1.439791, "process_kernel_time": 0.082071, "process_mem_max_rss": "106320", "process_out_blocks": "35", "process_in_blocks": "0"}
[0m10:16:37.923765 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:37.923645 after 5.78 seconds
[0m10:16:37.924227 [debug] [MainThread]: Flushing usage events
[0m10:16:40.157211 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:40.162225 | 12b3dcb6-110a-40a6-8159-85abf1a42a25 ==============================
[0m10:16:40.162225 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:40.162825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:40.170283 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:40.175515 | a15a7705-29f9-4f10-81d7-1b861751acb9 ==============================
[0m10:16:40.175515 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:40.176111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:40.326560 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:40.329073 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:16:40.342828 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:40.346662 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:16:40.524865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:40.525416 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:40.532069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:40.532816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:40.587029 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:40.590684 [info ] [MainThread]: 
[0m10:16:40.591811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:40.593689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:16:40.600088 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:16:40.602617 [info ] [MainThread]: 
[0m10:16:40.604049 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:16:40.606164 [debug] [MainThread]: Command end result
[0m10:16:40.608260 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49552345, "process_user_time": 1.252232, "process_kernel_time": 0.054096, "process_mem_max_rss": "97768", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:16:40.610049 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:40.609800 after 0.50 seconds
[0m10:16:40.610574 [debug] [MainThread]: Flushing usage events
[0m10:16:40.627768 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:16:40.628670 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:16:40.629307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:40.637985 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m10:16:40.639383 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:16:40.644807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:16:40.645519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:16:40.651710 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:40.653798 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:40.654342 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:16:40.654870 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:16:40.659004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:40.660874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:40.667380 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:16:40.667976 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:16:40.668386 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:16:40.670714 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:40.672044 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:16:40.672651 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:16:45.676775 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m10:16:45.683437 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:16:45.685202 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:16:45.691204 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.005 seconds
[0m10:16:45.702382 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:16:45.703102 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:16:45.715815 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.716390 [debug] [MainThread]: On master: BEGIN
[0m10:16:45.719227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:50.736303 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m10:16:50.737534 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:50.738043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:50.742508 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m10:16:50.745852 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:50.746404 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:50.747834 [debug] [MainThread]: On master: BEGIN
[0m10:16:50.749030 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:16:50.749935 [debug] [MainThread]: On master: COMMIT
[0m10:16:50.750450 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:50.750921 [debug] [MainThread]: On master: COMMIT
[0m10:16:50.752087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:50.752635 [debug] [MainThread]: On master: Close
[0m10:16:50.754895 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:50.755629 [info ] [MainThread]: 
[0m10:16:50.769903 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m10:16:50.770700 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m10:16:50.771369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_customer)
[0m10:16:50.771822 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m10:16:50.780996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m10:16:50.783692 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m10:16:50.828957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m10:16:50.840674 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:16:50.841934 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m10:16:50.842907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:55.856347 [debug] [Thread-1 (]: SQL status: BEGIN in 5.013 seconds
[0m10:16:55.857157 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:16:55.857634 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m10:16:57.069886 [debug] [Thread-1 (]: SQL status: SELECT 259084 in 1.212 seconds
[0m10:16:57.078481 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:16:57.081629 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:16:57.082842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:16:57.101505 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m10:16:57.104881 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:16:57.106483 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m10:16:57.108940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:16:57.115055 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m10:16:57.122116 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:16:57.122602 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m10:16:57.123180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:16:57.126813 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m10:16:57.128961 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259084[0m in 6.36s]
[0m10:16:57.129845 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m10:16:57.131580 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:57.134971 [debug] [MainThread]: On master: BEGIN
[0m10:16:57.135372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:57.140774 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:57.141231 [debug] [MainThread]: On master: COMMIT
[0m10:16:57.141618 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:57.141961 [debug] [MainThread]: On master: COMMIT
[0m10:16:57.142430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:57.142783 [debug] [MainThread]: On master: Close
[0m10:16:57.143210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:57.143636 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:16:57.144082 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m10:16:57.144549 [info ] [MainThread]: 
[0m10:16:57.145116 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.55 seconds (16.55s).
[0m10:16:57.146030 [debug] [MainThread]: Command end result
[0m10:16:57.147110 [info ] [MainThread]: 
[0m10:16:57.147714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:57.149859 [info ] [MainThread]: 
[0m10:16:57.150996 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:16:57.154171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.021961, "process_user_time": 1.444416, "process_kernel_time": 0.089646, "process_mem_max_rss": "106280", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:16:57.156521 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:57.156420 after 17.02 seconds
[0m10:16:57.157245 [debug] [MainThread]: Flushing usage events
[0m10:16:59.919419 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:59.925146 | bf3ad9f6-c2d8-4cb0-8425-a7cb0bd1d5cf ==============================
[0m10:16:59.925146 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:59.926007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m10:16:59.927214 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:59.933796 | 7acaa816-c89f-48cd-88c0-3f2efb6b37f5 ==============================
[0m10:16:59.933796 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:59.935500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:59.932605 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:16:59.940920 | 16b3662b-6a91-4180-a0fa-3eded8d40c0a ==============================
[0m10:16:59.940920 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:16:59.941702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m10:17:00.134777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:00.148287 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:00.149919 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:00.155611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:00.169668 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:00.173560 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:00.337615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:00.338222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:00.348973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:00.349535 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:00.369900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:00.370560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:00.398517 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:00.400042 [info ] [MainThread]: 
[0m10:17:00.401343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:00.402440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:17:00.412136 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:00.414441 [info ] [MainThread]: 
[0m10:17:00.415429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:00.416436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:17:00.439273 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:17:00.440785 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:00.441677 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:17:00.442546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:00.443812 [info ] [MainThread]: 
[0m10:17:00.445520 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:17:00.449789 [debug] [MainThread]: Command end result
[0m10:17:00.456416 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.57083875, "process_user_time": 1.447147, "process_kernel_time": 0.148038, "process_mem_max_rss": "97848", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:17:00.457547 [debug] [MainThread]: Command `dbt test` succeeded at 10:17:00.457316 after 0.57 seconds
[0m10:17:00.458304 [debug] [MainThread]: Flushing usage events
[0m10:17:00.464317 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:17:00.474196 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:17:00.476038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:05.456281 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m10:17:05.458907 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:17:05.465245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:17:05.465955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:17:05.472645 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:05.475118 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:17:05.475535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:05.474642 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:05.476393 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:17:05.477077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:05.480913 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:17:05.481471 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:05.482138 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:17:05.485269 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m10:17:05.486945 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:17:05.486676 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m10:17:05.487648 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:17:05.489133 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:17:05.495701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:17:05.496338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:17:05.503432 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:05.505460 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:05.505948 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:17:05.506473 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:17:05.507005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:05.507502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:05.512439 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:17:05.512985 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:05.513520 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:17:05.515885 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:17:05.517100 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:17:05.517598 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:17:10.483401 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:17:10.484581 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:10.485025 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:17:10.487755 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:17:10.489962 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:17:10.490470 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:17:10.498875 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:10.499450 [debug] [MainThread]: On master: BEGIN
[0m10:17:10.499937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:10.515188 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m10:17:10.517250 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:10.518401 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:17:10.522931 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m10:17:10.527166 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:17:10.537997 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:17:10.575510 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:10.577522 [debug] [MainThread]: On master: BEGIN
[0m10:17:10.578826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:10.584660 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:17:10.585424 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:10.585991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:10.589656 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:17:10.592139 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:10.592699 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:10.593226 [debug] [MainThread]: On master: BEGIN
[0m10:17:10.593842 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:17:10.594489 [debug] [MainThread]: On master: COMMIT
[0m10:17:10.598140 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:10.598550 [debug] [MainThread]: On master: COMMIT
[0m10:17:10.598990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:10.599369 [debug] [MainThread]: On master: Close
[0m10:17:10.600056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:10.601045 [info ] [MainThread]: 
[0m10:17:10.610419 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m10:17:10.611124 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m10:17:10.611655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m10:17:10.612130 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m10:17:10.645554 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m10:17:10.680517 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m10:17:10.766411 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m10:17:10.768127 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:17:10.768763 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m10:17:10.769193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:15.506807 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m10:17:15.509231 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:15.509890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:15.518324 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:17:15.523931 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:15.528262 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:15.528695 [debug] [MainThread]: On master: BEGIN
[0m10:17:15.529202 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:17:15.529566 [debug] [MainThread]: On master: COMMIT
[0m10:17:15.530103 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:15.530463 [debug] [MainThread]: On master: COMMIT
[0m10:17:15.530857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:15.531215 [debug] [MainThread]: On master: Close
[0m10:17:15.532320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:15.533103 [info ] [MainThread]: 
[0m10:17:15.544266 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m10:17:15.545304 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m10:17:15.546110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m10:17:15.546549 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m10:17:15.569993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:17:15.571618 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m10:17:15.613431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:17:15.618331 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:17:15.618782 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m10:17:15.619403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:15.627469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:17:15.628191 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:17:15.628835 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m10:17:15.774654 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m10:17:15.779320 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:17:15.781241 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m10:17:17.179542 [debug] [Thread-1 (]: SQL status: SELECT 159084 in 1.549 seconds
[0m10:17:17.196863 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m10:17:17.197516 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:17:17.198108 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m10:17:17.227287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m10:17:17.235345 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m10:17:17.238093 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159084[0m in 1.69s]
[0m10:17:17.239465 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m10:17:17.241524 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:17.242017 [debug] [MainThread]: On master: BEGIN
[0m10:17:17.246102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:17.256833 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:17:17.257683 [debug] [MainThread]: On master: COMMIT
[0m10:17:17.258162 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:17.258566 [debug] [MainThread]: On master: COMMIT
[0m10:17:17.262209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:17.262588 [debug] [MainThread]: On master: Close
[0m10:17:17.263106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:17.263425 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:17:17.263742 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m10:17:17.264174 [info ] [MainThread]: 
[0m10:17:17.265020 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 16.86 seconds (16.86s).
[0m10:17:17.266200 [debug] [MainThread]: Command end result
[0m10:17:17.266625 [info ] [MainThread]: 
[0m10:17:17.267387 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:17.267926 [info ] [MainThread]: 
[0m10:17:17.268534 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:17.270242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.394703, "process_user_time": 1.638999, "process_kernel_time": 0.156914, "process_mem_max_rss": "107076", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m10:17:17.271313 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:17.271191 after 17.40 seconds
[0m10:17:17.272022 [debug] [MainThread]: Flushing usage events
[0m10:17:20.061784 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:17:20.068877 | 13f207ad-53c8-41ee-ac90-677488999fcc ==============================
[0m10:17:20.068877 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:17:20.070381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:17:20.269221 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:20.285754 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:20.609175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:20.610342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:20.688848 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:20.690737 [info ] [MainThread]: 
[0m10:17:20.691468 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:17:20.693441 [debug] [MainThread]: Command end result
[0m10:17:20.694217 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68359214, "process_user_time": 1.461552, "process_kernel_time": 0.149465, "process_mem_max_rss": "97644", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:17:20.694801 [debug] [MainThread]: Command `dbt test` succeeded at 10:17:20.694727 after 0.68 seconds
[0m10:17:20.695196 [debug] [MainThread]: Flushing usage events
[0m10:17:21.916290 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 6.132 seconds
[0m10:17:21.951357 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m10:17:21.952281 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:17:21.952876 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m10:17:21.960120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:17:21.967005 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m10:17:21.975521 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 11.36s]
[0m10:17:21.979784 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m10:17:21.984185 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:21.984721 [debug] [MainThread]: On master: BEGIN
[0m10:17:21.985166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:21.992858 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:17:21.996136 [debug] [MainThread]: On master: COMMIT
[0m10:17:21.999107 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:21.999529 [debug] [MainThread]: On master: COMMIT
[0m10:17:21.999984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:22.000330 [debug] [MainThread]: On master: Close
[0m10:17:22.000833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:22.001187 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m10:17:22.002106 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:17:22.003530 [info ] [MainThread]: 
[0m10:17:22.004784 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 21.59 seconds (21.59s).
[0m10:17:22.007066 [debug] [MainThread]: Command end result
[0m10:17:22.007583 [info ] [MainThread]: 
[0m10:17:22.008339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:22.008754 [info ] [MainThread]: 
[0m10:17:22.009559 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:22.012271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.12408, "process_user_time": 1.702292, "process_kernel_time": 0.188248, "process_mem_max_rss": "106844", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m10:17:22.014346 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:22.014208 after 22.13 seconds
[0m10:17:22.017522 [debug] [MainThread]: Flushing usage events
[0m10:17:25.084528 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:17:25.091989 | 352e9d3f-4ef4-4e31-bb4c-c492b3ee8e56 ==============================
[0m10:17:25.091989 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:17:25.092779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:25.087743 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:17:25.095551 | 13e2f0aa-d663-4450-9130-cc963fa5a55e ==============================
[0m10:17:25.095551 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:17:25.096306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:25.281414 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:25.292466 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:25.301996 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:25.320149 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:25.485110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:25.485689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:25.497095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:25.499110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:25.565670 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:25.566096 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:25.567709 [info ] [MainThread]: 
[0m10:17:25.568807 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:17:25.569333 [info ] [MainThread]: 
[0m10:17:25.571464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:25.570974 [debug] [MainThread]: Command end result
[0m10:17:25.572304 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5290354, "process_user_time": 1.406457, "process_kernel_time": 0.086458, "process_mem_max_rss": "97496", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:17:25.573218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:17:25.573330 [debug] [MainThread]: Command `dbt test` succeeded at 10:17:25.573200 after 0.53 seconds
[0m10:17:25.573832 [debug] [MainThread]: Flushing usage events
[0m10:17:25.606140 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:17:25.606836 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:17:25.607234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:30.618984 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m10:17:30.622417 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:17:30.630573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:17:30.631477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:17:30.638902 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:30.641781 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:17:30.642185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:30.641311 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:30.642914 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:17:30.643511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:35.655442 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m10:17:35.657595 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:35.658170 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:17:35.657054 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m10:17:35.658929 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:35.659431 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:17:35.661147 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:17:35.663551 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:17:35.663896 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.004 seconds
[0m10:17:35.665771 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:17:35.664353 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:17:35.666376 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:17:35.676737 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:35.679597 [debug] [MainThread]: On master: BEGIN
[0m10:17:35.679940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:35.684643 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:17:35.685175 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:35.685613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:35.689114 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:17:35.691730 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:35.692348 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:35.692729 [debug] [MainThread]: On master: BEGIN
[0m10:17:35.693412 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:17:35.693900 [debug] [MainThread]: On master: COMMIT
[0m10:17:35.694339 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:35.694748 [debug] [MainThread]: On master: COMMIT
[0m10:17:35.695231 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:35.695566 [debug] [MainThread]: On master: Close
[0m10:17:35.696301 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:35.696917 [info ] [MainThread]: 
[0m10:17:35.705319 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m10:17:35.706010 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m10:17:35.706531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m10:17:35.706985 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m10:17:35.715294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m10:17:35.717190 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m10:17:35.756147 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m10:17:35.757839 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:17:35.758340 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m10:17:35.758732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:40.766576 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m10:17:40.768112 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:17:40.768825 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m10:17:41.886171 [debug] [Thread-1 (]: SQL status: SELECT 1159084 in 1.116 seconds
[0m10:17:41.899592 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:17:41.900254 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m10:17:41.901063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:17:41.916405 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m10:17:41.917099 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:17:41.918890 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m10:17:41.926688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:17:41.932597 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m10:17:41.937511 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:17:41.938033 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m10:17:41.938593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:17:41.942492 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m10:17:41.945052 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159084[0m in 6.24s]
[0m10:17:41.946259 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m10:17:41.949795 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:41.950545 [debug] [MainThread]: On master: BEGIN
[0m10:17:41.951006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:41.956267 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:17:41.957181 [debug] [MainThread]: On master: COMMIT
[0m10:17:41.957581 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:41.957860 [debug] [MainThread]: On master: COMMIT
[0m10:17:41.958249 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:41.958549 [debug] [MainThread]: On master: Close
[0m10:17:41.959069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:41.959488 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m10:17:41.959922 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:17:41.960411 [info ] [MainThread]: 
[0m10:17:41.960948 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.39 seconds (16.39s).
[0m10:17:41.961648 [debug] [MainThread]: Command end result
[0m10:17:41.962057 [info ] [MainThread]: 
[0m10:17:41.962808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:41.963761 [info ] [MainThread]: 
[0m10:17:41.964236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:41.966972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.92454, "process_user_time": 1.612283, "process_kernel_time": 0.093655, "process_mem_max_rss": "106460", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:17:41.968349 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:41.968249 after 16.93 seconds
[0m10:17:41.971422 [debug] [MainThread]: Flushing usage events
[0m10:17:44.224446 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:17:44.225315 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:17:44.230726 | 81571a3f-a4a2-4dd6-b50e-4d51bc0850f5 ==============================
[0m10:17:44.230726 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:17:44.231228 | 35615731-b936-41f8-867f-ceff04dcea3c ==============================
[0m10:17:44.231228 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:17:44.232296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:44.232094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m10:17:44.425111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:44.435576 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:44.440513 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:44.451821 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:44.621845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:44.622543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:44.635519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:44.638018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:44.695113 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:44.696838 [info ] [MainThread]: 
[0m10:17:44.697732 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:44.699103 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:44.699516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:17:44.701976 [info ] [MainThread]: 
[0m10:17:44.702479 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:17:44.704388 [debug] [MainThread]: Command end result
[0m10:17:44.705210 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5218572, "process_user_time": 1.348172, "process_kernel_time": 0.128689, "process_mem_max_rss": "97760", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:17:44.710051 [debug] [MainThread]: Command `dbt test` succeeded at 10:17:44.709939 after 0.53 seconds
[0m10:17:44.715596 [debug] [MainThread]: Flushing usage events
[0m10:17:44.754702 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:17:44.770155 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:17:44.771136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:44.791301 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.020 seconds
[0m10:17:44.794676 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:17:44.800424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:17:44.801029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:17:44.806073 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:44.807905 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:44.808282 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:17:44.808618 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:17:44.809038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:44.809416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:44.814014 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:17:44.814506 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:44.814944 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:17:44.817943 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m10:17:44.819405 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:17:44.820064 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:17:49.815163 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:17:49.816244 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:49.818049 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:17:49.824319 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:17:49.826009 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:17:49.826500 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:17:49.832430 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:49.832963 [debug] [MainThread]: On master: BEGIN
[0m10:17:49.833319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:49.838200 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:17:49.838762 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:49.839300 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:49.842944 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:17:49.845065 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:49.845612 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:49.846009 [debug] [MainThread]: On master: BEGIN
[0m10:17:49.846582 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:17:49.847036 [debug] [MainThread]: On master: COMMIT
[0m10:17:49.847398 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:49.847697 [debug] [MainThread]: On master: COMMIT
[0m10:17:49.848131 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:49.848442 [debug] [MainThread]: On master: Close
[0m10:17:49.848963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:49.849515 [info ] [MainThread]: 
[0m10:17:49.859515 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m10:17:49.860162 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m10:17:49.860709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m10:17:49.861142 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m10:17:49.868416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m10:17:49.871139 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m10:17:49.902915 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m10:17:49.911734 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:17:49.912209 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m10:17:49.912532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:49.916973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:17:49.920043 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:17:49.923415 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m10:17:51.463497 [debug] [Thread-1 (]: SQL status: SELECT 1159084 in 1.539 seconds
[0m10:17:51.474986 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:17:51.475576 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m10:17:51.476533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:17:51.490087 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m10:17:51.491196 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:17:51.491618 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m10:17:51.502477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:17:51.507773 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m10:17:51.511064 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:17:51.512749 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m10:17:51.513272 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:17:51.520912 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m10:17:51.523070 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159084[0m in 1.66s]
[0m10:17:51.524022 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m10:17:51.525457 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:51.525905 [debug] [MainThread]: On master: BEGIN
[0m10:17:51.526286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:51.534230 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:17:51.535505 [debug] [MainThread]: On master: COMMIT
[0m10:17:51.537219 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:51.537553 [debug] [MainThread]: On master: COMMIT
[0m10:17:51.537964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:51.538264 [debug] [MainThread]: On master: Close
[0m10:17:51.538702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:51.540783 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:17:51.542069 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m10:17:51.543892 [info ] [MainThread]: 
[0m10:17:51.544667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.85 seconds (6.85s).
[0m10:17:51.546151 [debug] [MainThread]: Command end result
[0m10:17:51.546556 [info ] [MainThread]: 
[0m10:17:51.548152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:51.548982 [info ] [MainThread]: 
[0m10:17:51.549343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:51.550685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3734636, "process_user_time": 1.481506, "process_kernel_time": 0.15568, "process_mem_max_rss": "106364", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:17:51.552131 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:51.551866 after 7.37 seconds
[0m10:17:51.553106 [debug] [MainThread]: Flushing usage events
[0m10:17:53.439028 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:17:53.446314 | 3417dee8-b966-4985-9088-71cfdedb1586 ==============================
[0m10:17:53.446314 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:17:53.452111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m10:17:53.616643 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:53.638795 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:17:53.874292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:53.876989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:53.938147 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:17:53.939529 [info ] [MainThread]: 
[0m10:17:53.940073 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:53.944076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:17:53.944812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:17:53.974825 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:53.975279 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:53.975891 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:17:53.976466 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:17:53.976919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:53.977372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:58.987425 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m10:17:58.988653 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:17:58.989064 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:17:58.992606 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m10:17:59.000692 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:17:59.001112 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:17:58.997538 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:17:59.002586 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:17:59.003399 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.002 seconds
[0m10:17:59.006031 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:17:59.006429 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:17:59.012858 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:17:59.018796 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:59.021060 [debug] [MainThread]: On master: BEGIN
[0m10:17:59.022970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:59.028095 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:17:59.031143 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:59.034431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:59.037562 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:17:59.039766 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:59.040288 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:59.040680 [debug] [MainThread]: On master: BEGIN
[0m10:17:59.041245 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:17:59.041740 [debug] [MainThread]: On master: COMMIT
[0m10:17:59.042137 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:59.042494 [debug] [MainThread]: On master: COMMIT
[0m10:17:59.042922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:17:59.043337 [debug] [MainThread]: On master: Close
[0m10:17:59.043912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:59.044417 [info ] [MainThread]: 
[0m10:17:59.050807 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m10:17:59.051385 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m10:17:59.051943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m10:17:59.052440 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m10:17:59.059632 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m10:17:59.062012 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m10:17:59.074535 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m10:17:59.076270 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m10:17:59.076684 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m10:17:59.077100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:59.081450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:17:59.081961 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m10:17:59.082316 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m10:17:59.257202 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.174 seconds
[0m10:17:59.265430 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m10:17:59.266196 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m10:17:59.270111 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.22s]
[0m10:17:59.271633 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m10:17:59.273817 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:59.274247 [debug] [MainThread]: On master: BEGIN
[0m10:17:59.274676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:04.279794 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m10:18:04.281358 [debug] [MainThread]: On master: COMMIT
[0m10:18:04.284377 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:04.284750 [debug] [MainThread]: On master: COMMIT
[0m10:18:04.285153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:04.285468 [debug] [MainThread]: On master: Close
[0m10:18:04.287492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:04.289256 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m10:18:04.292292 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:18:04.292643 [info ] [MainThread]: 
[0m10:18:04.293043 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.35 seconds (10.35s).
[0m10:18:04.293654 [debug] [MainThread]: Command end result
[0m10:18:04.293967 [info ] [MainThread]: 
[0m10:18:04.294335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:04.294639 [info ] [MainThread]: 
[0m10:18:04.294950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:18:04.295782 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.893368, "process_user_time": 1.361704, "process_kernel_time": 0.084017, "process_mem_max_rss": "108468", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m10:18:04.299438 [debug] [MainThread]: Command `dbt test` succeeded at 10:18:04.299361 after 10.90 seconds
[0m10:18:04.299817 [debug] [MainThread]: Flushing usage events
[0m10:28:28.712370 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:28:28.718455 | 1a7059e0-f4f4-4f0c-924d-fa241b0fc409 ==============================
[0m10:28:28.718455 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:28:28.719121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:28.817814 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m10:28:28.821506 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m10:28:28.827115 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fra8so10'
[0m10:28:28.827825 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m10:28:28.828963 [debug] [MainThread]: Creating symlink to local dependency.
[0m10:28:28.829576 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m10:28:28.830637 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15554488, "process_user_time": 1.016758, "process_kernel_time": 0.140827, "process_mem_max_rss": "105908", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m10:28:28.831191 [debug] [MainThread]: Command `dbt deps` succeeded at 10:28:28.831099 after 0.16 seconds
[0m10:28:28.831588 [debug] [MainThread]: Flushing usage events
[0m10:28:35.943261 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:28:35.965428 | 7b91ff73-6aae-4c17-b875-515379f17f6b ==============================
[0m10:28:35.965428 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:28:35.970436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:28:36.155637 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:28:36.172182 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:28:36.173353 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:28:37.641204 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:28:37.643437 [info ] [MainThread]: 
[0m10:28:37.644140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:28:37.645054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:28:37.673637 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:28:37.674263 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:28:37.674631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:37.682900 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m10:28:37.683933 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:28:37.684620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m10:28:37.685110 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m10:28:37.690171 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:28:37.690534 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m10:28:37.690832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:37.695460 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:28:37.695931 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:28:37.696280 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m10:28:37.697032 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:28:37.697710 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m10:28:37.698026 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:28:37.698328 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m10:28:37.699357 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:28:37.699656 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m10:28:37.704311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m10:28:37.705075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:28:37.710407 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:28:37.712871 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:28:37.713339 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:28:37.713705 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:28:37.714054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:37.714436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:37.719111 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:28:37.719558 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:28:37.719893 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:28:37.723620 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:28:37.724588 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:28:37.724975 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:28:42.731184 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m10:28:42.733674 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:28:42.735540 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:28:42.745467 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:28:42.750256 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:28:42.751024 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:28:42.763548 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:42.764410 [debug] [MainThread]: On master: BEGIN
[0m10:28:42.767324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:42.773300 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:28:42.774440 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:42.774886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:42.782545 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:28:42.784259 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:42.784782 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:42.785127 [debug] [MainThread]: On master: BEGIN
[0m10:28:42.785746 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:28:42.786422 [debug] [MainThread]: On master: COMMIT
[0m10:28:42.786858 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:42.787189 [debug] [MainThread]: On master: COMMIT
[0m10:28:42.787641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:42.787998 [debug] [MainThread]: On master: Close
[0m10:28:42.788798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:42.789475 [info ] [MainThread]: 
[0m10:28:42.799757 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m10:28:42.800691 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m10:28:42.801402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m10:28:42.801814 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m10:28:42.802271 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m10:28:42.831643 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:28:42.832287 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m10:28:42.832752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:42.838078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:28:42.838671 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:28:42.839147 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m10:28:42.842562 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m10:28:42.903686 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:28:42.904357 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m10:28:42.906078 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m10:28:42.910427 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m10:28:42.925029 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m10:28:42.925599 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:28:42.926350 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m10:28:42.927419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:28:42.929764 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m10:28:42.931268 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.13s]
[0m10:28:42.931880 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m10:28:42.933328 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:42.933754 [debug] [MainThread]: On master: BEGIN
[0m10:28:42.934080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:42.938386 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:28:42.938835 [debug] [MainThread]: On master: COMMIT
[0m10:28:42.939162 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:42.939494 [debug] [MainThread]: On master: COMMIT
[0m10:28:42.939897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:42.940211 [debug] [MainThread]: On master: Close
[0m10:28:42.940648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:42.941022 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:28:42.941346 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m10:28:42.941693 [info ] [MainThread]: 
[0m10:28:42.942053 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m10:28:42.942786 [debug] [MainThread]: Command end result
[0m10:28:42.981738 [info ] [MainThread]: 
[0m10:28:42.982313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:42.982857 [info ] [MainThread]: 
[0m10:28:42.983285 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:28:42.984436 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.1134143, "process_user_time": 2.769494, "process_kernel_time": 0.123155, "process_mem_max_rss": "113840", "process_in_blocks": "8", "process_out_blocks": "3517"}
[0m10:28:42.985141 [debug] [MainThread]: Command `dbt seed` succeeded at 10:28:42.985031 after 7.11 seconds
[0m10:28:42.985597 [debug] [MainThread]: Flushing usage events
[0m10:29:01.476856 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:01.482122 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:01.487586 | 97584c8a-737f-441b-84e2-b603233adb0a ==============================
[0m10:29:01.487586 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:01.488846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}


============================== 10:29:01.491509 | fe966743-362a-42b9-b78b-725179854eb2 ==============================
[0m10:29:01.491509 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:01.493589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:01.488916 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:01.489781 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:01.496167 | 29584602-2713-4f3b-b616-f05be2782861 ==============================
[0m10:29:01.496167 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:01.498974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 10:29:01.499754 | 97bcc2e0-a66e-4e5c-96e8-d0d6247000ec ==============================
[0m10:29:01.499754 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:01.500884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:01.516464 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:01.526052 | 1e77cf68-27f8-4134-a68f-b332331fd851 ==============================
[0m10:29:01.526052 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:01.527707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:29:01.522920 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:01.536385 | e2686dc3-686d-4228-aee3-9de7eebe0c3e ==============================
[0m10:29:01.536385 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:01.537431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:01.542434 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:01.552200 | aa9cb38b-ee6f-41a0-b83e-9f0c65ebf4e2 ==============================
[0m10:29:01.552200 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:01.552962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m10:29:01.702967 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:01.708537 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:01.722808 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:01.728210 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:01.744815 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:01.754472 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:01.769964 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:01.767620 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:01.788719 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:01.791988 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:01.808919 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:01.821343 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:01.833968 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:01.832020 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:01.952105 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:01.954060 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:29:01.963846 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:01.965195 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:29:01.968025 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:01.968530 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:01.970168 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:29:01.970135 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:29:01.975592 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:01.976465 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:29:01.977770 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:01.978838 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:29:01.981209 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:29:01.982125 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:29:03.522012 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:03.526261 [info ] [MainThread]: 
[0m10:29:03.526918 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:03.527885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:03.528926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:03.530474 [info ] [MainThread]: 
[0m10:29:03.532057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:03.534899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:03.536918 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:03.540711 [info ] [MainThread]: 
[0m10:29:03.542021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:03.543537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:03.546027 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:03.548189 [info ] [MainThread]: 
[0m10:29:03.549980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:03.551234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:03.554156 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:03.556895 [info ] [MainThread]: 
[0m10:29:03.558181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:03.558736 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:03.560591 [info ] [MainThread]: 
[0m10:29:03.559649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:03.561473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:03.562133 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:03.562934 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:03.563775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.563805 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:03.562930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:03.564423 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:03.565334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.569996 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:03.570573 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:03.570961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.573589 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:03.575426 [info ] [MainThread]: 
[0m10:29:03.576145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:03.577376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:03.578474 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m10:29:03.579471 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:03.579623 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:03.579993 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:03.580467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m10:29:03.580553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.581169 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m10:29:03.585726 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:29:03.585881 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m10:29:03.587127 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:03.586380 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m10:29:03.588000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m10:29:03.587809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.587383 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:03.588611 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m10:29:03.589084 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:03.589741 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:03.592257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.592356 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:03.592884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.592865 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:29:03.593602 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:29:03.593726 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:29:03.594104 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m10:29:03.594197 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m10:29:03.594699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.594928 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:29:03.595907 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:29:03.596378 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:29:03.596769 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:29:03.597604 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m10:29:03.597715 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m10:29:03.598116 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m10:29:03.598843 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:03.602531 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:03.602656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m10:29:03.603057 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:03.603673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.603255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:29:03.603229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:29:03.603813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:29:03.607905 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:03.610588 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:03.608674 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:03.611062 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:03.611075 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:03.611587 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:03.611498 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:03.611968 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:03.612087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.612392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:03.612657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.612862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:03.617113 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:29:03.617130 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:29:03.617624 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:03.617522 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:03.618080 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:03.618422 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:03.620715 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:03.620731 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:03.621831 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:03.622374 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:03.622774 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:03.623322 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:08.578630 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m10:29:08.579978 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m10:29:08.581804 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:08.583628 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:08.590241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:29:08.590305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:29:08.590993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:29:08.597795 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.600624 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.591189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:29:08.601242 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:08.601846 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:08.602704 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m10:29:08.602513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:08.603856 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:29:08.603188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:08.603974 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m10:29:08.604651 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m10:29:08.601304 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.604616 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.605508 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:29:08.605310 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:08.606066 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:08.605775 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:08.607207 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:29:08.606411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:08.607340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:08.607813 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:29:08.609508 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:29:08.610344 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m10:29:08.610766 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m10:29:08.609962 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:29:08.611826 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.612534 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:08.612721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:29:08.612971 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:29:08.613263 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.009 seconds
[0m10:29:08.614087 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.615861 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:08.616071 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:08.617144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m10:29:08.616744 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:08.618882 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:08.619454 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:29:08.620308 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:08.613791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:29:08.621079 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.621326 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:29:08.621938 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:08.618559 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:29:08.623417 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:08.624299 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:08.623767 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.620856 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.625762 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:08.624188 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:08.624575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:29:08.626188 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:08.617991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:29:08.623908 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.626636 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:08.626330 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:08.628374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:08.627407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:08.629129 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:08.625431 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.630231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:08.629675 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.631005 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:08.625402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:29:08.632061 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:08.631679 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:08.632618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:08.633523 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:08.633853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:08.634640 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.635301 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:29:08.635813 [debug] [MainThread]: On master: BEGIN
[0m10:29:08.634088 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.636421 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.637141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:08.636671 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.636930 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:29:08.637318 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:08.638020 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:08.637588 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:08.638363 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.638663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:08.639696 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:08.639071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:08.640237 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:29:08.641438 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:08.641368 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:08.641537 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.642963 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:29:08.643072 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:08.643622 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:08.643759 [debug] [MainThread]: On master: BEGIN
[0m10:29:08.643465 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:08.643929 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.644790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:08.645447 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:29:08.645323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:08.644272 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:08.646254 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:08.646974 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:08.647086 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:08.646127 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:08.648350 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:08.649118 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:08.648870 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:08.648966 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:08.650362 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:29:08.650870 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:08.651107 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:08.651902 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.652505 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.653077 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:08.652994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:08.652992 [debug] [MainThread]: On master: BEGIN
[0m10:29:08.653697 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:08.653899 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:08.654631 [debug] [MainThread]: On master: COMMIT
[0m10:29:08.655092 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.655518 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:08.655956 [debug] [MainThread]: On master: COMMIT
[0m10:29:08.656939 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.657251 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:08.657777 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:08.657750 [debug] [MainThread]: On master: BEGIN
[0m10:29:08.658272 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.658624 [debug] [MainThread]: On master: Close
[0m10:29:08.658990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:08.659103 [debug] [MainThread]: On master: BEGIN
[0m10:29:08.659443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:08.660267 [info ] [MainThread]: 
[0m10:29:08.660443 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:29:08.664161 [debug] [MainThread]: On master: COMMIT
[0m10:29:08.664317 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:29:08.665307 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.665576 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.665868 [debug] [MainThread]: On master: COMMIT
[0m10:29:08.666226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:08.666486 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:08.667013 [debug] [MainThread]: On master: Close
[0m10:29:08.667733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:08.667798 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m10:29:08.668850 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:29:08.668383 [info ] [MainThread]: 
[0m10:29:08.669053 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m10:29:08.669840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m10:29:08.670359 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m10:29:08.670356 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:08.670988 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.671395 [debug] [MainThread]: On master: BEGIN
[0m10:29:08.672070 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:08.672569 [debug] [MainThread]: On master: COMMIT
[0m10:29:08.672944 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.673336 [debug] [MainThread]: On master: COMMIT
[0m10:29:08.673964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:08.674403 [debug] [MainThread]: On master: Close
[0m10:29:08.674947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:08.675444 [info ] [MainThread]: 
[0m10:29:08.678794 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m10:29:08.679214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m10:29:08.680980 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m10:29:08.681636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m10:29:08.682080 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m10:29:08.682390 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m10:29:08.682944 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m10:29:08.683758 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m10:29:08.683854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m10:29:08.684344 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m10:29:08.689292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m10:29:08.690899 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m10:29:08.692367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m10:29:08.697142 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m10:29:08.712385 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m10:29:08.717801 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m10:29:08.719147 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:29:08.719711 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m10:29:08.720133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:08.720503 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:29:08.721162 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m10:29:08.721500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:08.723720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m10:29:08.724844 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:29:08.725241 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m10:29:08.725600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:08.729735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:29:08.730137 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:29:08.730521 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m10:29:08.732697 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:29:08.737757 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:29:08.738200 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m10:29:08.738801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:08.749110 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m10:29:08.749697 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:29:08.750123 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m10:29:08.751205 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:08.755979 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m10:29:08.759282 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:29:08.759665 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m10:29:08.760140 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:29:08.762074 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m10:29:08.763482 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m10:29:08.764169 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m10:29:08.765327 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:08.765653 [debug] [MainThread]: On master: BEGIN
[0m10:29:08.765950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:13.614623 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m10:29:13.614623 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m10:29:13.616148 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:13.615680 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:13.617241 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:13.616825 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:13.620241 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:13.620440 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:29:13.622772 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:13.623222 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:13.623819 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:13.624567 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:13.633806 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.635256 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.635711 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.636481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:13.636822 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.637664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:13.642611 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:29:13.642267 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m10:29:13.643575 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.644135 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:13.644562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:13.645141 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:13.648551 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:29:13.648393 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m10:29:13.649615 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m10:29:13.650180 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:13.651346 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:13.651808 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:13.651275 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:13.652471 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:13.652519 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.653520 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.655283 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:29:13.655323 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:13.655798 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.657243 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.658254 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:13.658808 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.659280 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:13.659798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:13.660726 [debug] [MainThread]: On master: Close
[0m10:29:13.661716 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:13.661140 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.662505 [info ] [MainThread]: 
[0m10:29:13.663139 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.663869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:13.668175 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.668748 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.669308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:13.669408 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:29:13.670218 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.671052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:13.672153 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m10:29:13.673881 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m10:29:13.674779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m10:29:13.674853 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m10:29:13.674989 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:29:13.675736 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.676388 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:13.675721 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m10:29:13.678357 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:13.679759 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m10:29:13.680281 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.683521 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:13.686327 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.688799 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.690706 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:13.691133 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.692435 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.693565 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:29:13.695327 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.695555 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.696530 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.696137 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.696340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m10:29:13.698118 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.698443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:13.699798 [debug] [MainThread]: On master: Close
[0m10:29:13.700228 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:29:13.703249 [debug] [MainThread]: On master: Close
[0m10:29:13.703911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:13.705232 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m10:29:13.707733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:13.708630 [info ] [MainThread]: 
[0m10:29:13.709996 [info ] [MainThread]: 
[0m10:29:13.729467 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m10:29:13.730541 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m10:29:13.731413 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m10:29:13.732254 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m10:29:13.731799 [debug] [Thread-1 (]: SQL status: BEGIN in 5.010 seconds
[0m10:29:13.730588 [debug] [Thread-1 (]: SQL status: BEGIN in 5.010 seconds
[0m10:29:13.733868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m10:29:13.733630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m10:29:13.734235 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:29:13.734839 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:29:13.735205 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m10:29:13.735674 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m10:29:13.735378 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m10:29:13.736376 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m10:29:13.738689 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:29:13.747600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m10:29:13.752749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m10:29:13.752651 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m10:29:13.753937 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:29:13.755309 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m10:29:13.756777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:29:13.757877 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m10:29:13.762052 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m10:29:13.764709 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m10:29:13.765712 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m10:29:13.766865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:13.776253 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m10:29:13.778228 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.778087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:29:13.779496 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m10:29:13.779239 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.780279 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m10:29:13.781258 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.781748 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, city_name, country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m10:29:13.781309 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:29:13.782309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:13.782758 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m10:29:13.783409 [debug] [MainThread]: On master: Close
[0m10:29:13.784601 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "city_name" does not exist
LINE 15:     id as geography_key, city_name, country_name, regionname
                                  ^
HINT:  Perhaps you meant to reference the column "geography.cityname".

[0m10:29:13.786101 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: ROLLBACK
[0m10:29:13.785954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:13.787059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:29:13.788082 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:13.788612 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m10:29:13.788953 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m10:29:13.791337 [info ] [MainThread]: 
[0m10:29:13.794264 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m10:29:13.797166 [debug] [MainThread]: Command end result
[0m10:29:13.797578 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m10:29:13.798129 [info ] [MainThread]: 
[0m10:29:13.799689 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m10:29:13.802396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:13.805149 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:29:13.806179 [info ] [MainThread]: 
[0m10:29:13.812616 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:13.801887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m10:29:13.812748 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m10:29:13.815928 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:29:13.817058 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:29:13.821966 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:29:13.822241 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m10:29:13.822729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.348648, "process_user_time": 3.217584, "process_kernel_time": 0.23819, "process_mem_max_rss": "112960", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m10:29:13.824328 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m10:29:13.826903 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:13.826738 after 12.35 seconds
[0m10:29:13.826504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:13.827915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:13.831789 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m10:29:13.834776 [debug] [MainThread]: Flushing usage events
[0m10:29:13.854130 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.17s]
[0m10:29:13.854609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m10:29:13.861719 [debug] [Thread-1 (]: Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 15:     id as geography_key, city_name, country_name, regionname
                                    ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m10:29:13.863218 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:29:13.860646 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m10:29:13.871569 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m10:29:13.870745 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_geography ........................ [[31mERROR[0m in 0.19s]
[0m10:29:13.876714 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:29:13.891680 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m10:29:13.890130 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.897405 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.899177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:13.900763 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.902121 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.903587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:13.904683 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:29:13.906188 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m10:29:13.908311 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:29:13.909127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:29:13.910397 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.910822 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:29:13.912018 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.912992 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.913821 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.914631 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.916155 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.915652 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:13.916682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:13.917220 [debug] [MainThread]: On master: Close
[0m10:29:13.917995 [debug] [MainThread]: On master: Close
[0m10:29:13.919346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:13.920380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:13.921727 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:13.922776 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m10:29:13.923246 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m10:29:13.923416 [info ] [MainThread]: 
[0m10:29:13.923893 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m10:29:13.924707 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:13.924571 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m10:29:13.924383 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:29:13.925293 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m10:29:13.925684 [info ] [MainThread]: 
[0m10:29:13.926742 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m10:29:13.925832 [debug] [MainThread]: Command end result
[0m10:29:13.928473 [info ] [MainThread]: 
[0m10:29:13.928019 [debug] [MainThread]: Command end result
[0m10:29:13.927947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:13.929318 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:29:13.929342 [info ] [MainThread]: 
[0m10:29:13.930299 [info ] [MainThread]: 
[0m10:29:13.931093 [error] [MainThread]:   Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 15:     id as geography_key, city_name, country_name, regionname
                                    ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m10:29:13.930940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:13.931829 [info ] [MainThread]: 
[0m10:29:13.932873 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:13.932733 [info ] [MainThread]: 
[0m10:29:13.934464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.4938755, "process_user_time": 3.219809, "process_kernel_time": 0.254542, "process_mem_max_rss": "112448", "process_in_blocks": "472", "process_out_blocks": "1179", "command_success": false}
[0m10:29:13.934381 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:13.935885 [debug] [MainThread]: Command `dbt run` failed at 10:29:13.935779 after 12.50 seconds
[0m10:29:13.936618 [debug] [MainThread]: Flushing usage events
[0m10:29:13.937579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.496047, "process_user_time": 3.239666, "process_kernel_time": 0.2399, "process_mem_max_rss": "112852", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m10:29:13.939702 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:13.939390 after 12.50 seconds
[0m10:29:13.940120 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m10:29:13.940915 [debug] [MainThread]: Flushing usage events
[0m10:29:13.948579 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:29:13.949472 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m10:29:13.951100 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:29:13.957438 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m10:29:13.962061 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:29:13.963631 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m10:29:13.966393 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.967185 [debug] [MainThread]: On master: BEGIN
[0m10:29:13.967858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:13.975979 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:29:13.977277 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.978081 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:13.978710 [debug] [MainThread]: On master: COMMIT
[0m10:29:13.983764 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:13.984834 [debug] [MainThread]: On master: Close
[0m10:29:13.985811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:13.986425 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m10:29:13.986940 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:29:13.987613 [info ] [MainThread]: 
[0m10:29:13.988350 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m10:29:13.989808 [debug] [MainThread]: Command end result
[0m10:29:13.990505 [info ] [MainThread]: 
[0m10:29:13.991576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:13.992329 [info ] [MainThread]: 
[0m10:29:13.993030 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:13.994914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.5334015, "process_user_time": 3.248013, "process_kernel_time": 0.232792, "process_mem_max_rss": "112488", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m10:29:13.996133 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:13.995980 after 12.53 seconds
[0m10:29:13.996836 [debug] [MainThread]: Flushing usage events
[0m10:29:14.091379 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.353 seconds
[0m10:29:14.112896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:29:14.117623 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:29:14.123615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:29:14.169246 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m10:29:14.174574 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:29:14.182300 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m10:29:14.195157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:29:14.207261 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m10:29:14.212786 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:29:14.214239 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m10:29:14.216092 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:29:14.229370 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m10:29:14.241438 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 5.56s]
[0m10:29:14.245390 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m10:29:14.251261 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:14.252636 [debug] [MainThread]: On master: BEGIN
[0m10:29:14.254229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:14.264361 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:29:14.267136 [debug] [MainThread]: On master: COMMIT
[0m10:29:14.267995 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:14.269230 [debug] [MainThread]: On master: COMMIT
[0m10:29:14.270502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:14.271304 [debug] [MainThread]: On master: Close
[0m10:29:14.272427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:14.273189 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m10:29:14.274384 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:14.276301 [info ] [MainThread]: 
[0m10:29:14.277540 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m10:29:14.279368 [debug] [MainThread]: Command end result
[0m10:29:14.280345 [info ] [MainThread]: 
[0m10:29:14.281927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:14.283713 [info ] [MainThread]: 
[0m10:29:14.285071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:14.289030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.790014, "process_user_time": 3.299094, "process_kernel_time": 0.213653, "process_mem_max_rss": "112736", "process_out_blocks": "1193", "process_in_blocks": "0"}
[0m10:29:14.290924 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:14.290746 after 12.79 seconds
[0m10:29:14.291879 [debug] [MainThread]: Flushing usage events
[0m10:29:18.655451 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m10:29:18.658175 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:18.658838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:18.662710 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m10:29:18.667856 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:18.668455 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:18.668786 [debug] [MainThread]: On master: BEGIN
[0m10:29:18.669391 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:18.669930 [debug] [MainThread]: On master: COMMIT
[0m10:29:18.670434 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:18.670782 [debug] [MainThread]: On master: COMMIT
[0m10:29:18.671196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:18.671568 [debug] [MainThread]: On master: Close
[0m10:29:18.673091 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:18.673926 [info ] [MainThread]: 
[0m10:29:18.685593 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m10:29:18.686657 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m10:29:18.687710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m10:29:18.688286 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m10:29:18.700532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m10:29:18.701893 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m10:29:18.738584 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m10:29:18.740081 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:29:18.740547 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m10:29:18.740961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:18.747609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:29:18.748185 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:29:18.748714 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m10:29:18.751011 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:29:18.760431 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:29:18.761208 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m10:29:18.762192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:18.781706 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m10:29:18.782338 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:29:18.782736 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m10:29:18.784018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:18.789363 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m10:29:18.792915 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:29:18.793452 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m10:29:18.794175 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:29:18.797586 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m10:29:18.799675 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m10:29:18.800669 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m10:29:18.802460 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:18.802903 [debug] [MainThread]: On master: BEGIN
[0m10:29:18.803332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:18.808940 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:29:18.809479 [debug] [MainThread]: On master: COMMIT
[0m10:29:18.809863 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:18.810272 [debug] [MainThread]: On master: COMMIT
[0m10:29:18.810821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:18.811259 [debug] [MainThread]: On master: Close
[0m10:29:18.811836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:18.812223 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:29:18.812567 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m10:29:18.812950 [info ] [MainThread]: 
[0m10:29:18.813418 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m10:29:18.814314 [debug] [MainThread]: Command end result
[0m10:29:18.814805 [info ] [MainThread]: 
[0m10:29:18.815520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:18.815956 [info ] [MainThread]: 
[0m10:29:18.816796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:18.818592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.399677, "process_user_time": 3.19873, "process_kernel_time": 0.261367, "process_mem_max_rss": "112720", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m10:29:18.819585 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:18.819500 after 17.40 seconds
[0m10:29:18.820122 [debug] [MainThread]: Flushing usage events
[0m10:29:18.855530 [debug] [Thread-1 (]: SQL status: BEGIN in 5.026 seconds
[0m10:29:18.861303 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:29:18.863415 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m10:29:18.867026 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:29:18.884376 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:29:18.885342 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m10:29:18.886980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:18.903779 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m10:29:18.905495 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:29:18.909252 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m10:29:18.911600 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:18.920064 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m10:29:18.926292 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:29:18.927654 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m10:29:18.932238 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:29:18.944402 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m10:29:18.949079 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.21s]
[0m10:29:18.950756 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m10:29:18.956201 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:18.957295 [debug] [MainThread]: On master: BEGIN
[0m10:29:18.958285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:21.771806 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:21.773258 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:21.779158 | 5dce854f-ab29-4b3a-b246-dbec7c91c191 ==============================
[0m10:29:21.779158 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:21.774057 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:21.780426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 10:29:21.780539 | 1ffc72ed-7019-4fa2-82cf-4e423b8e1e90 ==============================
[0m10:29:21.780539 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:21.782365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 10:29:21.782666 | 62ecedda-6f49-44e2-92ea-98a754ecf195 ==============================
[0m10:29:21.782666 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:21.784057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m10:29:21.781702 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:21.785086 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:21.790167 | 727f3425-55cb-4337-b214-d97856268882 ==============================
[0m10:29:21.790167 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:21.795264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:21.790544 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:21.796120 | c578f16a-3b16-4841-b893-adb50ca12497 ==============================
[0m10:29:21.796120 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:21.800945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 10:29:21.801234 | c48a4a62-a1ba-424a-823d-c0cc1a734db7 ==============================
[0m10:29:21.801234 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:21.802273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:22.051864 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:22.051950 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:22.062119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:22.062273 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:22.065580 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:22.070663 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:22.077907 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:22.084993 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:22.086123 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:22.087713 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:22.090770 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:22.110644 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:22.271367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:22.272002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:22.277394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:22.278080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:22.290293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:22.291007 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:22.294166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:22.294862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:22.303157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:22.303699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:22.308683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:22.310117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:22.330472 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:22.332019 [info ] [MainThread]: 
[0m10:29:22.332592 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:22.333489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:22.355265 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:22.357779 [info ] [MainThread]: 
[0m10:29:22.360217 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:22.364228 [debug] [MainThread]: Command end result
[0m10:29:22.366811 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:22.366728 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:22.366237 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.678003, "process_user_time": 1.550608, "process_kernel_time": 0.151478, "process_mem_max_rss": "97700", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:22.367440 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:22.368143 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:22.367989 after 0.68 seconds
[0m10:29:22.368552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:22.368869 [debug] [MainThread]: Flushing usage events
[0m10:29:22.368773 [info ] [MainThread]: 
[0m10:29:22.369572 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:22.369822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:22.371179 [info ] [MainThread]: 
[0m10:29:22.371925 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:22.372191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:22.373774 [debug] [MainThread]: Command end result
[0m10:29:22.374563 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68532133, "process_user_time": 1.517829, "process_kernel_time": 0.132911, "process_mem_max_rss": "97408", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:22.376294 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:22.376206 after 0.69 seconds
[0m10:29:22.377534 [debug] [MainThread]: Flushing usage events
[0m10:29:22.378482 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:22.380122 [info ] [MainThread]: 
[0m10:29:22.384164 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:22.385405 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:22.387047 [info ] [MainThread]: 
[0m10:29:22.387372 [debug] [MainThread]: Command end result
[0m10:29:22.388162 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:22.388719 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.69377166, "process_user_time": 1.504316, "process_kernel_time": 0.154447, "process_mem_max_rss": "97296", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:22.390147 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:22.390024 after 0.70 seconds
[0m10:29:22.390421 [debug] [MainThread]: Command end result
[0m10:29:22.390852 [debug] [MainThread]: Flushing usage events
[0m10:29:22.391586 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7013935, "process_user_time": 1.54529, "process_kernel_time": 0.123138, "process_mem_max_rss": "97140", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:22.392577 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:22.392448 after 0.70 seconds
[0m10:29:22.398216 [debug] [MainThread]: Flushing usage events
[0m10:29:22.402892 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:22.403854 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:22.404757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:22.415861 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m10:29:22.418016 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:22.424576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:29:22.425181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:29:22.430986 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:22.433051 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:22.435129 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:22.436176 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:22.438150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:22.440139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:22.447473 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:29:22.448312 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:22.450304 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:22.453805 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m10:29:22.455227 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:22.458226 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:23.972127 [debug] [MainThread]: SQL status: BEGIN in 5.014 seconds
[0m10:29:23.973494 [debug] [MainThread]: On master: COMMIT
[0m10:29:23.974103 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:23.974596 [debug] [MainThread]: On master: COMMIT
[0m10:29:23.975107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:23.975526 [debug] [MainThread]: On master: Close
[0m10:29:23.976301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:23.976721 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:29:23.977063 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m10:29:23.977873 [info ] [MainThread]: 
[0m10:29:23.978489 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.40 seconds (20.40s).
[0m10:29:23.979889 [debug] [MainThread]: Command end result
[0m10:29:23.980312 [info ] [MainThread]: 
[0m10:29:23.980939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:23.981882 [info ] [MainThread]: 
[0m10:29:23.982687 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:23.985771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.555098, "process_user_time": 3.328388, "process_kernel_time": 0.227301, "process_mem_max_rss": "112932", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m10:29:23.987198 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:23.987071 after 22.56 seconds
[0m10:29:23.988026 [debug] [MainThread]: Flushing usage events
[0m10:29:26.215658 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:26.221057 | b9945897-16f3-4d3a-920e-4f83072dcc2e ==============================
[0m10:29:26.221057 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:26.221779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:26.223146 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:26.230829 | e0672b51-6be8-4eec-9c84-6618cb3240f3 ==============================
[0m10:29:26.230829 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:26.231488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:26.396272 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:26.400885 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:26.413519 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:26.413626 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:26.577318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:26.578146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:26.579538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:26.580099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:26.643279 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:26.644856 [info ] [MainThread]: 
[0m10:29:26.645510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:26.646369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:26.650866 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:26.653856 [info ] [MainThread]: 
[0m10:29:26.654783 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:26.656510 [debug] [MainThread]: Command end result
[0m10:29:26.657518 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49694318, "process_user_time": 1.228595, "process_kernel_time": 0.094973, "process_mem_max_rss": "97676", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:26.658618 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:26.658534 after 0.50 seconds
[0m10:29:26.660225 [debug] [MainThread]: Flushing usage events
[0m10:29:26.680437 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:26.681175 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:26.681812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:27.392439 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.024 seconds
[0m10:29:27.395930 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:27.403333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:29:27.403933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:29:27.411483 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:27.413379 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:27.413786 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:27.414215 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:27.414581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:27.414988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:27.419791 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:29:27.420398 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:27.420781 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:27.422851 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:27.423930 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:27.424394 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:27.453075 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m10:29:27.453946 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:27.454371 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:27.456233 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m10:29:27.457937 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:27.458384 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:27.464050 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:27.464482 [debug] [MainThread]: On master: BEGIN
[0m10:29:27.464855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:27.468813 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:29:27.469224 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:27.469717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:27.473196 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m10:29:27.474448 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:27.474913 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:27.475353 [debug] [MainThread]: On master: BEGIN
[0m10:29:27.475856 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:27.476269 [debug] [MainThread]: On master: COMMIT
[0m10:29:27.476620 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:27.476957 [debug] [MainThread]: On master: COMMIT
[0m10:29:27.477426 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:27.477823 [debug] [MainThread]: On master: Close
[0m10:29:27.478378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:27.479012 [info ] [MainThread]: 
[0m10:29:27.485606 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m10:29:27.486290 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m10:29:27.486829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m10:29:27.487237 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m10:29:27.493955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m10:29:27.495640 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m10:29:27.521477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m10:29:27.523059 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:29:27.523440 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m10:29:27.523799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:27.527936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:29:27.528350 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:29:27.528728 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m10:29:27.530919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:29:27.535842 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:29:27.536301 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m10:29:27.536932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:27.547052 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m10:29:27.547524 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:29:27.547912 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m10:29:27.548985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:27.553556 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m10:29:27.556822 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:29:27.557208 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m10:29:27.557691 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:29:27.559703 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m10:29:27.561152 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:29:27.561856 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m10:29:27.563117 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:27.563484 [debug] [MainThread]: On master: BEGIN
[0m10:29:27.563831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:31.124252 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:31.129554 | 60d89dfd-2740-4e9c-9026-fea17c02379e ==============================
[0m10:29:31.129554 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:31.130298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:31.278042 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:31.292131 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:31.431877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:31.432550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:31.503338 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:31.504922 [info ] [MainThread]: 
[0m10:29:31.505297 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:31.506961 [debug] [MainThread]: Command end result
[0m10:29:31.507714 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4165719, "process_user_time": 1.273561, "process_kernel_time": 0.096966, "process_mem_max_rss": "97816", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:31.508228 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:31.508155 after 0.42 seconds
[0m10:29:31.508547 [debug] [MainThread]: Flushing usage events
[0m10:29:31.694139 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m10:29:31.699079 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:31.711603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:29:31.712542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:29:31.720039 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:31.725185 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:31.723540 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:31.727749 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:31.729648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:31.726610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:31.738204 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:29:31.738697 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:29:31.739382 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:31.741160 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:31.742370 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:31.743536 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:31.746659 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:31.746955 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m10:29:31.751181 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:31.749422 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:31.751793 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:31.752144 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:31.759152 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:31.759768 [debug] [MainThread]: On master: BEGIN
[0m10:29:31.760269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:31.765017 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:29:31.765593 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:31.766077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:31.769219 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m10:29:31.770888 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:31.771444 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:31.771975 [debug] [MainThread]: On master: BEGIN
[0m10:29:31.774551 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:29:31.775958 [debug] [MainThread]: On master: COMMIT
[0m10:29:31.776624 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:31.778079 [debug] [MainThread]: On master: COMMIT
[0m10:29:31.778542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:31.779055 [debug] [MainThread]: On master: Close
[0m10:29:31.780199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:31.781716 [info ] [MainThread]: 
[0m10:29:31.789067 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m10:29:31.793818 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m10:29:31.794654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m10:29:31.795166 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m10:29:31.802489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m10:29:31.803750 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m10:29:31.834175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m10:29:31.835699 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:29:31.836161 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m10:29:31.836492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:32.436403 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m10:29:32.437907 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:32.438649 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:32.442671 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m10:29:32.444920 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:32.445530 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:32.454132 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:32.454849 [debug] [MainThread]: On master: BEGIN
[0m10:29:32.455338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:32.462115 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:29:32.462749 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:32.463410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:32.466870 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m10:29:32.468562 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:32.469078 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:32.469407 [debug] [MainThread]: On master: BEGIN
[0m10:29:32.469918 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:32.470337 [debug] [MainThread]: On master: COMMIT
[0m10:29:32.470769 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:32.471262 [debug] [MainThread]: On master: COMMIT
[0m10:29:32.471819 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:32.472190 [debug] [MainThread]: On master: Close
[0m10:29:32.472771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:32.473377 [info ] [MainThread]: 
[0m10:29:32.481170 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m10:29:32.481855 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m10:29:32.482353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m10:29:32.482716 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m10:29:32.489654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m10:29:32.490764 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m10:29:32.516967 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m10:29:32.517983 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:29:32.518342 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m10:29:32.518727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:32.523393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:29:32.523906 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:29:32.524403 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m10:29:32.526298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:29:32.531294 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:29:32.531727 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m10:29:32.532295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:32.542566 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m10:29:32.542937 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:29:32.543283 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m10:29:32.544474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:32.548988 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m10:29:32.551978 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:29:32.552329 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m10:29:32.552780 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:29:32.554795 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m10:29:32.556180 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:29:32.556910 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m10:29:32.558273 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:32.558624 [debug] [MainThread]: On master: BEGIN
[0m10:29:32.558944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:32.562825 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:29:32.563256 [debug] [MainThread]: On master: COMMIT
[0m10:29:32.563609 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:32.563941 [debug] [MainThread]: On master: COMMIT
[0m10:29:32.564336 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:32.564688 [debug] [MainThread]: On master: Close
[0m10:29:32.565133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:32.565453 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:29:32.565758 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m10:29:32.566127 [info ] [MainThread]: 
[0m10:29:32.566496 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m10:29:32.567109 [debug] [MainThread]: Command end result
[0m10:29:32.567429 [info ] [MainThread]: 
[0m10:29:32.567926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:32.568363 [info ] [MainThread]: 
[0m10:29:32.568789 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:32.569737 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.883435, "process_user_time": 1.680891, "process_kernel_time": 0.152532, "process_mem_max_rss": "106324", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m10:29:32.570443 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:32.570321 after 10.88 seconds
[0m10:29:32.570922 [debug] [MainThread]: Flushing usage events
[0m10:29:32.573241 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m10:29:32.576664 [debug] [MainThread]: On master: COMMIT
[0m10:29:32.579731 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:32.580170 [debug] [MainThread]: On master: COMMIT
[0m10:29:32.580680 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:32.581044 [debug] [MainThread]: On master: Close
[0m10:29:32.581681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:32.582111 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:32.583339 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m10:29:32.584021 [info ] [MainThread]: 
[0m10:29:32.586582 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.21 seconds (10.21s).
[0m10:29:32.587285 [debug] [MainThread]: Command end result
[0m10:29:32.589642 [info ] [MainThread]: 
[0m10:29:32.590718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:32.591104 [info ] [MainThread]: 
[0m10:29:32.593624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:32.595524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.91445, "process_user_time": 1.657993, "process_kernel_time": 0.154065, "process_mem_max_rss": "106108", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:29:32.599147 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:32.599010 after 10.92 seconds
[0m10:29:32.601712 [debug] [MainThread]: Flushing usage events
[0m10:29:36.848640 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m10:29:36.850153 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:29:36.851723 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m10:29:36.856344 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:29:36.864715 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:29:36.865319 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m10:29:36.866412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:36.878329 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m10:29:36.878884 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:29:36.879268 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m10:29:36.881632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:29:36.887610 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m10:29:36.891423 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:29:36.891833 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m10:29:36.892346 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:29:36.894781 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m10:29:36.896448 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.10s]
[0m10:29:36.897382 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m10:29:36.898898 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:36.899294 [debug] [MainThread]: On master: BEGIN
[0m10:29:36.899594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:36.904789 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:29:36.905354 [debug] [MainThread]: On master: COMMIT
[0m10:29:36.905824 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:36.906358 [debug] [MainThread]: On master: COMMIT
[0m10:29:36.906913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:36.907224 [debug] [MainThread]: On master: Close
[0m10:29:36.907669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:36.907972 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m10:29:36.908246 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:36.908620 [info ] [MainThread]: 
[0m10:29:36.909096 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m10:29:36.909776 [debug] [MainThread]: Command end result
[0m10:29:36.910072 [info ] [MainThread]: 
[0m10:29:36.910516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:36.910850 [info ] [MainThread]: 
[0m10:29:36.911259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:36.912333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.731461, "process_user_time": 1.417211, "process_kernel_time": 0.09421, "process_mem_max_rss": "106208", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m10:29:36.913063 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:36.912981 after 10.73 seconds
[0m10:29:36.913479 [debug] [MainThread]: Flushing usage events
[0m10:29:40.338920 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:40.345080 | feaa7ae1-e1f2-484c-8b36-484af19fa1a8 ==============================
[0m10:29:40.345080 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:40.345983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:40.345077 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:40.343649 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:40.346593 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:40.352087 | cf30887b-e6b4-4653-b98a-2017a9b92426 ==============================
[0m10:29:40.352087 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:29:40.351700 | 234602d4-b593-4780-9e9b-084a88eed620 ==============================
[0m10:29:40.351700 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:29:40.352017 | 93523cb6-eeb5-4fd5-89ca-741704894947 ==============================
[0m10:29:40.352017 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:40.353091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:40.353679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:40.353711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:29:40.516472 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:40.519154 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:40.523423 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:40.529201 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:40.531045 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:40.535196 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:40.543592 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:40.545992 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:40.716994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:40.717736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:40.732607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:40.733479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:40.737765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:40.738559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:40.740735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:40.742594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:40.791757 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:40.794567 [info ] [MainThread]: 
[0m10:29:40.795163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:40.796046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:40.804754 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:40.806364 [info ] [MainThread]: 
[0m10:29:40.807117 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:40.807250 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:40.808854 [info ] [MainThread]: 
[0m10:29:40.809411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:40.810028 [debug] [MainThread]: Command end result
[0m10:29:40.810828 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50618154, "process_user_time": 1.24449, "process_kernel_time": 0.088176, "process_mem_max_rss": "97352", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:40.810269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:40.811407 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:40.811320 after 0.51 seconds
[0m10:29:40.812534 [debug] [MainThread]: Flushing usage events
[0m10:29:40.813862 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:40.816348 [info ] [MainThread]: 
[0m10:29:40.818559 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:40.820317 [debug] [MainThread]: Command end result
[0m10:29:40.821187 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5112433, "process_user_time": 1.266383, "process_kernel_time": 0.080214, "process_mem_max_rss": "97500", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:40.821791 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:40.821709 after 0.51 seconds
[0m10:29:40.822185 [debug] [MainThread]: Flushing usage events
[0m10:29:40.828958 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:40.831622 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:40.833713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:40.847153 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:40.847933 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:40.848471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:44.452667 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:29:44.453516 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:44.458437 | 8c9e16e7-9b4b-4204-af18-f9cbd8961b44 ==============================
[0m10:29:44.458437 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:29:44.458593 | ac210059-11d5-4e35-a299-ef2754f1073b ==============================
[0m10:29:44.458593 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:44.459202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:44.459443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:44.632046 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:44.632350 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:44.647012 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:44.652686 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:44.800644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:44.800612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:44.801140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:44.801524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:44.858436 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:44.860036 [info ] [MainThread]: 
[0m10:29:44.860660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:44.861716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:29:44.862629 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:44.863894 [info ] [MainThread]: 
[0m10:29:44.864607 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:44.867602 [debug] [MainThread]: Command end result
[0m10:29:44.868254 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4529735, "process_user_time": 1.270399, "process_kernel_time": 0.084358, "process_mem_max_rss": "97632", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:44.868778 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:44.868685 after 0.45 seconds
[0m10:29:44.869225 [debug] [MainThread]: Flushing usage events
[0m10:29:44.896193 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:29:44.898641 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:29:44.900585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:44.910921 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m10:29:44.912268 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:44.916762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:29:44.917546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:29:44.923706 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:44.925911 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:44.926369 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:44.926823 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:44.927250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:44.927670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:44.933207 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:29:44.933566 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:29:44.934141 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:44.934677 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:44.935108 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:44.935533 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:44.938768 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:29:44.939017 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m10:29:44.940221 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:44.941424 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:44.942044 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:44.942393 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:44.949027 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:44.949545 [debug] [MainThread]: On master: BEGIN
[0m10:29:44.949891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:44.955045 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:29:44.955552 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:44.955987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:44.958885 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m10:29:44.960544 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:44.960969 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:44.961270 [debug] [MainThread]: On master: BEGIN
[0m10:29:44.961749 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:44.962096 [debug] [MainThread]: On master: COMMIT
[0m10:29:44.962390 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:44.962792 [debug] [MainThread]: On master: COMMIT
[0m10:29:44.963222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:44.963594 [debug] [MainThread]: On master: Close
[0m10:29:44.964078 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:44.964548 [info ] [MainThread]: 
[0m10:29:44.970707 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m10:29:44.971241 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m10:29:44.971704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m10:29:44.972050 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m10:29:44.978712 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m10:29:44.979961 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m10:29:45.009385 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m10:29:45.010910 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:29:45.011300 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m10:29:45.011648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:45.016471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:29:45.017011 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:29:45.017511 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_id, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m10:29:45.025085 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.007 seconds
[0m10:29:45.032168 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:29:45.032825 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m10:29:45.034140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:45.059215 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m10:29:45.060150 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:29:45.060835 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m10:29:45.062372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:45.068537 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m10:29:45.071873 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:29:45.072250 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m10:29:45.072813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:29:45.075033 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m10:29:45.076442 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.10s]
[0m10:29:45.077105 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m10:29:45.078372 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.078719 [debug] [MainThread]: On master: BEGIN
[0m10:29:45.079005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:45.858082 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.024 seconds
[0m10:29:45.862379 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:45.861998 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m10:29:45.869277 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:29:45.874348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:29:45.877135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:29:45.875100 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:29:45.882778 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:45.884979 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:45.885370 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:45.885767 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:45.886136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:45.886476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:45.878083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:29:45.886819 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:45.889432 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:45.890070 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:29:45.890585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:29:45.891255 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:29:45.891086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:45.891673 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:29:45.891697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:45.892095 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:45.892710 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:45.893196 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:45.893720 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:45.896265 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m10:29:45.896572 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:29:45.896690 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:29:45.897748 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:45.899073 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:29:45.899475 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:29:45.898807 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:45.899510 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:45.901374 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.001 seconds
[0m10:29:45.902597 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:29:45.900114 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:45.903065 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:29:45.907342 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.907780 [debug] [MainThread]: On master: BEGIN
[0m10:29:45.908080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:50.098620 [debug] [MainThread]: SQL status: BEGIN in 5.019 seconds
[0m10:29:50.099899 [debug] [MainThread]: On master: COMMIT
[0m10:29:50.100338 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:50.100715 [debug] [MainThread]: On master: COMMIT
[0m10:29:50.101104 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:50.101410 [debug] [MainThread]: On master: Close
[0m10:29:50.102054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:50.102373 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:29:50.102646 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m10:29:50.103117 [info ] [MainThread]: 
[0m10:29:50.103632 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m10:29:50.104464 [debug] [MainThread]: Command end result
[0m10:29:50.104827 [info ] [MainThread]: 
[0m10:29:50.105304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:50.105681 [info ] [MainThread]: 
[0m10:29:50.106084 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:50.107137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6881595, "process_user_time": 1.449247, "process_kernel_time": 0.104089, "process_mem_max_rss": "106408", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:29:50.107765 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:50.107686 after 5.69 seconds
[0m10:29:50.108185 [debug] [MainThread]: Flushing usage events
[0m10:29:50.914464 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m10:29:50.916573 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:29:50.917448 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:29:50.921636 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:29:50.921097 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m10:29:50.923838 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:29:50.924356 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:50.925084 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:50.925018 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:29:50.929337 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m10:29:50.931998 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:50.932506 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:50.932876 [debug] [MainThread]: On master: BEGIN
[0m10:29:50.932759 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:50.933401 [debug] [MainThread]: On master: BEGIN
[0m10:29:50.933597 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:50.934083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:50.934471 [debug] [MainThread]: On master: COMMIT
[0m10:29:50.935137 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:50.935585 [debug] [MainThread]: On master: COMMIT
[0m10:29:50.936173 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:50.936575 [debug] [MainThread]: On master: Close
[0m10:29:50.937290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:50.937959 [info ] [MainThread]: 
[0m10:29:50.945625 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m10:29:50.946255 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m10:29:50.946871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m10:29:50.947342 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m10:29:50.954855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m10:29:50.955943 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m10:29:50.989636 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m10:29:50.991013 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:29:50.991476 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m10:29:50.991941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:50.996554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:29:51.000645 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:29:51.001552 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m10:29:51.004827 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m10:29:51.010655 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:29:51.011640 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m10:29:51.013814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:51.031582 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m10:29:51.032284 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:29:51.032831 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m10:29:51.034049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:51.040407 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m10:29:51.044546 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:29:51.045037 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m10:29:51.045698 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:29:51.048157 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m10:29:51.050142 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.10s]
[0m10:29:51.050981 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m10:29:51.052418 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:51.052891 [debug] [MainThread]: On master: BEGIN
[0m10:29:51.053274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:51.058083 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:29:51.058639 [debug] [MainThread]: On master: COMMIT
[0m10:29:51.059107 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:51.059454 [debug] [MainThread]: On master: COMMIT
[0m10:29:51.059928 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:51.060279 [debug] [MainThread]: On master: Close
[0m10:29:51.060750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:51.061083 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:51.061445 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m10:29:51.061840 [info ] [MainThread]: 
[0m10:29:51.062304 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m10:29:51.063037 [debug] [MainThread]: Command end result
[0m10:29:51.063401 [info ] [MainThread]: 
[0m10:29:51.063923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:51.064288 [info ] [MainThread]: 
[0m10:29:51.064684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:51.065872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.766377, "process_user_time": 1.419122, "process_kernel_time": 0.10151, "process_mem_max_rss": "106412", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:29:51.066585 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:51.066497 after 10.77 seconds
[0m10:29:51.067046 [debug] [MainThread]: Flushing usage events
[0m10:29:55.956875 [debug] [MainThread]: SQL status: BEGIN in 5.022 seconds
[0m10:29:55.959463 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:55.960242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:55.965586 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m10:29:55.968644 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:55.969249 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:55.969702 [debug] [MainThread]: On master: BEGIN
[0m10:29:55.970309 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:29:55.970880 [debug] [MainThread]: On master: COMMIT
[0m10:29:55.971280 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:55.971632 [debug] [MainThread]: On master: COMMIT
[0m10:29:55.972094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:55.972470 [debug] [MainThread]: On master: Close
[0m10:29:55.973289 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:55.974190 [info ] [MainThread]: 
[0m10:29:55.983516 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m10:29:55.984187 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m10:29:55.984755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m10:29:55.985209 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m10:29:55.993098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m10:29:55.994306 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m10:29:56.025233 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m10:29:56.026355 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:29:56.026817 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m10:29:56.027244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:56.031611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:29:56.032248 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:29:56.032759 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m10:29:56.035745 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m10:29:56.041581 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:29:56.041988 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m10:29:56.042595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:29:56.055898 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m10:29:56.056453 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:29:56.057036 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m10:29:56.058685 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:29:56.063490 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m10:29:56.066584 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:29:56.066921 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m10:29:56.067360 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:29:56.069356 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m10:29:56.070859 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.09s]
[0m10:29:56.071560 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m10:29:56.073084 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:56.073520 [debug] [MainThread]: On master: BEGIN
[0m10:29:56.073830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:56.078373 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:29:56.078764 [debug] [MainThread]: On master: COMMIT
[0m10:29:56.079106 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:56.079468 [debug] [MainThread]: On master: COMMIT
[0m10:29:56.080024 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:29:56.080357 [debug] [MainThread]: On master: Close
[0m10:29:56.080825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:56.081265 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:29:56.081688 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m10:29:56.082173 [info ] [MainThread]: 
[0m10:29:56.082524 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m10:29:56.083130 [debug] [MainThread]: Command end result
[0m10:29:56.083429 [info ] [MainThread]: 
[0m10:29:56.083825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:56.084136 [info ] [MainThread]: 
[0m10:29:56.084432 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:56.085520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.775625, "process_user_time": 1.430459, "process_kernel_time": 0.107409, "process_mem_max_rss": "106144", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:29:56.086219 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:56.086140 after 15.78 seconds
[0m10:29:56.086652 [debug] [MainThread]: Flushing usage events
[0m10:29:57.348198 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:57.353561 | 42858a2e-7a76-459f-b4a6-2ed97d602c06 ==============================
[0m10:29:57.353561 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:57.354161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m10:29:57.510801 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:57.524273 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:57.682895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:57.683448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:57.741473 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:57.742751 [info ] [MainThread]: 
[0m10:29:57.743109 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:57.744624 [debug] [MainThread]: Command end result
[0m10:29:57.745318 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43775988, "process_user_time": 1.213341, "process_kernel_time": 0.091648, "process_mem_max_rss": "97892", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:57.745810 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:57.745743 after 0.44 seconds
[0m10:29:57.746147 [debug] [MainThread]: Flushing usage events
[0m10:29:58.381201 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:29:58.386552 | aa17959e-d8e6-4ee5-89ea-a881ca088270 ==============================
[0m10:29:58.386552 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:29:58.387105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m10:29:58.533769 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:58.547225 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:29:58.689464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:58.690287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:58.762982 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:29:58.764871 [info ] [MainThread]: 
[0m10:29:58.765508 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:29:58.767132 [debug] [MainThread]: Command end result
[0m10:29:58.768115 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42174745, "process_user_time": 1.234677, "process_kernel_time": 0.090829, "process_mem_max_rss": "97908", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:29:58.768912 [debug] [MainThread]: Command `dbt test` succeeded at 10:29:58.768786 after 0.42 seconds
[0m10:29:58.769401 [debug] [MainThread]: Flushing usage events
[0m10:30:03.421799 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:30:03.427896 | 9cd3a192-b361-41d5-9818-7dd127bcc3fd ==============================
[0m10:30:03.427896 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:30:03.428611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:30:03.456410 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:30:03.461550 | 2b8e9fff-8547-4a8b-a707-45f27c264af7 ==============================
[0m10:30:03.461550 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:30:03.462177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:30:03.579491 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:03.592820 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:30:03.620588 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:03.642475 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:30:03.744228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:03.744702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:03.798220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:03.798721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:03.814279 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:30:03.815672 [info ] [MainThread]: 
[0m10:30:03.816021 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:30:03.817328 [debug] [MainThread]: Command end result
[0m10:30:03.817932 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42989796, "process_user_time": 1.265842, "process_kernel_time": 0.081182, "process_mem_max_rss": "97776", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:30:03.821241 [debug] [MainThread]: Command `dbt test` succeeded at 10:30:03.821166 after 0.43 seconds
[0m10:30:03.821622 [debug] [MainThread]: Flushing usage events
[0m10:30:03.859304 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:30:03.860872 [info ] [MainThread]: 
[0m10:30:03.864367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:03.865275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:30:03.896308 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:30:03.898260 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:30:03.898705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:03.907838 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m10:30:03.910903 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:30:03.915815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:30:03.916602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:30:03.921689 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:03.923897 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:03.924397 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:30:03.924829 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:30:03.925357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:03.925833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:03.931278 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:30:03.931801 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:03.932173 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:30:03.935587 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m10:30:03.936821 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:30:03.937332 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:30:08.945875 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m10:30:08.947644 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:08.948512 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:30:08.953158 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m10:30:08.955636 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:30:08.956366 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:30:08.965236 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:08.965940 [debug] [MainThread]: On master: BEGIN
[0m10:30:08.966532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:08.973397 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:30:08.974123 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:08.974599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:08.978230 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m10:30:08.980456 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:08.980963 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:08.981327 [debug] [MainThread]: On master: BEGIN
[0m10:30:08.981816 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:30:08.982265 [debug] [MainThread]: On master: COMMIT
[0m10:30:08.982579 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:08.982870 [debug] [MainThread]: On master: COMMIT
[0m10:30:08.983369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:08.983678 [debug] [MainThread]: On master: Close
[0m10:30:08.984196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:08.984750 [info ] [MainThread]: 
[0m10:30:08.991576 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m10:30:08.992206 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m10:30:08.992736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_customers)
[0m10:30:08.993129 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m10:30:09.009061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m10:30:09.010224 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m10:30:09.036210 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m10:30:09.037407 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:30:09.037843 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m10:30:09.038212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:09.042699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:30:09.043184 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:30:09.043640 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m10:30:09.046409 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:30:09.051725 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:30:09.052114 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m10:30:09.052959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:30:09.063615 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m10:30:09.064071 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:30:09.064442 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m10:30:09.065378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:30:09.069914 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m10:30:09.072891 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:30:09.073225 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m10:30:09.073605 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:30:09.075492 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m10:30:09.076906 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:30:09.077603 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m10:30:09.078869 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.079343 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.079672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:14.097922 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m10:30:14.099574 [debug] [MainThread]: On master: COMMIT
[0m10:30:14.100208 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:14.100731 [debug] [MainThread]: On master: COMMIT
[0m10:30:14.101457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:14.102053 [debug] [MainThread]: On master: Close
[0m10:30:14.103058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:14.103535 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:30:14.104052 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m10:30:14.104749 [info ] [MainThread]: 
[0m10:30:14.105523 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m10:30:14.106862 [debug] [MainThread]: Command end result
[0m10:30:14.107390 [info ] [MainThread]: 
[0m10:30:14.108024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:14.108760 [info ] [MainThread]: 
[0m10:30:14.109446 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:14.111070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.707101, "process_user_time": 1.440214, "process_kernel_time": 0.101944, "process_mem_max_rss": "106560", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m10:30:14.112036 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:14.111866 after 10.71 seconds
[0m10:30:14.112599 [debug] [MainThread]: Flushing usage events
[0m10:30:21.729276 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:30:21.734656 | fbf860e9-ce07-4245-b4ce-e8c848e4c029 ==============================
[0m10:30:21.734656 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:30:21.735260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:30:21.743652 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:30:21.749234 | cc23b697-fa6d-41d2-a15a-7d213ccfda9a ==============================
[0m10:30:21.749234 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:30:21.749837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:30:21.911766 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:21.912556 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:21.927575 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:30:21.928401 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:30:22.069776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:22.069411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:22.070266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:22.070569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:22.128071 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:30:22.129609 [info ] [MainThread]: 
[0m10:30:22.130231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:22.131205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:30:22.138065 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:30:22.140275 [info ] [MainThread]: 
[0m10:30:22.140853 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:30:22.142657 [debug] [MainThread]: Command end result
[0m10:30:22.143419 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45316496, "process_user_time": 1.224854, "process_kernel_time": 0.147102, "process_mem_max_rss": "97648", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:30:22.143961 [debug] [MainThread]: Command `dbt test` succeeded at 10:30:22.143878 after 0.45 seconds
[0m10:30:22.144483 [debug] [MainThread]: Flushing usage events
[0m10:30:22.168929 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:30:22.169813 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:30:22.170332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:22.177745 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m10:30:22.180822 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:30:22.188695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:30:22.189509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:30:22.195830 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:22.198916 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:22.199602 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:30:22.201050 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:30:22.201784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:22.202393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:27.230552 [debug] [ThreadPool]: SQL status: BEGIN in 5.028 seconds
[0m10:30:27.232056 [debug] [ThreadPool]: SQL status: BEGIN in 5.030 seconds
[0m10:30:27.233143 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:27.234060 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:27.234823 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:30:27.235519 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:30:27.240565 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m10:30:27.240932 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:30:27.243853 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:30:27.245880 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:30:27.246642 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:30:27.247018 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:30:27.257247 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:27.257826 [debug] [MainThread]: On master: BEGIN
[0m10:30:27.258446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:27.263648 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:30:27.264149 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:27.264664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:27.268217 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:30:27.270433 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:27.270913 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:27.271313 [debug] [MainThread]: On master: BEGIN
[0m10:30:27.271863 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:30:27.272404 [debug] [MainThread]: On master: COMMIT
[0m10:30:27.272777 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:27.273088 [debug] [MainThread]: On master: COMMIT
[0m10:30:27.273585 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:27.274001 [debug] [MainThread]: On master: Close
[0m10:30:27.274606 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:27.275386 [info ] [MainThread]: 
[0m10:30:27.282823 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m10:30:27.283614 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m10:30:27.284260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m10:30:27.284722 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m10:30:27.292594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m10:30:27.293655 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m10:30:27.326537 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m10:30:27.327642 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:30:27.328099 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m10:30:27.328440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:32.340492 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m10:30:32.341617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:30:32.342288 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m10:30:33.517669 [debug] [Thread-1 (]: SQL status: SELECT 258932 in 1.175 seconds
[0m10:30:33.524887 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:30:33.525364 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:30:33.526136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:30:33.539383 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m10:30:33.540005 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:30:33.540380 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m10:30:33.549134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m10:30:33.554153 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m10:30:33.557239 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:30:33.557568 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m10:30:33.558095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:30:33.560778 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m10:30:33.562569 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 258932[0m in 6.28s]
[0m10:30:33.563435 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m10:30:33.565190 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:33.565637 [debug] [MainThread]: On master: BEGIN
[0m10:30:33.565972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:33.571480 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:30:33.571873 [debug] [MainThread]: On master: COMMIT
[0m10:30:33.572267 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:33.572580 [debug] [MainThread]: On master: COMMIT
[0m10:30:33.572985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:33.573334 [debug] [MainThread]: On master: Close
[0m10:30:33.573786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:33.574131 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m10:30:33.574760 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:30:33.575160 [info ] [MainThread]: 
[0m10:30:33.575558 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m10:30:33.576188 [debug] [MainThread]: Command end result
[0m10:30:33.576563 [info ] [MainThread]: 
[0m10:30:33.577016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:33.577357 [info ] [MainThread]: 
[0m10:30:33.577782 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:33.578856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.882718, "process_user_time": 1.405407, "process_kernel_time": 0.16833, "process_mem_max_rss": "106652", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:30:33.579605 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:33.579518 after 11.88 seconds
[0m10:30:33.580044 [debug] [MainThread]: Flushing usage events
[0m10:30:40.831042 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:30:40.840318 | 9141b2f4-8db9-4522-b96c-ac7f704078b3 ==============================
[0m10:30:40.840318 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:30:40.843410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:30:40.848442 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:30:40.856451 | fdf95db8-7bd8-4734-84ab-c9a0a84227b1 ==============================
[0m10:30:40.856451 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:30:40.857139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:30:40.865592 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:30:40.872952 | fda2c6e6-e388-477e-be86-40c4723f014c ==============================
[0m10:30:40.872952 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:30:40.873838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:30:41.026168 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:41.031682 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:41.043409 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:41.046707 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:30:41.050502 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:30:41.060623 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:30:41.222319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:41.223034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:41.223516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:41.224052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:41.239648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:41.240302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:41.280338 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:30:41.281455 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:30:41.283015 [info ] [MainThread]: 
[0m10:30:41.284537 [info ] [MainThread]: 
[0m10:30:41.285085 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:41.285668 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:41.286574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:30:41.286969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:30:41.302404 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:30:41.303998 [info ] [MainThread]: 
[0m10:30:41.304507 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:30:41.306139 [debug] [MainThread]: Command end result
[0m10:30:41.306916 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4969627, "process_user_time": 1.268599, "process_kernel_time": 0.12293, "process_mem_max_rss": "97532", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:30:41.307525 [debug] [MainThread]: Command `dbt test` succeeded at 10:30:41.307444 after 0.50 seconds
[0m10:30:41.307930 [debug] [MainThread]: Flushing usage events
[0m10:30:41.322878 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:30:41.322706 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:30:41.323417 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:30:41.323498 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:30:41.323973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:41.324025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:41.332035 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m10:30:41.332096 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m10:30:41.333465 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:30:41.333502 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:30:41.338593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:30:41.339038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:30:41.339252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:30:41.339713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:30:41.344387 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:41.346295 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:41.345035 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:41.346832 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:30:41.347194 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:41.347373 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:30:41.347663 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:30:41.347786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:41.348180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:41.348111 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:30:41.348560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:41.349082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:41.353184 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:30:41.353963 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:41.354448 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:30:41.354599 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:30:41.354950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:30:41.355480 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:30:41.357382 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m10:30:41.358569 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m10:30:41.358685 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:30:41.359343 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:30:41.360022 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:30:41.361761 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:30:46.368150 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m10:30:46.369712 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:46.368532 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m10:30:46.370935 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:30:46.370455 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:30:46.371647 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:30:46.374766 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:30:46.375135 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:30:46.377545 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:30:46.380601 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:30:46.381852 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:30:46.381483 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:30:46.390277 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:46.391117 [debug] [MainThread]: On master: BEGIN
[0m10:30:46.392143 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:46.392394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:46.392961 [debug] [MainThread]: On master: BEGIN
[0m10:30:46.393761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:46.400915 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:30:46.401670 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:46.402200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:46.406283 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m10:30:46.409052 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:46.409693 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:46.410249 [debug] [MainThread]: On master: BEGIN
[0m10:30:46.411084 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:30:46.411906 [debug] [MainThread]: On master: COMMIT
[0m10:30:46.412326 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:46.412659 [debug] [MainThread]: On master: COMMIT
[0m10:30:46.413108 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:46.413525 [debug] [MainThread]: On master: Close
[0m10:30:46.414239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:46.415004 [info ] [MainThread]: 
[0m10:30:46.423695 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m10:30:46.424439 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m10:30:46.424997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_main)
[0m10:30:46.425400 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m10:30:46.448892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m10:30:46.450931 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m10:30:46.495880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m10:30:46.497715 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:30:46.498233 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m10:30:46.498629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:46.504920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:30:46.505759 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:30:46.506327 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m10:30:51.409179 [debug] [MainThread]: SQL status: BEGIN in 5.016 seconds
[0m10:30:51.410718 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:51.411254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:51.414483 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:30:51.417913 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:51.418366 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:51.418674 [debug] [MainThread]: On master: BEGIN
[0m10:30:51.419316 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:30:51.419884 [debug] [MainThread]: On master: COMMIT
[0m10:30:51.420261 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:51.420624 [debug] [MainThread]: On master: COMMIT
[0m10:30:51.421108 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:51.421511 [debug] [MainThread]: On master: Close
[0m10:30:51.422417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:51.423153 [info ] [MainThread]: 
[0m10:30:51.431460 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m10:30:51.432218 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m10:30:51.432721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m10:30:51.433118 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m10:30:51.454035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:30:51.455322 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m10:30:51.499999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:30:51.501124 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:30:51.501537 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m10:30:51.501853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:51.914533 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.406 seconds
[0m10:30:51.934868 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m10:30:51.935515 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:30:51.935999 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m10:30:51.967897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m10:30:51.971891 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m10:30:51.974746 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.55s]
[0m10:30:51.975858 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m10:30:51.978783 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:51.979293 [debug] [MainThread]: On master: BEGIN
[0m10:30:51.979640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:56.509358 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m10:30:56.510722 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:30:56.512416 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m10:30:56.994843 [debug] [MainThread]: SQL status: BEGIN in 5.015 seconds
[0m10:30:56.996103 [debug] [MainThread]: On master: COMMIT
[0m10:30:56.996697 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:56.997087 [debug] [MainThread]: On master: COMMIT
[0m10:30:56.997707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:56.998144 [debug] [MainThread]: On master: Close
[0m10:30:56.998873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:56.999267 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:30:56.999572 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m10:30:57.000041 [info ] [MainThread]: 
[0m10:30:57.000568 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.71 seconds (15.71s).
[0m10:30:57.001575 [debug] [MainThread]: Command end result
[0m10:30:57.001895 [info ] [MainThread]: 
[0m10:30:57.002442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:57.002853 [info ] [MainThread]: 
[0m10:30:57.003385 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:57.005534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.215054, "process_user_time": 1.425902, "process_kernel_time": 0.139185, "process_mem_max_rss": "107160", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m10:30:57.006662 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:57.006560 after 16.22 seconds
[0m10:30:57.007285 [debug] [MainThread]: Flushing usage events
[0m10:30:57.599116 [debug] [Thread-1 (]: SQL status: SELECT 158932 in 1.084 seconds
[0m10:30:57.621704 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m10:30:57.622503 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:30:57.623092 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m10:30:57.627165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:30:57.630640 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m10:30:57.633514 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 158932[0m in 6.20s]
[0m10:30:57.634755 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m10:30:57.637017 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:57.637533 [debug] [MainThread]: On master: BEGIN
[0m10:30:57.637969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:57.644591 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:30:57.645313 [debug] [MainThread]: On master: COMMIT
[0m10:30:57.645753 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:57.646124 [debug] [MainThread]: On master: COMMIT
[0m10:30:57.646598 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:30:57.646978 [debug] [MainThread]: On master: Close
[0m10:30:57.647555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:57.648003 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:30:57.648594 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m10:30:57.649146 [info ] [MainThread]: 
[0m10:30:57.649727 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 16.36 seconds (16.36s).
[0m10:30:57.650669 [debug] [MainThread]: Command end result
[0m10:30:57.651074 [info ] [MainThread]: 
[0m10:30:57.651693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:57.652118 [info ] [MainThread]: 
[0m10:30:57.652630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:57.654070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.847942, "process_user_time": 1.446674, "process_kernel_time": 0.136535, "process_mem_max_rss": "106932", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m10:30:57.654920 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:57.654842 after 16.85 seconds
[0m10:30:57.655414 [debug] [MainThread]: Flushing usage events
[0m10:31:04.077353 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:31:04.084114 | 299e2271-d4ce-4858-a8a4-f286a00b835b ==============================
[0m10:31:04.084114 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:31:04.084752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:31:04.241015 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:31:04.253014 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:31:04.392820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:04.393369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:04.454789 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:31:04.456183 [info ] [MainThread]: 
[0m10:31:04.456627 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:31:04.458229 [debug] [MainThread]: Command end result
[0m10:31:04.459008 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42400363, "process_user_time": 1.257789, "process_kernel_time": 0.128489, "process_mem_max_rss": "97764", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:31:04.459561 [debug] [MainThread]: Command `dbt test` succeeded at 10:31:04.459486 after 0.42 seconds
[0m10:31:04.459984 [debug] [MainThread]: Flushing usage events
[0m10:31:04.985222 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:31:04.990881 | 28cdd563-5f88-4faa-802f-2aa0a79b7195 ==============================
[0m10:31:04.990881 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:31:04.991833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:31:05.018869 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:31:05.024365 | 261f27ac-3287-4528-b3a0-5d51bc4b8551 ==============================
[0m10:31:05.024365 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:31:05.025189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:31:05.160124 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:31:05.172711 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:31:05.174722 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:31:05.195469 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:31:05.340054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:05.340924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:05.367829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:05.368358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:05.421185 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:31:05.422709 [info ] [MainThread]: 
[0m10:31:05.423075 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:31:05.424509 [debug] [MainThread]: Command end result
[0m10:31:05.425244 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48178908, "process_user_time": 1.238785, "process_kernel_time": 0.078493, "process_mem_max_rss": "97748", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:31:05.425853 [debug] [MainThread]: Command `dbt test` succeeded at 10:31:05.425782 after 0.48 seconds
[0m10:31:05.426824 [debug] [MainThread]: Flushing usage events
[0m10:31:05.426329 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:31:05.429852 [info ] [MainThread]: 
[0m10:31:05.431083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:31:05.432228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:31:05.466877 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:31:05.467455 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:31:05.467914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:05.475602 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m10:31:05.476614 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:31:05.481290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:31:05.481806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:31:05.486794 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:31:05.488552 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:31:05.488965 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:31:05.489310 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:31:05.489639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:05.489977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:05.494876 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:31:05.495439 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:31:05.495836 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:31:05.499008 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:31:05.500126 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:31:05.500541 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:31:10.504845 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m10:31:10.506909 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:31:10.509893 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:31:10.512182 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.002 seconds
[0m10:31:10.514698 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:31:10.515266 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:31:10.521753 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:10.522247 [debug] [MainThread]: On master: BEGIN
[0m10:31:10.522619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:15.544295 [debug] [MainThread]: SQL status: BEGIN in 5.021 seconds
[0m10:31:15.546735 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:15.547551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:31:15.554048 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m10:31:15.557719 [debug] [MainThread]: On master: ROLLBACK
[0m10:31:15.558302 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:15.558739 [debug] [MainThread]: On master: BEGIN
[0m10:31:15.559334 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:31:15.559869 [debug] [MainThread]: On master: COMMIT
[0m10:31:15.560257 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:15.560625 [debug] [MainThread]: On master: COMMIT
[0m10:31:15.561115 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:31:15.561488 [debug] [MainThread]: On master: Close
[0m10:31:15.562196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:31:15.563013 [info ] [MainThread]: 
[0m10:31:15.571745 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m10:31:15.572516 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m10:31:15.573077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m10:31:15.573502 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m10:31:15.581094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m10:31:15.582131 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m10:31:15.609943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m10:31:15.610938 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:31:15.611325 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m10:31:15.611688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:20.630833 [debug] [Thread-1 (]: SQL status: BEGIN in 5.018 seconds
[0m10:31:20.632372 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:31:20.633087 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m10:31:22.090302 [debug] [Thread-1 (]: SQL status: SELECT 1158932 in 1.456 seconds
[0m10:31:22.103855 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:31:22.104363 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m10:31:22.105452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:31:22.119204 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m10:31:22.119705 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:31:22.120113 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m10:31:22.130719 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m10:31:22.138373 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m10:31:22.142468 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:31:22.142902 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m10:31:22.143469 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:31:22.146699 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m10:31:22.148864 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1158932[0m in 6.57s]
[0m10:31:22.150105 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m10:31:22.153197 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:22.153821 [debug] [MainThread]: On master: BEGIN
[0m10:31:22.154204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:22.161090 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:31:22.161641 [debug] [MainThread]: On master: COMMIT
[0m10:31:22.162053 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:22.162362 [debug] [MainThread]: On master: COMMIT
[0m10:31:22.162886 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:31:22.163278 [debug] [MainThread]: On master: Close
[0m10:31:22.163814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:22.164174 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m10:31:22.164523 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:31:22.164983 [info ] [MainThread]: 
[0m10:31:22.165386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.73 seconds (16.73s).
[0m10:31:22.166224 [debug] [MainThread]: Command end result
[0m10:31:22.166575 [info ] [MainThread]: 
[0m10:31:22.167139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:31:22.167479 [info ] [MainThread]: 
[0m10:31:22.167924 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:31:22.169819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.207388, "process_user_time": 1.393392, "process_kernel_time": 0.107721, "process_mem_max_rss": "106132", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:31:22.170674 [debug] [MainThread]: Command `dbt run` succeeded at 10:31:22.170567 after 17.21 seconds
[0m10:31:22.171140 [debug] [MainThread]: Flushing usage events
[0m10:31:29.247051 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:31:29.248037 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:31:29.254799 | c9dee846-897e-474f-a49c-185fbb01bcff ==============================
[0m10:31:29.254799 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:31:29.255317 | e350f0f0-0c66-454e-8cf0-1bbc542c8b16 ==============================
[0m10:31:29.255317 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:31:29.256069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:31:29.256529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:31:29.432961 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:31:29.440507 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:31:29.452022 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:31:29.455383 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:31:29.686897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:29.685651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:29.687407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:29.687827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:29.764752 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:31:29.767039 [info ] [MainThread]: 
[0m10:31:29.767807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:31:29.768847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:31:29.775235 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:31:29.777211 [info ] [MainThread]: 
[0m10:31:29.777680 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:31:29.779678 [debug] [MainThread]: Command end result
[0m10:31:29.780605 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5737015, "process_user_time": 1.297002, "process_kernel_time": 0.152, "process_mem_max_rss": "97612", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:31:29.781208 [debug] [MainThread]: Command `dbt test` succeeded at 10:31:29.781137 after 0.57 seconds
[0m10:31:29.781582 [debug] [MainThread]: Flushing usage events
[0m10:31:29.804343 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:31:29.806757 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:31:29.810885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:29.818334 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m10:31:29.819486 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:31:29.824168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:31:29.824795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:31:29.829772 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:31:29.831670 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:31:29.832069 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:31:29.832427 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:31:29.832813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:31:29.833134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:34.846446 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m10:31:34.847281 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m10:31:34.849314 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:31:34.851664 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:31:34.848132 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:31:34.854566 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:31:34.856560 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m10:31:34.858373 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:31:34.858671 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.003 seconds
[0m10:31:34.859154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:31:34.860650 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:31:34.862494 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:31:34.871277 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:34.872273 [debug] [MainThread]: On master: BEGIN
[0m10:31:34.872689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:34.877472 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:31:34.878030 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:34.878473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:31:34.881931 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:31:34.884037 [debug] [MainThread]: On master: ROLLBACK
[0m10:31:34.884544 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:34.884936 [debug] [MainThread]: On master: BEGIN
[0m10:31:34.885451 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:31:34.885944 [debug] [MainThread]: On master: COMMIT
[0m10:31:34.886332 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:34.886639 [debug] [MainThread]: On master: COMMIT
[0m10:31:34.887128 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:31:34.887531 [debug] [MainThread]: On master: Close
[0m10:31:34.888037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:31:34.888658 [info ] [MainThread]: 
[0m10:31:34.895529 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m10:31:34.896243 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m10:31:34.896882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m10:31:34.897386 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m10:31:34.905350 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m10:31:34.908030 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m10:31:34.938219 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m10:31:34.940121 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:31:34.940487 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m10:31:34.940858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:34.947951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:31:34.950701 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:31:34.951081 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m10:31:36.572658 [debug] [Thread-1 (]: SQL status: SELECT 1158932 in 1.620 seconds
[0m10:31:36.581804 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:31:36.582386 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m10:31:36.583458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:31:36.597198 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m10:31:36.597646 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:31:36.598015 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m10:31:36.610172 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:31:36.615307 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m10:31:36.618358 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:31:36.618713 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m10:31:36.619197 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:31:36.621987 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m10:31:36.623937 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1158932[0m in 1.73s]
[0m10:31:36.625296 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m10:31:36.627648 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:36.628187 [debug] [MainThread]: On master: BEGIN
[0m10:31:36.628565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:36.634294 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:31:36.634909 [debug] [MainThread]: On master: COMMIT
[0m10:31:36.635429 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:36.635816 [debug] [MainThread]: On master: COMMIT
[0m10:31:36.636271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:31:36.636658 [debug] [MainThread]: On master: Close
[0m10:31:36.637105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:36.637418 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m10:31:36.637706 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:31:36.638089 [info ] [MainThread]: 
[0m10:31:36.638477 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m10:31:36.639152 [debug] [MainThread]: Command end result
[0m10:31:36.639479 [info ] [MainThread]: 
[0m10:31:36.639955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:31:36.640280 [info ] [MainThread]: 
[0m10:31:36.640754 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:31:36.642403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.438296, "process_user_time": 1.445254, "process_kernel_time": 0.169146, "process_mem_max_rss": "106584", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:31:36.643452 [debug] [MainThread]: Command `dbt run` succeeded at 10:31:36.643337 after 7.44 seconds
[0m10:31:36.644016 [debug] [MainThread]: Flushing usage events
[0m10:31:44.406135 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:31:44.411935 | 82061ae1-d615-4e59-882d-002e6726f68e ==============================
[0m10:31:44.411935 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:31:44.412467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:31:44.554370 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:31:44.568441 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:31:44.698905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:31:44.699428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:31:44.758073 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:31:44.759371 [info ] [MainThread]: 
[0m10:31:44.759915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:31:44.763872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:31:44.764434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:31:44.795092 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:31:44.795420 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:31:44.795778 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:31:44.796151 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:31:44.796493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:44.796860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:44.804062 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:31:44.804501 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:31:44.804954 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:31:44.805340 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:31:44.805726 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:31:44.806122 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:31:44.809628 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:31:44.809873 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m10:31:44.810969 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:31:44.812240 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:31:44.812717 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:31:44.813030 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:31:44.820395 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:44.820864 [debug] [MainThread]: On master: BEGIN
[0m10:31:44.821221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:44.825396 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:31:44.825862 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:44.826235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:31:44.829692 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:31:44.831773 [debug] [MainThread]: On master: ROLLBACK
[0m10:31:44.832241 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:44.832553 [debug] [MainThread]: On master: BEGIN
[0m10:31:44.833014 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:31:44.833395 [debug] [MainThread]: On master: COMMIT
[0m10:31:44.833712 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:44.834017 [debug] [MainThread]: On master: COMMIT
[0m10:31:44.834395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:31:44.834716 [debug] [MainThread]: On master: Close
[0m10:31:44.835170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:31:44.835648 [info ] [MainThread]: 
[0m10:31:44.842622 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m10:31:44.843091 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m10:31:44.843573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m10:31:44.843929 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m10:31:44.851259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m10:31:44.852762 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m10:31:44.865163 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m10:31:44.866746 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m10:31:44.867105 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m10:31:44.867440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:44.871722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:31:44.872186 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m10:31:44.872489 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m10:31:45.051422 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.178 seconds
[0m10:31:45.056089 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m10:31:45.056794 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m10:31:45.057574 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.21s]
[0m10:31:45.058331 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m10:31:45.060048 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:45.060543 [debug] [MainThread]: On master: BEGIN
[0m10:31:45.061004 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:50.078138 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m10:31:50.079472 [debug] [MainThread]: On master: COMMIT
[0m10:31:50.080144 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:50.080763 [debug] [MainThread]: On master: COMMIT
[0m10:31:50.081606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:31:50.082271 [debug] [MainThread]: On master: Close
[0m10:31:50.083096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:50.083571 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m10:31:50.084038 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:31:50.084555 [info ] [MainThread]: 
[0m10:31:50.085338 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m10:31:50.086781 [debug] [MainThread]: Command end result
[0m10:31:50.087478 [info ] [MainThread]: 
[0m10:31:50.088128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:31:50.088666 [info ] [MainThread]: 
[0m10:31:50.089202 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:31:50.090796 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.7187757, "process_user_time": 1.279549, "process_kernel_time": 0.082099, "process_mem_max_rss": "108348", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m10:31:50.091672 [debug] [MainThread]: Command `dbt test` succeeded at 10:31:50.091547 after 5.72 seconds
[0m10:31:50.092172 [debug] [MainThread]: Flushing usage events
[0m10:40:54.104563 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:40:54.110092 | 6dd3563f-431a-4595-85f3-99caedf46733 ==============================
[0m10:40:54.110092 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:40:54.110647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:54.199419 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m10:40:54.201062 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m10:40:54.205081 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p1mbkqia'
[0m10:40:54.205461 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m10:40:54.206138 [debug] [MainThread]: Creating symlink to local dependency.
[0m10:40:54.206596 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m10:40:54.207470 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13624579, "process_user_time": 0.932428, "process_kernel_time": 0.143219, "process_mem_max_rss": "105872", "process_in_blocks": "216", "process_out_blocks": "11"}
[0m10:40:54.207957 [debug] [MainThread]: Command `dbt deps` succeeded at 10:40:54.207883 after 0.14 seconds
[0m10:40:54.208284 [debug] [MainThread]: Flushing usage events
[0m10:41:01.189385 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:41:01.194508 | 9ac946b7-5429-4e56-a729-8a5d9ec8770f ==============================
[0m10:41:01.194508 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:41:01.195019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m10:41:01.337411 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:41:01.348940 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m10:41:01.350096 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:41:02.664687 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:41:02.666677 [info ] [MainThread]: 
[0m10:41:02.667308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:41:02.668269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:41:02.697127 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:41:02.697634 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:41:02.697979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:02.707372 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m10:41:02.708441 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:41:02.709089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m10:41:02.709554 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m10:41:02.714273 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:41:02.714647 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m10:41:02.714964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:02.719275 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:41:02.719690 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:41:02.720071 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m10:41:02.720817 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:41:02.721593 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m10:41:02.721927 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m10:41:02.722215 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m10:41:02.723440 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:41:02.723776 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m10:41:02.728154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m10:41:02.728673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:41:02.733223 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:41:02.735043 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:41:02.735429 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:41:02.735770 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:41:02.736091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:02.736415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:07.746523 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m10:41:07.747733 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m10:41:07.748645 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:41:07.749271 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:41:07.749890 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:41:07.750414 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:41:07.755728 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m10:41:07.756365 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m10:41:07.758477 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:41:07.760098 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:41:07.760942 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:41:07.761297 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:41:07.769136 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:07.769693 [debug] [MainThread]: On master: BEGIN
[0m10:41:07.770133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:07.774447 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:41:07.774884 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:07.775340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:41:07.778494 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:41:07.779636 [debug] [MainThread]: On master: ROLLBACK
[0m10:41:07.780098 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:07.780438 [debug] [MainThread]: On master: BEGIN
[0m10:41:07.780936 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:41:07.781409 [debug] [MainThread]: On master: COMMIT
[0m10:41:07.781744 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:07.782122 [debug] [MainThread]: On master: COMMIT
[0m10:41:07.782562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:41:07.782883 [debug] [MainThread]: On master: Close
[0m10:41:07.783435 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:41:07.783960 [info ] [MainThread]: 
[0m10:41:07.792051 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m10:41:07.792634 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m10:41:07.793103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m10:41:07.793490 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m10:41:07.793833 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m10:41:07.817165 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:41:07.817587 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m10:41:07.817919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:12.846947 [debug] [Thread-1 (]: SQL status: BEGIN in 5.028 seconds
[0m10:41:12.848834 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:41:12.849535 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m10:41:12.854378 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m10:41:12.914156 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:41:12.914636 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m10:41:12.915896 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m10:41:12.919814 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m10:41:12.933878 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m10:41:12.934611 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m10:41:12.935240 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m10:41:12.936365 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:41:12.939028 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m10:41:12.941586 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 5.15s]
[0m10:41:12.942691 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m10:41:12.944570 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:12.944993 [debug] [MainThread]: On master: BEGIN
[0m10:41:12.945347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:12.950198 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:41:12.950757 [debug] [MainThread]: On master: COMMIT
[0m10:41:12.951147 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:12.951598 [debug] [MainThread]: On master: COMMIT
[0m10:41:12.952065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:41:12.952450 [debug] [MainThread]: On master: Close
[0m10:41:12.952947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:12.953341 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m10:41:12.953723 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:41:12.954141 [info ] [MainThread]: 
[0m10:41:12.954570 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m10:41:12.955326 [debug] [MainThread]: Command end result
[0m10:41:12.995422 [info ] [MainThread]: 
[0m10:41:12.996046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:12.996433 [info ] [MainThread]: 
[0m10:41:12.996867 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:41:12.998357 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.841927, "process_user_time": 2.467243, "process_kernel_time": 0.146954, "process_mem_max_rss": "113716", "process_in_blocks": "16", "process_out_blocks": "3517"}
[0m10:41:12.999209 [debug] [MainThread]: Command `dbt seed` succeeded at 10:41:12.999093 after 11.84 seconds
[0m10:41:12.999750 [debug] [MainThread]: Flushing usage events
[0m10:42:16.615340 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:42:16.617095 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:16.622575 | 3b46d654-d665-4d5d-8879-2037dc288ea5 ==============================
[0m10:42:16.622575 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:42:16.622740 | 460925d4-b790-433c-b88a-21bf988cd1f6 ==============================
[0m10:42:16.622740 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:16.623253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m10:42:16.624297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:42:16.623028 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:42:16.624991 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:16.629881 | 81c03bd9-fd6a-4fec-8678-2303e5a94787 ==============================
[0m10:42:16.629881 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:16.626181 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:42:16.630735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 10:42:16.630670 | a3b78172-80e1-4db5-84c2-8499029e961c ==============================
[0m10:42:16.630670 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:42:16.632088 | 242d90f0-b238-484a-a2b8-9a8503c652f7 ==============================
[0m10:42:16.632088 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:16.633055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:42:16.632963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'send_anonymous_usage_stats': 'True'}
[0m10:42:16.631638 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:42:16.631725 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:16.638887 | 9005b0b7-f0a2-4abf-9683-4e7a41fd8618 ==============================
[0m10:42:16.638887 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:42:16.639104 | 8add650e-282a-488b-a0a0-8adb5c98e334 ==============================
[0m10:42:16.639104 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:16.639682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:42:16.640489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:42:16.838974 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:16.839383 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:16.843044 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:16.846593 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:16.849296 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:16.874592 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:16.875276 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:16.880395 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:16.894693 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:16.896436 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:16.903718 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:16.915570 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:16.944705 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:16.946821 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:17.020449 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:42:17.022384 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:42:17.023435 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:42:17.026981 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:42:17.028131 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:42:17.029443 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:42:17.034237 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:42:17.035011 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:42:17.057307 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:42:17.058051 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:42:17.070677 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:42:17.071638 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:42:17.085655 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:42:17.086506 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m10:42:18.517365 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:18.521065 [info ] [MainThread]: 
[0m10:42:18.521691 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:18.522542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:18.523286 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:18.524444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:18.525453 [info ] [MainThread]: 
[0m10:42:18.526508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:18.525932 [info ] [MainThread]: 
[0m10:42:18.528100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:18.528458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:18.530770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:18.565857 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:18.566763 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:18.566458 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:18.567940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.568602 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:18.570191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.570692 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:18.571578 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:18.572542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.578638 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:18.580778 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m10:42:18.580549 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m10:42:18.582379 [info ] [MainThread]: 
[0m10:42:18.583088 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:18.583439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:18.583492 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:18.583691 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:18.585370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m10:42:18.584763 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:18.586770 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m10:42:18.586435 [info ] [MainThread]: 
[0m10:42:18.584847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m10:42:18.591400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:18.592291 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m10:42:18.593575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:18.594521 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:42:18.595333 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m10:42:18.596045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:18.598473 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:18.600722 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:42:18.600479 [info ] [MainThread]: 
[0m10:42:18.601865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:18.601450 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m10:42:18.604298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:18.605132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:18.620518 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m10:42:18.624532 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:42:18.625358 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m10:42:18.627202 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:42:18.628916 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:42:18.629557 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:42:18.629924 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m10:42:18.630259 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m10:42:18.630710 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m10:42:18.631349 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m10:42:18.633782 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m10:42:18.634368 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m10:42:18.634515 [debug] [ThreadPool]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_namespace_nspname_index"
DETAIL:  Key (nspname)=(dev) already exists.

[0m10:42:18.638765 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:18.639674 [debug] [ThreadPool]: On create_sales_dw_dev: ROLLBACK
[0m10:42:18.639832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m10:42:18.639963 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:18.640777 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m10:42:18.641355 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:42:18.641083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.641746 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m10:42:18.643550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:18.644418 [debug] [MainThread]: Connection 'create_sales_dw_dev' was properly closed.
[0m10:42:18.645825 [info ] [MainThread]: 
[0m10:42:18.640679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:18.646802 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:18.647644 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m10:42:18.648202 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:18.648851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.648610 [error] [MainThread]: Encountered an error:
Database Error
  duplicate key value violates unique constraint "pg_namespace_nspname_index"
  DETAIL:  Key (nspname)=(dev) already exists.
[0m10:42:18.646538 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:18.650003 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m10:42:18.649875 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:18.650423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0752287, "process_user_time": 2.81174, "process_kernel_time": 0.207863, "process_mem_max_rss": "111672", "process_out_blocks": "1163", "command_success": false, "process_in_blocks": "0"}
[0m10:42:18.650653 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:18.651497 [debug] [MainThread]: Command `dbt run` failed at 10:42:18.651408 after 2.08 seconds
[0m10:42:18.651657 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:18.652070 [debug] [MainThread]: Flushing usage events
[0m10:42:18.651830 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:18.651180 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:18.652403 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:18.653152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.651815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:18.653104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.656577 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m10:42:18.659329 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:18.661286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:42:18.662824 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m10:42:18.664927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:42:18.665577 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:18.662412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:18.665593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:18.672712 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:18.668866 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:18.673088 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:18.673610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:42:18.674091 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:18.674689 [info ] [MainThread]: 
[0m10:42:18.674649 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:18.672584 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:18.675129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:18.675529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:18.675179 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:18.675526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.675841 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:18.676411 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:18.677368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:18.677014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:18.677725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.674319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:18.681072 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:42:18.681552 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:18.679585 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:18.682002 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:18.681543 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:18.682062 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:18.682674 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:18.683397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:18.683866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.685038 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:42:18.685503 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:42:18.686149 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:18.689008 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:18.689255 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:18.689355 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:18.692102 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:18.693862 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:18.697363 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:18.708914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:18.709496 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:18.709845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.715700 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m10:42:18.717050 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:18.721467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:42:18.722136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:18.727511 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:18.730142 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:18.730517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:18.729723 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:18.731257 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:18.731814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:18.736409 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:42:18.736880 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:18.737237 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:18.740135 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:42:18.741303 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:18.741729 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:23.588300 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.016 seconds
[0m10:42:23.590657 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:23.597565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:42:23.598294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:23.605354 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:23.607776 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:23.608314 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:23.608738 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:23.609192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:23.609592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:23.614721 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:42:23.615342 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:23.615789 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:23.618286 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:23.619627 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:23.620284 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:23.666917 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m10:42:23.667501 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m10:42:23.668153 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:23.668608 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:23.669052 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:23.669461 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:23.671706 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:23.672006 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:42:23.673313 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:23.674403 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:23.674956 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:23.675317 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:23.681281 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:42:23.681910 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:23.681773 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.682434 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:23.682882 [debug] [MainThread]: On master: BEGIN
[0m10:42:23.683325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:23.684800 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:42:23.686347 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:23.686973 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:23.688233 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m10:42:23.688978 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:42:23.689176 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:23.689582 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.689397 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:42:23.690343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:23.690000 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:23.690384 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m10:42:23.690863 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:23.691383 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:23.691884 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:23.692393 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:23.693369 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:23.692991 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:42:23.693340 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.694509 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:42:23.694772 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:23.695598 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.695272 [debug] [MainThread]: On master: BEGIN
[0m10:42:23.696060 [debug] [MainThread]: On master: BEGIN
[0m10:42:23.696098 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:23.696368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:23.694770 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:23.696776 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:23.696876 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:23.697527 [debug] [MainThread]: On master: COMMIT
[0m10:42:23.696478 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:23.697757 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:23.698068 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.698612 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:23.698833 [debug] [MainThread]: On master: COMMIT
[0m10:42:23.699644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:23.699352 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:23.700147 [debug] [MainThread]: On master: Close
[0m10:42:23.700973 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:23.701549 [info ] [MainThread]: 
[0m10:42:23.705557 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.706128 [debug] [MainThread]: On master: BEGIN
[0m10:42:23.706706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:23.707218 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.708028 [debug] [MainThread]: On master: BEGIN
[0m10:42:23.708729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:23.711665 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m10:42:23.712329 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m10:42:23.712873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m10:42:23.713292 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m10:42:23.721308 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m10:42:23.724086 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m10:42:23.740215 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m10:42:23.740906 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:23.741409 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:23.743597 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:23.745245 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:23.745812 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:23.751245 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.751748 [debug] [MainThread]: On master: BEGIN
[0m10:42:23.752232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:23.753149 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m10:42:23.755075 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:42:23.755584 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m10:42:23.756100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:23.756997 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:42:23.757438 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.757932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:23.760982 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:42:23.762015 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:23.762502 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.762978 [debug] [MainThread]: On master: BEGIN
[0m10:42:23.763585 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:23.764075 [debug] [MainThread]: On master: COMMIT
[0m10:42:23.764433 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:23.764748 [debug] [MainThread]: On master: COMMIT
[0m10:42:23.765220 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:23.765622 [debug] [MainThread]: On master: Close
[0m10:42:23.766546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:23.767429 [info ] [MainThread]: 
[0m10:42:23.773594 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m10:42:23.774296 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m10:42:23.774995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m10:42:23.775455 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m10:42:23.783650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m10:42:23.784972 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m10:42:23.812015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m10:42:23.813183 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:42:23.813597 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m10:42:23.813969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:28.624960 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m10:42:28.625982 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:28.626407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:28.628653 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:42:28.630161 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:28.630654 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:28.637428 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.637878 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.638239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:28.642336 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:42:28.642773 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.643188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:28.645597 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:28.646739 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:28.647212 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.647522 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.647987 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:28.648346 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.648655 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.648953 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.649389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.649733 [debug] [MainThread]: On master: Close
[0m10:42:28.650252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:28.650863 [info ] [MainThread]: 
[0m10:42:28.657877 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m10:42:28.658494 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m10:42:28.659057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m10:42:28.659454 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m10:42:28.667256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m10:42:28.668746 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m10:42:28.697567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m10:42:28.698921 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:42:28.699333 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m10:42:28.699780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:28.704104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:42:28.704597 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:42:28.705033 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m10:42:28.705799 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m10:42:28.706555 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.707143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:28.709829 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:42:28.711535 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:28.712171 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.712616 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.713459 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:28.713352 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m10:42:28.714023 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.714355 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.714783 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.714933 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m10:42:28.715660 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.715564 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.715798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:28.716154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:28.716465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.717105 [debug] [MainThread]: On master: Close
[0m10:42:28.717796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:28.718351 [info ] [MainThread]: 
[0m10:42:28.719702 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:42:28.719591 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:42:28.723281 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:28.723877 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.723825 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:28.724334 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.724716 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.725010 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:28.725548 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.725800 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.726036 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.726518 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.726405 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:28.727194 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.727191 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.727645 [debug] [MainThread]: On master: Close
[0m10:42:28.727806 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.727948 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m10:42:28.728516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:28.729669 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.730543 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.730373 [info ] [MainThread]: 
[0m10:42:28.730490 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m10:42:28.730949 [debug] [MainThread]: On master: Close
[0m10:42:28.731605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m10:42:28.731778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:28.732583 [info ] [MainThread]: 
[0m10:42:28.732645 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m10:42:28.738080 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m10:42:28.738825 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m10:42:28.739676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m10:42:28.740227 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m10:42:28.740573 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m10:42:28.741361 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m10:42:28.741992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m10:42:28.742501 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m10:42:28.745276 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m10:42:28.746929 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m10:42:28.749179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m10:42:28.751569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m10:42:28.752599 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m10:42:28.752990 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m10:42:28.763815 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m10:42:28.764518 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:42:28.765301 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m10:42:28.769355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:42:28.775071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m10:42:28.778680 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:42:28.779168 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m10:42:28.779286 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:42:28.779524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:28.779941 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m10:42:28.781328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m10:42:28.782205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:28.782732 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:42:28.783172 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m10:42:28.783519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:28.785433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:42:28.786728 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:42:28.787387 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m10:42:28.787582 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m10:42:28.787589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:42:28.788258 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:42:28.788758 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m10:42:28.788793 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:42:28.789351 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m10:42:28.789084 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:42:28.789886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:28.790021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:42:28.795172 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:42:28.795577 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m10:42:28.795982 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m10:42:28.796269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:28.796404 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:42:28.796280 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:42:28.796790 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m10:42:28.797177 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m10:42:28.797962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:28.798229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:42:28.806465 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m10:42:28.806618 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m10:42:28.806921 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:42:28.807324 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m10:42:28.808068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.808241 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m10:42:28.808766 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:42:28.809089 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m10:42:28.809798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.812783 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m10:42:28.811310 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m10:42:28.814290 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m10:42:28.815100 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m10:42:28.817426 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m10:42:28.815341 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:42:28.818362 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m10:42:28.818846 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m10:42:28.819185 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m10:42:28.819441 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:42:28.819865 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:42:28.819986 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m10:42:28.819861 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m10:42:28.821624 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:42:28.822126 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m10:42:28.822151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:42:28.822273 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m10:42:28.824235 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.11s]
[0m10:42:28.824241 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m10:42:28.825225 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m10:42:28.825846 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m10:42:28.826384 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m10:42:28.827206 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.828167 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m10:42:28.828278 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:42:28.827584 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.828761 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m10:42:28.829122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:28.829145 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m10:42:28.829456 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.829989 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.830019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:28.830163 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.830387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:28.830726 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.831310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:28.833830 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:42:28.834233 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:42:28.834388 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.834653 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.834817 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.835261 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.835166 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.837860 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:42:28.838121 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.838191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.838321 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.838592 [debug] [MainThread]: On master: Close
[0m10:42:28.838654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.838779 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.839118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:28.839070 [debug] [MainThread]: On master: Close
[0m10:42:28.839215 [debug] [MainThread]: On master: COMMIT
[0m10:42:28.839437 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:42:28.839694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:28.839786 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:28.839879 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m10:42:28.840141 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m10:42:28.840244 [debug] [MainThread]: On master: Close
[0m10:42:28.840483 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:42:28.840471 [info ] [MainThread]: 
[0m10:42:28.840817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:28.840972 [info ] [MainThread]: 
[0m10:42:28.841358 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m10:42:28.841033 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m10:42:28.841480 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m10:42:28.841786 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:42:28.842200 [info ] [MainThread]: 
[0m10:42:28.842299 [debug] [MainThread]: Command end result
[0m10:42:28.842613 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m10:42:28.842681 [info ] [MainThread]: 
[0m10:42:28.843271 [debug] [MainThread]: Command end result
[0m10:42:28.842745 [debug] [MainThread]: Command end result
[0m10:42:28.845070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:28.845084 [info ] [MainThread]: 
[0m10:42:28.845177 [info ] [MainThread]: 
[0m10:42:28.845500 [info ] [MainThread]: 
[0m10:42:28.845700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:28.845924 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:28.845679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:28.846098 [info ] [MainThread]: 
[0m10:42:28.846422 [info ] [MainThread]: 
[0m10:42:28.846607 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:28.846987 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:28.846912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.272505, "process_user_time": 2.947837, "process_kernel_time": 0.230173, "process_mem_max_rss": "112520", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m10:42:28.847655 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:28.847568 after 12.27 seconds
[0m10:42:28.847778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.259312, "process_user_time": 2.997326, "process_kernel_time": 0.231031, "process_mem_max_rss": "112796", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m10:42:28.848099 [debug] [MainThread]: Flushing usage events
[0m10:42:28.847649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.263924, "process_user_time": 3.03288, "process_kernel_time": 0.201119, "process_mem_max_rss": "112800", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m10:42:28.848277 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:28.848205 after 12.26 seconds
[0m10:42:28.848809 [debug] [MainThread]: Flushing usage events
[0m10:42:28.849459 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:28.849335 after 12.27 seconds
[0m10:42:28.852185 [debug] [MainThread]: Flushing usage events
[0m10:42:28.856170 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m10:42:28.856705 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:42:28.857132 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m10:42:28.859420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:42:28.867812 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m10:42:28.873353 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m10:42:28.874066 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m10:42:28.874820 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:42:28.877290 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m10:42:28.878999 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.10s]
[0m10:42:28.879791 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m10:42:28.881188 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:28.881552 [debug] [MainThread]: On master: BEGIN
[0m10:42:28.881881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:28.968858 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.263 seconds
[0m10:42:28.974985 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:42:28.975531 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:42:28.976404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:28.988838 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m10:42:28.989244 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:42:28.989580 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m10:42:28.995727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:42:29.001497 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m10:42:29.005338 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m10:42:29.006053 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m10:42:29.006881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:42:29.009628 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m10:42:29.011439 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.35s]
[0m10:42:29.012248 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m10:42:29.013783 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:29.014305 [debug] [MainThread]: On master: BEGIN
[0m10:42:29.014664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:29.019748 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:42:29.020234 [debug] [MainThread]: On master: COMMIT
[0m10:42:29.020550 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:29.020842 [debug] [MainThread]: On master: COMMIT
[0m10:42:29.021216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:29.021516 [debug] [MainThread]: On master: Close
[0m10:42:29.022009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:29.022307 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m10:42:29.022604 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:42:29.022958 [info ] [MainThread]: 
[0m10:42:29.023349 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.50 seconds (10.50s).
[0m10:42:29.024014 [debug] [MainThread]: Command end result
[0m10:42:29.024332 [info ] [MainThread]: 
[0m10:42:29.024754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:29.025095 [info ] [MainThread]: 
[0m10:42:29.025469 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:29.026381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.452148, "process_user_time": 2.983874, "process_kernel_time": 0.220766, "process_mem_max_rss": "112612", "process_out_blocks": "1193", "process_in_blocks": "0"}
[0m10:42:29.026926 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:29.026834 after 12.45 seconds
[0m10:42:29.027273 [debug] [MainThread]: Flushing usage events
[0m10:42:33.807562 [debug] [Thread-1 (]: SQL status: BEGIN in 5.017 seconds
[0m10:42:33.809467 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:42:33.810108 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m10:42:33.812169 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:42:33.822442 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:42:33.822930 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m10:42:33.823548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:33.834628 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m10:42:33.835097 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:42:33.835491 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m10:42:33.836435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:42:33.841412 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m10:42:33.844557 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m10:42:33.844930 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m10:42:33.845420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:42:33.848361 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m10:42:33.850289 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 5.11s]
[0m10:42:33.851343 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m10:42:33.853532 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:33.854060 [debug] [MainThread]: On master: BEGIN
[0m10:42:33.854446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:33.859536 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:42:33.860089 [debug] [MainThread]: On master: COMMIT
[0m10:42:33.860492 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:33.860888 [debug] [MainThread]: On master: COMMIT
[0m10:42:33.861315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:33.861649 [debug] [MainThread]: On master: Close
[0m10:42:33.862133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:33.862552 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m10:42:33.862946 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:42:33.863441 [info ] [MainThread]: 
[0m10:42:33.863958 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m10:42:33.864766 [debug] [MainThread]: Command end result
[0m10:42:33.865254 [info ] [MainThread]: 
[0m10:42:33.865856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:33.866272 [info ] [MainThread]: 
[0m10:42:33.866711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:33.868209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.278896, "process_user_time": 3.017851, "process_kernel_time": 0.226769, "process_mem_max_rss": "112776", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m10:42:33.869097 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:33.869008 after 17.28 seconds
[0m10:42:33.869608 [debug] [MainThread]: Flushing usage events
[0m10:42:33.888021 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m10:42:33.890218 [debug] [MainThread]: On master: COMMIT
[0m10:42:33.891954 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:33.894097 [debug] [MainThread]: On master: COMMIT
[0m10:42:33.896072 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:33.896469 [debug] [MainThread]: On master: Close
[0m10:42:33.897464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:33.899890 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:42:33.900885 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m10:42:33.901491 [info ] [MainThread]: 
[0m10:42:33.903891 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.23 seconds (15.23s).
[0m10:42:33.905515 [debug] [MainThread]: Command end result
[0m10:42:33.906908 [info ] [MainThread]: 
[0m10:42:33.908147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:33.909829 [info ] [MainThread]: 
[0m10:42:33.910248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:33.912048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.321209, "process_user_time": 3.089036, "process_kernel_time": 0.207283, "process_mem_max_rss": "112756", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m10:42:33.912952 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:33.912869 after 17.32 seconds
[0m10:42:33.913590 [debug] [MainThread]: Flushing usage events
[0m10:42:36.386069 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:42:36.390553 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:42:36.390810 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:36.394958 | 8829a307-3913-4599-bcb1-08860b7c115b ==============================
[0m10:42:36.394958 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:36.395990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'send_anonymous_usage_stats': 'True'}


============================== 10:42:36.396298 | c004373b-e484-46d8-b208-0c7845a07549 ==============================
[0m10:42:36.396298 [info ] [MainThread]: Running with dbt=1.8.2


============================== 10:42:36.396463 | aa98a6e3-8d4c-4fc8-965b-b361acd449e0 ==============================
[0m10:42:36.396463 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:36.397449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:42:36.397527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m10:42:36.394364 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:36.402247 | 792b6d45-2baf-4af8-89db-bbbd8e0adaaf ==============================
[0m10:42:36.402247 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:36.403139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:42:36.402195 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:36.407455 | 4ab0e001-f663-4076-a3de-02588fe85f42 ==============================
[0m10:42:36.407455 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:36.408851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:42:36.562637 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:36.576203 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:36.577919 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:36.582446 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:36.593276 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:36.596203 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:36.598693 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:36.605310 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:36.614965 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:36.630344 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:36.741155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:36.744305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:36.761351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:36.762130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:36.774877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:36.775423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:36.788835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:36.789462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:36.818102 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:36.819536 [info ] [MainThread]: 
[0m10:42:36.820069 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:36.821712 [debug] [MainThread]: Command end result
[0m10:42:36.822288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:36.822452 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4783137, "process_user_time": 1.23455, "process_kernel_time": 0.103045, "process_mem_max_rss": "97504", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:36.823223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:36.823012 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:36.822944 after 0.48 seconds
[0m10:42:36.827575 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:36.827166 [debug] [MainThread]: Flushing usage events
[0m10:42:36.829394 [info ] [MainThread]: 
[0m10:42:36.831720 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:36.833899 [debug] [MainThread]: Command end result
[0m10:42:36.835826 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48770258, "process_user_time": 1.247842, "process_kernel_time": 0.086613, "process_mem_max_rss": "97448", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:36.836711 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:36.836589 after 0.49 seconds
[0m10:42:36.837521 [debug] [MainThread]: Flushing usage events
[0m10:42:36.850736 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:36.854905 [info ] [MainThread]: 
[0m10:42:36.855551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:36.856575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:36.863646 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:36.865560 [info ] [MainThread]: 
[0m10:42:36.866277 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:36.867955 [debug] [MainThread]: Command end result
[0m10:42:36.868885 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5168513, "process_user_time": 1.262427, "process_kernel_time": 0.094255, "process_mem_max_rss": "97676", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:36.869623 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:36.869530 after 0.52 seconds
[0m10:42:36.870126 [debug] [MainThread]: Flushing usage events
[0m10:42:36.890787 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:36.891715 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:36.892220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:36.899445 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:36.901502 [info ] [MainThread]: 
[0m10:42:36.901513 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m10:42:36.902176 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:36.904100 [debug] [MainThread]: Command end result
[0m10:42:36.903439 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:36.904935 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.54751444, "process_user_time": 1.270066, "process_kernel_time": 0.089711, "process_mem_max_rss": "97804", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:36.905988 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:36.905828 after 0.55 seconds
[0m10:42:36.907999 [debug] [MainThread]: Flushing usage events
[0m10:42:36.911045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:42:36.912041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:36.917337 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:36.920365 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:36.920698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:36.919894 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:36.922022 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:36.922612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:36.928101 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:42:36.928726 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:36.929199 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:36.932508 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m10:42:36.933828 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:36.934389 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:41.310873 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:41.315742 | 0394a5ae-9169-45bb-a04f-813ea77eeea6 ==============================
[0m10:42:41.315742 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:41.316397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:42:41.316502 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:41.321678 | 947cb31d-2e26-4261-a53d-8bb06d8dffde ==============================
[0m10:42:41.321678 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:41.322265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:42:41.321627 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:41.328070 | dfadb4f7-1cde-465c-86c8-73f160d1c4a7 ==============================
[0m10:42:41.328070 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:41.329388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m10:42:41.327858 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:41.334972 | 6371d3f5-a94c-4809-bdac-e580bc3ce782 ==============================
[0m10:42:41.334972 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:41.335812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m10:42:41.494682 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:41.499597 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:41.502372 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:41.507094 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:41.509050 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:41.519111 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:41.521686 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:41.529602 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:41.665136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:41.665748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:41.675581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:41.676068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:41.692297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:41.692781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:41.712239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:41.712709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:41.726606 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:41.727042 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:41.728147 [info ] [MainThread]: 
[0m10:42:41.728397 [info ] [MainThread]: 
[0m10:42:41.729042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:41.728986 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:41.732325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:41.733013 [debug] [MainThread]: Command end result
[0m10:42:41.733658 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.462128, "process_user_time": 1.181938, "process_kernel_time": 0.064377, "process_mem_max_rss": "97404", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:41.734361 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:41.734218 after 0.46 seconds
[0m10:42:41.735038 [debug] [MainThread]: Flushing usage events
[0m10:42:41.751227 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:41.752730 [info ] [MainThread]: 
[0m10:42:41.753323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:41.754056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:41.759006 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:41.759583 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:41.759989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:41.766255 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m10:42:41.767386 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:41.771852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:42:41.772790 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:41.774398 [info ] [MainThread]: 
[0m10:42:41.774964 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:41.776492 [debug] [MainThread]: Command end result
[0m10:42:41.777316 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49323633, "process_user_time": 1.18069, "process_kernel_time": 0.066094, "process_mem_max_rss": "97356", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:41.778069 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:41.777978 after 0.49 seconds
[0m10:42:41.772681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:42:41.778528 [debug] [MainThread]: Flushing usage events
[0m10:42:41.778183 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:41.780227 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:41.780681 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:41.781107 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:41.781647 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:41.781492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:41.781883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:41.782209 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:41.782706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:41.787013 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:42:41.787585 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:41.787960 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:41.789992 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:42:41.791169 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:41.791657 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:41.933012 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m10:42:41.934523 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:41.935129 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:41.938663 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:42:41.940497 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:41.941003 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:41.947068 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:41.947691 [debug] [MainThread]: On master: BEGIN
[0m10:42:41.948145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:41.952992 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:42:41.953522 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:41.953922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:41.957805 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m10:42:41.959083 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:41.959519 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:41.960029 [debug] [MainThread]: On master: BEGIN
[0m10:42:41.960839 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:41.961681 [debug] [MainThread]: On master: COMMIT
[0m10:42:41.962330 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:41.962740 [debug] [MainThread]: On master: COMMIT
[0m10:42:41.963195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:41.963569 [debug] [MainThread]: On master: Close
[0m10:42:41.964088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:41.964727 [info ] [MainThread]: 
[0m10:42:41.972131 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m10:42:41.972821 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m10:42:41.973522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m10:42:41.974047 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m10:42:41.982079 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m10:42:41.983688 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m10:42:42.013232 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m10:42:42.019242 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:42:42.019813 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m10:42:42.020380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:42.024919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:42:42.025489 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:42:42.026019 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m10:42:42.028168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:42:42.034132 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:42:42.034510 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m10:42:42.035084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:42.047187 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m10:42:42.047694 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:42:42.048108 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m10:42:42.049063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:42:42.053988 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m10:42:42.057243 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m10:42:42.057772 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m10:42:42.058377 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:42:42.060455 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m10:42:42.062058 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m10:42:42.062695 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m10:42:42.063879 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:42.064252 [debug] [MainThread]: On master: BEGIN
[0m10:42:42.064554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:46.797978 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m10:42:46.799784 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:46.800863 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:46.800005 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.017 seconds
[0m10:42:46.803167 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:46.804800 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m10:42:46.807734 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:46.808479 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:46.812178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:42:46.816441 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:46.816969 [debug] [MainThread]: On master: BEGIN
[0m10:42:46.818878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:46.813073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:42:46.820262 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:46.822429 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:46.822827 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:46.823184 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:46.823548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:46.823942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:46.828374 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:42:46.828791 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:46.829138 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:42:46.831099 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m10:42:46.832157 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:42:46.832550 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:42:47.082946 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m10:42:47.084297 [debug] [MainThread]: On master: COMMIT
[0m10:42:47.084973 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:47.085537 [debug] [MainThread]: On master: COMMIT
[0m10:42:47.086279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:47.086858 [debug] [MainThread]: On master: Close
[0m10:42:47.087666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:47.088253 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m10:42:47.088772 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:42:47.089379 [info ] [MainThread]: 
[0m10:42:47.090402 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m10:42:47.091716 [debug] [MainThread]: Command end result
[0m10:42:47.092274 [info ] [MainThread]: 
[0m10:42:47.092966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:47.093450 [info ] [MainThread]: 
[0m10:42:47.093955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:47.095417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.746073, "process_user_time": 1.426973, "process_kernel_time": 0.121252, "process_mem_max_rss": "106272", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m10:42:47.096197 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:47.096067 after 10.75 seconds
[0m10:42:47.096876 [debug] [MainThread]: Flushing usage events
[0m10:42:51.840294 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m10:42:51.840368 [debug] [MainThread]: SQL status: BEGIN in 5.020 seconds
[0m10:42:51.846199 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:51.846998 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:51.847881 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:42:51.849707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:51.853325 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:42:51.855770 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m10:42:51.858160 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:42:51.860630 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:42:51.864626 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:51.865307 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:51.865896 [debug] [MainThread]: On master: BEGIN
[0m10:42:51.866663 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:51.867262 [debug] [MainThread]: On master: COMMIT
[0m10:42:51.867789 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:51.868266 [debug] [MainThread]: On master: COMMIT
[0m10:42:51.868814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:51.869311 [debug] [MainThread]: On master: Close
[0m10:42:51.870486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:51.871147 [info ] [MainThread]: 
[0m10:42:51.872321 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:51.875140 [debug] [MainThread]: On master: BEGIN
[0m10:42:51.875940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:51.882592 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:42:51.882720 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m10:42:51.883146 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:51.883733 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:51.883888 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m10:42:51.884609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m10:42:51.885134 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m10:42:51.886778 [debug] [MainThread]: SQL status: SELECT 6 in 0.002 seconds
[0m10:42:51.888428 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:51.888850 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:51.889165 [debug] [MainThread]: On master: BEGIN
[0m10:42:51.889707 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:42:51.890268 [debug] [MainThread]: On master: COMMIT
[0m10:42:51.890805 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:51.891163 [debug] [MainThread]: On master: COMMIT
[0m10:42:51.891837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:51.892332 [debug] [MainThread]: On master: Close
[0m10:42:51.893154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:51.893816 [info ] [MainThread]: 
[0m10:42:51.894360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m10:42:51.898843 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m10:42:51.903620 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m10:42:51.904287 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m10:42:51.904865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m10:42:51.905296 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m10:42:51.918948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m10:42:51.920432 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m10:42:51.942351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m10:42:51.950046 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:42:51.950489 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m10:42:51.950843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:51.957217 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m10:42:51.958210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:42:51.958795 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:42:51.959232 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:42:51.959585 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m10:42:51.959989 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m10:42:51.960552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:42:51.962240 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:42:51.966101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:42:51.968314 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:42:51.968726 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m10:42:51.969049 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:42:51.969476 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m10:42:51.969791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:51.972865 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:42:51.981363 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:42:51.981976 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m10:42:51.983043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:42:51.986892 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m10:42:51.991053 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:42:51.991749 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m10:42:51.994184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:42:51.996531 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m10:42:51.996958 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:42:51.997399 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m10:42:51.998107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:42:52.000479 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m10:42:52.003323 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m10:42:52.006718 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m10:42:52.007089 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m10:42:52.007648 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:42:52.008101 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m10:42:52.010458 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m10:42:52.011932 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m10:42:52.012128 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:42:52.012948 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m10:42:52.013334 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:42:52.016208 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:52.016431 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m10:42:52.016829 [debug] [MainThread]: On master: BEGIN
[0m10:42:52.018556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:52.018946 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m10:42:52.020071 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m10:42:52.021946 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:52.022960 [debug] [MainThread]: On master: BEGIN
[0m10:42:52.023307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:52.024025 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:42:52.024513 [debug] [MainThread]: On master: COMMIT
[0m10:42:52.024924 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:52.025249 [debug] [MainThread]: On master: COMMIT
[0m10:42:52.025676 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:52.026041 [debug] [MainThread]: On master: Close
[0m10:42:52.026522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:52.026872 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m10:42:52.027190 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:42:52.027580 [info ] [MainThread]: 
[0m10:42:52.027975 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m10:42:52.028742 [debug] [MainThread]: Command end result
[0m10:42:52.029105 [info ] [MainThread]: 
[0m10:42:52.029595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:52.029951 [info ] [MainThread]: 
[0m10:42:52.030422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:52.031768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.751808, "process_user_time": 1.359147, "process_kernel_time": 0.076176, "process_mem_max_rss": "106396", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:42:52.032490 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:52.032416 after 10.75 seconds
[0m10:42:52.032979 [debug] [MainThread]: Flushing usage events
[0m10:42:54.499942 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:54.505824 | 3b25c8d6-e0c6-44ab-ba5c-69d27d839acf ==============================
[0m10:42:54.505824 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:54.506591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:42:54.529367 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:54.536956 | c9fdb63e-42ec-4c8b-a2aa-1fbe40004ec8 ==============================
[0m10:42:54.536956 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:54.538996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m10:42:54.700507 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:54.724953 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:54.727278 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:54.742077 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:54.898604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:54.899173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:54.906821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:54.908849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:54.953985 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:54.955836 [info ] [MainThread]: 
[0m10:42:54.956986 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:54.960399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:42:54.969696 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:54.970886 [info ] [MainThread]: 
[0m10:42:54.971217 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:54.972535 [debug] [MainThread]: Command end result
[0m10:42:54.973135 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48865828, "process_user_time": 1.29879, "process_kernel_time": 0.100525, "process_mem_max_rss": "97812", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:54.973578 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:54.973509 after 0.49 seconds
[0m10:42:54.973913 [debug] [MainThread]: Flushing usage events
[0m10:42:54.989060 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:42:54.990062 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:42:54.991866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:55.001091 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m10:42:55.003588 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:42:55.010965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:42:55.011500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:42:55.019312 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:42:55.016348 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:42:55.019997 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:42:55.020246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:42:55.019667 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:42:55.020629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:57.040284 [debug] [MainThread]: SQL status: BEGIN in 5.016 seconds
[0m10:42:57.042029 [debug] [MainThread]: On master: COMMIT
[0m10:42:57.042717 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:57.043336 [debug] [MainThread]: On master: COMMIT
[0m10:42:57.044093 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:42:57.044617 [debug] [MainThread]: On master: Close
[0m10:42:57.045779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:57.046303 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:42:57.046726 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m10:42:57.047629 [info ] [MainThread]: 
[0m10:42:57.048338 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m10:42:57.049869 [debug] [MainThread]: Command end result
[0m10:42:57.050353 [info ] [MainThread]: 
[0m10:42:57.051060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:42:57.051487 [info ] [MainThread]: 
[0m10:42:57.052074 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:42:57.054625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.773641, "process_user_time": 1.366499, "process_kernel_time": 0.09804, "process_mem_max_rss": "106060", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m10:42:57.056251 [debug] [MainThread]: Command `dbt run` succeeded at 10:42:57.056131 after 15.78 seconds
[0m10:42:57.057083 [debug] [MainThread]: Flushing usage events
[0m10:42:59.443836 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:59.450421 | bd483ed2-2a6f-42dc-a6c5-3e65b115ccba ==============================
[0m10:42:59.450421 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:59.451056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:42:59.522489 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:42:59.528322 | 76504191-f01e-4b3d-9e4b-7d8b1bef5658 ==============================
[0m10:42:59.528322 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:42:59.528919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:42:59.602613 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:59.615463 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:59.682566 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:42:59.695062 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:42:59.758969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:59.759668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:59.850777 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:59.852801 [info ] [MainThread]: 
[0m10:42:59.854510 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:42:59.861488 [debug] [MainThread]: Command end result
[0m10:42:59.863502 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45615816, "process_user_time": 1.261226, "process_kernel_time": 0.107019, "process_mem_max_rss": "98032", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:42:59.865896 [debug] [MainThread]: Command `dbt test` succeeded at 10:42:59.865635 after 0.46 seconds
[0m10:42:59.866719 [debug] [MainThread]: Flushing usage events
[0m10:42:59.906231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:42:59.913220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:42:59.984032 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:42:59.986515 [info ] [MainThread]: 
[0m10:42:59.987651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:42:59.989710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:43:00.034722 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m10:43:00.037289 [debug] [ThreadPool]: SQL status: BEGIN in 5.017 seconds
[0m10:43:00.038220 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:00.038769 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:43:00.037775 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:00.039601 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:43:00.043785 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m10:43:00.046223 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:43:00.046023 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:43:00.044123 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:43:00.046927 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:43:00.048150 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:43:00.046931 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:43:00.048471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:00.049716 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:43:00.063451 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:00.064320 [debug] [MainThread]: On master: BEGIN
[0m10:43:00.065074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:04.115995 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:04.122243 | 60292560-8f57-45aa-a194-45884dc40307 ==============================
[0m10:43:04.122243 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:04.125882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:04.122809 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:04.128144 | 08695c9e-5fe1-45f8-96be-9e3ffa213f6f ==============================
[0m10:43:04.128144 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:04.132983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:43:04.279690 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:04.282555 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:04.292007 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:04.299351 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:04.437535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:04.438107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:04.454439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:04.455748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:04.508682 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:04.510176 [info ] [MainThread]: 
[0m10:43:04.510560 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:43:04.512045 [debug] [MainThread]: Command end result
[0m10:43:04.512758 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4337675, "process_user_time": 1.186817, "process_kernel_time": 0.129306, "process_mem_max_rss": "97704", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:43:04.513222 [debug] [MainThread]: Command `dbt test` succeeded at 10:43:04.513137 after 0.43 seconds
[0m10:43:04.513619 [debug] [MainThread]: Flushing usage events
[0m10:43:04.517870 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:04.519384 [info ] [MainThread]: 
[0m10:43:04.520122 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:04.521183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:43:04.551214 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:43:04.551708 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:43:04.552140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:05.067181 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.018 seconds
[0m10:43:05.070529 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:43:05.074720 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m10:43:05.076294 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.077178 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:05.079270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:43:05.081665 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m10:43:05.080232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:43:05.087212 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:05.089117 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:05.089605 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:05.090401 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.089996 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:43:05.091001 [debug] [MainThread]: On master: BEGIN
[0m10:43:05.090742 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:43:05.091297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:05.091782 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:43:05.091722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:05.092472 [debug] [MainThread]: On master: COMMIT
[0m10:43:05.093045 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.093506 [debug] [MainThread]: On master: COMMIT
[0m10:43:05.094088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:05.094436 [debug] [MainThread]: On master: Close
[0m10:43:05.095056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:05.095740 [info ] [MainThread]: 
[0m10:43:05.096575 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:43:05.097008 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:43:05.101466 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:05.102506 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:05.103017 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:43:05.103533 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:43:05.104071 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m10:43:05.104774 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m10:43:05.105311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m10:43:05.105729 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m10:43:05.105928 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:43:05.106240 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m10:43:05.107466 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:43:05.110600 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:43:05.114866 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:43:05.115800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m10:43:05.115196 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:43:05.117158 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m10:43:05.121264 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.124069 [debug] [MainThread]: On master: BEGIN
[0m10:43:05.127849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:05.132178 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:43:05.132687 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.133111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:05.135763 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m10:43:05.137406 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:05.137841 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.138180 [debug] [MainThread]: On master: BEGIN
[0m10:43:05.138720 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:43:05.139208 [debug] [MainThread]: On master: COMMIT
[0m10:43:05.139560 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.139879 [debug] [MainThread]: On master: COMMIT
[0m10:43:05.140307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:05.140655 [debug] [MainThread]: On master: Close
[0m10:43:05.141137 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:05.141745 [info ] [MainThread]: 
[0m10:43:05.148582 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m10:43:05.149165 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m10:43:05.149639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m10:43:05.150038 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m10:43:05.151131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m10:43:05.154909 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:43:05.155351 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m10:43:05.155789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:05.158356 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m10:43:05.159289 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m10:43:05.160041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:43:05.163831 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:43:05.166131 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m10:43:05.169313 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m10:43:05.176980 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:43:05.177884 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m10:43:05.181037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:43:05.194027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m10:43:05.195786 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m10:43:05.196307 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:43:05.196785 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m10:43:05.197237 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:43:05.197644 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m10:43:05.198125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:43:05.198401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:05.207319 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m10:43:05.211180 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m10:43:05.211802 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m10:43:05.212685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:43:05.215552 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m10:43:05.217465 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.11s]
[0m10:43:05.218313 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m10:43:05.219777 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.220369 [debug] [MainThread]: On master: BEGIN
[0m10:43:05.220935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:05.230335 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:43:05.231808 [debug] [MainThread]: On master: COMMIT
[0m10:43:05.233055 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:05.233457 [debug] [MainThread]: On master: COMMIT
[0m10:43:05.233935 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:05.234260 [debug] [MainThread]: On master: Close
[0m10:43:05.234734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:05.235113 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m10:43:05.235438 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:43:05.235847 [info ] [MainThread]: 
[0m10:43:05.236351 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m10:43:05.237037 [debug] [MainThread]: Command end result
[0m10:43:05.237405 [info ] [MainThread]: 
[0m10:43:05.237879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:05.238267 [info ] [MainThread]: 
[0m10:43:05.238809 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:43:05.239775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.785799, "process_user_time": 1.448792, "process_kernel_time": 0.139326, "process_mem_max_rss": "105796", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m10:43:05.240322 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:05.240251 after 10.79 seconds
[0m10:43:05.240626 [debug] [MainThread]: Flushing usage events
[0m10:43:09.566749 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m10:43:09.570692 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:43:09.578045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:43:09.579050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:43:09.588769 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:09.589183 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:43:09.589517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:09.586503 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:09.590297 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:43:09.590909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:09.595348 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:43:09.595950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:09.596470 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:43:09.599011 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:43:09.600088 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:43:09.600532 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:43:10.222063 [debug] [Thread-1 (]: SQL status: BEGIN in 5.023 seconds
[0m10:43:10.223467 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:43:10.224210 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m10:43:10.227927 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m10:43:10.236923 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:43:10.237425 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m10:43:10.238185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:43:10.256034 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m10:43:10.259901 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:43:10.260302 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m10:43:10.261745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:43:10.266682 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m10:43:10.270017 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m10:43:10.270461 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m10:43:10.271008 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:43:10.273255 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m10:43:10.275161 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.12s]
[0m10:43:10.276175 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m10:43:10.277782 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:10.278825 [debug] [MainThread]: On master: BEGIN
[0m10:43:10.279464 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:10.284105 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:43:10.285238 [debug] [MainThread]: On master: COMMIT
[0m10:43:10.285924 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:10.286436 [debug] [MainThread]: On master: COMMIT
[0m10:43:10.286973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:10.287465 [debug] [MainThread]: On master: Close
[0m10:43:10.288031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:10.288505 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:43:10.288982 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m10:43:10.289488 [info ] [MainThread]: 
[0m10:43:10.290094 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m10:43:10.291050 [debug] [MainThread]: Command end result
[0m10:43:10.291531 [info ] [MainThread]: 
[0m10:43:10.292120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:10.292598 [info ] [MainThread]: 
[0m10:43:10.293065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:43:10.294113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.810561, "process_user_time": 1.464295, "process_kernel_time": 0.158111, "process_mem_max_rss": "106644", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:43:10.294789 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:10.294714 after 10.81 seconds
[0m10:43:10.295280 [debug] [MainThread]: Flushing usage events
[0m10:43:12.658593 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:12.663644 | 81ac26a2-65b5-410c-b0a8-603bcd5923c4 ==============================
[0m10:43:12.663644 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:12.659918 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m10:43:12.664349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 10:43:12.665417 | 67f54d62-cd26-496f-bcdf-ee7ad330f2b3 ==============================
[0m10:43:12.665417 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:12.666062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:12.832395 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:12.835539 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:12.873484 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:12.874455 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:13.034007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:13.034586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:13.035067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:13.035587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:13.091048 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:13.092744 [info ] [MainThread]: 
[0m10:43:13.093466 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:13.094511 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:43:13.100911 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:13.102630 [info ] [MainThread]: 
[0m10:43:13.103097 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:43:13.104509 [debug] [MainThread]: Command end result
[0m10:43:13.105186 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.47998962, "process_user_time": 1.27107, "process_kernel_time": 0.068597, "process_mem_max_rss": "98152", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:43:13.105693 [debug] [MainThread]: Command `dbt test` succeeded at 10:43:13.105618 after 0.48 seconds
[0m10:43:13.106054 [debug] [MainThread]: Flushing usage events
[0m10:43:13.122903 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:43:13.123640 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:43:13.124084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:13.129888 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m10:43:13.131182 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:43:13.135640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:43:13.136325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:43:13.141970 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:13.144045 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:13.144522 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:43:13.144976 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:43:13.145377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:13.145765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:13.150445 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:43:13.151001 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:13.151512 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:43:13.153649 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:43:13.154907 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:43:13.155454 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:43:14.612512 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m10:43:14.616632 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:14.617706 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:43:14.623432 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m10:43:14.629176 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:43:14.630198 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:43:14.641576 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:14.642120 [debug] [MainThread]: On master: BEGIN
[0m10:43:14.642574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:14.651154 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:43:14.652018 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:14.652916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:14.662404 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m10:43:14.669317 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:14.670154 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:14.670644 [debug] [MainThread]: On master: BEGIN
[0m10:43:14.671375 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:43:14.671864 [debug] [MainThread]: On master: COMMIT
[0m10:43:14.672341 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:14.672689 [debug] [MainThread]: On master: COMMIT
[0m10:43:14.673162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:14.673587 [debug] [MainThread]: On master: Close
[0m10:43:14.674547 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:14.675304 [info ] [MainThread]: 
[0m10:43:14.685924 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m10:43:14.686849 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m10:43:14.687582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m10:43:14.688179 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m10:43:14.696592 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m10:43:14.698117 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m10:43:14.731661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m10:43:14.733154 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:43:14.733581 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m10:43:14.733948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:14.739006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:43:14.739497 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:43:14.739925 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_id, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m10:43:14.748616 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.008 seconds
[0m10:43:14.754415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:43:14.755019 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m10:43:14.755773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:43:14.770834 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m10:43:14.771411 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:43:14.771958 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m10:43:14.773626 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:43:14.778815 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m10:43:14.782533 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m10:43:14.782977 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m10:43:14.783568 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:43:14.786992 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m10:43:14.788877 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.10s]
[0m10:43:14.789644 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m10:43:14.791488 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:14.791992 [debug] [MainThread]: On master: BEGIN
[0m10:43:14.792518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:17.962383 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:17.969485 | d91388e3-dde1-422c-a1a1-be1335931aed ==============================
[0m10:43:17.969485 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:17.970144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:43:18.158718 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m10:43:18.169357 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:18.170860 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:43:18.176695 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m10:43:18.182451 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:43:18.187755 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:43:18.195281 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:18.202744 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:18.205845 [debug] [MainThread]: On master: BEGIN
[0m10:43:18.207607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:18.214867 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:18.402349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:18.405752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:18.473211 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:18.474768 [info ] [MainThread]: 
[0m10:43:18.475194 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:43:18.476691 [debug] [MainThread]: Command end result
[0m10:43:18.477567 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5508692, "process_user_time": 1.356873, "process_kernel_time": 0.22933, "process_mem_max_rss": "97756", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:43:18.478295 [debug] [MainThread]: Command `dbt test` succeeded at 10:43:18.478170 after 0.55 seconds
[0m10:43:18.478758 [debug] [MainThread]: Flushing usage events
[0m10:43:19.811653 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m10:43:19.814250 [debug] [MainThread]: On master: COMMIT
[0m10:43:19.815096 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:19.815750 [debug] [MainThread]: On master: COMMIT
[0m10:43:19.816480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:19.817188 [debug] [MainThread]: On master: Close
[0m10:43:19.818856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:19.819374 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:43:19.819878 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m10:43:19.820847 [info ] [MainThread]: 
[0m10:43:19.821784 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m10:43:19.823492 [debug] [MainThread]: Command end result
[0m10:43:19.824105 [info ] [MainThread]: 
[0m10:43:19.824986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:19.825485 [info ] [MainThread]: 
[0m10:43:19.826041 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:43:19.828875 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.7528305, "process_user_time": 1.399103, "process_kernel_time": 0.150011, "process_mem_max_rss": "106744", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:43:19.830579 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:19.830406 after 15.75 seconds
[0m10:43:19.831627 [debug] [MainThread]: Flushing usage events
[0m10:43:23.232365 [debug] [MainThread]: SQL status: BEGIN in 5.024 seconds
[0m10:43:23.234443 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:23.235343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:23.241138 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m10:43:23.245499 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:23.246040 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:23.246405 [debug] [MainThread]: On master: BEGIN
[0m10:43:23.247080 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:43:23.247591 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.248231 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:23.248594 [debug] [MainThread]: On master: COMMIT
[0m10:43:23.249057 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:23.249507 [debug] [MainThread]: On master: Close
[0m10:43:23.250824 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:23.251844 [info ] [MainThread]: 
[0m10:43:23.267646 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m10:43:23.268665 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m10:43:23.269366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m10:43:23.269833 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m10:43:23.288762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m10:43:23.289962 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m10:43:23.318730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m10:43:23.319859 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:43:23.320189 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m10:43:23.320518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:26.806817 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:26.813100 | 81ca3374-fc78-44f8-b72c-431a1bbff633 ==============================
[0m10:43:26.813100 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:26.813720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:26.957914 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:26.970355 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:27.102013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:27.102512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:27.162145 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:27.163487 [info ] [MainThread]: 
[0m10:43:27.163893 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:43:27.165306 [debug] [MainThread]: Command end result
[0m10:43:27.166035 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39572734, "process_user_time": 1.172523, "process_kernel_time": 0.098548, "process_mem_max_rss": "97948", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:43:27.166529 [debug] [MainThread]: Command `dbt test` succeeded at 10:43:27.166464 after 0.40 seconds
[0m10:43:27.166930 [debug] [MainThread]: Flushing usage events
[0m10:43:28.338044 [debug] [Thread-1 (]: SQL status: BEGIN in 5.017 seconds
[0m10:43:28.339724 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:43:28.340593 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m10:43:28.346731 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:43:28.354927 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:43:28.355537 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m10:43:28.356432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:43:28.368743 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m10:43:28.369212 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:43:28.369645 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m10:43:28.370791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:43:28.375407 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m10:43:28.378440 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m10:43:28.378897 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m10:43:28.379420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:43:28.383011 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m10:43:28.385043 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 5.11s]
[0m10:43:28.385777 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m10:43:28.387385 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:28.387922 [debug] [MainThread]: On master: BEGIN
[0m10:43:28.388245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:28.392296 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:43:28.392657 [debug] [MainThread]: On master: COMMIT
[0m10:43:28.393004 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:28.393284 [debug] [MainThread]: On master: COMMIT
[0m10:43:28.393601 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:28.393861 [debug] [MainThread]: On master: Close
[0m10:43:28.394233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:28.394561 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m10:43:28.394819 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:43:28.395209 [info ] [MainThread]: 
[0m10:43:28.395776 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m10:43:28.396592 [debug] [MainThread]: Command end result
[0m10:43:28.396923 [info ] [MainThread]: 
[0m10:43:28.397381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:28.397753 [info ] [MainThread]: 
[0m10:43:28.398201 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:43:28.399795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.774529, "process_user_time": 1.491047, "process_kernel_time": 0.100272, "process_mem_max_rss": "106688", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m10:43:28.400875 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:28.400790 after 15.78 seconds
[0m10:43:28.401433 [debug] [MainThread]: Flushing usage events
[0m10:43:35.793987 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:35.800271 | c2a6b6b2-e622-4dbc-8d74-f1fd9877d287 ==============================
[0m10:43:35.800271 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:35.800918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:35.823403 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:35.828886 | cd26d05a-a413-4171-a103-23299bd019f6 ==============================
[0m10:43:35.828886 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:35.829478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:35.966014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:35.985536 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:36.003158 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:36.023733 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:36.151948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:36.153745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:36.181069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:36.181828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:36.236088 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:36.236581 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:36.237841 [info ] [MainThread]: 
[0m10:43:36.239065 [info ] [MainThread]: 
[0m10:43:36.239410 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:43:36.239897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:36.241223 [debug] [MainThread]: Command end result
[0m10:43:36.242424 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4842802, "process_user_time": 1.207662, "process_kernel_time": 0.107683, "process_mem_max_rss": "97492", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:43:36.242057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:43:36.243182 [debug] [MainThread]: Command `dbt test` succeeded at 10:43:36.243094 after 0.49 seconds
[0m10:43:36.243623 [debug] [MainThread]: Flushing usage events
[0m10:43:36.275284 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:43:36.277538 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:43:36.277903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:41.300684 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.022 seconds
[0m10:43:41.303495 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:43:41.311047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:43:41.311737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:43:41.320954 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:41.321330 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:43:41.321664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:41.318921 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:41.322381 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:43:41.322932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:41.326494 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:43:41.327069 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:41.327552 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:43:41.327934 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:43:41.328355 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:41.328761 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:43:41.330411 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m10:43:41.331697 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:43:41.331964 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:43:41.333227 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:43:41.332344 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:43:41.333621 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:43:41.339843 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:41.340257 [debug] [MainThread]: On master: BEGIN
[0m10:43:41.340632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:46.357725 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m10:43:46.359215 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:46.360018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:46.365873 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m10:43:46.369377 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:46.369957 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:46.370362 [debug] [MainThread]: On master: BEGIN
[0m10:43:46.371021 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:43:46.371607 [debug] [MainThread]: On master: COMMIT
[0m10:43:46.372069 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:46.372518 [debug] [MainThread]: On master: COMMIT
[0m10:43:46.373079 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:46.373494 [debug] [MainThread]: On master: Close
[0m10:43:46.374165 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:46.375029 [info ] [MainThread]: 
[0m10:43:46.384100 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m10:43:46.384888 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m10:43:46.385462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m10:43:46.385859 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m10:43:46.393347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m10:43:46.394464 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m10:43:46.423035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m10:43:46.424114 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:43:46.424501 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m10:43:46.424832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:46.429802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:43:46.430205 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:43:46.430578 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m10:43:47.704172 [debug] [Thread-1 (]: SQL status: SELECT 259297 in 1.273 seconds
[0m10:43:47.713838 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:43:47.714631 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m10:43:47.715678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:43:47.729879 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m10:43:47.730345 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:43:47.730747 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m10:43:47.735081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:43:47.740040 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m10:43:47.743173 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m10:43:47.743549 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m10:43:47.744136 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:43:47.746505 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m10:43:47.748557 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259297[0m in 1.36s]
[0m10:43:47.749895 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m10:43:47.752035 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:47.752511 [debug] [MainThread]: On master: BEGIN
[0m10:43:47.752979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:47.760839 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:43:47.761429 [debug] [MainThread]: On master: COMMIT
[0m10:43:47.761898 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:47.762207 [debug] [MainThread]: On master: COMMIT
[0m10:43:47.762663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:47.762975 [debug] [MainThread]: On master: Close
[0m10:43:47.763449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:47.763801 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m10:43:47.764197 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:43:47.764575 [info ] [MainThread]: 
[0m10:43:47.764948 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.52 seconds (11.52s).
[0m10:43:47.765682 [debug] [MainThread]: Command end result
[0m10:43:47.766027 [info ] [MainThread]: 
[0m10:43:47.766522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:47.766850 [info ] [MainThread]: 
[0m10:43:47.767275 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:43:47.768618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.001318, "process_user_time": 1.35251, "process_kernel_time": 0.124678, "process_mem_max_rss": "106428", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:43:47.769455 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:47.769332 after 12.00 seconds
[0m10:43:47.769928 [debug] [MainThread]: Flushing usage events
[0m10:43:54.999960 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:55.007843 | 1e5c158b-dcdb-498a-b7c2-5f79815ac526 ==============================
[0m10:43:55.007843 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:55.011656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:55.008970 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:55.015179 | d9909381-8242-48a7-83f2-cc5cf534a2a5 ==============================
[0m10:43:55.015179 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:55.015899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m10:43:55.015257 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:43:55.021696 | 123e33c4-c766-42e4-8eea-c74c4870758b ==============================
[0m10:43:55.021696 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:43:55.023557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m10:43:55.244008 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:55.251877 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:55.254618 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:43:55.295838 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:55.307927 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:55.314372 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:43:55.507943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:55.508619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:55.515189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:55.516059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:55.528601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:43:55.529529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:43:55.578117 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:55.581654 [info ] [MainThread]: 
[0m10:43:55.584308 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:55.587135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:43:55.587089 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:55.593512 [info ] [MainThread]: 
[0m10:43:55.594805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:55.597662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:43:55.619820 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:43:55.621403 [info ] [MainThread]: 
[0m10:43:55.621905 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:43:55.623671 [debug] [MainThread]: Command end result
[0m10:43:55.624458 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.65592957, "process_user_time": 1.347419, "process_kernel_time": 0.176974, "process_mem_max_rss": "97452", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:43:55.624993 [debug] [MainThread]: Command `dbt test` succeeded at 10:43:55.624886 after 0.66 seconds
[0m10:43:55.625505 [debug] [MainThread]: Flushing usage events
[0m10:43:55.637604 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:43:55.638633 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:43:55.640558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:55.644062 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:43:55.645206 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:43:55.645945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:55.653114 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m10:43:55.654492 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:43:55.654698 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m10:43:55.656252 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:43:55.659877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:43:55.661700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:43:55.660504 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:43:55.666330 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:55.668369 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:55.668777 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:43:55.669142 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:43:55.669505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:55.669845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:55.662304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:43:55.670652 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:55.673216 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:55.673744 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:43:55.674217 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:43:55.674953 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:43:55.674782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:43:55.675825 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:43:55.675222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:55.676336 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:43:55.676726 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:43:55.677424 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:43:55.677912 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:43:55.680104 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m10:43:55.681560 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:43:55.682079 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m10:43:55.682430 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:43:55.683511 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:43:55.685718 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:43:55.690996 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.691630 [debug] [MainThread]: On master: BEGIN
[0m10:43:55.692388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:55.698134 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:43:55.698731 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.699218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:55.703156 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:43:55.705713 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:55.706165 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.706498 [debug] [MainThread]: On master: BEGIN
[0m10:43:55.707022 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:43:55.707590 [debug] [MainThread]: On master: COMMIT
[0m10:43:55.708011 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:55.708415 [debug] [MainThread]: On master: COMMIT
[0m10:43:55.708952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:43:55.709255 [debug] [MainThread]: On master: Close
[0m10:43:55.709811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:55.710220 [info ] [MainThread]: 
[0m10:43:55.722116 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m10:43:55.724220 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m10:43:55.724943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m10:43:55.725345 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m10:43:55.745690 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m10:43:55.747053 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m10:43:55.790604 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m10:43:55.795654 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:43:55.796151 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m10:43:55.796644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:55.801447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:43:55.802184 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:43:55.802756 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m10:44:00.689789 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m10:44:00.691000 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m10:44:00.692079 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:44:00.692560 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:44:00.693003 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:44:00.693432 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:44:00.697000 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m10:44:00.697246 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:44:00.699584 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:44:00.701011 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:44:00.701634 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:44:00.701976 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:44:00.711152 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:00.711729 [debug] [MainThread]: On master: BEGIN
[0m10:44:00.712093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:00.717281 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:44:00.717738 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:00.718098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:00.722727 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m10:44:00.724693 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:00.725081 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:00.725371 [debug] [MainThread]: On master: BEGIN
[0m10:44:00.725903 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:44:00.726277 [debug] [MainThread]: On master: COMMIT
[0m10:44:00.726579 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:00.726862 [debug] [MainThread]: On master: COMMIT
[0m10:44:00.727232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:00.727554 [debug] [MainThread]: On master: Close
[0m10:44:00.737608 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:00.738538 [info ] [MainThread]: 
[0m10:44:00.754574 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m10:44:00.755312 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m10:44:00.756095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m10:44:00.756731 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m10:44:00.777912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:44:00.779247 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m10:44:00.820907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:44:00.822261 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:44:00.822642 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m10:44:00.822996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:00.827771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:44:00.828189 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:44:00.828549 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m10:44:01.508252 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.704 seconds
[0m10:44:01.529540 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m10:44:01.530342 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m10:44:01.530832 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m10:44:01.551405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m10:44:01.555505 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m10:44:01.558473 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.83s]
[0m10:44:01.559553 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m10:44:01.562101 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:01.562524 [debug] [MainThread]: On master: BEGIN
[0m10:44:01.562877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:01.570045 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:44:01.570736 [debug] [MainThread]: On master: COMMIT
[0m10:44:01.571244 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:01.571648 [debug] [MainThread]: On master: COMMIT
[0m10:44:01.572223 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:01.572573 [debug] [MainThread]: On master: Close
[0m10:44:01.573108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:01.573693 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m10:44:01.574415 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:44:01.575394 [info ] [MainThread]: 
[0m10:44:01.576084 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m10:44:01.578078 [debug] [MainThread]: Command end result
[0m10:44:01.578902 [info ] [MainThread]: 
[0m10:44:01.580090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:01.580836 [info ] [MainThread]: 
[0m10:44:01.581835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:01.585326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.626464, "process_user_time": 1.539839, "process_kernel_time": 0.185425, "process_mem_max_rss": "106780", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m10:44:01.586957 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:01.586824 after 6.63 seconds
[0m10:44:01.587746 [debug] [MainThread]: Flushing usage events
[0m10:44:02.336531 [debug] [Thread-1 (]: SQL status: SELECT 159297 in 1.507 seconds
[0m10:44:02.353911 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m10:44:02.354439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m10:44:02.354890 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m10:44:02.358400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:44:02.361520 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m10:44:02.363833 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159297[0m in 1.61s]
[0m10:44:02.364933 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m10:44:02.367129 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:02.367586 [debug] [MainThread]: On master: BEGIN
[0m10:44:02.367963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:02.373289 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:44:02.373915 [debug] [MainThread]: On master: COMMIT
[0m10:44:02.374472 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:02.374844 [debug] [MainThread]: On master: COMMIT
[0m10:44:02.375263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:02.375569 [debug] [MainThread]: On master: Close
[0m10:44:02.376013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:02.376317 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m10:44:02.376633 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:44:02.377018 [info ] [MainThread]: 
[0m10:44:02.377408 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m10:44:02.378172 [debug] [MainThread]: Command end result
[0m10:44:02.378545 [info ] [MainThread]: 
[0m10:44:02.379020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:02.379358 [info ] [MainThread]: 
[0m10:44:02.379746 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:02.381488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.406791, "process_user_time": 1.537121, "process_kernel_time": 0.176738, "process_mem_max_rss": "106360", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m10:44:02.382759 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:02.382646 after 7.41 seconds
[0m10:44:02.383346 [debug] [MainThread]: Flushing usage events
[0m10:44:09.389704 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:44:09.395429 | 307ceb8a-279e-4b3b-aae1-2149661bcd2a ==============================
[0m10:44:09.395429 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:44:09.399035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:09.418595 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:44:09.425755 | 449e7b92-76b0-4069-86f6-92d328af03a9 ==============================
[0m10:44:09.425755 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:44:09.426420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:44:09.434890 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:44:09.440663 | 22362ccd-3456-479e-8383-35c9544080fc ==============================
[0m10:44:09.440663 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:44:09.444911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:44:09.591818 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:09.591875 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:09.610588 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:44:09.613084 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:44:09.626483 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:09.642349 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:44:09.793595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:09.794351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:09.796016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:09.798345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:09.816589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:09.817162 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:09.855852 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:44:09.857484 [info ] [MainThread]: 
[0m10:44:09.859487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:09.861830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:44:09.867300 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:44:09.868827 [info ] [MainThread]: 
[0m10:44:09.869297 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:44:09.870814 [debug] [MainThread]: Command end result
[0m10:44:09.871592 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49678662, "process_user_time": 1.266735, "process_kernel_time": 0.110889, "process_mem_max_rss": "97252", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:44:09.872087 [debug] [MainThread]: Command `dbt test` succeeded at 10:44:09.872016 after 0.50 seconds
[0m10:44:09.872409 [debug] [MainThread]: Flushing usage events
[0m10:44:09.881713 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:44:09.884861 [info ] [MainThread]: 
[0m10:44:09.885776 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:44:09.888835 [debug] [MainThread]: Command end result
[0m10:44:09.889699 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4975668, "process_user_time": 1.27655, "process_kernel_time": 0.13067, "process_mem_max_rss": "97720", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:44:09.890245 [debug] [MainThread]: Command `dbt test` succeeded at 10:44:09.890154 after 0.50 seconds
[0m10:44:09.890677 [debug] [MainThread]: Flushing usage events
[0m10:44:09.896268 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:44:09.897335 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:44:09.901346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:09.912130 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m10:44:09.915945 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:44:09.922163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m10:44:09.922881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:44:09.927925 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:44:09.930797 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:44:09.934367 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:44:09.939305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:09.937991 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:44:09.941890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:09.946731 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:44:09.947337 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:44:09.947881 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:44:09.950830 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.002 seconds
[0m10:44:09.952334 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:44:09.952890 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:44:14.963399 [debug] [ThreadPool]: SQL status: BEGIN in 5.021 seconds
[0m10:44:14.964995 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:44:14.965897 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:44:14.969487 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:44:14.971657 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:44:14.972334 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:44:14.980375 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:14.981074 [debug] [MainThread]: On master: BEGIN
[0m10:44:14.981546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:14.986635 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:44:14.987257 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:14.987795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:14.991625 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:44:14.993887 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:14.994319 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:14.994638 [debug] [MainThread]: On master: BEGIN
[0m10:44:14.995179 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:44:14.995682 [debug] [MainThread]: On master: COMMIT
[0m10:44:14.996040 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:14.996573 [debug] [MainThread]: On master: COMMIT
[0m10:44:14.997045 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:14.997414 [debug] [MainThread]: On master: Close
[0m10:44:14.997946 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:14.998486 [info ] [MainThread]: 
[0m10:44:15.005325 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m10:44:15.005927 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m10:44:15.006453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions)
[0m10:44:15.006814 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m10:44:15.014084 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m10:44:15.015491 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m10:44:15.045717 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m10:44:15.046849 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:44:15.047168 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m10:44:15.047459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:15.051714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:44:15.052176 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:44:15.052617 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m10:44:16.487026 [debug] [Thread-1 (]: SQL status: SELECT 1159297 in 1.433 seconds
[0m10:44:16.502615 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:44:16.503250 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m10:44:16.504980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:16.521009 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m10:44:16.521737 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:44:16.522193 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m10:44:16.551188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m10:44:16.557712 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m10:44:16.561313 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m10:44:16.561740 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m10:44:16.562714 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:44:16.566997 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m10:44:16.570376 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159297[0m in 1.56s]
[0m10:44:16.571672 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m10:44:16.576036 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.576654 [debug] [MainThread]: On master: BEGIN
[0m10:44:16.577081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:16.586001 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:44:16.586760 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.587394 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:16.587754 [debug] [MainThread]: On master: COMMIT
[0m10:44:16.588195 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:16.588541 [debug] [MainThread]: On master: Close
[0m10:44:16.589034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:16.589428 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:44:16.589734 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m10:44:16.590174 [info ] [MainThread]: 
[0m10:44:16.590681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.73 seconds (6.73s).
[0m10:44:16.591522 [debug] [MainThread]: Command end result
[0m10:44:16.591927 [info ] [MainThread]: 
[0m10:44:16.592382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:16.592748 [info ] [MainThread]: 
[0m10:44:16.593251 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:16.596096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.244922, "process_user_time": 1.459462, "process_kernel_time": 0.169634, "process_mem_max_rss": "106180", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m10:44:16.597298 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:16.597167 after 7.25 seconds
[0m10:44:16.597950 [debug] [MainThread]: Flushing usage events
[0m10:44:23.691222 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:44:23.697779 | 459587ae-c3cd-4d76-bfc3-57b8561bbe20 ==============================
[0m10:44:23.697779 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:44:23.701387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m10:44:23.698695 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:44:23.704311 | 87798076-28f8-487a-8976-fa20a173fa71 ==============================
[0m10:44:23.704311 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:44:23.705055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m10:44:23.880834 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:23.884074 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:23.898016 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:44:23.900840 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:44:24.060436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:24.061108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:24.070109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:24.072281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:24.127259 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:44:24.128891 [info ] [MainThread]: 
[0m10:44:24.129518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:24.130159 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:44:24.131269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m10:44:24.131831 [info ] [MainThread]: 
[0m10:44:24.136316 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:44:24.139279 [debug] [MainThread]: Command end result
[0m10:44:24.139999 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48187438, "process_user_time": 1.245303, "process_kernel_time": 0.2027, "process_mem_max_rss": "97916", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m10:44:24.140543 [debug] [MainThread]: Command `dbt test` succeeded at 10:44:24.140469 after 0.48 seconds
[0m10:44:24.140890 [debug] [MainThread]: Flushing usage events
[0m10:44:24.164826 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m10:44:24.165503 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m10:44:24.167503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:29.193373 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.026 seconds
[0m10:44:29.195828 [debug] [ThreadPool]: On list_sales_dw: Close
[0m10:44:29.202764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m10:44:29.203462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:44:29.209698 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:44:29.211756 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:44:29.212151 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:44:29.212511 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:44:29.212842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:29.213181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:29.217547 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:44:29.218039 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:44:29.218403 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:44:29.221063 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m10:44:29.222067 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:44:29.222486 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:44:34.233163 [debug] [ThreadPool]: SQL status: BEGIN in 5.023 seconds
[0m10:44:34.235510 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:44:34.236278 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:44:34.240365 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.003 seconds
[0m10:44:34.242508 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:44:34.243085 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:44:34.251736 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:34.252198 [debug] [MainThread]: On master: BEGIN
[0m10:44:34.252581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:39.259065 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m10:44:39.259992 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:39.260447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:39.264805 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m10:44:39.267785 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:39.268514 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:39.269089 [debug] [MainThread]: On master: BEGIN
[0m10:44:39.269725 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:44:39.270220 [debug] [MainThread]: On master: COMMIT
[0m10:44:39.270780 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:39.271310 [debug] [MainThread]: On master: COMMIT
[0m10:44:39.271898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:39.272360 [debug] [MainThread]: On master: Close
[0m10:44:39.273040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:39.274129 [info ] [MainThread]: 
[0m10:44:39.282104 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m10:44:39.282886 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m10:44:39.283642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m10:44:39.284145 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m10:44:39.292417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m10:44:39.294017 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m10:44:39.328963 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m10:44:39.331773 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:44:39.332200 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m10:44:39.332597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:44.353127 [debug] [Thread-1 (]: SQL status: BEGIN in 5.020 seconds
[0m10:44:44.354913 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:44:44.355708 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m10:44:46.321738 [debug] [Thread-1 (]: SQL status: SELECT 1159297 in 1.963 seconds
[0m10:44:46.347059 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:44:46.347603 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m10:44:46.348748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:44:46.363526 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m10:44:46.363963 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:44:46.364345 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m10:44:46.373427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:44:46.379075 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m10:44:46.382422 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m10:44:46.382748 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m10:44:46.383329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:44:46.389122 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m10:44:46.398111 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159297[0m in 7.11s]
[0m10:44:46.403644 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m10:44:46.425274 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:46.426296 [debug] [MainThread]: On master: BEGIN
[0m10:44:46.426886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:46.441861 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m10:44:46.442691 [debug] [MainThread]: On master: COMMIT
[0m10:44:46.443272 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:46.443683 [debug] [MainThread]: On master: COMMIT
[0m10:44:46.444192 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:46.444709 [debug] [MainThread]: On master: Close
[0m10:44:46.446005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:46.446540 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m10:44:46.447042 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m10:44:46.448159 [info ] [MainThread]: 
[0m10:44:46.449019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.32 seconds (22.32s).
[0m10:44:46.450991 [debug] [MainThread]: Command end result
[0m10:44:46.451633 [info ] [MainThread]: 
[0m10:44:46.453287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:46.453724 [info ] [MainThread]: 
[0m10:44:46.454332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:46.457655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.802128, "process_user_time": 1.505229, "process_kernel_time": 0.180466, "process_mem_max_rss": "106136", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m10:44:46.459070 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:46.458954 after 22.80 seconds
[0m10:44:46.459794 [debug] [MainThread]: Flushing usage events
[0m10:44:53.685121 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 10:44:53.692091 | 351d6493-afbc-4bd0-a3b6-b63145d6195d ==============================
[0m10:44:53.692091 [info ] [MainThread]: Running with dbt=1.8.2
[0m10:44:53.692661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:53.849976 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:44:53.862798 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m10:44:53.994075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:44:53.994602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:44:54.054032 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m10:44:54.055425 [info ] [MainThread]: 
[0m10:44:54.055918 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:44:54.059753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m10:44:54.060405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m10:44:54.093867 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:44:54.094198 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:44:54.094556 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m10:44:54.094936 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m10:44:54.095291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:54.095658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:54.102912 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:44:54.103285 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:44:54.103664 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m10:44:54.104033 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m10:44:54.104430 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:44:54.104810 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m10:44:54.108403 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m10:44:54.108669 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m10:44:54.109792 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m10:44:54.111053 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m10:44:54.111676 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m10:44:54.112022 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m10:44:54.119647 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:54.120097 [debug] [MainThread]: On master: BEGIN
[0m10:44:54.120464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:54.124111 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:44:54.124529 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:54.124914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:54.128079 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m10:44:54.129966 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:54.130361 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:54.130683 [debug] [MainThread]: On master: BEGIN
[0m10:44:54.131134 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:44:54.131512 [debug] [MainThread]: On master: COMMIT
[0m10:44:54.131848 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:54.132183 [debug] [MainThread]: On master: COMMIT
[0m10:44:54.132584 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:54.132893 [debug] [MainThread]: On master: Close
[0m10:44:54.133337 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:54.133745 [info ] [MainThread]: 
[0m10:44:54.140062 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m10:44:54.140512 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m10:44:54.140994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m10:44:54.141390 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m10:44:54.149053 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m10:44:54.150799 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m10:44:54.162962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m10:44:54.164469 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m10:44:54.164988 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m10:44:54.165523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:59.188513 [debug] [Thread-1 (]: SQL status: BEGIN in 5.022 seconds
[0m10:44:59.190156 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m10:44:59.190988 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m10:44:59.402400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.211 seconds
[0m10:44:59.407423 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m10:44:59.408074 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m10:44:59.408928 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 5.27s]
[0m10:44:59.409867 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m10:44:59.411635 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:59.412065 [debug] [MainThread]: On master: BEGIN
[0m10:44:59.412437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:59.417469 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:44:59.417942 [debug] [MainThread]: On master: COMMIT
[0m10:44:59.418310 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:59.418719 [debug] [MainThread]: On master: COMMIT
[0m10:44:59.419203 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:44:59.419559 [debug] [MainThread]: On master: Close
[0m10:44:59.419999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:59.420312 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m10:44:59.420621 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m10:44:59.420987 [info ] [MainThread]: 
[0m10:44:59.421386 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m10:44:59.422043 [debug] [MainThread]: Command end result
[0m10:44:59.422393 [info ] [MainThread]: 
[0m10:44:59.422792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:59.423114 [info ] [MainThread]: 
[0m10:44:59.423490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:59.424499 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.7764378, "process_user_time": 1.28084, "process_kernel_time": 0.171844, "process_mem_max_rss": "108860", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m10:44:59.425123 [debug] [MainThread]: Command `dbt test` succeeded at 10:44:59.425034 after 5.78 seconds
[0m10:44:59.425552 [debug] [MainThread]: Flushing usage events
[0m12:16:41.958496 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:16:41.964542 | 52476dee-c3a4-4721-a9c4-32432a44c65e ==============================
[0m12:16:41.964542 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:16:41.967270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:16:42.059314 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m12:16:42.060922 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m12:16:42.064692 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-22uvhb_p'
[0m12:16:42.065115 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m12:16:42.065879 [debug] [MainThread]: Creating symlink to local dependency.
[0m12:16:42.066339 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m12:16:42.067174 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15371987, "process_user_time": 1.018179, "process_kernel_time": 0.114132, "process_mem_max_rss": "105904", "process_in_blocks": "16", "process_out_blocks": "11"}
[0m12:16:42.068285 [debug] [MainThread]: Command `dbt deps` succeeded at 12:16:42.068169 after 0.15 seconds
[0m12:16:42.068677 [debug] [MainThread]: Flushing usage events
[0m12:16:48.912642 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:16:48.917872 | b78c3e9e-b3c5-4284-90d9-62f84d421707 ==============================
[0m12:16:48.917872 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:16:48.918418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:49.070927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:16:49.085017 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:16:49.086156 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:16:50.535729 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:16:50.537747 [info ] [MainThread]: 
[0m12:16:50.538451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:16:50.539412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:16:50.566706 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:16:50.567290 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:16:50.567854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:50.574635 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.007 seconds
[0m12:16:50.575944 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:16:50.576683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m12:16:50.577241 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m12:16:50.582171 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:16:50.582611 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m12:16:50.582936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:50.587479 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:16:50.587996 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:16:50.588446 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m12:16:50.589403 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:16:50.590430 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:16:50.590836 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:16:50.591251 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:16:50.592119 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m12:16:50.592547 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m12:16:50.597463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m12:16:50.598044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:16:50.603006 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:16:50.604862 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:16:50.605249 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:16:50.605617 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:16:50.605981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:50.606382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:50.610852 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:16:50.611175 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:16:50.611539 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:16:50.611926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:16:50.612295 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:16:50.612699 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:16:50.615842 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:16:50.616122 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:16:50.617167 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:16:50.618162 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:16:50.618700 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:16:50.619034 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:16:50.624039 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:50.624565 [debug] [MainThread]: On master: BEGIN
[0m12:16:50.624953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:50.629287 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:16:50.629707 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:50.630122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:16:50.633389 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:16:50.634421 [debug] [MainThread]: On master: ROLLBACK
[0m12:16:50.634941 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:50.635376 [debug] [MainThread]: On master: BEGIN
[0m12:16:50.636058 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:16:50.636687 [debug] [MainThread]: On master: COMMIT
[0m12:16:50.637178 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:50.637599 [debug] [MainThread]: On master: COMMIT
[0m12:16:50.638099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:50.638459 [debug] [MainThread]: On master: Close
[0m12:16:50.638911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:50.639274 [info ] [MainThread]: 
[0m12:16:50.644968 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m12:16:50.645537 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m12:16:50.645971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m12:16:50.646261 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m12:16:50.646741 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m12:16:50.670463 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:16:50.670990 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m12:16:50.671477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:50.676614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:16:50.677184 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:16:50.677699 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m12:16:50.679350 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.001 seconds
[0m12:16:50.736807 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:16:50.737497 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m12:16:50.739216 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m12:16:50.744006 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m12:16:50.759115 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:16:50.759646 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:16:50.760045 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:16:50.761299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:16:50.762935 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m12:16:50.764331 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.12s]
[0m12:16:50.765011 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m12:16:50.766234 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:50.766634 [debug] [MainThread]: On master: BEGIN
[0m12:16:50.766981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:50.771734 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:16:50.772226 [debug] [MainThread]: On master: COMMIT
[0m12:16:50.772619 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:50.772986 [debug] [MainThread]: On master: COMMIT
[0m12:16:50.773496 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:50.773836 [debug] [MainThread]: On master: Close
[0m12:16:50.774316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:50.774673 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m12:16:50.775397 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:16:50.775815 [info ] [MainThread]: 
[0m12:16:50.776230 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m12:16:50.776966 [debug] [MainThread]: Command end result
[0m12:16:50.815052 [info ] [MainThread]: 
[0m12:16:50.815528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:50.815833 [info ] [MainThread]: 
[0m12:16:50.816108 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:16:50.816784 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.9410604, "process_user_time": 2.676846, "process_kernel_time": 0.09535, "process_mem_max_rss": "113644", "process_in_blocks": "8", "process_out_blocks": "3517"}
[0m12:16:50.817276 [debug] [MainThread]: Command `dbt seed` succeeded at 12:16:50.817187 after 1.94 seconds
[0m12:16:50.817635 [debug] [MainThread]: Flushing usage events
[0m12:17:07.073888 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:07.083876 | 8ab9ee69-fe5c-4c8f-b512-74918e915268 ==============================
[0m12:17:07.083876 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:07.085460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:07.105738 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:17:07.110189 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:07.112644 | 2592a9da-76d0-47d9-b472-8757ad73d3a4 ==============================
[0m12:17:07.112644 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:07.116890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 12:17:07.118402 | 1361bf5c-14d4-462d-bf4b-2467ec6d52c2 ==============================
[0m12:17:07.118402 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:07.120285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m12:17:07.114885 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:07.123435 | 07436699-c6ac-4074-b3f0-6e8667754b7a ==============================
[0m12:17:07.123435 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:07.124492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:07.123728 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:07.129830 | f80bc627-49e9-431b-b41d-88a779f750b5 ==============================
[0m12:17:07.129830 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:07.131912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m12:17:07.156213 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:07.162182 | 177bc8bd-2ac8-4153-b80a-09d07f9223d6 ==============================
[0m12:17:07.162182 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:07.162929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:07.171698 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:07.179968 | 74991224-bb44-4555-8c7a-dbb4c826be4f ==============================
[0m12:17:07.179968 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:07.181842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:07.285204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:07.326130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:07.462444 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:07.485548 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:07.487529 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:07.498672 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:07.512862 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:07.518053 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:07.519225 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:17:07.519842 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:07.564545 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:07.567630 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:07.573785 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:07.576836 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:07.617612 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:07.621381 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:07.665211 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:07.666518 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:17:07.711397 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:07.712417 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:17:07.740957 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:07.742050 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:17:07.743662 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:07.744513 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:17:07.757386 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:07.758575 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:17:07.772238 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:17:07.772964 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:17:09.342777 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:09.348452 [info ] [MainThread]: 
[0m12:17:09.355699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:09.358068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:09.371324 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:09.376544 [info ] [MainThread]: 
[0m12:17:09.377792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:09.380563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:09.403244 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:09.404378 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:09.405757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.418593 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m12:17:09.417112 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:09.421546 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:09.422678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:17:09.423788 [info ] [MainThread]: 
[0m12:17:09.423857 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:17:09.422554 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:09.425536 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:09.429749 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:09.431689 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:09.431598 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:17:09.432791 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:17:09.431755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.433527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:09.441335 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:17:09.442964 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:09.443557 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:17:09.448418 [info ] [MainThread]: 
[0m12:17:09.448017 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:17:09.449523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:09.450465 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:17:09.451010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:09.452607 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:17:09.453392 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:17:09.454141 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:17:09.456204 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:17:09.456819 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:17:09.462626 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:09.462572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m12:17:09.463471 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:09.464763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.463262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:09.469748 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:09.473452 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:09.474348 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:09.475332 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m12:17:09.475516 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:09.476052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:09.476964 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:09.476710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.481936 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:09.483175 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:09.483918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.486111 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:17:09.487137 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:09.486331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:09.487868 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:09.491788 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:17:09.493116 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:09.492899 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m12:17:09.487103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:09.493731 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:09.494534 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:09.493572 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:09.496008 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:09.497635 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:09.501650 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:09.502116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:09.502510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.502804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:09.503613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:09.509718 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:17:09.510654 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:09.510099 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:17:09.510809 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:09.511646 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:09.510044 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:09.512629 [info ] [MainThread]: 
[0m12:17:09.512215 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:09.512531 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:09.512776 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:09.513487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:09.513126 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:09.515457 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:17:09.515474 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:09.516170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:09.516568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:09.516650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.517111 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:09.518581 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:09.518980 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:17:09.521956 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:09.522169 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:17:09.523129 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:09.523313 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:09.524238 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:09.524591 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:17:09.525502 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:09.526000 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:09.526895 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:09.528906 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.529410 [debug] [MainThread]: On master: BEGIN
[0m12:17:09.529942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:09.528339 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:17:09.529701 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:09.531178 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:09.531813 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:09.532386 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:09.535197 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:17:09.536483 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.536933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:09.539177 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:09.539714 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.539519 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:09.540068 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:17:09.541239 [debug] [MainThread]: On master: BEGIN
[0m12:17:09.541946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:09.541923 [info ] [MainThread]: 
[0m12:17:09.542547 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:09.542680 [info ] [MainThread]: 
[0m12:17:09.543715 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:09.544662 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:09.544702 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:09.544689 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.544863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:09.545292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.545401 [debug] [MainThread]: On master: BEGIN
[0m12:17:09.545755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:09.545994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:09.546119 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:09.548921 [debug] [MainThread]: On master: COMMIT
[0m12:17:09.551591 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.553612 [debug] [MainThread]: On master: COMMIT
[0m12:17:09.554517 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:09.555654 [debug] [MainThread]: On master: Close
[0m12:17:09.556513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:09.558908 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m12:17:09.560052 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.558343 [info ] [MainThread]: 
[0m12:17:09.561296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:09.566067 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:17:09.567550 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:09.568231 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.568826 [debug] [MainThread]: On master: BEGIN
[0m12:17:09.569720 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:09.569529 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m12:17:09.570245 [debug] [MainThread]: On master: COMMIT
[0m12:17:09.571011 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.570980 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m12:17:09.571568 [debug] [MainThread]: On master: COMMIT
[0m12:17:09.572122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m12:17:09.572254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:09.572818 [debug] [MainThread]: On master: Close
[0m12:17:09.572819 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m12:17:09.573544 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:09.574419 [info ] [MainThread]: 
[0m12:17:09.582283 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m12:17:09.583304 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m12:17:09.583559 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m12:17:09.584188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m12:17:09.584770 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m12:17:09.586423 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m12:17:09.587031 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:09.587815 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:09.588235 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:09.588615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.589037 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:09.589695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:09.593395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m12:17:09.594789 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m12:17:09.616272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m12:17:09.622533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m12:17:09.624397 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:17:09.624626 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:17:09.625147 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m12:17:09.625614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:09.625546 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m12:17:09.626368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:09.631656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:17:09.631737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:17:09.632218 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:17:09.632592 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, city_name, country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m12:17:09.632543 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:17:09.633022 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m12:17:09.633339 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "city_name" does not exist
LINE 15:     id as geography_key, city_name, country_name, regionname
                                  ^
HINT:  Perhaps you meant to reference the column "geography.cityname".

[0m12:17:09.633939 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: ROLLBACK
[0m12:17:09.634819 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m12:17:09.635543 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:17:09.641024 [debug] [Thread-1 (]: Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 15:     id as geography_key, city_name, country_name, regionname
                                    ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m12:17:09.642675 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_geography ........................ [[31mERROR[0m in 0.07s]
[0m12:17:09.641243 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:17:09.643270 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m12:17:09.643630 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m12:17:09.644446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:09.645056 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.645475 [debug] [MainThread]: On master: BEGIN
[0m12:17:09.645817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:09.650148 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:17:09.650735 [debug] [MainThread]: On master: COMMIT
[0m12:17:09.651080 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.651428 [debug] [MainThread]: On master: COMMIT
[0m12:17:09.651862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:09.652212 [debug] [MainThread]: On master: Close
[0m12:17:09.652703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:09.653042 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m12:17:09.653421 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:17:09.653797 [info ] [MainThread]: 
[0m12:17:09.654164 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:17:09.654747 [debug] [MainThread]: Command end result
[0m12:17:09.655096 [info ] [MainThread]: 
[0m12:17:09.655226 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:17:09.656000 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:17:09.655664 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:17:09.656447 [info ] [MainThread]: 
[0m12:17:09.656910 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:17:09.657481 [error] [MainThread]:   Database Error in model dim_geography (models/dim/dim_geography.sql)
  column "city_name" does not exist
  LINE 15:     id as geography_key, city_name, country_name, regionname
                                    ^
  HINT:  Perhaps you meant to reference the column "geography.cityname".
  compiled code at target/run/dbtcomp/models/dim/dim_geography.sql
[0m12:17:09.658030 [info ] [MainThread]: 
[0m12:17:09.658498 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:17:09.658631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:09.659282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5817845, "process_user_time": 3.707823, "process_kernel_time": 0.251928, "process_mem_max_rss": "112772", "process_in_blocks": "472", "process_out_blocks": "1180", "command_success": false}
[0m12:17:09.664451 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m12:17:09.664674 [debug] [MainThread]: Command `dbt run` failed at 12:17:09.664575 after 2.59 seconds
[0m12:17:09.668195 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:17:09.668639 [debug] [MainThread]: Flushing usage events
[0m12:17:09.669030 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m12:17:09.671734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:09.679040 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m12:17:09.682029 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m12:17:09.683703 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m12:17:09.686705 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:09.687482 [debug] [MainThread]: On master: BEGIN
[0m12:17:09.689452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:14.452790 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.021 seconds
[0m12:17:14.456174 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:14.463762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:14.464854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:14.472142 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.475809 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:14.476485 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:14.476976 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:14.477399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:14.478084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:14.483168 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:17:14.484042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.484789 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:14.484548 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:17:14.485728 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.486274 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:14.487919 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:14.489708 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:14.488977 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:14.490451 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:14.491482 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:14.492477 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:14.497352 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:14.498033 [debug] [MainThread]: On master: BEGIN
[0m12:17:14.498666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:14.504872 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:17:14.505645 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:14.506211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:14.510234 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m12:17:14.511700 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:14.512304 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:14.512719 [debug] [MainThread]: On master: BEGIN
[0m12:17:14.513372 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:14.513981 [debug] [MainThread]: On master: COMMIT
[0m12:17:14.514544 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:14.514988 [debug] [MainThread]: On master: COMMIT
[0m12:17:14.515532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:14.516033 [debug] [MainThread]: On master: Close
[0m12:17:14.516710 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:14.517275 [info ] [MainThread]: 
[0m12:17:14.527737 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m12:17:14.528809 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m12:17:14.529718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m12:17:14.530334 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m12:17:14.543295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m12:17:14.544986 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m12:17:14.560660 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m12:17:14.562882 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:14.573940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:14.574984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:14.582878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m12:17:14.582183 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.584803 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:14.586133 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:17:14.586951 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m12:17:14.585462 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:14.587428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:14.586530 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:14.587769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:14.588349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:14.593516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:17:14.593949 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:17:14.594417 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:14.594851 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:17:14.595351 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:14.595850 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m12:17:14.598089 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:17:14.598879 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:14.600381 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m12:17:14.601809 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:14.602040 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:14.602669 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:14.603118 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m12:17:14.605063 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:14.605979 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:17:14.606608 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m12:17:14.607469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:14.608251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:17:14.610395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:14.611122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:14.608942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:17:14.617304 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.617447 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:14.620105 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:17:14.619568 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:14.620740 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:17:14.619770 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.621321 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:17:14.620100 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:14.620327 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:14.621125 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:14.622572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:14.621682 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:14.621923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:14.622455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:14.622205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:14.626482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:14.628010 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m12:17:14.632879 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:17:14.632621 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:17:14.635468 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:17:14.635704 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.636138 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m12:17:14.635829 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:14.636506 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:14.636793 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:14.636963 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:14.639339 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m12:17:14.639472 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:14.640899 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m12:17:14.639506 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:14.641616 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m12:17:14.642339 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:14.642830 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:14.643045 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:14.643300 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:14.643469 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:14.643929 [debug] [MainThread]: On master: BEGIN
[0m12:17:14.644437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:14.649654 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:17:14.650179 [debug] [MainThread]: On master: COMMIT
[0m12:17:14.650699 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:14.651132 [debug] [MainThread]: On master: COMMIT
[0m12:17:14.651680 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:14.652148 [debug] [MainThread]: On master: Close
[0m12:17:14.652646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:14.652987 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m12:17:14.653300 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:17:14.653782 [info ] [MainThread]: 
[0m12:17:14.654237 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m12:17:14.655063 [debug] [MainThread]: Command end result
[0m12:17:14.655492 [info ] [MainThread]: 
[0m12:17:14.655933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:14.656263 [info ] [MainThread]: 
[0m12:17:14.656745 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:14.657723 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5994263, "process_user_time": 3.65596, "process_kernel_time": 0.279674, "process_mem_max_rss": "112836", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m12:17:14.658322 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:14.658239 after 7.60 seconds
[0m12:17:14.658744 [debug] [MainThread]: Flushing usage events
[0m12:17:14.695906 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m12:17:14.697845 [debug] [MainThread]: On master: COMMIT
[0m12:17:14.701523 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:14.702005 [debug] [MainThread]: On master: COMMIT
[0m12:17:14.702590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:14.702937 [debug] [MainThread]: On master: Close
[0m12:17:14.703505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:14.705513 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:17:14.708773 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m12:17:14.709811 [info ] [MainThread]: 
[0m12:17:14.710907 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m12:17:14.712868 [debug] [MainThread]: Command end result
[0m12:17:14.716116 [info ] [MainThread]: 
[0m12:17:14.717553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:14.719470 [info ] [MainThread]: 
[0m12:17:14.721520 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:14.723052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6192355, "process_user_time": 3.634329, "process_kernel_time": 0.252664, "process_mem_max_rss": "112676", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m12:17:14.726746 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:14.726589 after 7.62 seconds
[0m12:17:14.727236 [debug] [MainThread]: Flushing usage events
[0m12:17:19.490016 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m12:17:19.491221 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:19.491846 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:19.494937 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:17:19.496525 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:19.497063 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:19.503173 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.503779 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.504291 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:19.510271 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:17:19.510981 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.511646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:19.515818 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:17:19.517437 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:19.517977 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.518295 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.519029 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:19.519593 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.519970 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.520283 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.520921 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:19.521401 [debug] [MainThread]: On master: Close
[0m12:17:19.522107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:19.522637 [info ] [MainThread]: 
[0m12:17:19.529945 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m12:17:19.530679 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m12:17:19.531243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m12:17:19.531757 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m12:17:19.541446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m12:17:19.543572 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m12:17:19.573507 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m12:17:19.575050 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:17:19.575678 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m12:17:19.576098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:19.581929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:17:19.582499 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:17:19.582970 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m12:17:19.584567 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:17:19.590973 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:17:19.591498 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m12:17:19.592282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:19.600177 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m12:17:19.604735 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:17:19.605205 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:19.605517 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:17:19.605776 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:19.606220 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:17:19.607290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:19.608398 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:19.613197 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m12:17:19.614718 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:19.616792 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:17:19.617521 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m12:17:19.617887 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:19.618840 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:19.621432 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m12:17:19.623217 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m12:17:19.624000 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m12:17:19.624052 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.624585 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.625151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:19.625541 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.626060 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.626550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:19.631845 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:17:19.631837 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m12:17:19.632757 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.632748 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m12:17:19.633335 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:19.633568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:19.633633 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:19.633871 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:19.634468 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:19.636543 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m12:17:19.636713 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m12:17:19.636815 [debug] [MainThread]: SQL status: SELECT 3 in 0.002 seconds
[0m12:17:19.638455 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:19.638564 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:19.639307 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:19.639144 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:19.639858 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:19.640901 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.641348 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.642042 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:19.642639 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.643102 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.643584 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.644111 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:19.644466 [debug] [MainThread]: On master: Close
[0m12:17:19.645092 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:19.645742 [info ] [MainThread]: 
[0m12:17:19.645903 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.645924 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.649683 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.649762 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.650234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:19.650302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:19.653876 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m12:17:19.655734 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m12:17:19.656566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m12:17:19.656946 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:17:19.656950 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:17:19.657577 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m12:17:19.657864 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.658011 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.658821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:19.658703 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:19.661966 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:17:19.663518 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:19.662366 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m12:17:19.664118 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.665155 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.665158 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:19.665966 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:19.665919 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.666502 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.667042 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.666876 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.667468 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.667518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m12:17:19.668176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:19.668097 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:19.668897 [debug] [MainThread]: On master: Close
[0m12:17:19.669248 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.669747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:19.670434 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.670458 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m12:17:19.670588 [info ] [MainThread]: 
[0m12:17:19.671620 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.672595 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:19.674528 [debug] [MainThread]: On master: Close
[0m12:17:19.675742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:19.676986 [info ] [MainThread]: 
[0m12:17:19.679965 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m12:17:19.682864 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m12:17:19.683618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m12:17:19.684151 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m12:17:19.684805 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m12:17:19.685534 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m12:17:19.686170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m12:17:19.686655 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m12:17:19.698336 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m12:17:19.703687 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m12:17:19.705510 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:17:19.707701 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m12:17:19.710143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m12:17:19.712963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:19.716486 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m12:17:19.726820 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m12:17:19.733229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:17:19.736677 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:17:19.741558 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m12:17:19.749556 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:17:19.778870 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:17:19.779446 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m12:17:19.780321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:19.792258 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:17:19.792929 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:17:19.793436 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:17:19.794666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:19.795428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m12:17:19.795815 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m12:17:19.800455 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:17:19.800917 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:17:19.800957 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m12:17:19.800466 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m12:17:19.801403 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m12:17:19.801424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:19.801952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:19.805559 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:17:19.807042 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m12:17:19.807641 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:19.808791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:17:19.809624 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m12:17:19.810762 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:17:19.811449 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m12:17:19.811566 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m12:17:19.812313 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m12:17:19.813712 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.814045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:17:19.814404 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.817749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:19.822127 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:17:19.822553 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.822411 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:17:19.823103 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.823504 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m12:17:19.823958 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.824573 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:19.824904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:19.828678 [debug] [MainThread]: On master: Close
[0m12:17:19.829210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:19.829547 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m12:17:19.829876 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:17:19.830673 [info ] [MainThread]: 
[0m12:17:19.831041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m12:17:19.831655 [debug] [MainThread]: Command end result
[0m12:17:19.831971 [info ] [MainThread]: 
[0m12:17:19.832372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:19.832741 [info ] [MainThread]: 
[0m12:17:19.835842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:19.836723 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.714496, "process_user_time": 3.752654, "process_kernel_time": 0.247217, "process_mem_max_rss": "112644", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m12:17:19.837282 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:19.837204 after 12.72 seconds
[0m12:17:19.837662 [debug] [MainThread]: Flushing usage events
[0m12:17:19.843454 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:17:19.845901 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:17:19.846298 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:17:19.847790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:19.855383 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m12:17:19.859873 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:17:19.860969 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m12:17:19.862043 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:19.865429 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m12:17:19.867189 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m12:17:19.867857 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m12:17:19.869382 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.869923 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.870435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:19.874811 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:17:19.875288 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.875712 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.876108 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.876609 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:19.876990 [debug] [MainThread]: On master: Close
[0m12:17:19.877496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:19.878033 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m12:17:19.878395 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:17:19.878753 [info ] [MainThread]: 
[0m12:17:19.879147 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m12:17:19.879907 [debug] [MainThread]: Command end result
[0m12:17:19.880755 [info ] [MainThread]: 
[0m12:17:19.881349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:19.881784 [info ] [MainThread]: 
[0m12:17:19.882129 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:19.882878 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.825365, "process_user_time": 3.702297, "process_kernel_time": 0.273493, "process_mem_max_rss": "112908", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:17:19.883397 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:19.883321 after 12.83 seconds
[0m12:17:19.883776 [debug] [MainThread]: Flushing usage events
[0m12:17:22.385415 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:22.390900 | 5bfd22f4-074c-46ee-9988-e046a22cdd79 ==============================
[0m12:17:22.390900 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:22.391546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m12:17:22.420089 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:22.425173 | 24711174-ddb3-4739-981c-3bb5c7ecdecf ==============================
[0m12:17:22.425173 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:22.425771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:22.423129 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:22.431914 | 23942036-f510-4fc8-9aa3-3580bcad8cfc ==============================
[0m12:17:22.431914 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:22.432686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:22.560500 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:22.578953 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:22.603448 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:22.611466 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:22.623548 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:22.632804 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:22.726906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:22.727517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:22.789974 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:22.791421 [info ] [MainThread]: 
[0m12:17:22.792168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:22.794164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:22.805564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:22.806182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:22.821104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:22.821638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:22.830214 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:22.830727 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:22.831129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:22.870258 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:22.871620 [info ] [MainThread]: 
[0m12:17:22.872080 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:22.873597 [debug] [MainThread]: Command end result
[0m12:17:22.874334 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.505307, "process_user_time": 1.236752, "process_kernel_time": 0.069435, "process_mem_max_rss": "97640", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:22.874851 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:22.874784 after 0.51 seconds
[0m12:17:22.875211 [debug] [MainThread]: Flushing usage events
[0m12:17:22.880272 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:22.881778 [info ] [MainThread]: 
[0m12:17:22.882453 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:22.884313 [debug] [MainThread]: Command end result
[0m12:17:22.885134 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51606196, "process_user_time": 1.236387, "process_kernel_time": 0.071426, "process_mem_max_rss": "97136", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:22.885802 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:22.885688 after 0.52 seconds
[0m12:17:22.886232 [debug] [MainThread]: Flushing usage events
[0m12:17:24.637237 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m12:17:24.638677 [debug] [MainThread]: On master: COMMIT
[0m12:17:24.639118 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:24.639478 [debug] [MainThread]: On master: COMMIT
[0m12:17:24.640166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:24.640626 [debug] [MainThread]: On master: Close
[0m12:17:24.641305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:24.641924 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:17:24.642326 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m12:17:24.642923 [info ] [MainThread]: 
[0m12:17:24.653917 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m12:17:24.661972 [debug] [MainThread]: Command end result
[0m12:17:24.679085 [info ] [MainThread]: 
[0m12:17:24.711289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:24.729787 [info ] [MainThread]: 
[0m12:17:24.730999 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:24.734084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.746252, "process_user_time": 3.692327, "process_kernel_time": 0.272642, "process_mem_max_rss": "112728", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m12:17:24.734964 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:24.734865 after 17.75 seconds
[0m12:17:24.735821 [debug] [MainThread]: Flushing usage events
[0m12:17:24.817568 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m12:17:24.818771 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:17:24.819484 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m12:17:25.065999 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.245 seconds
[0m12:17:25.073831 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:17:25.074654 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:17:25.075810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:25.093036 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:17:25.093680 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:17:25.094185 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:17:25.100262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:17:25.106083 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m12:17:25.110259 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:17:25.110853 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m12:17:25.111532 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:17:25.114302 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m12:17:25.116406 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 5.43s]
[0m12:17:25.117416 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m12:17:25.119009 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:25.119496 [debug] [MainThread]: On master: BEGIN
[0m12:17:25.119896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:25.125016 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:17:25.125513 [debug] [MainThread]: On master: COMMIT
[0m12:17:25.126045 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:25.126503 [debug] [MainThread]: On master: COMMIT
[0m12:17:25.127081 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:25.127502 [debug] [MainThread]: On master: Close
[0m12:17:25.128196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:25.129150 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:17:25.129570 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m12:17:25.130072 [info ] [MainThread]: 
[0m12:17:25.130543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.59 seconds (15.59s).
[0m12:17:25.131329 [debug] [MainThread]: Command end result
[0m12:17:25.131731 [info ] [MainThread]: 
[0m12:17:25.132214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:25.132630 [info ] [MainThread]: 
[0m12:17:25.133082 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:25.134162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.081703, "process_user_time": 3.787883, "process_kernel_time": 0.288329, "process_mem_max_rss": "112592", "process_out_blocks": "1193", "process_in_blocks": "0"}
[0m12:17:25.134837 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:25.134747 after 18.08 seconds
[0m12:17:25.135519 [debug] [MainThread]: Flushing usage events
[0m12:17:27.500528 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:27.506386 | a0077520-d0bb-48a0-ae34-a804ceaec7e1 ==============================
[0m12:17:27.506386 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:27.507582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:27.508350 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:17:27.508873 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:27.514830 | 56b397cb-d1e2-4c8b-998f-65593af9e207 ==============================
[0m12:17:27.514830 [info ] [MainThread]: Running with dbt=1.8.2


============================== 12:17:27.514910 | 93bbfe32-8f33-4a9d-be97-ffa0fca54d0c ==============================
[0m12:17:27.514910 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:27.515707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'send_anonymous_usage_stats': 'True'}
[0m12:17:27.516431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:17:27.673014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:27.679314 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:27.682709 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:27.694154 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:27.694639 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:27.695799 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:27.837458 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m12:17:27.840179 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:27.850533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:27.850728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:27.851205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:27.855211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:27.855313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:27.855747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:27.855827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:27.851176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:27.857348 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:27.859322 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:27.859787 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:27.860206 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:27.860616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:27.861074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:27.865662 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:17:27.866285 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:27.866768 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:27.869063 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m12:17:27.870180 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:27.870636 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:27.903797 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:27.905293 [info ] [MainThread]: 
[0m12:17:27.905966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:27.906989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:27.915110 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:27.916225 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:27.916548 [info ] [MainThread]: 
[0m12:17:27.917042 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:27.917674 [info ] [MainThread]: 
[0m12:17:27.918282 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:27.918653 [debug] [MainThread]: Command end result
[0m12:17:27.919443 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.450228, "process_user_time": 1.250096, "process_kernel_time": 0.085623, "process_mem_max_rss": "97836", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:27.920043 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:27.919962 after 0.45 seconds
[0m12:17:27.920050 [debug] [MainThread]: Command end result
[0m12:17:27.920493 [debug] [MainThread]: Flushing usage events
[0m12:17:27.920873 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45602164, "process_user_time": 1.274944, "process_kernel_time": 0.070606, "process_mem_max_rss": "97360", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:27.921528 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:27.921444 after 0.46 seconds
[0m12:17:27.922002 [debug] [MainThread]: Flushing usage events
[0m12:17:27.934619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:27.935504 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:27.936054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:31.382655 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:31.387837 | 0b676100-16ee-4097-b97d-d66a3d201674 ==============================
[0m12:17:31.387837 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:31.388482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:31.389192 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:31.393992 | 4f5f7460-2e98-4160-aeef-fa5d79e8bdf1 ==============================
[0m12:17:31.393992 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:31.394549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:31.549530 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:31.567368 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:31.576882 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:31.594025 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:31.734264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:31.735023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:31.747556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:31.748028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:31.796126 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:31.797570 [info ] [MainThread]: 
[0m12:17:31.800865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:31.801799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:31.809042 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:31.810347 [info ] [MainThread]: 
[0m12:17:31.810686 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:31.812002 [debug] [MainThread]: Command end result
[0m12:17:31.812702 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46457496, "process_user_time": 1.204612, "process_kernel_time": 0.068261, "process_mem_max_rss": "97388", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:31.813234 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:31.813155 after 0.47 seconds
[0m12:17:31.813569 [debug] [MainThread]: Flushing usage events
[0m12:17:31.828171 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:31.828911 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:31.830878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:31.837273 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m12:17:31.841438 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:31.848778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:31.849383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:31.856753 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:31.860245 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:31.861708 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:31.862912 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:31.863711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:31.865695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:31.870924 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:17:31.871914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:31.873795 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:31.875917 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m12:17:31.876983 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:31.878744 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:32.382795 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:32.388031 | 9d9be954-5a00-4c43-a0e7-296cf8eb738d ==============================
[0m12:17:32.388031 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:32.388554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:32.527311 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:32.539084 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:32.670419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:32.670984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:32.729539 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:32.730810 [info ] [MainThread]: 
[0m12:17:32.731185 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:32.732573 [debug] [MainThread]: Command end result
[0m12:17:32.733255 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3865095, "process_user_time": 1.155859, "process_kernel_time": 0.075186, "process_mem_max_rss": "97872", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:32.733747 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:32.733680 after 0.39 seconds
[0m12:17:32.734089 [debug] [MainThread]: Flushing usage events
[0m12:17:32.867442 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:17:32.868990 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:32.870856 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:32.874454 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:17:32.879001 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:32.882935 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:32.890430 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:32.892734 [debug] [MainThread]: On master: BEGIN
[0m12:17:32.893232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:32.952302 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.016 seconds
[0m12:17:32.954434 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:32.959854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:32.960668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:32.967473 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:32.969794 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:32.970531 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:32.971151 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:32.971653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:32.972068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:32.977904 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:17:32.978427 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:32.978874 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:32.981269 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:32.982506 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:32.983081 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:36.884491 [debug] [ThreadPool]: SQL status: BEGIN in 5.021 seconds
[0m12:17:36.885824 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:36.886769 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:36.890739 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:17:36.892956 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:36.893882 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:36.901173 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:36.901845 [debug] [MainThread]: On master: BEGIN
[0m12:17:36.902385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:36.909253 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:17:36.909944 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:36.910568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:36.914123 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m12:17:36.915725 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:36.916219 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:36.916567 [debug] [MainThread]: On master: BEGIN
[0m12:17:36.917076 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:36.917473 [debug] [MainThread]: On master: COMMIT
[0m12:17:36.917873 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:36.918173 [debug] [MainThread]: On master: COMMIT
[0m12:17:36.918557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:36.918902 [debug] [MainThread]: On master: Close
[0m12:17:36.919497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:36.919997 [info ] [MainThread]: 
[0m12:17:36.926914 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m12:17:36.927580 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m12:17:36.928133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m12:17:36.928515 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m12:17:36.935875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m12:17:36.937701 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m12:17:36.967897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m12:17:36.970135 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:17:36.970769 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m12:17:36.971132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:36.977542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:17:36.978323 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:17:36.978774 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m12:17:36.980887 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:17:36.987511 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:17:36.988080 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m12:17:36.989019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:37.000531 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:17:37.001012 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:17:37.001374 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:17:37.002491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:37.007810 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m12:17:37.011101 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:17:37.011450 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m12:17:37.011963 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:37.013902 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m12:17:37.015714 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:17:37.016449 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m12:17:37.017882 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.018298 [debug] [MainThread]: On master: BEGIN
[0m12:17:37.018646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:37.023416 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:17:37.023937 [debug] [MainThread]: On master: COMMIT
[0m12:17:37.024268 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.024573 [debug] [MainThread]: On master: COMMIT
[0m12:17:37.025014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:37.025354 [debug] [MainThread]: On master: Close
[0m12:17:37.025774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:37.026078 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m12:17:37.026368 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:17:37.026701 [info ] [MainThread]: 
[0m12:17:37.027041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m12:17:37.027663 [debug] [MainThread]: Command end result
[0m12:17:37.027987 [info ] [MainThread]: 
[0m12:17:37.028374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:37.028698 [info ] [MainThread]: 
[0m12:17:37.029075 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:37.029900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.682994, "process_user_time": 1.357125, "process_kernel_time": 0.087072, "process_mem_max_rss": "105896", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:17:37.030453 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:37.030363 after 5.68 seconds
[0m12:17:37.030841 [debug] [MainThread]: Flushing usage events
[0m12:17:37.905900 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m12:17:37.907189 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.908065 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:37.912116 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m12:17:37.914577 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:37.915217 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.915584 [debug] [MainThread]: On master: BEGIN
[0m12:17:37.916332 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:37.916893 [debug] [MainThread]: On master: COMMIT
[0m12:17:37.917386 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.917745 [debug] [MainThread]: On master: COMMIT
[0m12:17:37.918275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:37.918781 [debug] [MainThread]: On master: Close
[0m12:17:37.919445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:37.920167 [info ] [MainThread]: 
[0m12:17:37.928023 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m12:17:37.928850 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m12:17:37.929544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m12:17:37.930153 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m12:17:37.938436 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m12:17:37.940068 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m12:17:37.970839 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m12:17:37.972334 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:17:37.972884 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m12:17:37.973322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:37.978552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:17:37.979190 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:17:37.979762 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.city_name = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m12:17:37.980938 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column g.city_name does not exist
LINE 11: join "sales_dw"."dev_raw"."geography" g on g.city_name = e.p...
                                                    ^
HINT:  Perhaps you meant to reference the column "g.cityname".

[0m12:17:37.981515 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: ROLLBACK
[0m12:17:37.982203 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m12:17:37.981864 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m12:17:37.984108 [debug] [Thread-1 (]: Database Error in model staging_product (models/staging/staging_product.sql)
  column g.city_name does not exist
  LINE 11: join "sales_dw"."dev_raw"."geography" g on g.city_name = e.p...
                                                      ^
  HINT:  Perhaps you meant to reference the column "g.cityname".
  compiled code at target/run/dbtcomp/models/staging/staging_product.sql
[0m12:17:37.984540 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:37.985097 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:37.986184 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.staging_product ....................... [[31mERROR[0m in 0.06s]
[0m12:17:37.986847 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m12:17:37.987522 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m12:17:37.988904 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:37.988928 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.989343 [debug] [MainThread]: On master: BEGIN
[0m12:17:37.989390 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:37.989754 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:37.994509 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:17:37.995057 [debug] [MainThread]: On master: COMMIT
[0m12:17:37.995470 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.995387 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:37.996188 [debug] [MainThread]: On master: BEGIN
[0m12:17:37.995914 [debug] [MainThread]: On master: COMMIT
[0m12:17:37.996555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:37.996821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:37.997370 [debug] [MainThread]: On master: Close
[0m12:17:37.998088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:37.998426 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m12:17:37.998740 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:17:38.000275 [info ] [MainThread]: 
[0m12:17:38.000727 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.21 seconds (15.21s).
[0m12:17:38.001611 [debug] [MainThread]: Command end result
[0m12:17:38.002077 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:17:38.002499 [info ] [MainThread]: 
[0m12:17:38.002953 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:38.003400 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:17:38.003920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:38.004289 [info ] [MainThread]: 
[0m12:17:38.004885 [error] [MainThread]:   Database Error in model staging_product (models/staging/staging_product.sql)
  column g.city_name does not exist
  LINE 11: join "sales_dw"."dev_raw"."geography" g on g.city_name = e.p...
                                                      ^
  HINT:  Perhaps you meant to reference the column "g.cityname".
  compiled code at target/run/dbtcomp/models/staging/staging_product.sql
[0m12:17:38.005355 [info ] [MainThread]: 
[0m12:17:38.005789 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:17:38.006796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.660818, "process_user_time": 1.366065, "process_kernel_time": 0.100445, "process_mem_max_rss": "106508", "process_out_blocks": "31", "command_success": false, "process_in_blocks": "0"}
[0m12:17:38.007303 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m12:17:38.007489 [debug] [MainThread]: Command `dbt run` failed at 12:17:38.007409 after 15.66 seconds
[0m12:17:38.007989 [debug] [MainThread]: Flushing usage events
[0m12:17:38.009397 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:38.010096 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:38.010636 [debug] [MainThread]: On master: BEGIN
[0m12:17:38.011445 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:38.011988 [debug] [MainThread]: On master: COMMIT
[0m12:17:38.012345 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:38.012792 [debug] [MainThread]: On master: COMMIT
[0m12:17:38.013431 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:38.013869 [debug] [MainThread]: On master: Close
[0m12:17:38.014451 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:38.014908 [info ] [MainThread]: 
[0m12:17:38.022387 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m12:17:38.023381 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m12:17:38.023989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m12:17:38.024412 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m12:17:38.032613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m12:17:38.034075 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m12:17:38.063505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m12:17:38.065073 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:17:38.065643 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m12:17:38.066053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:38.071219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:17:38.071671 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:17:38.072025 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m12:17:38.073707 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:17:38.079706 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:17:38.080316 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m12:17:38.081068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:38.092016 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:17:38.092671 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:17:38.093140 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:17:38.094711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:38.100256 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m12:17:38.103896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:17:38.104420 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m12:17:38.105161 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:38.107282 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m12:17:38.108993 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m12:17:38.109783 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m12:17:38.111311 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:38.111802 [debug] [MainThread]: On master: BEGIN
[0m12:17:38.112235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:38.117384 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:17:38.117973 [debug] [MainThread]: On master: COMMIT
[0m12:17:38.118323 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:38.118640 [debug] [MainThread]: On master: COMMIT
[0m12:17:38.119023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:38.119402 [debug] [MainThread]: On master: Close
[0m12:17:38.119854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:38.120188 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:17:38.120488 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m12:17:38.120840 [info ] [MainThread]: 
[0m12:17:38.121284 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m12:17:38.121929 [debug] [MainThread]: Command end result
[0m12:17:38.122256 [info ] [MainThread]: 
[0m12:17:38.122732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:38.123103 [info ] [MainThread]: 
[0m12:17:38.123504 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:38.124387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.661354, "process_user_time": 1.401192, "process_kernel_time": 0.093546, "process_mem_max_rss": "106360", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m12:17:38.125070 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:38.124945 after 10.66 seconds
[0m12:17:38.125561 [debug] [MainThread]: Flushing usage events
[0m12:17:44.032856 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:44.038241 | 587d89c2-66e0-4226-8632-f0c235cae350 ==============================
[0m12:17:44.038241 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:44.038877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:44.047832 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:44.054298 | f13de762-ce81-4bd3-b83f-16fc58c193d2 ==============================
[0m12:17:44.054298 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:44.054904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m12:17:44.212366 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:44.216256 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:44.230521 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:44.229479 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:44.376949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:44.377525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:44.383454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:44.384675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:44.438302 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:44.439741 [info ] [MainThread]: 
[0m12:17:44.440465 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:44.441393 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:44.441287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:44.442772 [info ] [MainThread]: 
[0m12:17:44.443688 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:44.445855 [debug] [MainThread]: Command end result
[0m12:17:44.447141 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45400816, "process_user_time": 1.317262, "process_kernel_time": 0.078552, "process_mem_max_rss": "97608", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:44.449386 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:44.449289 after 0.46 seconds
[0m12:17:44.450008 [debug] [MainThread]: Flushing usage events
[0m12:17:44.473283 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:44.474725 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:44.475856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:44.485645 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m12:17:44.488737 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:44.497007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:44.497626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:44.502793 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:44.506445 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:44.506951 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:44.507450 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:44.507900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:44.508455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:44.513324 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:17:44.513852 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:44.514370 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:44.516801 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:17:44.517961 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:44.518524 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:44.940255 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:44.945557 | 64b3f0ca-ca91-418d-a363-9d4e76bb01fa ==============================
[0m12:17:44.945557 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:44.946298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:17:44.987812 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:44.992972 | a4fa2eb9-cad8-41fa-970c-a091e0fed788 ==============================
[0m12:17:44.992972 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:44.997787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:45.101579 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:45.116844 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:45.162504 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:45.182128 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:45.293893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:45.294496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:45.367474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:45.368200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:45.397259 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:45.400732 [info ] [MainThread]: 
[0m12:17:45.401216 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:45.403207 [debug] [MainThread]: Command end result
[0m12:17:45.404511 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49724126, "process_user_time": 1.232138, "process_kernel_time": 0.072242, "process_mem_max_rss": "97344", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:45.405738 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:45.405640 after 0.50 seconds
[0m12:17:45.406228 [debug] [MainThread]: Flushing usage events
[0m12:17:45.484887 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:45.486994 [info ] [MainThread]: 
[0m12:17:45.490969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:45.491982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:45.523610 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:45.525953 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:45.527844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:45.536461 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m12:17:45.537704 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:45.542864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:17:45.543572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:17:45.549714 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:45.551956 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:45.552451 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:45.552995 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:45.553526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:45.554094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:45.560152 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:17:45.560725 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:45.561225 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:45.564261 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m12:17:45.565549 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:45.566212 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:49.530494 [debug] [ThreadPool]: SQL status: BEGIN in 5.021 seconds
[0m12:17:49.532917 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:49.533918 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:17:49.538712 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m12:17:49.542084 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:17:49.543065 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:17:49.552984 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:49.553721 [debug] [MainThread]: On master: BEGIN
[0m12:17:49.554235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:49.561277 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:17:49.561828 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:49.562280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:49.566521 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m12:17:49.568380 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:49.569019 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:49.569454 [debug] [MainThread]: On master: BEGIN
[0m12:17:49.570112 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:49.570708 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.571189 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:49.571572 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.572087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:49.572423 [debug] [MainThread]: On master: Close
[0m12:17:49.573223 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:49.573890 [info ] [MainThread]: 
[0m12:17:49.582825 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m12:17:49.583753 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m12:17:49.584699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m12:17:49.585160 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m12:17:49.593421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m12:17:49.595181 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m12:17:49.630531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m12:17:49.632513 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:17:49.633161 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m12:17:49.633645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:49.639446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:17:49.640048 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:17:49.640552 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m12:17:49.643729 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m12:17:49.650260 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:17:49.650886 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m12:17:49.651846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:49.666969 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:17:49.667612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:17:49.668193 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:17:49.669362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:49.674514 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m12:17:49.678185 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:17:49.678673 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m12:17:49.679355 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:17:49.681867 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m12:17:49.683771 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.10s]
[0m12:17:49.684523 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m12:17:49.686206 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:49.686669 [debug] [MainThread]: On master: BEGIN
[0m12:17:49.687129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:49.693030 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:17:49.693550 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.694128 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:49.694566 [debug] [MainThread]: On master: COMMIT
[0m12:17:49.695112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:49.695557 [debug] [MainThread]: On master: Close
[0m12:17:49.696151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:49.696582 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:17:49.697047 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m12:17:49.697539 [info ] [MainThread]: 
[0m12:17:49.698011 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m12:17:49.698762 [debug] [MainThread]: Command end result
[0m12:17:49.699117 [info ] [MainThread]: 
[0m12:17:49.699618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:49.700134 [info ] [MainThread]: 
[0m12:17:49.700620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:49.701697 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.698052, "process_user_time": 1.473778, "process_kernel_time": 0.107691, "process_mem_max_rss": "106376", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:17:49.702512 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:49.702376 after 5.70 seconds
[0m12:17:49.703017 [debug] [MainThread]: Flushing usage events
[0m12:17:50.562824 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m12:17:50.565355 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:50.565993 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:17:50.571772 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:17:50.574922 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:17:50.575780 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:17:50.584453 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:50.585131 [debug] [MainThread]: On master: BEGIN
[0m12:17:50.585744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:50.591473 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:17:50.592131 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:50.592691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:50.596332 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m12:17:50.599035 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:50.599699 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:50.600172 [debug] [MainThread]: On master: BEGIN
[0m12:17:50.601111 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:50.601722 [debug] [MainThread]: On master: COMMIT
[0m12:17:50.602175 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:50.602660 [debug] [MainThread]: On master: COMMIT
[0m12:17:50.603191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:50.603722 [debug] [MainThread]: On master: Close
[0m12:17:50.604441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:50.605057 [info ] [MainThread]: 
[0m12:17:50.613073 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m12:17:50.614184 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m12:17:50.615045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m12:17:50.615690 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m12:17:50.623771 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m12:17:50.625306 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m12:17:50.659763 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m12:17:50.661573 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:17:50.662126 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m12:17:50.662646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:50.667818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:17:50.668369 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:17:50.668876 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m12:17:50.671274 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m12:17:50.677640 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:17:50.678211 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m12:17:50.679131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:17:50.692344 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m12:17:50.692884 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:17:50.693341 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m12:17:50.694459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:17:50.699767 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m12:17:50.703578 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:17:50.704014 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m12:17:50.704713 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:17:50.706993 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m12:17:50.708934 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.09s]
[0m12:17:50.709900 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m12:17:50.711542 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:50.712055 [debug] [MainThread]: On master: BEGIN
[0m12:17:50.712507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:50.717409 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:17:50.717884 [debug] [MainThread]: On master: COMMIT
[0m12:17:50.718456 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:50.718865 [debug] [MainThread]: On master: COMMIT
[0m12:17:50.719408 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:50.719858 [debug] [MainThread]: On master: Close
[0m12:17:50.720460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:50.720838 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:17:50.721171 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m12:17:50.721532 [info ] [MainThread]: 
[0m12:17:50.721897 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m12:17:50.722549 [debug] [MainThread]: Command end result
[0m12:17:50.722894 [info ] [MainThread]: 
[0m12:17:50.723336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:50.723681 [info ] [MainThread]: 
[0m12:17:50.724020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:17:50.724883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7725663, "process_user_time": 1.445402, "process_kernel_time": 0.090274, "process_mem_max_rss": "106376", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:17:50.725495 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:50.725419 after 5.77 seconds
[0m12:17:50.725874 [debug] [MainThread]: Flushing usage events
[0m12:17:56.965784 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:56.971020 | b72b25c3-b4ca-4a42-a5f3-5ab6d7a922e7 ==============================
[0m12:17:56.971020 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:56.971713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:57.184873 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:57.260516 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:57.432418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:57.432921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:57.508640 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:57.510075 [info ] [MainThread]: 
[0m12:17:57.510478 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:57.512191 [debug] [MainThread]: Command end result
[0m12:17:57.512938 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.588416, "process_user_time": 1.466669, "process_kernel_time": 0.092356, "process_mem_max_rss": "97604", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:57.513532 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:57.513457 after 0.59 seconds
[0m12:17:57.514401 [debug] [MainThread]: Flushing usage events
[0m12:17:57.984739 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:57.990138 | f2fdfea1-f56c-408c-b5bf-7d45486235ef ==============================
[0m12:17:57.990138 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:57.990798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:58.013451 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:17:58.021219 | e61eb6b3-cdba-4059-83c4-e9d4c6838714 ==============================
[0m12:17:58.021219 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:17:58.023442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:58.165597 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:58.178766 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:58.209024 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:17:58.232911 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:17:58.422372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:58.423068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:58.430317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:58.431076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:58.475855 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:58.477389 [info ] [MainThread]: 
[0m12:17:58.478066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:58.478979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:17:58.496482 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:17:58.498425 [info ] [MainThread]: 
[0m12:17:58.499566 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:17:58.502382 [debug] [MainThread]: Command end result
[0m12:17:58.503101 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5403156, "process_user_time": 1.411725, "process_kernel_time": 0.101991, "process_mem_max_rss": "97744", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:17:58.503751 [debug] [MainThread]: Command `dbt test` succeeded at 12:17:58.503643 after 0.54 seconds
[0m12:17:58.504115 [debug] [MainThread]: Flushing usage events
[0m12:17:58.509458 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:17:58.510371 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:17:58.512319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:58.519878 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m12:17:58.521677 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:17:58.527193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:17:58.527797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:17:58.534186 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:17:58.536129 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:17:58.538333 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:17:58.538964 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:17:58.540336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:58.542311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:03.549948 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m12:18:03.551359 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:18:03.552131 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:18:03.555133 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m12:18:03.555696 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:18:03.556346 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:18:03.558193 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:18:03.558951 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:18:03.559699 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:18:03.562613 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m12:18:03.564123 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:18:03.564852 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:18:03.572365 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:03.579700 [debug] [MainThread]: On master: BEGIN
[0m12:18:03.580205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:08.592674 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m12:18:08.593531 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:08.593988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:08.597428 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m12:18:08.599398 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:08.600015 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:08.600473 [debug] [MainThread]: On master: BEGIN
[0m12:18:08.601205 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:18:08.601731 [debug] [MainThread]: On master: COMMIT
[0m12:18:08.602123 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:08.602504 [debug] [MainThread]: On master: COMMIT
[0m12:18:08.602943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:08.603312 [debug] [MainThread]: On master: Close
[0m12:18:08.603976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:08.604574 [info ] [MainThread]: 
[0m12:18:08.612270 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m12:18:08.612998 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m12:18:08.613604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m12:18:08.614008 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m12:18:08.632375 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m12:18:08.633792 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m12:18:08.661913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m12:18:08.663669 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:18:08.664285 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m12:18:08.664831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:08.669812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:18:08.670368 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:18:08.670838 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m12:18:08.673573 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:18:08.679766 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:18:08.680259 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m12:18:08.681083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:18:08.692130 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m12:18:08.692563 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:18:08.692904 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m12:18:08.693955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:18:08.698648 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m12:18:08.701999 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:18:08.702416 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m12:18:08.702979 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:18:08.705089 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m12:18:08.706688 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m12:18:08.707345 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m12:18:08.708674 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:08.709030 [debug] [MainThread]: On master: BEGIN
[0m12:18:08.709365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:08.713977 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:18:08.714479 [debug] [MainThread]: On master: COMMIT
[0m12:18:08.714882 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:08.715295 [debug] [MainThread]: On master: COMMIT
[0m12:18:08.715856 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:08.716299 [debug] [MainThread]: On master: Close
[0m12:18:08.716789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:08.717176 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:18:08.717520 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m12:18:08.717972 [info ] [MainThread]: 
[0m12:18:08.718501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m12:18:08.719160 [debug] [MainThread]: Command end result
[0m12:18:08.719502 [info ] [MainThread]: 
[0m12:18:08.719936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:08.720275 [info ] [MainThread]: 
[0m12:18:08.720607 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:18:08.721480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.776008, "process_user_time": 1.536232, "process_kernel_time": 0.109515, "process_mem_max_rss": "106272", "process_out_blocks": "35", "process_in_blocks": "0"}
[0m12:18:08.722065 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:08.721975 after 10.78 seconds
[0m12:18:08.722523 [debug] [MainThread]: Flushing usage events
[0m12:18:15.912981 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:18:15.919068 | 977da815-7928-4e6e-82eb-58b1b5d38513 ==============================
[0m12:18:15.919068 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:18:15.919740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:15.940047 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:18:15.946322 | 3d06070f-b538-4b0d-b812-95e27ec33724 ==============================
[0m12:18:15.946322 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:18:15.947529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:18:16.089311 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:18:16.104616 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:18:16.117442 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:18:16.142062 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:18:16.294241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:16.294803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:16.324554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:16.325092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:16.371887 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:18:16.373376 [info ] [MainThread]: 
[0m12:18:16.373756 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:18:16.375120 [debug] [MainThread]: Command end result
[0m12:18:16.376828 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5049774, "process_user_time": 1.270142, "process_kernel_time": 0.064158, "process_mem_max_rss": "97488", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:18:16.378484 [debug] [MainThread]: Command `dbt test` succeeded at 12:18:16.378390 after 0.51 seconds
[0m12:18:16.378844 [debug] [MainThread]: Flushing usage events
[0m12:18:16.391651 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:18:16.396411 [info ] [MainThread]: 
[0m12:18:16.397065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:16.397983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:18:16.427522 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:18:16.428193 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:18:16.428671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:21.447682 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.019 seconds
[0m12:18:21.450912 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:18:21.459330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:18:21.460473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:18:21.467449 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:18:21.470499 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:18:21.471137 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:18:21.472037 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:18:21.472666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:21.473185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:21.479687 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:18:21.480359 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:18:21.480914 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:18:21.484062 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:18:21.485563 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:18:21.486112 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:18:26.497303 [debug] [ThreadPool]: SQL status: BEGIN in 5.023 seconds
[0m12:18:26.500552 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:18:26.501586 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:18:26.507036 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m12:18:26.510655 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:18:26.511534 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:18:26.523547 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:26.524219 [debug] [MainThread]: On master: BEGIN
[0m12:18:26.524699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:26.530234 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:18:26.530751 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:26.531288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:26.535130 [debug] [MainThread]: SQL status: SELECT 10 in 0.003 seconds
[0m12:18:26.537422 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:26.538160 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:26.538562 [debug] [MainThread]: On master: BEGIN
[0m12:18:26.539204 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:18:26.539732 [debug] [MainThread]: On master: COMMIT
[0m12:18:26.540254 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:26.540801 [debug] [MainThread]: On master: COMMIT
[0m12:18:26.541458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:26.541896 [debug] [MainThread]: On master: Close
[0m12:18:26.542671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:26.543279 [info ] [MainThread]: 
[0m12:18:26.553335 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m12:18:26.554194 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m12:18:26.554821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m12:18:26.555249 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m12:18:26.563868 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m12:18:26.565363 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m12:18:26.601261 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m12:18:26.603138 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:18:26.603623 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m12:18:26.604270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:26.612102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:18:26.612743 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:18:26.614292 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m12:18:27.792450 [debug] [Thread-1 (]: SQL status: SELECT 258888 in 1.177 seconds
[0m12:18:27.800088 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:18:27.800795 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:18:27.801863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:18:27.817017 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m12:18:27.817688 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:18:27.818218 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m12:18:27.824897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:18:27.830125 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m12:18:27.834006 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:18:27.834432 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m12:18:27.834940 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:18:27.837720 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m12:18:27.839534 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 258888[0m in 1.28s]
[0m12:18:27.840294 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m12:18:27.841582 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:27.841949 [debug] [MainThread]: On master: BEGIN
[0m12:18:27.842249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:27.847081 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:18:27.847515 [debug] [MainThread]: On master: COMMIT
[0m12:18:27.847828 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:27.848161 [debug] [MainThread]: On master: COMMIT
[0m12:18:27.848516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:27.848803 [debug] [MainThread]: On master: Close
[0m12:18:27.849220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:27.849475 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m12:18:27.849757 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:18:27.850083 [info ] [MainThread]: 
[0m12:18:27.850589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m12:18:27.851291 [debug] [MainThread]: Command end result
[0m12:18:27.851728 [info ] [MainThread]: 
[0m12:18:27.852219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:27.852596 [info ] [MainThread]: 
[0m12:18:27.852935 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:18:27.854107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.977244, "process_user_time": 1.45559, "process_kernel_time": 0.099244, "process_mem_max_rss": "106488", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:18:27.854828 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:27.854744 after 11.98 seconds
[0m12:18:27.855432 [debug] [MainThread]: Flushing usage events
[0m12:18:35.447075 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:18:35.454034 | 863828c6-d844-40b1-af57-38711fbfb399 ==============================
[0m12:18:35.454034 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:18:35.454655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:35.608394 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:18:35.621489 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:18:35.759538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:35.760082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:35.822073 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:18:35.823736 [info ] [MainThread]: 
[0m12:18:35.824226 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:18:35.825753 [debug] [MainThread]: Command end result
[0m12:18:35.826482 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41486278, "process_user_time": 1.253823, "process_kernel_time": 0.104234, "process_mem_max_rss": "97820", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:18:35.827064 [debug] [MainThread]: Command `dbt test` succeeded at 12:18:35.826992 after 0.42 seconds
[0m12:18:35.827468 [debug] [MainThread]: Flushing usage events
[0m12:26:46.333957 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:26:46.339678 | 813aa046-b6fc-4963-a35d-56144cbb34b2 ==============================
[0m12:26:46.339678 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:26:46.344742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:26:46.447300 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m12:26:46.449867 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m12:26:46.467857 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-li_eqkon'
[0m12:26:46.468471 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m12:26:46.469515 [debug] [MainThread]: Creating symlink to local dependency.
[0m12:26:46.470156 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m12:26:46.471158 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.18134129, "process_user_time": 1.134781, "process_kernel_time": 0.142733, "process_mem_max_rss": "106016", "process_in_blocks": "136", "process_out_blocks": "11"}
[0m12:26:46.471829 [debug] [MainThread]: Command `dbt deps` succeeded at 12:26:46.471689 after 0.18 seconds
[0m12:26:46.472518 [debug] [MainThread]: Flushing usage events
[0m12:26:53.339299 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:26:53.344335 | b5789615-a9e9-4ddb-8e84-4b58ae250a25 ==============================
[0m12:26:53.344335 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:26:53.344944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:53.516658 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:26:53.531193 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:26:53.535302 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:26:55.205201 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:26:55.207191 [info ] [MainThread]: 
[0m12:26:55.207910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:26:55.208812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:26:55.248352 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:26:55.249101 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:26:55.249560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:55.258320 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m12:26:55.259765 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:26:55.260572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m12:26:55.261231 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m12:26:55.266913 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:26:55.267449 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m12:26:55.267960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:55.275435 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:26:55.276431 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:26:55.276952 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m12:26:55.278122 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:26:55.279139 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:26:55.279805 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:26:55.280406 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:26:55.281469 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:26:55.281953 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m12:26:55.287906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m12:26:55.288536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:26:55.295680 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:26:55.298567 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:26:55.299185 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:26:55.299740 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:26:55.300234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:55.300694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:55.305450 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:26:55.305935 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:26:55.306478 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:26:55.309741 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:26:55.310790 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:26:55.311286 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:27:00.307952 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:27:00.308779 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:27:00.312104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:27:00.314574 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:27:00.316129 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:27:00.316724 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:27:00.326895 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:00.327469 [debug] [MainThread]: On master: BEGIN
[0m12:27:00.327876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:05.346928 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m12:27:05.351456 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:05.352460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:27:05.360815 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m12:27:05.367445 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:05.368119 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:05.368579 [debug] [MainThread]: On master: BEGIN
[0m12:27:05.369417 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:27:05.369886 [debug] [MainThread]: On master: COMMIT
[0m12:27:05.370680 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:05.371509 [debug] [MainThread]: On master: COMMIT
[0m12:27:05.373037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:27:05.373643 [debug] [MainThread]: On master: Close
[0m12:27:05.374688 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:27:05.375741 [info ] [MainThread]: 
[0m12:27:05.389440 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m12:27:05.390868 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m12:27:05.391831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m12:27:05.392475 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m12:27:05.393169 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m12:27:05.445280 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:27:05.446692 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m12:27:05.447384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:05.454058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:27:05.455435 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:27:05.455944 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m12:27:05.459276 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m12:27:05.543792 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:27:05.544475 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m12:27:05.547182 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m12:27:05.556274 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m12:27:05.578056 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:27:05.578613 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:27:05.578994 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:27:05.580334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:27:05.583170 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m12:27:05.585414 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.19s]
[0m12:27:05.586312 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m12:27:05.590590 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:05.591128 [debug] [MainThread]: On master: BEGIN
[0m12:27:05.591569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:05.596777 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:27:05.597332 [debug] [MainThread]: On master: COMMIT
[0m12:27:05.597738 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:05.598185 [debug] [MainThread]: On master: COMMIT
[0m12:27:05.598788 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:27:05.599203 [debug] [MainThread]: On master: Close
[0m12:27:05.599766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:05.600196 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:27:05.600607 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m12:27:05.601105 [info ] [MainThread]: 
[0m12:27:05.601710 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m12:27:05.602548 [debug] [MainThread]: Command end result
[0m12:27:05.675967 [info ] [MainThread]: 
[0m12:27:05.676671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:05.677099 [info ] [MainThread]: 
[0m12:27:05.678137 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:27:05.679608 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.441851, "process_user_time": 2.942871, "process_kernel_time": 0.132761, "process_mem_max_rss": "113700", "process_in_blocks": "24", "process_out_blocks": "3516"}
[0m12:27:05.683637 [debug] [MainThread]: Command `dbt seed` succeeded at 12:27:05.683498 after 12.45 seconds
[0m12:27:05.684168 [debug] [MainThread]: Flushing usage events
[0m12:28:10.137122 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:28:10.132914 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:10.143845 | 75660be2-fc0d-442e-9fbd-5494ab329775 ==============================
[0m12:28:10.143845 [info ] [MainThread]: Running with dbt=1.8.2


============================== 12:28:10.144876 | 2e5c2753-5ef4-4dd5-9f78-d16b00f9578e ==============================
[0m12:28:10.144876 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:10.146230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:10.147564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:28:10.153420 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:10.163564 | 0f90fa46-d8eb-4586-a0e7-39287c4f4a9d ==============================
[0m12:28:10.163564 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:10.165664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:10.193629 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:10.223259 | db67bdbe-5983-4cb6-a39f-ac5e1cf2efaa ==============================
[0m12:28:10.223259 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:10.227892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m12:28:10.265853 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:10.279107 | f3b1aab7-18e8-4ae9-afa9-e985e0bc192d ==============================
[0m12:28:10.279107 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:10.281027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:28:10.275188 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:10.288292 | ef80a478-ba0b-45da-8ce1-f18358a1faa7 ==============================
[0m12:28:10.288292 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:10.291595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:10.282928 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:10.298047 | f45910b5-8edc-467e-a8af-7131d9aac4bd ==============================
[0m12:28:10.298047 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:10.301229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:10.443577 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:10.468137 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:10.485301 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:10.488425 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:10.510019 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:10.546970 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:10.578220 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:10.636738 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:10.659137 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:10.669653 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:10.671754 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:10.688333 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:10.690189 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:28:10.728262 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:10.724027 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:10.729689 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:10.751459 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:10.753025 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:28:10.763544 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:10.764988 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:28:10.865257 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:10.866489 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:28:10.899051 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:10.899936 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:28:10.909124 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:10.910789 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:28:10.915727 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:28:10.916885 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:28:13.450663 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:13.456185 [info ] [MainThread]: 
[0m12:28:13.461117 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:13.477392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:13.527181 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:13.531904 [info ] [MainThread]: 
[0m12:28:13.533507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:13.535853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:13.544944 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:13.547211 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:13.552500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.578609 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:13.579571 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:13.580439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.591321 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m12:28:13.594354 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:13.597663 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:13.598477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:28:13.602747 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:28:13.604730 [info ] [MainThread]: 
[0m12:28:13.608485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:13.612184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:13.623056 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:28:13.623741 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:28:13.626503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:13.636866 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:28:13.643234 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:28:13.645856 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:28:13.648381 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:28:13.650018 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:28:13.651192 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:28:13.652224 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:28:13.655412 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m12:28:13.656343 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:28:13.666719 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:13.667439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m12:28:13.667907 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:13.668963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.669015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:13.676206 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:13.684430 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:13.686996 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:13.688394 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:13.690730 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.022 seconds
[0m12:28:13.689851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:13.694924 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:13.691891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.704875 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:28:13.708733 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:13.709531 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m12:28:13.711417 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:13.713016 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:13.719698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:28:13.719945 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:13.721241 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m12:28:13.730075 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:13.732120 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m12:28:13.720772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:13.734327 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:13.736983 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:13.733563 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:13.743153 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:13.742151 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:13.744502 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:13.747642 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:13.749606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.748784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:13.756355 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:13.757516 [debug] [MainThread]: On master: BEGIN
[0m12:28:13.758554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:13.764298 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:28:13.765679 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:13.766767 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:13.768988 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:28:13.770479 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:13.771541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:13.774036 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:28:13.777876 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:13.783328 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:13.781068 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m12:28:13.788678 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:13.789927 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:13.791234 [debug] [MainThread]: On master: BEGIN
[0m12:28:13.793281 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:28:13.794506 [debug] [MainThread]: On master: COMMIT
[0m12:28:13.795771 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:13.797118 [debug] [MainThread]: On master: COMMIT
[0m12:28:13.798037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:13.798769 [debug] [MainThread]: On master: Close
[0m12:28:13.800658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:13.803072 [info ] [MainThread]: 
[0m12:28:13.815124 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m12:28:13.817331 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m12:28:13.820555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m12:28:13.821697 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m12:28:13.824698 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:13.830194 [info ] [MainThread]: 
[0m12:28:13.831315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:13.833710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:13.833361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m12:28:13.839023 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m12:28:13.871009 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:13.872937 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:13.877110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.886358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m12:28:13.888665 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m12:28:13.891150 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:13.891775 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:28:13.894564 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m12:28:13.896315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:13.904061 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:13.910672 [info ] [MainThread]: 
[0m12:28:13.907793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:28:13.913776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:13.916169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m12:28:13.918446 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:28:13.918695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:13.921787 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m12:28:13.912861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:28:13.930975 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:13.939261 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m12:28:13.939719 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:13.941082 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:13.942472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:13.945679 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:13.947495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.951695 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:28:13.953512 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m12:28:13.955195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:13.957429 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:28:13.962159 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:28:13.963317 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:13.964406 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:13.966098 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:13.968988 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:13.978541 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:13.976467 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:28:13.975320 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:13.982840 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:13.986105 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:28:13.990517 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:28:13.989912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:13.978956 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m12:28:13.993493 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:28:13.990514 [info ] [MainThread]: 
[0m12:28:13.989396 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:13.997082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:13.996384 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:13.997747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:13.998183 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:13.998922 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:13.998939 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:14.012398 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m12:28:14.014923 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.019102 [debug] [MainThread]: On master: BEGIN
[0m12:28:14.020829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:14.024456 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:28:14.027260 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m12:28:14.029654 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:14.033362 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:28:14.035504 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.037237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:14.037685 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m12:28:14.043671 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.22s]
[0m12:28:14.046139 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m12:28:14.049788 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:14.049520 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m12:28:14.051340 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:14.052718 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:14.053064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:14.054157 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.054854 [debug] [MainThread]: On master: BEGIN
[0m12:28:14.054636 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.055463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:14.055908 [debug] [MainThread]: On master: BEGIN
[0m12:28:14.060418 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:28:14.062171 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m12:28:14.062226 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.064007 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.064897 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.065255 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:14.065940 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:28:14.066580 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:28:14.067942 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.068798 [debug] [MainThread]: On master: Close
[0m12:28:14.069303 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.069969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:14.071552 [info ] [MainThread]: 
[0m12:28:14.071149 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.073538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:28:14.076693 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:14.078161 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:28:14.078961 [debug] [MainThread]: On master: Close
[0m12:28:14.080085 [info ] [MainThread]: 
[0m12:28:14.080726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:14.081299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:14.081949 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:28:14.074361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:14.083057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:14.083137 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m12:28:14.084785 [info ] [MainThread]: 
[0m12:28:14.085883 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m12:28:14.086623 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m12:28:14.086820 [debug] [MainThread]: Command end result
[0m12:28:14.087478 [info ] [MainThread]: 
[0m12:28:14.087552 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m12:28:14.083046 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:14.088131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:14.088857 [info ] [MainThread]: 
[0m12:28:14.089357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:14.088860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m12:28:14.086972 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:14.090411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.090338, "process_user_time": 5.168939, "process_kernel_time": 0.314987, "process_mem_max_rss": "113024", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m12:28:14.091177 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:14.091089 after 4.09 seconds
[0m12:28:14.088872 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:14.090840 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m12:28:14.091730 [debug] [MainThread]: Flushing usage events
[0m12:28:14.090877 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:14.092694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:14.097035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:14.106011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m12:28:14.109133 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:28:14.109035 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m12:28:14.109616 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:28:14.111982 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:14.114025 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:14.110354 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:14.119334 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:14.120281 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:28:14.122530 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:14.122961 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:14.123319 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:14.123333 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:28:14.124142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:14.124157 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:14.126629 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:14.128565 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:14.135442 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m12:28:14.136389 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.137064 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:14.137861 [debug] [MainThread]: On master: BEGIN
[0m12:28:14.138906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:14.145769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:28:14.147593 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:28:14.148371 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.148983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:14.150303 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m12:28:14.153054 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:28:14.154161 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m12:28:14.147302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:14.154873 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m12:28:14.155845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:14.157880 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:14.154026 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:14.158668 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.159850 [debug] [MainThread]: On master: BEGIN
[0m12:28:14.158145 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:14.161237 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:28:14.159640 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:14.161865 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.162378 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.161120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:14.162949 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.162233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:14.164005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:14.163371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:14.164788 [debug] [MainThread]: On master: Close
[0m12:28:14.165609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:14.166167 [info ] [MainThread]: 
[0m12:28:14.171086 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:28:14.173156 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:14.173719 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:14.174333 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m12:28:14.175540 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m12:28:14.176633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m12:28:14.176741 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:28:14.177221 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m12:28:14.178323 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:14.178948 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:14.186957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m12:28:14.193432 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m12:28:14.231472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m12:28:14.241393 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:28:14.242065 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m12:28:14.243602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:14.249153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:28:14.250176 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:28:14.250928 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m12:28:14.253925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:28:14.262278 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:28:14.263170 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m12:28:14.264092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:14.278409 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:28:14.279280 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:28:14.279738 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:28:14.281293 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:28:14.290561 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m12:28:14.297284 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:28:14.298290 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m12:28:14.299989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:28:14.303317 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m12:28:14.305364 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m12:28:14.307323 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m12:28:14.310053 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.311103 [debug] [MainThread]: On master: BEGIN
[0m12:28:14.311538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:14.323978 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:28:14.324683 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.325504 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:14.329190 [debug] [MainThread]: On master: COMMIT
[0m12:28:14.330138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:14.330773 [debug] [MainThread]: On master: Close
[0m12:28:14.331509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:14.332160 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m12:28:14.332553 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:28:14.332957 [info ] [MainThread]: 
[0m12:28:14.333437 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m12:28:14.334753 [debug] [MainThread]: Command end result
[0m12:28:14.335335 [info ] [MainThread]: 
[0m12:28:14.335851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:14.336282 [info ] [MainThread]: 
[0m12:28:14.336796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:14.337873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1708446, "process_user_time": 5.037371, "process_kernel_time": 0.381554, "process_mem_max_rss": "112724", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:28:14.338548 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:14.338453 after 4.17 seconds
[0m12:28:14.339094 [debug] [MainThread]: Flushing usage events
[0m12:28:18.562964 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m12:28:18.570855 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:18.579052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:28:18.579832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:18.588665 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:18.591340 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:18.591897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:18.590886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:18.592992 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:18.593552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:18.598983 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:28:18.599721 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:18.600495 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:18.601135 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:28:18.601844 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:18.602399 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:18.604264 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:28:18.606545 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:18.607070 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:28:18.607871 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:18.610106 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:18.612200 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:18.621676 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:18.622590 [debug] [MainThread]: On master: BEGIN
[0m12:28:18.623104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:18.771868 [debug] [ThreadPool]: SQL status: BEGIN in 5.023 seconds
[0m12:28:18.773395 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:18.777370 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:18.788440 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m12:28:18.795291 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:18.802498 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:18.812474 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:18.813046 [debug] [MainThread]: On master: BEGIN
[0m12:28:18.813435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:18.818670 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:28:18.819410 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:18.820315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:18.823713 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m12:28:18.825230 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:18.825823 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:18.826206 [debug] [MainThread]: On master: BEGIN
[0m12:28:18.826673 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:18.827139 [debug] [MainThread]: On master: COMMIT
[0m12:28:18.827622 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:18.827985 [debug] [MainThread]: On master: COMMIT
[0m12:28:18.828386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:18.828738 [debug] [MainThread]: On master: Close
[0m12:28:18.829332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:18.829989 [info ] [MainThread]: 
[0m12:28:18.838150 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m12:28:18.838826 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m12:28:18.839392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m12:28:18.839816 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m12:28:18.847922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m12:28:18.849337 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m12:28:18.879619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m12:28:18.881181 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:28:18.881723 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m12:28:18.882162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:18.887353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:28:18.887927 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:28:18.888369 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m12:28:18.889793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:28:18.895651 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:28:18.896136 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m12:28:18.896878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:18.907654 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:28:18.908111 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:28:18.908538 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:28:18.911246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:28:18.916205 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m12:28:18.919449 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:28:18.919868 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m12:28:18.920514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:28:18.923011 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m12:28:18.924584 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m12:28:18.925235 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m12:28:18.926382 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:18.926710 [debug] [MainThread]: On master: BEGIN
[0m12:28:18.927028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:19.008507 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.018 seconds
[0m12:28:19.012133 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:19.022198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:28:19.023668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:19.033103 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:19.035962 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:19.036574 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:19.037168 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:19.037734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:19.038231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:19.042962 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:28:19.043498 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:19.043983 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:19.051301 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m12:28:19.053302 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:19.054014 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:19.163506 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m12:28:19.165065 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:28:19.165725 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m12:28:19.167500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:28:19.168877 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m12:28:19.173067 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:19.173873 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:19.176573 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m12:28:19.181987 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:19.181494 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:28:19.182680 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m12:28:19.182688 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:19.183781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:19.191234 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.195989 [debug] [MainThread]: On master: BEGIN
[0m12:28:19.196782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:19.198563 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:28:19.199234 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:28:19.199738 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:28:19.200915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:28:19.201551 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:28:19.205197 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.206868 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m12:28:19.207018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:19.210557 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:28:19.211226 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m12:28:19.211999 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:28:19.213595 [debug] [MainThread]: SQL status: SELECT 4 in 0.002 seconds
[0m12:28:19.218140 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:19.219349 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m12:28:19.220029 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.220976 [debug] [MainThread]: On master: BEGIN
[0m12:28:19.221725 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.13s]
[0m12:28:19.222642 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:19.222894 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m12:28:19.223532 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.224104 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.224702 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.225287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:19.225775 [debug] [MainThread]: On master: Close
[0m12:28:19.225685 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.226476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:19.227014 [debug] [MainThread]: On master: BEGIN
[0m12:28:19.227679 [info ] [MainThread]: 
[0m12:28:19.228148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:19.235943 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m12:28:19.236454 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:28:19.236779 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m12:28:19.237003 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.237560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m12:28:19.237888 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.238224 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m12:28:19.238483 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.240464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:19.241260 [debug] [MainThread]: On master: Close
[0m12:28:19.241844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:19.242766 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m12:28:19.245128 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:28:19.245645 [info ] [MainThread]: 
[0m12:28:19.246105 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m12:28:19.246972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m12:28:19.246917 [debug] [MainThread]: Command end result
[0m12:28:19.248474 [info ] [MainThread]: 
[0m12:28:19.250515 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m12:28:19.249842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:19.251982 [info ] [MainThread]: 
[0m12:28:19.252446 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:19.253644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.121932, "process_user_time": 5.152183, "process_kernel_time": 0.312064, "process_mem_max_rss": "112676", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m12:28:19.254718 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:19.254593 after 9.12 seconds
[0m12:28:19.255323 [debug] [MainThread]: Flushing usage events
[0m12:28:19.304399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m12:28:19.320072 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:28:19.325089 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m12:28:19.336868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:19.350827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m12:28:19.351660 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:28:19.352696 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m12:28:19.354510 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:28:19.360119 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:28:19.360847 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m12:28:19.362008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:28:19.374598 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:28:19.376994 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:28:19.379014 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:28:19.380367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:28:19.386705 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m12:28:19.393127 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:28:19.394395 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m12:28:19.396778 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:28:19.402331 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m12:28:19.405956 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.17s]
[0m12:28:19.406963 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m12:28:19.408941 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.409693 [debug] [MainThread]: On master: BEGIN
[0m12:28:19.412954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:19.423351 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:28:19.424020 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.424417 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:19.424822 [debug] [MainThread]: On master: COMMIT
[0m12:28:19.426276 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:28:19.428029 [debug] [MainThread]: On master: Close
[0m12:28:19.429071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:19.431200 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m12:28:19.433086 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:28:19.434651 [info ] [MainThread]: 
[0m12:28:19.435762 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m12:28:19.438405 [debug] [MainThread]: Command end result
[0m12:28:19.439173 [info ] [MainThread]: 
[0m12:28:19.439751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:19.440549 [info ] [MainThread]: 
[0m12:28:19.441870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:19.444145 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.24625, "process_user_time": 5.035177, "process_kernel_time": 0.367914, "process_mem_max_rss": "112740", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:28:19.445597 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:19.445469 after 9.25 seconds
[0m12:28:19.446188 [debug] [MainThread]: Flushing usage events
[0m12:28:21.993124 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:21.999472 | 811b6fde-5995-4c9a-9c91-bd26089375cd ==============================
[0m12:28:21.999472 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:22.000402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:22.002645 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:22.009805 | 4622edd0-9c89-4fa3-a303-f708f0734a19 ==============================
[0m12:28:22.009805 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:22.011103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m12:28:22.027155 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:22.040481 | 7fa736e4-caca-4950-8f63-84f4cb59af7a ==============================
[0m12:28:22.040481 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:22.043573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:22.078742 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:22.091132 | 5dc286f4-90dd-4668-ac38-18491710d63b ==============================
[0m12:28:22.091132 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:22.092644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m12:28:22.303710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:22.304247 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:22.309247 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:22.331322 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:22.333143 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:22.334163 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:22.353614 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:22.359797 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:22.581421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:22.582385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:22.583013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:22.587281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:22.615200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:22.616154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:22.619976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:22.620617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:22.690240 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:22.701211 [info ] [MainThread]: 
[0m12:28:22.702259 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:22.705072 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:22.709151 [info ] [MainThread]: 
[0m12:28:22.725566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:22.726289 [debug] [MainThread]: Command end result
[0m12:28:22.732795 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7664137, "process_user_time": 1.627548, "process_kernel_time": 0.124186, "process_mem_max_rss": "97484", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:22.734227 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:22.734036 after 0.77 seconds
[0m12:28:22.733906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:22.734958 [debug] [MainThread]: Flushing usage events
[0m12:28:22.741280 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:22.742636 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:22.745042 [info ] [MainThread]: 
[0m12:28:22.746985 [info ] [MainThread]: 
[0m12:28:22.746750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:22.747986 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:22.750421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:22.750585 [debug] [MainThread]: Command end result
[0m12:28:22.754757 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8062547, "process_user_time": 1.668338, "process_kernel_time": 0.128645, "process_mem_max_rss": "97848", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:22.757427 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:22.757158 after 0.81 seconds
[0m12:28:22.759011 [debug] [MainThread]: Flushing usage events
[0m12:28:22.790426 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:22.793312 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:22.796149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:22.798100 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:22.799060 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:22.800754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:22.809089 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m12:28:22.811144 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:22.812460 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m12:28:22.817867 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:22.820600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:28:22.824058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:28:22.821976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:28:22.830198 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:22.824807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:28:22.834309 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:22.835519 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:22.836323 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:22.839962 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:22.840100 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:22.840727 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:22.841946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:22.842146 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:22.842725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:22.843173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:22.844528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:22.852698 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:28:22.852438 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:28:22.854163 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:22.853650 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:28:22.855443 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:22.855032 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:22.855897 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:22.857428 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:22.856730 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:22.859207 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m12:28:22.861762 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:22.860269 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:28:22.861976 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m12:28:22.863128 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:22.863926 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:22.865422 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:22.867069 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:22.867657 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:22.875000 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:22.881144 [debug] [MainThread]: On master: BEGIN
[0m12:28:22.882067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:23.629652 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m12:28:23.635437 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:23.636084 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:23.645248 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m12:28:23.649244 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:23.652156 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:23.652629 [debug] [MainThread]: On master: BEGIN
[0m12:28:23.653362 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:23.653946 [debug] [MainThread]: On master: COMMIT
[0m12:28:23.654373 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:23.654761 [debug] [MainThread]: On master: COMMIT
[0m12:28:23.655234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:23.656174 [debug] [MainThread]: On master: Close
[0m12:28:23.657924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:23.659131 [info ] [MainThread]: 
[0m12:28:23.669429 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m12:28:23.670342 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m12:28:23.671037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m12:28:23.671623 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m12:28:23.682274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m12:28:23.683947 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m12:28:23.730043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m12:28:23.732304 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:28:23.732972 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m12:28:23.733449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:23.946896 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m12:28:23.950488 [debug] [MainThread]: On master: COMMIT
[0m12:28:23.954549 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:23.967218 [debug] [MainThread]: On master: COMMIT
[0m12:28:23.976398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:23.981942 [debug] [MainThread]: On master: Close
[0m12:28:23.982836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:23.984031 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m12:28:23.984997 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:28:23.985684 [info ] [MainThread]: 
[0m12:28:23.987180 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m12:28:23.990787 [debug] [MainThread]: Command end result
[0m12:28:23.991354 [info ] [MainThread]: 
[0m12:28:23.992091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:23.996041 [info ] [MainThread]: 
[0m12:28:23.996558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:23.998216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.967726, "process_user_time": 4.972405, "process_kernel_time": 0.29311, "process_mem_max_rss": "112720", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:28:23.999287 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:23.999183 after 13.97 seconds
[0m12:28:23.999877 [debug] [MainThread]: Flushing usage events
[0m12:28:24.045760 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m12:28:24.051074 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:24.051708 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:24.054294 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:28:24.057379 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:24.059234 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:24.070693 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:24.072977 [debug] [MainThread]: On master: BEGIN
[0m12:28:24.075053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:24.081948 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:28:24.082705 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:24.083435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:24.086842 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m12:28:24.088743 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:24.089343 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:24.089680 [debug] [MainThread]: On master: BEGIN
[0m12:28:24.090291 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:24.090772 [debug] [MainThread]: On master: COMMIT
[0m12:28:24.091214 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:24.091837 [debug] [MainThread]: On master: COMMIT
[0m12:28:24.092307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:24.092696 [debug] [MainThread]: On master: Close
[0m12:28:24.093620 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:24.094360 [info ] [MainThread]: 
[0m12:28:24.106036 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m12:28:24.107166 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m12:28:24.108178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m12:28:24.108930 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m12:28:24.125503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m12:28:24.129526 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m12:28:24.171101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m12:28:24.172437 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:28:24.172829 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m12:28:24.173157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:26.694886 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:28:26.695043 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:26.700835 | b8467e4a-2054-4ca5-b07f-82c99f45b445 ==============================
[0m12:28:26.700835 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:26.702052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 12:28:26.702581 | cdd30b7f-8929-45d8-9b90-844b1d8aaddc ==============================
[0m12:28:26.702581 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:26.703558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:28:26.981290 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:26.996219 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:26.999026 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:27.021786 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:27.197175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:27.201016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:27.244813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:27.245422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:27.271889 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:27.273517 [info ] [MainThread]: 
[0m12:28:27.274134 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:27.275822 [debug] [MainThread]: Command end result
[0m12:28:27.276570 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.629495, "process_user_time": 1.469708, "process_kernel_time": 0.090334, "process_mem_max_rss": "97712", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:27.277095 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:27.277016 after 0.63 seconds
[0m12:28:27.278240 [debug] [MainThread]: Flushing usage events
[0m12:28:27.322407 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:27.324301 [info ] [MainThread]: 
[0m12:28:27.326216 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:27.329347 [debug] [MainThread]: Command end result
[0m12:28:27.330263 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6891804, "process_user_time": 1.48108, "process_kernel_time": 0.097922, "process_mem_max_rss": "97176", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:27.331018 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:27.330889 after 0.69 seconds
[0m12:28:27.331891 [debug] [MainThread]: Flushing usage events
[0m12:28:27.858064 [debug] [ThreadPool]: SQL status: BEGIN in 5.017 seconds
[0m12:28:27.860035 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:27.862075 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:27.866725 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:28:27.868322 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:27.870061 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:27.877536 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:27.879612 [debug] [MainThread]: On master: BEGIN
[0m12:28:27.880107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:27.887504 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:28:27.887717 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m12:28:27.888395 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:27.888800 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:27.889279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:27.889815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:27.893035 [debug] [MainThread]: SQL status: SELECT 5 in 0.002 seconds
[0m12:28:27.893567 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m12:28:27.895410 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:27.896387 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:27.896485 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:27.897099 [debug] [MainThread]: On master: BEGIN
[0m12:28:27.897514 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:27.899098 [debug] [MainThread]: On master: BEGIN
[0m12:28:27.898421 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:27.899876 [debug] [MainThread]: On master: COMMIT
[0m12:28:27.900405 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:27.900892 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:28:27.901399 [debug] [MainThread]: On master: COMMIT
[0m12:28:27.901812 [debug] [MainThread]: On master: COMMIT
[0m12:28:27.902532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:27.902869 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:27.903578 [debug] [MainThread]: On master: Close
[0m12:28:27.904269 [debug] [MainThread]: On master: COMMIT
[0m12:28:27.904925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:27.906000 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:27.905754 [info ] [MainThread]: 
[0m12:28:27.906773 [debug] [MainThread]: On master: Close
[0m12:28:27.909504 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:27.911165 [info ] [MainThread]: 
[0m12:28:27.916064 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m12:28:27.916880 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m12:28:27.918078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m12:28:27.919058 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m12:28:27.921037 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m12:28:27.921924 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m12:28:27.922792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m12:28:27.923268 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m12:28:27.927494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m12:28:27.929478 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m12:28:27.930809 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m12:28:27.938630 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m12:28:27.967231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m12:28:27.976157 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:28:27.977102 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m12:28:27.977955 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m12:28:27.978460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:27.979603 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:28:27.980427 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m12:28:27.980954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:28.740154 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m12:28:28.741272 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:28:28.748150 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m12:28:28.987939 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.239 seconds
[0m12:28:28.999485 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:28:29.000149 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:28:29.001055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:29.016934 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:28:29.019183 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:28:29.021094 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:28:29.038615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m12:28:29.050326 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m12:28:29.056167 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:28:29.056775 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m12:28:29.057748 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:28:29.061498 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m12:28:29.064158 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 5.39s]
[0m12:28:29.065246 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m12:28:29.067333 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:29.071476 [debug] [MainThread]: On master: BEGIN
[0m12:28:29.075996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:29.091133 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:28:29.091995 [debug] [MainThread]: On master: COMMIT
[0m12:28:29.092990 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:29.095711 [debug] [MainThread]: On master: COMMIT
[0m12:28:29.096770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:29.097404 [debug] [MainThread]: On master: Close
[0m12:28:29.101658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:29.106033 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:28:29.108920 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m12:28:29.116205 [info ] [MainThread]: 
[0m12:28:29.121243 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.66 seconds (15.66s).
[0m12:28:29.123768 [debug] [MainThread]: Command end result
[0m12:28:29.126343 [info ] [MainThread]: 
[0m12:28:29.129602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:29.133592 [info ] [MainThread]: 
[0m12:28:29.134532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:29.136906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.061153, "process_user_time": 4.985569, "process_kernel_time": 0.351749, "process_mem_max_rss": "113032", "process_out_blocks": "1192", "process_in_blocks": "0"}
[0m12:28:29.138494 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:29.138231 after 19.06 seconds
[0m12:28:29.139461 [debug] [MainThread]: Flushing usage events
[0m12:28:29.183299 [debug] [Thread-1 (]: SQL status: BEGIN in 5.010 seconds
[0m12:28:29.192133 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:28:29.192897 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m12:28:29.196829 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m12:28:29.207955 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:28:29.208964 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m12:28:29.210492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:29.237780 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m12:28:29.243239 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:28:29.244437 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m12:28:29.245720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:28:29.255427 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m12:28:29.262424 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:28:29.263023 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m12:28:29.266103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:28:29.270004 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m12:28:29.273690 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.16s]
[0m12:28:29.275242 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m12:28:29.277946 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:29.278813 [debug] [MainThread]: On master: BEGIN
[0m12:28:29.280517 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:29.288683 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:28:29.289389 [debug] [MainThread]: On master: COMMIT
[0m12:28:29.290053 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:29.290617 [debug] [MainThread]: On master: COMMIT
[0m12:28:29.291383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:29.295102 [debug] [MainThread]: On master: Close
[0m12:28:29.295771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:29.296930 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:28:29.298070 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m12:28:29.299376 [info ] [MainThread]: 
[0m12:28:29.299939 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.39 seconds (15.39s).
[0m12:28:29.300909 [debug] [MainThread]: Command end result
[0m12:28:29.301749 [info ] [MainThread]: 
[0m12:28:29.302496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:29.303020 [info ] [MainThread]: 
[0m12:28:29.303672 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:29.305671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.13376, "process_user_time": 5.025644, "process_kernel_time": 0.324807, "process_mem_max_rss": "113328", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:28:29.306976 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:29.306826 after 19.14 seconds
[0m12:28:29.307592 [debug] [MainThread]: Flushing usage events
[0m12:28:31.835285 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:31.841281 | 159c1b12-6a3b-4354-817b-57d18da07783 ==============================
[0m12:28:31.841281 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:31.842031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'send_anonymous_usage_stats': 'True'}
[0m12:28:31.872834 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:31.879016 | 8936cab9-1642-4c69-922e-29f7c45a242e ==============================
[0m12:28:31.879016 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:31.879840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m12:28:32.051648 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:32.074311 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:32.099339 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:32.124590 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:32.279545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:32.280106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:32.310792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:32.311473 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:32.397647 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:32.384181 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:32.403551 [info ] [MainThread]: 
[0m12:28:32.406586 [info ] [MainThread]: 
[0m12:28:32.415231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:32.415874 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:32.427622 [debug] [MainThread]: Command end result
[0m12:28:32.423200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:32.437472 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.69433916, "process_user_time": 1.455864, "process_kernel_time": 0.107541, "process_mem_max_rss": "97368", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:32.438306 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:32.438150 after 0.70 seconds
[0m12:28:32.438944 [debug] [MainThread]: Flushing usage events
[0m12:28:32.471175 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:32.472365 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:32.472960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:32.479816 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m12:28:32.481566 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:32.486555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:28:32.487327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:32.492820 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:32.495612 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:32.495065 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:32.496534 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:32.496906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:32.496141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:32.997124 [debug] [Thread-1 (]: SQL status: BEGIN in 5.018 seconds
[0m12:28:32.991807 [debug] [Thread-1 (]: SQL status: BEGIN in 5.011 seconds
[0m12:28:32.999569 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:28:33.000649 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:28:33.004272 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m12:28:33.005473 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m12:28:33.009406 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:28:33.014195 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:28:33.031121 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:28:33.027628 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:28:33.033722 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m12:28:33.033948 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m12:28:33.034543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:33.035044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:33.046764 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:28:33.047352 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:28:33.047498 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m12:28:33.047804 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:28:33.048270 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:28:33.048804 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m12:28:33.049033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:28:33.049971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:28:33.055170 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m12:28:33.058343 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m12:28:33.059307 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:28:33.059771 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m12:28:33.060340 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:28:33.063079 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m12:28:33.062894 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:28:33.065212 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.14s]
[0m12:28:33.066412 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m12:28:33.065902 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m12:28:33.067261 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:28:33.068300 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:33.068882 [debug] [MainThread]: On master: BEGIN
[0m12:28:33.069417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:33.070527 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m12:28:33.073237 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.15s]
[0m12:28:33.074586 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:28:33.074705 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m12:28:33.075298 [debug] [MainThread]: On master: COMMIT
[0m12:28:33.075931 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:33.076514 [debug] [MainThread]: On master: COMMIT
[0m12:28:33.077289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:33.077147 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:33.077741 [debug] [MainThread]: On master: Close
[0m12:28:33.077840 [debug] [MainThread]: On master: BEGIN
[0m12:28:33.078334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:33.079570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:33.079735 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:28:33.080183 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m12:28:33.080797 [info ] [MainThread]: 
[0m12:28:33.081360 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m12:28:33.082185 [debug] [MainThread]: Command end result
[0m12:28:33.082616 [info ] [MainThread]: 
[0m12:28:33.083306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:33.083743 [info ] [MainThread]: 
[0m12:28:33.084235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:33.084245 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:28:33.084927 [debug] [MainThread]: On master: COMMIT
[0m12:28:33.085512 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:33.085548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.086545, "process_user_time": 1.946861, "process_kernel_time": 0.115704, "process_mem_max_rss": "106476", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:28:33.085992 [debug] [MainThread]: On master: COMMIT
[0m12:28:33.086437 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:33.086316 after 11.09 seconds
[0m12:28:33.086571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:33.087036 [debug] [MainThread]: On master: Close
[0m12:28:33.087018 [debug] [MainThread]: Flushing usage events
[0m12:28:33.087650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:33.088146 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m12:28:33.088568 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:28:33.089262 [info ] [MainThread]: 
[0m12:28:33.090105 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m12:28:33.091202 [debug] [MainThread]: Command end result
[0m12:28:33.091681 [info ] [MainThread]: 
[0m12:28:33.092885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:33.094033 [info ] [MainThread]: 
[0m12:28:33.096061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:33.098239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.14491, "process_user_time": 1.855144, "process_kernel_time": 0.138673, "process_mem_max_rss": "105972", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m12:28:33.102768 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:33.102526 after 11.15 seconds
[0m12:28:33.104350 [debug] [MainThread]: Flushing usage events
[0m12:28:36.758029 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:36.774901 | 4fcfae57-d206-4749-a548-34e73c8f7a8e ==============================
[0m12:28:36.774901 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:36.763690 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:28:36.782815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 12:28:36.787264 | 8773d92e-996b-4964-a68c-68ad971a6c00 ==============================
[0m12:28:36.787264 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:36.794724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:28:36.957218 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:36.961152 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:36.971994 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:36.975099 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:37.148625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:37.149435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:37.150960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:37.151727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:37.226881 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:37.230522 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:37.235215 [info ] [MainThread]: 
[0m12:28:37.242273 [info ] [MainThread]: 
[0m12:28:37.254148 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:37.255914 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:37.265499 [debug] [MainThread]: Command end result
[0m12:28:37.276658 [debug] [MainThread]: Command end result
[0m12:28:37.289004 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58885807, "process_user_time": 1.32508, "process_kernel_time": 0.085096, "process_mem_max_rss": "97948", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:37.285640 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58329797, "process_user_time": 1.369872, "process_kernel_time": 0.081828, "process_mem_max_rss": "97800", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:37.305797 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:37.305618 after 0.61 seconds
[0m12:28:37.305994 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:37.305796 after 0.60 seconds
[0m12:28:37.306521 [debug] [MainThread]: Flushing usage events
[0m12:28:37.306620 [debug] [MainThread]: Flushing usage events
[0m12:28:37.504173 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:28:37.506898 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:37.508251 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:37.508701 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m12:28:37.509398 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:37.510984 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:37.512126 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:28:37.515786 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:37.516593 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m12:28:37.519138 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:37.517411 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:37.520275 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:37.531073 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:37.531738 [debug] [MainThread]: On master: BEGIN
[0m12:28:37.532168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:37.539039 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:28:37.540131 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:37.540746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:37.547401 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m12:28:37.551267 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:37.552716 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:37.553499 [debug] [MainThread]: On master: BEGIN
[0m12:28:37.554599 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:37.555357 [debug] [MainThread]: On master: COMMIT
[0m12:28:37.555945 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:37.556378 [debug] [MainThread]: On master: COMMIT
[0m12:28:37.556998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:37.557529 [debug] [MainThread]: On master: Close
[0m12:28:37.558516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:37.559806 [info ] [MainThread]: 
[0m12:28:37.574522 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m12:28:37.579784 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m12:28:37.582298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m12:28:37.585125 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m12:28:37.596891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m12:28:37.598531 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m12:28:37.636689 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m12:28:37.638348 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:28:37.638904 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m12:28:37.639347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:40.053314 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:40.058666 | 039d7d0a-d91f-4a9e-ab5d-287997281b4e ==============================
[0m12:28:40.058666 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:40.059592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:40.089992 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:40.095804 | 8aa9f917-3b33-4aac-860a-98a7d60bda14 ==============================
[0m12:28:40.095804 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:40.096802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:40.105177 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:40.118041 | dfd0cd74-9a8f-45ef-a697-e5d533818ee3 ==============================
[0m12:28:40.118041 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:40.118717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:40.110977 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:40.124509 | f525251d-cf24-4ead-abee-8f0fcc49e3cc ==============================
[0m12:28:40.124509 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:40.125294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:28:40.245318 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:40.277775 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:40.293456 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:40.319730 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:40.367995 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:40.371693 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:40.394567 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:40.398153 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:40.496629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:40.497258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:40.511784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:40.512359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:40.572657 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:40.578198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:40.579374 [info ] [MainThread]: 
[0m12:28:40.578943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:40.580160 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:40.586112 [debug] [MainThread]: Command end result
[0m12:28:40.588264 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.574401, "process_user_time": 1.403373, "process_kernel_time": 0.105706, "process_mem_max_rss": "97640", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:40.588741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:40.589314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:40.589325 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:40.589234 after 0.58 seconds
[0m12:28:40.589802 [debug] [MainThread]: Flushing usage events
[0m12:28:40.606120 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:40.608996 [info ] [MainThread]: 
[0m12:28:40.610402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:40.611867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:40.662091 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:40.663757 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:40.665144 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:40.665822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:40.667635 [info ] [MainThread]: 
[0m12:28:40.669468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:40.672011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:40.675450 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m12:28:40.678338 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:40.681584 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:40.683952 [info ] [MainThread]: 
[0m12:28:40.684714 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:40.687577 [debug] [MainThread]: Command end result
[0m12:28:40.687010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:28:40.688630 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.62735784, "process_user_time": 1.438857, "process_kernel_time": 0.099752, "process_mem_max_rss": "97464", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:40.689708 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:40.689554 after 0.63 seconds
[0m12:28:40.693004 [debug] [MainThread]: Flushing usage events
[0m12:28:40.687975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:28:40.697201 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:40.699621 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:40.700942 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:40.701632 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:40.702004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:40.704044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:40.704884 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:40.705819 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:40.707343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:40.710503 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:28:40.711366 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:40.711994 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:40.715974 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m12:28:40.716242 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m12:28:40.717738 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:40.717780 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:40.718734 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:40.723169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:28:40.723831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:28:40.729546 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:40.731926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:40.735350 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:40.737525 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:40.738130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:40.739190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:40.744590 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:28:40.745533 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:40.747982 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:40.750343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:28:40.752635 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:40.753377 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:42.649712 [debug] [Thread-1 (]: SQL status: BEGIN in 5.010 seconds
[0m12:28:42.651450 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:28:42.652196 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m12:28:42.654244 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:28:42.660661 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:28:42.661091 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m12:28:42.661622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:42.673242 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:28:42.673751 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:28:42.674283 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:28:42.675543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:28:42.680285 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m12:28:42.683644 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:28:42.684172 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m12:28:42.684901 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:28:42.687412 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m12:28:42.689433 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 5.11s]
[0m12:28:42.690385 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m12:28:42.691913 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:42.692312 [debug] [MainThread]: On master: BEGIN
[0m12:28:42.692701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:42.697114 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:28:42.697627 [debug] [MainThread]: On master: COMMIT
[0m12:28:42.698014 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:42.698369 [debug] [MainThread]: On master: COMMIT
[0m12:28:42.698842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:42.699232 [debug] [MainThread]: On master: Close
[0m12:28:42.699679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:42.700061 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m12:28:42.700453 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:28:42.700887 [info ] [MainThread]: 
[0m12:28:42.701282 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m12:28:42.701990 [debug] [MainThread]: Command end result
[0m12:28:42.702355 [info ] [MainThread]: 
[0m12:28:42.702786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:42.703185 [info ] [MainThread]: 
[0m12:28:42.703621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:42.704835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.883156, "process_user_time": 1.66274, "process_kernel_time": 0.113021, "process_mem_max_rss": "106512", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:28:42.705786 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:42.705707 after 10.88 seconds
[0m12:28:42.706281 [debug] [MainThread]: Flushing usage events
[0m12:28:45.717532 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m12:28:45.718682 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:45.719447 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:45.723607 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:28:45.727189 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:45.730129 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:45.738362 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:45.739944 [debug] [MainThread]: On master: BEGIN
[0m12:28:45.740314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:45.745898 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:28:45.745955 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:28:45.747017 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:45.746722 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:45.747443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:45.747904 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:45.750186 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m12:28:45.751597 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m12:28:45.752059 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:45.754254 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:45.754654 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:45.755060 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:45.755936 [debug] [MainThread]: On master: BEGIN
[0m12:28:45.756725 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:45.757410 [debug] [MainThread]: On master: COMMIT
[0m12:28:45.757817 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:45.758232 [debug] [MainThread]: On master: COMMIT
[0m12:28:45.758913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:45.759556 [debug] [MainThread]: On master: Close
[0m12:28:45.760246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:45.760947 [info ] [MainThread]: 
[0m12:28:45.762165 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:45.765344 [debug] [MainThread]: On master: BEGIN
[0m12:28:45.766891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:45.769813 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m12:28:45.770562 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m12:28:45.771487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m12:28:45.772065 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m12:28:45.779618 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m12:28:45.784167 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m12:28:45.819670 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m12:28:45.825430 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:28:45.825843 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m12:28:45.826285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:50.605555 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:50.614709 | 873ed532-4f47-4a07-92bf-9e1d9750d0de ==============================
[0m12:28:50.614709 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:50.617008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m12:28:50.627227 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:50.633363 | cee370d6-c0e5-413a-9423-770ced207b3a ==============================
[0m12:28:50.633363 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:50.634198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:50.774026 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m12:28:50.775106 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:50.776970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:50.781663 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m12:28:50.783606 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:50.785042 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:50.785891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:50.786766 [debug] [MainThread]: On master: BEGIN
[0m12:28:50.787230 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:50.787983 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:50.788464 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.788882 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:50.789402 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.790043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:50.790520 [debug] [MainThread]: On master: Close
[0m12:28:50.791172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:50.792233 [info ] [MainThread]: 
[0m12:28:50.801556 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m12:28:50.802287 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:50.802892 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m12:28:50.803656 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:50.803809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m12:28:50.804892 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m12:28:50.812528 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m12:28:50.814296 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m12:28:50.838975 [debug] [Thread-1 (]: SQL status: BEGIN in 5.011 seconds
[0m12:28:50.839745 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:28:50.840255 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m12:28:50.844046 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:28:50.850548 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m12:28:50.854379 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:28:50.855285 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m12:28:50.856245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:50.856693 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:28:50.858286 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m12:28:50.859946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:50.872184 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:28:50.872836 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:28:50.873390 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:28:50.874578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:28:50.880358 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m12:28:50.883797 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:28:50.884301 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m12:28:50.884937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:28:50.887284 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m12:28:50.888956 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.12s]
[0m12:28:50.890115 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m12:28:50.891566 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:50.892049 [debug] [MainThread]: On master: BEGIN
[0m12:28:50.892461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:50.897222 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:28:50.899767 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.900219 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:50.900652 [debug] [MainThread]: On master: COMMIT
[0m12:28:50.901276 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:50.901716 [debug] [MainThread]: On master: Close
[0m12:28:50.902379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:50.902843 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:28:50.903972 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m12:28:50.904820 [info ] [MainThread]: 
[0m12:28:50.905311 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m12:28:50.906496 [debug] [MainThread]: Command end result
[0m12:28:50.906972 [info ] [MainThread]: 
[0m12:28:50.907919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:50.908389 [info ] [MainThread]: 
[0m12:28:50.908903 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:50.909990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.868613, "process_user_time": 1.642511, "process_kernel_time": 0.101103, "process_mem_max_rss": "106196", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:28:50.910824 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:50.910718 after 10.87 seconds
[0m12:28:50.911686 [debug] [MainThread]: Flushing usage events
[0m12:28:50.991846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:50.992946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:50.994423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:50.996875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:51.075641 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:51.091509 [info ] [MainThread]: 
[0m12:28:51.099242 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:51.102919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:51.120395 [info ] [MainThread]: 
[0m12:28:51.123932 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:51.124366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:51.128025 [debug] [MainThread]: Command end result
[0m12:28:51.130407 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59055144, "process_user_time": 1.355968, "process_kernel_time": 0.074993, "process_mem_max_rss": "97640", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:51.132052 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:51.131945 after 0.59 seconds
[0m12:28:51.132511 [debug] [MainThread]: Flushing usage events
[0m12:28:51.167830 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:51.169517 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:51.170294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:51.177793 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m12:28:51.179165 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:28:51.184115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:28:51.184800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:28:51.191656 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:51.195020 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:51.195770 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:28:51.196329 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:28:51.196891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:51.197231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:51.202130 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:28:51.202827 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:28:51.204245 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:28:51.206946 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:28:51.209134 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:28:51.209891 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:28:51.211474 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:28:51.215272 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:28:51.213948 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m12:28:51.219731 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:28:51.219994 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:28:51.221913 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:28:51.230692 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:51.234422 [debug] [MainThread]: On master: BEGIN
[0m12:28:51.235492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:51.240828 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:28:51.241720 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:51.242158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:28:51.244943 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m12:28:51.246915 [debug] [MainThread]: On master: ROLLBACK
[0m12:28:51.247429 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:51.247830 [debug] [MainThread]: On master: BEGIN
[0m12:28:51.248509 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:28:51.249088 [debug] [MainThread]: On master: COMMIT
[0m12:28:51.249625 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:51.250050 [debug] [MainThread]: On master: COMMIT
[0m12:28:51.250519 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:51.250941 [debug] [MainThread]: On master: Close
[0m12:28:51.251448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:28:51.252093 [info ] [MainThread]: 
[0m12:28:51.260466 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m12:28:51.261175 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m12:28:51.261994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m12:28:51.262383 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m12:28:51.269902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m12:28:51.271272 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m12:28:51.324329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m12:28:51.325960 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:28:51.326473 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m12:28:51.326840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:51.333630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:28:51.334295 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:28:51.334861 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m12:28:51.337727 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m12:28:51.344301 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:28:51.344903 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m12:28:51.346052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:51.361865 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m12:28:51.363617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:28:51.364264 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m12:28:51.365667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m12:28:51.373152 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m12:28:51.379616 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:28:51.383861 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m12:28:51.385946 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:28:51.388495 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m12:28:51.391092 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.13s]
[0m12:28:51.392511 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m12:28:51.395020 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:51.398928 [debug] [MainThread]: On master: BEGIN
[0m12:28:51.399995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:55.876314 [debug] [Thread-1 (]: SQL status: BEGIN in 5.016 seconds
[0m12:28:55.885216 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:28:55.888509 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_id, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m12:28:55.907559 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.013 seconds
[0m12:28:55.925288 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:28:55.926476 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:28:55.927317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:28:55.941311 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m12:28:55.941969 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:28:55.942417 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m12:28:55.944090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:28:55.948849 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m12:28:55.951998 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:28:55.952537 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m12:28:55.953341 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:28:55.956487 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m12:28:55.958457 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 5.15s]
[0m12:28:55.959445 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m12:28:55.961276 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:55.961733 [debug] [MainThread]: On master: BEGIN
[0m12:28:55.962128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:55.966650 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:28:55.967225 [debug] [MainThread]: On master: COMMIT
[0m12:28:55.967659 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:55.968140 [debug] [MainThread]: On master: COMMIT
[0m12:28:55.971933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:55.972357 [debug] [MainThread]: On master: Close
[0m12:28:55.972903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:55.973281 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:28:55.973683 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m12:28:55.974164 [info ] [MainThread]: 
[0m12:28:55.974738 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m12:28:55.975509 [debug] [MainThread]: Command end result
[0m12:28:55.975869 [info ] [MainThread]: 
[0m12:28:55.976314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:55.976690 [info ] [MainThread]: 
[0m12:28:55.977173 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:55.978324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.911841, "process_user_time": 1.591203, "process_kernel_time": 0.127539, "process_mem_max_rss": "105528", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:28:55.979045 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:55.978971 after 15.91 seconds
[0m12:28:55.979498 [debug] [MainThread]: Flushing usage events
[0m12:28:56.411836 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m12:28:56.412921 [debug] [MainThread]: On master: COMMIT
[0m12:28:56.413517 [debug] [MainThread]: Using postgres connection "master"
[0m12:28:56.414161 [debug] [MainThread]: On master: COMMIT
[0m12:28:56.414761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:28:56.415216 [debug] [MainThread]: On master: Close
[0m12:28:56.415875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:56.416254 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:28:56.416569 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m12:28:56.417006 [info ] [MainThread]: 
[0m12:28:56.417503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m12:28:56.418458 [debug] [MainThread]: Command end result
[0m12:28:56.418812 [info ] [MainThread]: 
[0m12:28:56.419269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:56.419689 [info ] [MainThread]: 
[0m12:28:56.420198 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:28:56.422066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.843293, "process_user_time": 1.534109, "process_kernel_time": 0.093801, "process_mem_max_rss": "106880", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m12:28:56.423600 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:56.423478 after 5.84 seconds
[0m12:28:56.424943 [debug] [MainThread]: Flushing usage events
[0m12:28:58.320339 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:58.328683 | 95cf309d-c21a-4eb2-a207-7f376845de05 ==============================
[0m12:28:58.328683 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:58.329482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m12:28:58.514837 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:58.530825 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:58.606318 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:28:58.612002 | 018ea048-fabf-4398-81d9-e35248c91671 ==============================
[0m12:28:58.612002 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:28:58.612711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:58.770163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:58.771181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:58.829656 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:28:58.858213 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:28:58.903689 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:58.906809 [info ] [MainThread]: 
[0m12:28:58.907306 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:28:58.909003 [debug] [MainThread]: Command end result
[0m12:28:58.910292 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68084836, "process_user_time": 1.432436, "process_kernel_time": 0.108395, "process_mem_max_rss": "97688", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:28:58.911286 [debug] [MainThread]: Command `dbt test` succeeded at 12:28:58.911032 after 0.68 seconds
[0m12:28:58.912031 [debug] [MainThread]: Flushing usage events
[0m12:28:59.038719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:28:59.039406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:28:59.098337 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:28:59.100138 [info ] [MainThread]: 
[0m12:28:59.100855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:28:59.101932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:28:59.135875 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:28:59.136811 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:28:59.137505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:03.064976 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:29:03.070240 | 33378408-ac8a-4e09-9918-5363b8115906 ==============================
[0m12:29:03.070240 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:03.070929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:03.288935 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:29:03.364301 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:29:03.635821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:03.636885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:03.676509 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:29:03.682710 | a3110298-bbb1-4b7c-9787-6b5b8ec72563 ==============================
[0m12:29:03.682710 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:03.685413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:03.723708 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:29:03.725531 [info ] [MainThread]: 
[0m12:29:03.726073 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:29:03.727664 [debug] [MainThread]: Command end result
[0m12:29:03.729511 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.70656675, "process_user_time": 1.435687, "process_kernel_time": 0.08738, "process_mem_max_rss": "97468", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:29:03.731125 [debug] [MainThread]: Command `dbt test` succeeded at 12:29:03.731018 after 0.71 seconds
[0m12:29:03.732689 [debug] [MainThread]: Flushing usage events
[0m12:29:03.937245 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:29:04.015223 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:29:04.148226 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m12:29:04.152916 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:29:04.161319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:29:04.163103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:29:04.173335 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:04.176100 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:04.176689 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:29:04.177162 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:29:04.177561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:04.178301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:04.185951 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:29:04.186612 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:04.187691 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:29:04.190909 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:29:04.192334 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:29:04.193267 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:29:04.243191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:04.243709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:04.317223 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:29:04.319140 [info ] [MainThread]: 
[0m12:29:04.319646 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:29:04.321917 [debug] [MainThread]: Command end result
[0m12:29:04.324301 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.69739693, "process_user_time": 1.599953, "process_kernel_time": 0.090369, "process_mem_max_rss": "97476", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:29:04.326301 [debug] [MainThread]: Command `dbt test` succeeded at 12:29:04.326208 after 0.70 seconds
[0m12:29:04.326812 [debug] [MainThread]: Flushing usage events
[0m12:29:09.191505 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m12:29:09.193392 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:09.197039 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:29:09.199339 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m12:29:09.200969 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:29:09.201439 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:29:09.212012 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:09.213756 [debug] [MainThread]: On master: BEGIN
[0m12:29:09.214926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:14.225845 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m12:29:14.226761 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:14.227396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:14.231540 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m12:29:14.233577 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:14.233974 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:14.234254 [debug] [MainThread]: On master: BEGIN
[0m12:29:14.234721 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:29:14.235151 [debug] [MainThread]: On master: COMMIT
[0m12:29:14.235460 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:14.235741 [debug] [MainThread]: On master: COMMIT
[0m12:29:14.236160 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:14.236513 [debug] [MainThread]: On master: Close
[0m12:29:14.237804 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:14.239529 [info ] [MainThread]: 
[0m12:29:14.251974 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m12:29:14.253108 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m12:29:14.254106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m12:29:14.255449 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m12:29:14.272926 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m12:29:14.274154 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m12:29:14.306426 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m12:29:14.308128 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:29:14.308576 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m12:29:14.308945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:19.313905 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m12:29:19.316841 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:29:19.318490 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m12:29:19.322495 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:29:19.329630 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:29:19.331925 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m12:29:19.334432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:29:19.350929 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m12:29:19.351597 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:29:19.352304 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m12:29:19.353602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:29:19.359202 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m12:29:19.362921 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:29:19.364075 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m12:29:19.367219 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:29:19.369826 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m12:29:19.371697 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 5.12s]
[0m12:29:19.375170 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m12:29:19.378420 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:19.381882 [debug] [MainThread]: On master: BEGIN
[0m12:29:19.382305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:19.387504 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:29:19.389256 [debug] [MainThread]: On master: COMMIT
[0m12:29:19.389820 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:19.390394 [debug] [MainThread]: On master: COMMIT
[0m12:29:19.390911 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:19.391405 [debug] [MainThread]: On master: Close
[0m12:29:19.392340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:19.392864 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:29:19.393888 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m12:29:19.394818 [info ] [MainThread]: 
[0m12:29:19.395350 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.29 seconds (20.29s).
[0m12:29:19.399320 [debug] [MainThread]: Command end result
[0m12:29:19.399925 [info ] [MainThread]: 
[0m12:29:19.403009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:19.406866 [info ] [MainThread]: 
[0m12:29:19.407410 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:29:19.408695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.838194, "process_user_time": 1.612657, "process_kernel_time": 0.101552, "process_mem_max_rss": "106404", "process_out_blocks": "35", "process_in_blocks": "0"}
[0m12:29:19.409674 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:19.409551 after 20.84 seconds
[0m12:29:19.410328 [debug] [MainThread]: Flushing usage events
[0m12:29:27.399125 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:29:27.406120 | f8ff6b90-332e-47ad-a8b0-47a4425a2132 ==============================
[0m12:29:27.406120 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:27.409120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:27.405794 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:29:27.412209 | f771ec79-9007-4d4b-9bfe-dc200d3c749f ==============================
[0m12:29:27.412209 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:27.416304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:27.603685 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:29:27.635689 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:29:27.688117 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:29:27.688905 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:29:27.854484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:27.855040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:27.861048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:27.861754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:27.913964 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:29:27.916661 [info ] [MainThread]: 
[0m12:29:27.917523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:27.918672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:29:27.931325 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:29:27.933483 [info ] [MainThread]: 
[0m12:29:27.934057 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:29:27.935858 [debug] [MainThread]: Command end result
[0m12:29:27.939520 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.582262, "process_user_time": 1.440458, "process_kernel_time": 0.08869, "process_mem_max_rss": "97360", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:29:27.940450 [debug] [MainThread]: Command `dbt test` succeeded at 12:29:27.940321 after 0.58 seconds
[0m12:29:27.942186 [debug] [MainThread]: Flushing usage events
[0m12:29:27.958129 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:29:27.958941 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:29:27.959389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:27.965634 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m12:29:27.966885 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:29:27.971954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:29:27.972611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:29:27.978457 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:27.984850 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:27.986056 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:29:27.987197 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:29:27.988353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:27.988992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:27.995123 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:29:27.995784 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:27.996297 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:29:27.999637 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m12:29:28.002988 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:29:28.003734 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:29:32.998225 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m12:29:33.001514 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:33.002118 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:29:33.004411 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:29:33.006055 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:29:33.006570 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:29:33.012794 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:33.014299 [debug] [MainThread]: On master: BEGIN
[0m12:29:33.014829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:33.019431 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:29:33.020045 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:33.020522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:33.023635 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:29:33.026346 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:33.026904 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:33.027339 [debug] [MainThread]: On master: BEGIN
[0m12:29:33.027871 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:29:33.028420 [debug] [MainThread]: On master: COMMIT
[0m12:29:33.028838 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:33.029325 [debug] [MainThread]: On master: COMMIT
[0m12:29:33.029997 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:33.030431 [debug] [MainThread]: On master: Close
[0m12:29:33.031048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:33.031571 [info ] [MainThread]: 
[0m12:29:33.038660 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m12:29:33.039278 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m12:29:33.039811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m12:29:33.040308 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m12:29:33.047700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m12:29:33.048986 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m12:29:33.083032 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m12:29:33.090396 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:29:33.090875 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m12:29:33.093932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:33.098454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:29:33.099089 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:29:33.099621 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m12:29:34.295770 [debug] [Thread-1 (]: SQL status: SELECT 259181 in 1.195 seconds
[0m12:29:34.303064 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:29:34.303684 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:29:34.305147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:29:34.324569 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m12:29:34.333037 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:29:34.335447 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m12:29:34.348816 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:29:34.373352 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m12:29:34.392709 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:29:34.400108 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m12:29:34.408813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:29:34.412505 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m12:29:34.414778 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259181[0m in 1.37s]
[0m12:29:34.415651 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m12:29:34.417204 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:34.417767 [debug] [MainThread]: On master: BEGIN
[0m12:29:34.418576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:39.428996 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m12:29:39.429976 [debug] [MainThread]: On master: COMMIT
[0m12:29:39.430398 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:39.430899 [debug] [MainThread]: On master: COMMIT
[0m12:29:39.431706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:39.432160 [debug] [MainThread]: On master: Close
[0m12:29:39.434155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:39.434615 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:29:39.438079 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m12:29:39.438513 [info ] [MainThread]: 
[0m12:29:39.439043 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.52 seconds (11.52s).
[0m12:29:39.439842 [debug] [MainThread]: Command end result
[0m12:29:39.440219 [info ] [MainThread]: 
[0m12:29:39.440638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:39.440989 [info ] [MainThread]: 
[0m12:29:39.444150 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:29:39.445423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.095975, "process_user_time": 1.629531, "process_kernel_time": 0.124019, "process_mem_max_rss": "106444", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:29:39.446188 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:39.446091 after 12.10 seconds
[0m12:29:39.446656 [debug] [MainThread]: Flushing usage events
[0m12:29:46.459691 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:29:46.465911 | ff747da0-2a1b-4308-924d-8fab8ba86179 ==============================
[0m12:29:46.465911 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:46.466566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:46.496184 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:29:46.497962 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:29:46.502452 | 4934bdb4-43b1-4c00-90c8-8f8d69378695 ==============================
[0m12:29:46.502452 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:46.503511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 12:29:46.504010 | f93fad3f-9c3f-4741-99bc-cc8ab5a47b31 ==============================
[0m12:29:46.504010 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:29:46.506101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:29:46.701872 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:29:46.727286 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:29:46.748224 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:29:46.753498 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:29:46.776126 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:29:46.778993 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:29:46.944076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:46.944877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:46.956694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:46.957825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:46.968082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:29:46.968697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:29:47.041419 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:29:47.045328 [info ] [MainThread]: 
[0m12:29:47.045857 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:29:47.051670 [info ] [MainThread]: 
[0m12:29:47.048715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:47.054260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:29:47.052430 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:29:47.057359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:29:47.058861 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:29:47.060720 [info ] [MainThread]: 
[0m12:29:47.061277 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:29:47.062946 [debug] [MainThread]: Command end result
[0m12:29:47.063802 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6104948, "process_user_time": 1.42177, "process_kernel_time": 0.089742, "process_mem_max_rss": "97328", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:29:47.064700 [debug] [MainThread]: Command `dbt test` succeeded at 12:29:47.064586 after 0.61 seconds
[0m12:29:47.065316 [debug] [MainThread]: Flushing usage events
[0m12:29:47.090111 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:29:47.091447 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:29:47.091400 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:29:47.092284 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:29:47.092388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:47.093141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:47.102194 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m12:29:47.104608 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:29:47.116687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:29:47.118139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:29:47.127278 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:47.130599 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:47.131317 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:29:47.131804 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:29:47.132274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:47.132700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:47.139623 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:29:47.140495 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:47.141324 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:29:47.145446 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:29:47.147292 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:29:47.148109 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:29:52.104697 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m12:29:52.107138 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:29:52.112758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:29:52.113495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:29:52.123125 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:52.125945 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:29:52.126419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:52.125415 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:52.127328 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:29:52.127836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:52.131248 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:29:52.131779 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:52.132238 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:29:52.134867 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m12:29:52.136322 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:29:52.136904 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:29:52.143080 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m12:29:52.145210 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:29:52.145810 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:29:52.148036 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m12:29:52.149628 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:29:52.150316 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:29:52.157376 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:52.157849 [debug] [MainThread]: On master: BEGIN
[0m12:29:52.158239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:52.162636 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:29:52.163125 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:52.163646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:29:52.167023 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:29:52.169360 [debug] [MainThread]: On master: ROLLBACK
[0m12:29:52.169961 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:52.170491 [debug] [MainThread]: On master: BEGIN
[0m12:29:52.171210 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:29:52.171669 [debug] [MainThread]: On master: COMMIT
[0m12:29:52.172096 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:52.172555 [debug] [MainThread]: On master: COMMIT
[0m12:29:52.173040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:52.173473 [debug] [MainThread]: On master: Close
[0m12:29:52.174122 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:29:52.174685 [info ] [MainThread]: 
[0m12:29:52.181369 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m12:29:52.182154 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m12:29:52.182853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m12:29:52.184142 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m12:29:52.204691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:29:52.206343 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m12:29:52.249259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:29:52.251123 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:29:52.251619 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m12:29:52.251997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:52.256513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:29:52.257045 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:29:52.257562 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m12:29:53.881795 [debug] [Thread-1 (]: SQL status: SELECT 159181 in 1.624 seconds
[0m12:29:53.896445 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m12:29:53.897003 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:29:53.897393 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m12:29:53.918039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m12:29:53.920194 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m12:29:53.922095 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159181[0m in 1.74s]
[0m12:29:53.922861 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m12:29:53.924383 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:53.924868 [debug] [MainThread]: On master: BEGIN
[0m12:29:53.925216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:53.929867 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:29:53.930383 [debug] [MainThread]: On master: COMMIT
[0m12:29:53.930764 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:53.931187 [debug] [MainThread]: On master: COMMIT
[0m12:29:53.931749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:29:53.932227 [debug] [MainThread]: On master: Close
[0m12:29:53.932768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:53.933198 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m12:29:53.933618 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:29:53.934109 [info ] [MainThread]: 
[0m12:29:53.934577 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m12:29:53.935300 [debug] [MainThread]: Command end result
[0m12:29:53.935684 [info ] [MainThread]: 
[0m12:29:53.936202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:29:53.936605 [info ] [MainThread]: 
[0m12:29:53.937030 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:29:53.937901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.4873486, "process_user_time": 1.606142, "process_kernel_time": 0.101769, "process_mem_max_rss": "106956", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m12:29:53.938534 [debug] [MainThread]: Command `dbt run` succeeded at 12:29:53.938450 after 7.49 seconds
[0m12:29:53.938946 [debug] [MainThread]: Flushing usage events
[0m12:29:57.133845 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m12:29:57.135026 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:29:57.135748 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:29:57.139381 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:29:57.140996 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:29:57.141616 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:29:57.148035 [debug] [MainThread]: Using postgres connection "master"
[0m12:29:57.152021 [debug] [MainThread]: On master: BEGIN
[0m12:29:57.155010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:01.563932 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:30:01.570586 | 3f8759a4-3db1-4ae7-9365-9942c8899437 ==============================
[0m12:30:01.570586 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:01.571164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m12:30:01.746348 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:30:01.770287 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:30:01.954862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:01.955819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:02.052229 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:30:02.069994 [info ] [MainThread]: 
[0m12:30:02.071091 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:30:02.073402 [debug] [MainThread]: Command end result
[0m12:30:02.074218 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5630068, "process_user_time": 1.327535, "process_kernel_time": 0.094896, "process_mem_max_rss": "97420", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:30:02.075284 [debug] [MainThread]: Command `dbt test` succeeded at 12:30:02.075196 after 0.56 seconds
[0m12:30:02.076576 [debug] [MainThread]: Flushing usage events
[0m12:30:02.161184 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m12:30:02.162550 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:02.164294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:30:02.167741 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:30:02.171473 [debug] [MainThread]: On master: ROLLBACK
[0m12:30:02.172262 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:02.173422 [debug] [MainThread]: On master: BEGIN
[0m12:30:02.174116 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:30:02.176000 [debug] [MainThread]: On master: COMMIT
[0m12:30:02.177539 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:02.177953 [debug] [MainThread]: On master: COMMIT
[0m12:30:02.178478 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:02.178853 [debug] [MainThread]: On master: Close
[0m12:30:02.179608 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:02.180133 [info ] [MainThread]: 
[0m12:30:02.190927 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m12:30:02.191820 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m12:30:02.192501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m12:30:02.192986 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m12:30:02.214387 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m12:30:02.216109 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m12:30:02.259734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m12:30:02.261021 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m12:30:02.261482 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m12:30:02.261949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:07.274364 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m12:30:07.280051 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m12:30:07.280606 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m12:30:12.847404 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.566 seconds
[0m12:30:12.871624 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m12:30:12.873099 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m12:30:12.873784 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m12:30:12.885518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:30:12.889141 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m12:30:12.891771 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 10.70s]
[0m12:30:12.893075 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m12:30:12.895413 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:12.896387 [debug] [MainThread]: On master: BEGIN
[0m12:30:12.898053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:12.905382 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:30:12.906181 [debug] [MainThread]: On master: COMMIT
[0m12:30:12.907017 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:12.907783 [debug] [MainThread]: On master: COMMIT
[0m12:30:12.908736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:12.909912 [debug] [MainThread]: On master: Close
[0m12:30:12.910940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:12.911717 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:30:12.913960 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m12:30:12.914389 [info ] [MainThread]: 
[0m12:30:12.914855 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 25.87 seconds (25.87s).
[0m12:30:12.916317 [debug] [MainThread]: Command end result
[0m12:30:12.937259 [info ] [MainThread]: 
[0m12:30:12.951944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:12.955956 [info ] [MainThread]: 
[0m12:30:12.964927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:30:12.970033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.549034, "process_user_time": 1.645093, "process_kernel_time": 0.111286, "process_mem_max_rss": "106840", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m12:30:12.985171 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:12.984748 after 26.56 seconds
[0m12:30:12.990984 [debug] [MainThread]: Flushing usage events
[0m12:30:20.236679 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:30:20.247701 | 2c28d675-a874-47c9-8498-781e39283567 ==============================
[0m12:30:20.247701 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:20.248618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:20.261438 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:30:20.268406 | e87167d0-5a7c-4647-bf09-b7a9b6713ba0 ==============================
[0m12:30:20.268406 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:20.269130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:20.443027 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:30:20.464144 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:30:20.475250 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:30:20.490835 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:30:20.669229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:20.670774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:20.739475 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:30:20.741305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:20.742569 [info ] [MainThread]: 
[0m12:30:20.742834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:20.742983 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:30:20.749131 [debug] [MainThread]: Command end result
[0m12:30:20.751048 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58742535, "process_user_time": 1.478419, "process_kernel_time": 0.12563, "process_mem_max_rss": "97480", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:30:20.752168 [debug] [MainThread]: Command `dbt test` succeeded at 12:30:20.752059 after 0.59 seconds
[0m12:30:20.752647 [debug] [MainThread]: Flushing usage events
[0m12:30:20.822910 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:30:20.829582 [info ] [MainThread]: 
[0m12:30:20.830363 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:30:20.832913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:30:20.885434 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:30:20.886068 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:30:20.886509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:20.893834 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m12:30:20.894972 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:30:20.899897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:30:20.900494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:30:20.906784 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:30:20.908843 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:30:20.909269 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:30:20.909659 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:30:20.910165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:20.910679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:25.917199 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m12:30:25.917791 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m12:30:25.918689 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:30:25.919171 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:30:25.918274 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:30:25.919754 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:30:25.921963 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:30:25.923412 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:30:25.922231 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m12:30:25.925449 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:30:25.924263 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:30:25.926102 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:30:25.933548 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:25.934090 [debug] [MainThread]: On master: BEGIN
[0m12:30:25.934528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:25.939008 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:30:25.939486 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:25.940026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:30:25.943429 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:30:25.945677 [debug] [MainThread]: On master: ROLLBACK
[0m12:30:25.946378 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:25.946793 [debug] [MainThread]: On master: BEGIN
[0m12:30:25.947434 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:30:25.948007 [debug] [MainThread]: On master: COMMIT
[0m12:30:25.948503 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:25.948879 [debug] [MainThread]: On master: COMMIT
[0m12:30:25.949543 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:25.949997 [debug] [MainThread]: On master: Close
[0m12:30:25.950661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:25.951250 [info ] [MainThread]: 
[0m12:30:25.957750 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m12:30:25.958399 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m12:30:25.959046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m12:30:25.959498 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m12:30:25.966807 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m12:30:25.968176 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m12:30:26.000114 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m12:30:26.001543 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:30:26.002097 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m12:30:26.002532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:26.006746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:30:26.007335 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:30:26.007752 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m12:30:27.363214 [debug] [Thread-1 (]: SQL status: SELECT 1159181 in 1.355 seconds
[0m12:30:27.372763 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:30:27.373392 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m12:30:27.374380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:30:27.394070 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m12:30:27.394744 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:30:27.395299 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m12:30:27.397157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:30:27.402870 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m12:30:27.406619 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:30:27.408929 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m12:30:27.410812 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:30:27.414481 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m12:30:27.416615 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159181[0m in 1.46s]
[0m12:30:27.417732 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m12:30:27.420267 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:27.420730 [debug] [MainThread]: On master: BEGIN
[0m12:30:27.421824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:32.433155 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m12:30:32.434414 [debug] [MainThread]: On master: COMMIT
[0m12:30:32.434860 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:32.435272 [debug] [MainThread]: On master: COMMIT
[0m12:30:32.435788 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:32.436184 [debug] [MainThread]: On master: Close
[0m12:30:32.436911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:32.437447 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:30:32.437862 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m12:30:32.438422 [info ] [MainThread]: 
[0m12:30:32.439136 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.61 seconds (11.61s).
[0m12:30:32.440130 [debug] [MainThread]: Command end result
[0m12:30:32.440510 [info ] [MainThread]: 
[0m12:30:32.441183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:32.441743 [info ] [MainThread]: 
[0m12:30:32.442238 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:30:32.443664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.275408, "process_user_time": 1.671866, "process_kernel_time": 0.121791, "process_mem_max_rss": "106600", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:30:32.444501 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:32.444408 after 12.28 seconds
[0m12:30:32.445091 [debug] [MainThread]: Flushing usage events
[0m12:30:40.170220 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:30:40.181141 | 8ccf932c-b19f-4637-84a7-73a6cc6de1a2 ==============================
[0m12:30:40.181141 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:40.187921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:40.179229 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:30:40.206304 | 9e776fcf-2a39-4712-8acf-a51d7ad5d058 ==============================
[0m12:30:40.206304 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:40.209635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m12:30:40.436417 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:30:40.441262 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:30:40.458807 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:30:40.465690 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:30:40.757060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:40.757362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:40.758872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:40.759039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:40.844823 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:30:40.848278 [info ] [MainThread]: 
[0m12:30:40.851395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:30:40.857820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:30:40.867004 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:30:40.869986 [info ] [MainThread]: 
[0m12:30:40.871959 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:30:40.877378 [debug] [MainThread]: Command end result
[0m12:30:40.880113 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7555155, "process_user_time": 1.557552, "process_kernel_time": 0.117627, "process_mem_max_rss": "97388", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:30:40.899577 [debug] [MainThread]: Command `dbt test` succeeded at 12:30:40.899246 after 0.77 seconds
[0m12:30:40.903014 [debug] [MainThread]: Flushing usage events
[0m12:30:40.981516 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:30:40.983177 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:30:40.989122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:41.023101 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.035 seconds
[0m12:30:41.027263 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:30:41.040338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:30:41.041534 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:30:41.051110 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:30:41.055986 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:30:41.058173 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:30:41.059319 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:30:41.059921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:41.060522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:41.071373 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:30:41.072114 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:30:41.073433 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:30:41.074364 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:30:41.075896 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:30:41.079912 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:30:41.085018 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m12:30:41.085682 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:41.089392 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:30:41.090847 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:30:41.091557 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:30:41.092177 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:30:41.102579 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:41.104274 [debug] [MainThread]: On master: BEGIN
[0m12:30:41.106107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:46.118937 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m12:30:46.120932 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:46.121466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:30:46.125446 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:30:46.130511 [debug] [MainThread]: On master: ROLLBACK
[0m12:30:46.131167 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:46.132749 [debug] [MainThread]: On master: BEGIN
[0m12:30:46.137977 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:30:46.139001 [debug] [MainThread]: On master: COMMIT
[0m12:30:46.141844 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:46.143848 [debug] [MainThread]: On master: COMMIT
[0m12:30:46.145677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:46.146142 [debug] [MainThread]: On master: Close
[0m12:30:46.147346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:46.148140 [info ] [MainThread]: 
[0m12:30:46.157282 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m12:30:46.158278 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m12:30:46.158907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m12:30:46.159334 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m12:30:46.169844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m12:30:46.171246 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m12:30:46.208754 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m12:30:46.212736 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:30:46.214676 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m12:30:46.216910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:46.225017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:30:46.233569 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:30:46.235486 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m12:30:47.974009 [debug] [Thread-1 (]: SQL status: SELECT 1159181 in 1.737 seconds
[0m12:30:47.987547 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:30:47.988398 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m12:30:47.989584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:30:48.006959 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m12:30:48.007576 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:30:48.008028 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m12:30:48.012236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:30:48.023495 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m12:30:48.032272 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:30:48.033638 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m12:30:48.035905 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:30:48.041784 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m12:30:48.044979 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159181[0m in 1.88s]
[0m12:30:48.046319 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m12:30:48.048854 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:48.049537 [debug] [MainThread]: On master: BEGIN
[0m12:30:48.050117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:48.057092 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:30:48.057683 [debug] [MainThread]: On master: COMMIT
[0m12:30:48.058233 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:48.058766 [debug] [MainThread]: On master: COMMIT
[0m12:30:48.059317 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:48.059789 [debug] [MainThread]: On master: Close
[0m12:30:48.060371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:48.101326 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:30:48.104162 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m12:30:48.107227 [info ] [MainThread]: 
[0m12:30:48.109311 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m12:30:48.111964 [debug] [MainThread]: Command end result
[0m12:30:48.114122 [info ] [MainThread]: 
[0m12:30:48.114873 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:48.117000 [info ] [MainThread]: 
[0m12:30:48.117649 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:30:48.120371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.995033, "process_user_time": 1.810002, "process_kernel_time": 0.16399, "process_mem_max_rss": "106344", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:30:48.121907 [debug] [MainThread]: Command `dbt run` succeeded at 12:30:48.121706 after 8.00 seconds
[0m12:30:48.122691 [debug] [MainThread]: Flushing usage events
[0m12:30:55.945518 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:30:55.951771 | 97f2f5ec-cfee-4350-9735-1ef8b1cbb32d ==============================
[0m12:30:55.951771 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:30:55.954824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:56.164764 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:30:56.180905 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:30:56.436998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:56.437669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:56.517494 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:30:56.520043 [info ] [MainThread]: 
[0m12:30:56.523937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:30:56.528805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:30:56.539053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:30:56.563636 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:30:56.564180 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:30:56.568726 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:30:56.569831 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:30:56.570310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:56.570807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:56.577058 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:30:56.577454 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:30:56.577924 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:30:56.578508 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:30:56.579176 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:30:56.579724 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:30:56.585803 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:30:56.587081 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:30:56.586090 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.003 seconds
[0m12:30:56.588764 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:30:56.587563 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:30:56.589298 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:30:56.595978 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:56.596610 [debug] [MainThread]: On master: BEGIN
[0m12:30:56.597822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:01.611122 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m12:31:01.613336 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:01.613947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:31:01.621923 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m12:31:01.629344 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:01.631710 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:01.633254 [debug] [MainThread]: On master: BEGIN
[0m12:31:01.635002 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:31:01.636707 [debug] [MainThread]: On master: COMMIT
[0m12:31:01.637941 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:01.638729 [debug] [MainThread]: On master: COMMIT
[0m12:31:01.639274 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:01.639902 [debug] [MainThread]: On master: Close
[0m12:31:01.641815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:01.642415 [info ] [MainThread]: 
[0m12:31:01.651412 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m12:31:01.652039 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m12:31:01.652651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m12:31:01.653039 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m12:31:01.661718 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m12:31:01.663452 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m12:31:01.679168 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m12:31:01.682391 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m12:31:01.682781 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m12:31:01.685704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:06.693331 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m12:31:06.694839 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m12:31:06.695426 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m12:31:07.088489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.392 seconds
[0m12:31:07.096541 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m12:31:07.097452 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m12:31:07.098706 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 5.45s]
[0m12:31:07.099777 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m12:31:07.102789 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:07.103366 [debug] [MainThread]: On master: BEGIN
[0m12:31:07.103779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:07.109884 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:31:07.110409 [debug] [MainThread]: On master: COMMIT
[0m12:31:07.110888 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:07.111268 [debug] [MainThread]: On master: COMMIT
[0m12:31:07.111855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:07.112245 [debug] [MainThread]: On master: Close
[0m12:31:07.112804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:07.113236 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m12:31:07.113665 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:31:07.114277 [info ] [MainThread]: 
[0m12:31:07.114728 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.59 seconds (10.59s).
[0m12:31:07.115600 [debug] [MainThread]: Command end result
[0m12:31:07.116070 [info ] [MainThread]: 
[0m12:31:07.116555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:07.116987 [info ] [MainThread]: 
[0m12:31:07.117474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:31:07.118820 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.215239, "process_user_time": 1.567522, "process_kernel_time": 0.116827, "process_mem_max_rss": "108064", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m12:31:07.119613 [debug] [MainThread]: Command `dbt test` succeeded at 12:31:07.119476 after 11.22 seconds
[0m12:31:07.120192 [debug] [MainThread]: Flushing usage events
[0m12:37:39.662731 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:37:39.670552 | 8c9dea80-0af3-44f6-bba3-fdebfa5a5f36 ==============================
[0m12:37:39.670552 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:37:39.671125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m12:37:39.837931 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m12:37:39.843325 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m12:37:39.847228 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r5doad1y'
[0m12:37:39.847669 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m12:37:39.848449 [debug] [MainThread]: Creating symlink to local dependency.
[0m12:37:39.848915 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m12:37:39.849897 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.23141192, "process_user_time": 1.08852, "process_kernel_time": 0.1158, "process_mem_max_rss": "106172", "process_in_blocks": "848", "process_out_blocks": "11"}
[0m12:37:39.850414 [debug] [MainThread]: Command `dbt deps` succeeded at 12:37:39.850341 after 0.23 seconds
[0m12:37:39.850728 [debug] [MainThread]: Flushing usage events
[0m12:37:41.772420 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:37:41.777983 | a2b8aadf-9934-4f6c-8bef-20342e6ed386 ==============================
[0m12:37:41.777983 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:37:41.780725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:37:41.972336 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:37:42.009718 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:37:42.013374 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:37:43.829605 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:37:43.833061 [info ] [MainThread]: 
[0m12:37:43.834013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:43.837359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:37:43.867436 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:37:43.868087 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:37:43.868551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:43.876625 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m12:37:43.877919 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:37:43.878745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m12:37:43.879285 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m12:37:43.884162 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:37:43.884603 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m12:37:43.885022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:43.889658 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:37:43.890291 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:37:43.890756 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m12:37:43.891794 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:37:43.892727 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:37:43.893092 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:37:43.893420 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:37:43.894484 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:37:43.894825 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m12:37:43.899534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m12:37:43.900175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:37:43.905120 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:37:43.907097 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:37:43.907525 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:37:43.907900 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:37:43.908236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:43.908560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:43.913403 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:37:43.913986 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:37:43.914449 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:37:43.918333 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:37:43.919299 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:37:43.919756 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:37:48.915960 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:37:48.919127 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:37:48.920852 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:37:48.923692 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:37:48.926078 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:37:48.926717 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:37:48.938051 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.939823 [debug] [MainThread]: On master: BEGIN
[0m12:37:48.941860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:48.946928 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:37:48.947526 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.948049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:48.955831 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:37:48.960147 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:48.960816 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.963081 [debug] [MainThread]: On master: BEGIN
[0m12:37:48.964315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:37:48.965933 [debug] [MainThread]: On master: COMMIT
[0m12:37:48.966333 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:48.967422 [debug] [MainThread]: On master: COMMIT
[0m12:37:48.971756 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:37:48.972154 [debug] [MainThread]: On master: Close
[0m12:37:48.972798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:48.973365 [info ] [MainThread]: 
[0m12:37:48.983534 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m12:37:48.984354 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m12:37:48.985055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m12:37:48.985544 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m12:37:48.986076 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m12:37:49.013846 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:37:49.014659 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m12:37:49.015240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:49.020537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:37:49.021146 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:37:49.021579 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m12:37:49.024543 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m12:37:49.088722 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:37:49.090842 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m12:37:49.093372 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m12:37:49.099515 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m12:37:49.130002 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:37:49.137854 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:37:49.161601 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:37:49.173359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:37:49.186771 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m12:37:49.189105 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.20s]
[0m12:37:49.190347 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m12:37:49.192946 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:49.193369 [debug] [MainThread]: On master: BEGIN
[0m12:37:49.193748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:49.198731 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:37:49.199230 [debug] [MainThread]: On master: COMMIT
[0m12:37:49.199571 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:49.199942 [debug] [MainThread]: On master: COMMIT
[0m12:37:49.200419 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:37:49.200782 [debug] [MainThread]: On master: Close
[0m12:37:49.201373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:49.201719 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:37:49.202196 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m12:37:49.202552 [info ] [MainThread]: 
[0m12:37:49.203092 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.37 seconds (5.37s).
[0m12:37:49.204005 [debug] [MainThread]: Command end result
[0m12:37:49.251981 [info ] [MainThread]: 
[0m12:37:49.253231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:49.253883 [info ] [MainThread]: 
[0m12:37:49.254297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:37:49.255860 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.52885, "process_user_time": 3.050378, "process_kernel_time": 0.099281, "process_mem_max_rss": "113648", "process_in_blocks": "24", "process_out_blocks": "3516"}
[0m12:37:49.256668 [debug] [MainThread]: Command `dbt seed` succeeded at 12:37:49.256569 after 7.53 seconds
[0m12:37:49.257282 [debug] [MainThread]: Flushing usage events
[0m12:38:48.024475 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:38:48.034220 | cfe84676-68e7-41dc-beab-8f9754ddef9a ==============================
[0m12:38:48.034220 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:38:48.039975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.087550 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:38:48.098425 | 34f13fd2-7e1c-4966-ae54-134d560aa59c ==============================
[0m12:38:48.098425 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:38:48.099436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.095487 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:38:48.099808 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:38:48.106347 | 8f4a5695-64fa-4d11-b3bb-f69f648a37fa ==============================
[0m12:38:48.106347 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:38:48.108580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 12:38:48.108784 | e04157eb-5a08-4099-bcca-a2b963a52d5e ==============================
[0m12:38:48.108784 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:38:48.103436 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:38:48.111705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.106014 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:38:48.114287 | a4dd5591-5ebd-47b0-8cf9-905b9359d514 ==============================
[0m12:38:48.114287 [info ] [MainThread]: Running with dbt=1.8.2


============================== 12:38:48.112604 | 4d9f2ce7-d23e-49e4-bfc6-b5e2a088143c ==============================
[0m12:38:48.112604 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:38:48.117070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.118598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.127364 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:38:48.138179 | 13df1dd2-c6d7-4adb-ba99-ba90ef1dd2a1 ==============================
[0m12:38:48.138179 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:38:48.140206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.407579 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.483051 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:38:48.527059 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.542832 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.543219 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.552818 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.660186 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.665818 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.710033 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:38:48.716803 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:38:48.716330 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:38:48.733022 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:38:48.728794 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:38:48.735032 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:38:48.873622 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:38:48.887104 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:38:48.927240 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:38:48.928594 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:38:48.931065 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:38:48.933436 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:38:48.936620 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:38:48.939102 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:38:48.942320 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:38:48.943367 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:38:48.967196 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:38:48.969954 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:38:48.986425 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:38:48.988500 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:38:51.403747 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:38:51.415365 [info ] [MainThread]: 
[0m12:38:51.417315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:51.419687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:38:51.432103 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:38:51.433759 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:38:51.436374 [info ] [MainThread]: 
[0m12:38:51.440094 [info ] [MainThread]: 
[0m12:38:51.441597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:51.443551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:51.445964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:38:51.446989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:38:51.462208 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:38:51.468816 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:38:51.471443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.487357 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m12:38:51.493900 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:38:51.494852 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:38:51.496422 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:38:51.497420 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:38:51.499558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.499157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:38:51.500786 [info ] [MainThread]: 
[0m12:38:51.502293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:38:51.504555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:51.504598 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:38:51.505150 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:38:51.505855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.506471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:38:51.512606 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m12:38:51.513143 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.514526 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:38:51.516259 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m12:38:51.516859 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:38:51.516516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.519605 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:38:51.519356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:38:51.522930 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:38:51.522885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:38:51.527694 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:38:51.530677 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.536923 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:38:51.539787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.539454 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.538649 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m12:38:51.542845 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:38:51.543375 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.544531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.544549 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:38:51.547665 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:38:51.546717 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:38:51.549262 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:38:51.553455 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.554109 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:38:51.553947 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:38:51.556583 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:38:51.551637 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:38:51.557830 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.558630 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.562309 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:38:51.561208 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:38:51.560516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.566477 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m12:38:51.563114 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m12:38:51.566870 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m12:38:51.569436 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:38:51.572296 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:38:51.572394 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:38:51.575363 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:38:51.577614 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.578994 [info ] [MainThread]: 
[0m12:38:51.579754 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:38:51.580299 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:38:51.583068 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:38:51.581966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:51.585549 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:38:51.584820 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:38:51.587309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:38:51.588188 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:38:51.587847 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:38:51.590516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m12:38:51.599811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m12:38:51.602298 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:38:51.605648 [info ] [MainThread]: 
[0m12:38:51.605203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m12:38:51.607426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:51.593099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:38:51.611114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:38:51.608490 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:51.606734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:38:51.613735 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.609748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:38:51.616719 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:38:51.618180 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:38:51.619936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.619067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.616550 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.616578 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:51.621037 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:51.621754 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:38:51.624141 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:38:51.624980 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:38:51.626701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.621162 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.629115 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:38:51.626198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.629524 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:38:51.630166 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:38:51.630306 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:51.627721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.631689 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:38:51.631406 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:38:51.631108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.632428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.637485 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:38:51.639640 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:38:51.640479 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.640315 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:38:51.640227 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m12:38:51.640919 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:38:51.641522 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:38:51.642462 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:38:51.643942 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:38:51.645337 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:38:51.646676 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:38:51.648028 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:38:51.648805 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:38:51.649423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.650600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:38:51.651414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:38:51.657582 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.660008 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:51.660563 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:38:51.661158 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:38:51.661649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.662113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.667496 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:38:51.667948 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:38:51.668459 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.669010 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:51.669470 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:38:51.670077 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:38:51.671339 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:38:51.673174 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:38:51.673820 [info ] [MainThread]: 
[0m12:38:51.674486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:51.673525 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:38:51.675569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:38:51.674718 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:38:51.676000 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:38:51.676677 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:38:51.677173 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:38:51.683257 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:51.683866 [debug] [MainThread]: On master: BEGIN
[0m12:38:51.684369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:51.688946 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:38:51.689582 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:51.690222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:38:51.693043 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m12:38:51.694278 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:51.694801 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:51.695226 [debug] [MainThread]: On master: BEGIN
[0m12:38:51.695903 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:38:51.697425 [debug] [MainThread]: On master: COMMIT
[0m12:38:51.697827 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:51.698340 [debug] [MainThread]: On master: COMMIT
[0m12:38:51.698883 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:51.699241 [debug] [MainThread]: On master: Close
[0m12:38:51.699732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:51.700408 [info ] [MainThread]: 
[0m12:38:51.703232 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:38:51.703786 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:38:51.707315 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m12:38:51.707376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.708020 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m12:38:51.708790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m12:38:51.709314 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m12:38:51.713652 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m12:38:51.715165 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:38:51.718333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m12:38:51.721194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:38:51.726971 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m12:38:51.722216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:38:51.729831 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.732282 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:51.733091 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:38:51.734595 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:38:51.735567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:51.736118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:51.740469 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:38:51.742123 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:51.742674 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:38:51.745334 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:38:51.746536 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:38:51.747132 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:38:51.757085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m12:38:51.759917 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:38:51.760428 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m12:38:51.760895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:56.576340 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m12:38:56.581266 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:38:56.591505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:38:56.592264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:38:56.600709 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:56.602733 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:56.603183 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:38:56.603573 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:38:56.604052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:56.604435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:56.609222 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:38:56.610130 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:56.610526 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:38:56.611069 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:38:56.611492 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:56.612036 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:38:56.613794 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:38:56.614125 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:38:56.615621 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:38:56.616833 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:38:56.617441 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:38:56.617836 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:38:56.623788 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.624260 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.624572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:56.630267 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m12:38:56.634217 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:56.635053 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:38:56.638869 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:38:56.640302 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m12:38:56.642357 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:56.642945 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:38:56.640849 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m12:38:56.643829 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:38:56.642579 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m12:38:56.643819 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:56.644497 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:38:56.645534 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:38:56.644423 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:56.647634 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:38:56.649565 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:38:56.653791 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:38:56.654016 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:38:56.655206 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:38:56.654606 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:38:56.658355 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:38:56.663100 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.661301 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m12:38:56.661153 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:38:56.666461 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.666371 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:38:56.670234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:56.671226 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:38:56.673019 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.669481 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:38:56.673959 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.675309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:56.682269 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:38:56.685565 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:38:56.685117 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.686948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:38:56.686379 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.686087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:38:56.687622 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.688040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:38:56.688756 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.694069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:56.698119 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:38:56.687089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:38:56.698382 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:38:56.712648 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:56.707125 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:56.699924 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:56.715982 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.716744 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.740861 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m12:38:56.721135 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:38:56.726072 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.741120 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.742444 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.747202 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:38:56.743898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:56.751268 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:38:56.756751 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m12:38:56.753718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:38:56.758461 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.717106 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:38:56.765508 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.774142 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:56.774568 [debug] [Thread-1 (]: SQL status: BEGIN in 5.013 seconds
[0m12:38:56.777196 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.778875 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.780355 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.779316 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:38:56.779970 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:38:56.778305 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:38:56.781072 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:56.777359 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m12:38:56.782026 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:38:56.780678 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.780239 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:38:56.782799 [debug] [MainThread]: On master: Close
[0m12:38:56.782366 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:38:56.783626 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:38:56.781471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:56.784138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:56.785463 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:56.784281 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m12:38:56.787186 [debug] [MainThread]: On master: Close
[0m12:38:56.787599 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:56.788406 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:38:56.787894 [info ] [MainThread]: 
[0m12:38:56.790295 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:38:56.789282 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.791161 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:38:56.790166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:56.793280 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:38:56.792176 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.792988 [info ] [MainThread]: 
[0m12:38:56.793514 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:38:56.795378 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:38:56.794498 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:38:56.799498 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.801330 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.802297 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.804431 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:56.804828 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:38:56.805627 [debug] [MainThread]: On master: Close
[0m12:38:56.807209 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m12:38:56.808536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:56.811107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:38:56.811757 [info ] [MainThread]: 
[0m12:38:56.813784 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m12:38:56.817561 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m12:38:56.820446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m12:38:56.822288 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m12:38:56.823994 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.825889 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m12:38:56.827034 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.829746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:56.829224 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m12:38:56.834623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m12:38:56.836895 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m12:38:56.839826 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m12:38:56.841385 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:38:56.841831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m12:38:56.842357 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.842385 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m12:38:56.843872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:38:56.845582 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m12:38:56.844597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m12:38:56.847612 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:38:56.850212 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m12:38:56.846574 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:38:56.850304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m12:38:56.851193 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:38:56.851141 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:56.852327 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:38:56.853116 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.853259 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m12:38:56.855077 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.855410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:38:56.856398 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:38:56.857231 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.858548 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.859987 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.860680 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:56.863337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m12:38:56.863738 [debug] [MainThread]: On master: Close
[0m12:38:56.864393 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m12:38:56.866449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:56.867601 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m12:38:56.868479 [info ] [MainThread]: 
[0m12:38:56.870525 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:38:56.871562 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m12:38:56.873233 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:38:56.880464 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m12:38:56.882394 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m12:38:56.883098 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.17s]
[0m12:38:56.883979 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m12:38:56.885329 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m12:38:56.885718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m12:38:56.885913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m12:38:56.887048 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m12:38:56.888984 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.889732 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:38:56.890879 [debug] [MainThread]: On master: BEGIN
[0m12:38:56.891310 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m12:38:56.891759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:56.892151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:56.893819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m12:38:56.896288 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:38:56.896881 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m12:38:56.897491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:56.898205 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:38:56.898824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m12:38:56.898990 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.899810 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:56.900448 [debug] [MainThread]: On master: COMMIT
[0m12:38:56.901266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:56.901325 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m12:38:56.901775 [debug] [MainThread]: On master: Close
[0m12:38:56.902635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:38:56.906160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:56.906202 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:38:56.906525 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m12:38:56.905608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m12:38:56.906645 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m12:38:56.906823 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:38:56.907479 [info ] [MainThread]: 
[0m12:38:56.908115 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m12:38:56.908264 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:38:56.908502 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:38:56.909269 [debug] [MainThread]: Command end result
[0m12:38:56.909702 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m12:38:56.911149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:56.910945 [info ] [MainThread]: 
[0m12:38:56.911856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:56.912429 [info ] [MainThread]: 
[0m12:38:56.913396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:56.916290 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:38:56.916928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:38:56.917007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.862549, "process_user_time": 4.967621, "process_kernel_time": 0.320525, "process_mem_max_rss": "113144", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:38:56.917024 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m12:38:56.917567 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:38:56.918388 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:56.918275 after 8.86 seconds
[0m12:38:56.918365 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m12:38:56.918394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:38:56.918966 [debug] [MainThread]: Flushing usage events
[0m12:38:56.920548 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:38:56.930894 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:38:56.932289 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m12:38:56.935438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:38:56.943951 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:38:56.949523 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:38:56.957958 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:38:56.960745 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m12:38:56.962708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:38:56.972661 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m12:38:56.973491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:38:56.974723 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:38:56.977424 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m12:38:56.979286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:56.978750 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:38:56.982250 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:38:56.983869 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:38:56.984774 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:38:56.985322 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m12:38:56.989711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m12:38:56.990211 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:38:56.990792 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:38:56.993985 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m12:38:56.992194 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m12:38:56.994632 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m12:38:56.997122 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.16s]
[0m12:38:56.998366 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m12:38:56.998761 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m12:38:57.001566 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:57.003205 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:38:57.003643 [debug] [MainThread]: On master: BEGIN
[0m12:38:57.004107 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m12:38:57.004575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:57.005912 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:38:57.010080 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:38:57.011144 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m12:38:57.011300 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m12:38:57.013354 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:38:57.013080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:38:57.014534 [debug] [MainThread]: On master: COMMIT
[0m12:38:57.017062 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.17s]
[0m12:38:57.017182 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:57.019491 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m12:38:57.019961 [debug] [MainThread]: On master: COMMIT
[0m12:38:57.021568 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:38:57.022389 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:57.023474 [debug] [MainThread]: On master: Close
[0m12:38:57.024042 [debug] [MainThread]: On master: BEGIN
[0m12:38:57.024617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:57.025492 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m12:38:57.025278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:57.026849 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:38:57.027806 [info ] [MainThread]: 
[0m12:38:57.029221 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m12:38:57.031801 [debug] [MainThread]: Command end result
[0m12:38:57.032600 [info ] [MainThread]: 
[0m12:38:57.033910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:57.034879 [info ] [MainThread]: 
[0m12:38:57.035926 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:38:57.037422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:57.038596 [debug] [MainThread]: On master: COMMIT
[0m12:38:57.039137 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m12:38:57.040619 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.024045, "process_user_time": 4.963226, "process_kernel_time": 0.390272, "process_mem_max_rss": "112672", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m12:38:57.039758 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:57.041175 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:38:57.042200 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m12:38:57.041932 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:57.041783 after 9.03 seconds
[0m12:38:57.042087 [debug] [MainThread]: On master: COMMIT
[0m12:38:57.043434 [debug] [MainThread]: Flushing usage events
[0m12:38:57.044014 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:38:57.044454 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:57.047043 [debug] [MainThread]: On master: Close
[0m12:38:57.048794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:57.050022 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:38:57.052895 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m12:38:57.053750 [info ] [MainThread]: 
[0m12:38:57.054513 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m12:38:57.056948 [debug] [MainThread]: Command end result
[0m12:38:57.057691 [info ] [MainThread]: 
[0m12:38:57.059359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:57.058542 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m12:38:57.061984 [info ] [MainThread]: 
[0m12:38:57.063500 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:57.066267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.129156, "process_user_time": 4.969191, "process_kernel_time": 0.330026, "process_mem_max_rss": "112988", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m12:38:57.067515 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:57.067331 after 9.13 seconds
[0m12:38:57.068403 [debug] [MainThread]: Flushing usage events
[0m12:38:57.068972 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:38:57.071216 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m12:38:57.073327 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:38:57.080711 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m12:38:57.086048 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.20s]
[0m12:38:57.087897 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m12:38:57.095571 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:57.098473 [debug] [MainThread]: On master: BEGIN
[0m12:38:57.099505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:57.113336 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:38:57.115381 [debug] [MainThread]: On master: COMMIT
[0m12:38:57.116862 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:57.118394 [debug] [MainThread]: On master: COMMIT
[0m12:38:57.119495 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:38:57.120236 [debug] [MainThread]: On master: Close
[0m12:38:57.121831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:57.122957 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:38:57.124160 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m12:38:57.125227 [info ] [MainThread]: 
[0m12:38:57.126428 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m12:38:57.128582 [debug] [MainThread]: Command end result
[0m12:38:57.129351 [info ] [MainThread]: 
[0m12:38:57.130891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:57.132637 [info ] [MainThread]: 
[0m12:38:57.134713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:57.142423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.110254, "process_user_time": 4.943403, "process_kernel_time": 0.355933, "process_mem_max_rss": "112708", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:38:57.145379 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:57.145021 after 9.11 seconds
[0m12:38:57.146570 [debug] [MainThread]: Flushing usage events
[0m12:39:01.419923 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:39:01.420924 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:01.432744 | 260641b7-92f5-4b97-9ca1-ed251f0835a8 ==============================
[0m12:39:01.432744 [info ] [MainThread]: Running with dbt=1.8.2


============================== 12:39:01.433062 | 0fe844c8-d85c-4625-8714-9d4a2a9cf57e ==============================
[0m12:39:01.433062 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:01.436025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:01.424829 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:39:01.436235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 12:39:01.440797 | 056faf73-ed51-4bab-9b9d-fec3b0df08b6 ==============================
[0m12:39:01.440797 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:01.449963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:01.487024 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:39:01.482613 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:01.494499 | 751d4ed7-0a77-46dd-a176-bdf4119e241c ==============================
[0m12:39:01.494499 [info ] [MainThread]: Running with dbt=1.8.2


============================== 12:39:01.494234 | 23a3226d-d5bf-4c2b-a30a-a187b4c44367 ==============================
[0m12:39:01.494234 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:01.495693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:01.493669 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:39:01.498789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 12:39:01.502074 | 1ddf440e-7650-41ea-96fe-818cc51c070f ==============================
[0m12:39:01.502074 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:01.507909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:01.501190 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:01.516651 | 4992e25a-4112-4cdf-82df-069b74e59828 ==============================
[0m12:39:01.516651 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:01.519829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:01.638105 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m12:39:01.640565 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:01.642024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:01.654200 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m12:39:01.666950 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:01.674166 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:01.675649 [debug] [MainThread]: On master: BEGIN
[0m12:39:01.679320 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m12:39:01.683701 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.686402 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:01.689067 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.693384 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:01.701002 [debug] [MainThread]: On master: Close
[0m12:39:01.708068 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:01.716142 [info ] [MainThread]: 
[0m12:39:01.751500 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m12:39:01.753425 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m12:39:01.755174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m12:39:01.759520 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m12:39:01.778595 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m12:39:01.783909 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m12:39:01.801756 [debug] [ThreadPool]: SQL status: BEGIN in 5.019 seconds
[0m12:39:01.808187 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:01.810994 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:01.820540 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:39:01.826167 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:01.829169 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:01.850383 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m12:39:01.896989 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:01.900395 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:39:01.898813 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:01.901204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:01.903672 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:01.907929 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m12:39:01.906793 [debug] [MainThread]: On master: BEGIN
[0m12:39:01.911194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:01.912524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:01.924347 [debug] [Thread-1 (]: SQL status: BEGIN in 5.031 seconds
[0m12:39:01.933746 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:39:01.933511 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m12:39:01.936434 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:01.939088 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:01.937455 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m12:39:01.938901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:01.951792 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:39:01.954334 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:01.959667 [debug] [MainThread]: SQL status: SELECT 3 in 0.012 seconds
[0m12:39:01.969323 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:01.972024 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:01.979697 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:01.979447 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:01.982005 [debug] [MainThread]: On master: BEGIN
[0m12:39:01.988078 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:01.988613 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.989040 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:01.981141 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:01.992149 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.994374 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:39:01.996339 [debug] [MainThread]: On master: Close
[0m12:39:01.994045 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:01.999422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:02.005990 [info ] [MainThread]: 
[0m12:39:02.005401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:39:02.011994 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m12:39:02.019249 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:02.021789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:02.022470 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:02.042095 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:39:02.049812 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:39:02.055204 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m12:39:02.054594 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:39:02.057693 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m12:39:02.062822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m12:39:02.068012 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:39:02.068615 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m12:39:02.076159 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:02.087088 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m12:39:02.099345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m12:39:02.099515 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:02.108463 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:39:02.109788 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m12:39:02.113831 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m12:39:02.119899 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:39:02.131950 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m12:39:02.145981 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 5.32s]
[0m12:39:02.154089 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m12:39:02.166464 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:02.194969 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:02.200065 [debug] [MainThread]: On master: BEGIN
[0m12:39:02.200564 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m12:39:02.202143 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:02.216374 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:39:02.220069 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m12:39:02.222942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:02.223579 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m12:39:02.229554 [debug] [MainThread]: On master: COMMIT
[0m12:39:02.234146 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:02.242267 [debug] [MainThread]: On master: COMMIT
[0m12:39:02.247653 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:02.253851 [debug] [MainThread]: On master: Close
[0m12:39:02.256875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:02.259438 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m12:39:02.261238 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:39:02.264989 [info ] [MainThread]: 
[0m12:39:02.269587 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.82 seconds (10.82s).
[0m12:39:02.271074 [debug] [MainThread]: Command end result
[0m12:39:02.272430 [info ] [MainThread]: 
[0m12:39:02.274871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:02.280166 [info ] [MainThread]: 
[0m12:39:02.282550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:02.286575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.240948, "process_user_time": 5.056458, "process_kernel_time": 0.371844, "process_mem_max_rss": "112408", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m12:39:02.299115 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:02.298704 after 14.25 seconds
[0m12:39:02.303211 [debug] [MainThread]: Flushing usage events
[0m12:39:02.471863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.471918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.473529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.474724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.478021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.480738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.480478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.479570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.483597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.484167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.555168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.566136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.610443 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:02.617614 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:02.619079 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:02.626002 [info ] [MainThread]: 
[0m12:39:02.629489 [info ] [MainThread]: 
[0m12:39:02.632838 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:02.641028 [info ] [MainThread]: 
[0m12:39:02.637091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:02.640356 [info ] [MainThread]: 
[0m12:39:02.651567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:02.632543 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:02.645810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:02.654921 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:02.657159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:02.657700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:02.661521 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:02.666109 [info ] [MainThread]: 
[0m12:39:02.665477 [debug] [MainThread]: Command end result
[0m12:39:02.667975 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:02.672163 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3088359, "process_user_time": 2.990544, "process_kernel_time": 0.296082, "process_mem_max_rss": "97316", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:02.674959 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:02.674822 after 1.31 seconds
[0m12:39:02.678612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.679298 [debug] [MainThread]: Command end result
[0m12:39:02.679696 [debug] [MainThread]: Flushing usage events
[0m12:39:02.680191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.682223 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.3079425, "process_user_time": 3.027535, "process_kernel_time": 0.268276, "process_mem_max_rss": "97240", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:02.686582 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:02.686363 after 1.31 seconds
[0m12:39:02.687259 [debug] [MainThread]: Flushing usage events
[0m12:39:02.739953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:02.751862 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:02.754887 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:02.756823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:02.761692 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:02.780024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:02.789452 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:02.791304 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:02.794416 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.038 seconds
[0m12:39:02.797850 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m12:39:02.796616 [info ] [MainThread]: 
[0m12:39:02.801951 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:02.804807 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:02.803324 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:02.805822 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:02.806262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:02.820315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:39:02.822597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:39:02.815297 [debug] [MainThread]: Command end result
[0m12:39:02.832539 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4250902, "process_user_time": 3.12386, "process_kernel_time": 0.267128, "process_mem_max_rss": "97240", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:02.833117 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.027 seconds
[0m12:39:02.823552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:39:02.837345 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:02.837011 after 1.43 seconds
[0m12:39:02.846013 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:02.839581 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:02.825117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:39:02.853034 [debug] [MainThread]: Flushing usage events
[0m12:39:02.857271 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:02.846283 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:02.853639 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:02.868666 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:02.868107 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:02.863247 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:02.866203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:39:02.874073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:02.872999 [info ] [MainThread]: 
[0m12:39:02.867564 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:02.863870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:02.881003 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:02.876238 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:02.892187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:02.884596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:02.896132 [debug] [MainThread]: Command end result
[0m12:39:02.894621 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m12:39:02.869717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:39:02.903246 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.4951555, "process_user_time": 3.144077, "process_kernel_time": 0.321453, "process_mem_max_rss": "97392", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:02.900245 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:39:02.923037 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:02.915720 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:02.920566 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m12:39:02.904816 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:02.923046 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:02.921747 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:02.921280 after 1.51 seconds
[0m12:39:02.927000 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:02.929894 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:02.930314 [debug] [MainThread]: Flushing usage events
[0m12:39:02.928712 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:02.931620 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m12:39:02.926711 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:02.931224 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:02.935131 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:02.944123 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m12:39:02.933581 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:02.941225 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:02.932003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:02.946882 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m12:39:02.954138 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:39:02.936285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:02.956830 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:02.950894 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:02.957716 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m12:39:02.958316 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:02.959989 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:02.964897 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m12:39:02.965991 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:02.966713 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:02.967483 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m12:39:02.959416 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:02.968296 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:02.972909 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:02.976454 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:02.968046 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:02.978382 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:02.979873 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:39:02.976323 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:02.983264 [debug] [MainThread]: On master: BEGIN
[0m12:39:02.981950 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m12:39:02.987265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:02.989458 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:02.991030 [debug] [MainThread]: On master: BEGIN
[0m12:39:02.986266 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:02.990996 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:02.992473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:02.993035 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:02.994159 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:02.997130 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:39:03.000976 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.000587 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:39:03.002716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:03.007000 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.008354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:03.013666 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m12:39:03.012585 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.016338 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:03.013866 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m12:39:03.016759 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.018282 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.018319 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:03.018877 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.018756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:03.021209 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.022490 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:39:03.023587 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.024400 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.026959 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:03.026299 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.028585 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.027673 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.029054 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:39:03.029287 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.029541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:03.030984 [debug] [MainThread]: On master: Close
[0m12:39:03.030108 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.031250 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.032265 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:03.032901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:03.034041 [info ] [MainThread]: 
[0m12:39:03.042332 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m12:39:03.041927 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m12:39:03.047635 [debug] [MainThread]: On master: Close
[0m12:39:03.049531 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:03.050376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:03.053192 [info ] [MainThread]: 
[0m12:39:03.053992 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.060244 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.057055 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m12:39:03.063143 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:39:03.064722 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m12:39:03.066298 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.068624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m12:39:03.070295 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m12:39:03.069388 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.076254 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m12:39:03.078070 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.080039 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m12:39:03.083885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m12:39:03.082442 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:03.087909 [debug] [MainThread]: On master: Close
[0m12:39:03.086724 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m12:39:03.093468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m12:39:03.091232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:03.097909 [info ] [MainThread]: 
[0m12:39:03.105664 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m12:39:03.111943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m12:39:03.111748 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m12:39:03.114978 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m12:39:03.117612 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m12:39:03.121082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m12:39:03.125433 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m12:39:03.141394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m12:39:03.149336 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m12:39:03.156624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m12:39:03.177524 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:39:03.180490 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m12:39:03.183540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:03.185395 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m12:39:03.189820 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:39:03.191302 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m12:39:03.193304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:03.196627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m12:39:03.198514 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:39:03.199596 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m12:39:03.205567 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:39:03.205363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m12:39:03.208518 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m12:39:03.209216 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:39:03.214371 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:39:03.216105 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m12:39:03.213284 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m12:39:03.217664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:03.223227 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:39:03.223194 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:39:03.226248 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m12:39:03.230172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:39:03.232750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m12:39:03.235219 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:39:03.235832 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:39:03.236833 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m12:39:03.236942 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m12:39:03.238248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:39:03.242868 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:39:03.252417 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:39:03.256332 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:39:03.259097 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:39:03.259885 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:39:03.259746 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:39:03.261743 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:39:03.262393 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m12:39:03.263699 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:39:03.265252 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:39:03.264522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:39:03.264964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:39:03.284166 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m12:39:03.284718 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m12:39:03.295806 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:39:03.298787 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m12:39:03.301347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:39:03.303501 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:39:03.303746 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m12:39:03.306419 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m12:39:03.307823 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:39:03.309831 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m12:39:03.309096 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:39:03.308649 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m12:39:03.316149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:39:03.315396 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m12:39:03.318973 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m12:39:03.321926 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m12:39:03.324215 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m12:39:03.328532 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m12:39:03.328464 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m12:39:03.329849 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.334472 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.337727 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:39:03.336221 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.338231 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.339430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:03.338858 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m12:39:03.340717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:03.343685 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:39:03.349373 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m12:39:03.354654 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.24s]
[0m12:39:03.357664 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m12:39:03.363187 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.365862 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.366369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:03.373075 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:39:03.373851 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.374378 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:03.375087 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.375946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:03.376481 [debug] [MainThread]: On master: Close
[0m12:39:03.377137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:03.377546 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m12:39:03.378001 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:39:03.378563 [info ] [MainThread]: 
[0m12:39:03.379179 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:39:03.380458 [debug] [MainThread]: Command end result
[0m12:39:03.381193 [info ] [MainThread]: 
[0m12:39:03.382001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:03.382596 [info ] [MainThread]: 
[0m12:39:03.383644 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:03.387630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0867186, "process_user_time": 3.384099, "process_kernel_time": 0.313743, "process_mem_max_rss": "106444", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m12:39:03.388669 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:03.388473 after 2.09 seconds
[0m12:39:03.389348 [debug] [MainThread]: Flushing usage events
[0m12:39:05.769159 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:05.776798 | dc8e636b-e8e1-4f3d-a7e9-9d8f5696f109 ==============================
[0m12:39:05.776798 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:05.778431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:06.058120 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:06.096610 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:06.427286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:06.428135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:06.520067 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:06.521778 [info ] [MainThread]: 
[0m12:39:06.522438 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:06.524409 [debug] [MainThread]: Command end result
[0m12:39:06.525325 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8228047, "process_user_time": 2.079212, "process_kernel_time": 0.203277, "process_mem_max_rss": "97572", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:06.526323 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:06.526180 after 0.82 seconds
[0m12:39:06.526914 [debug] [MainThread]: Flushing usage events
[0m12:39:06.568224 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:06.574987 | c5f81110-07e3-4dde-8891-5d28b884ff16 ==============================
[0m12:39:06.574987 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:06.576651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m12:39:06.663434 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:06.670402 | fc445cff-199a-44c6-bdae-e82b54af7670 ==============================
[0m12:39:06.670402 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:06.671854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:06.776480 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:06.836156 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:06.886168 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:06.910281 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:06.929105 [debug] [Thread-1 (]: SQL status: BEGIN in 5.018 seconds
[0m12:39:06.931224 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:39:06.931852 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m12:39:06.933984 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:39:06.947650 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:39:06.948239 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m12:39:06.949532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:06.976208 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:39:06.977731 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:39:06.978449 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:39:06.981570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:39:06.989757 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m12:39:06.996028 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:39:06.999609 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m12:39:07.000559 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:39:07.005571 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m12:39:07.010244 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.25s]
[0m12:39:07.012399 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m12:39:07.016638 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.017199 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.019444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:07.025415 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:39:07.026163 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.026616 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.027020 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.028056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:07.028727 [debug] [MainThread]: On master: Close
[0m12:39:07.029463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:07.029943 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:07.030316 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m12:39:07.030862 [info ] [MainThread]: 
[0m12:39:07.031526 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.53 seconds (15.53s).
[0m12:39:07.032715 [debug] [MainThread]: Command end result
[0m12:39:07.033282 [info ] [MainThread]: 
[0m12:39:07.034872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:07.035671 [info ] [MainThread]: 
[0m12:39:07.036440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:07.038525 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.008865, "process_user_time": 5.041528, "process_kernel_time": 0.336588, "process_mem_max_rss": "112648", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m12:39:07.039876 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:07.039695 after 19.01 seconds
[0m12:39:07.040593 [debug] [MainThread]: Flushing usage events
[0m12:39:07.141062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:07.142105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:07.173800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:07.175028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:07.238388 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:07.239932 [debug] [Thread-1 (]: SQL status: BEGIN in 5.016 seconds
[0m12:39:07.245085 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:39:07.244356 [info ] [MainThread]: 
[0m12:39:07.245977 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m12:39:07.247243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:07.250542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:07.274168 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:07.277178 [info ] [MainThread]: 
[0m12:39:07.280832 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:07.287465 [debug] [MainThread]: Command end result
[0m12:39:07.288991 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6812744, "process_user_time": 2.005002, "process_kernel_time": 0.129624, "process_mem_max_rss": "97656", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:07.290386 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:07.290255 after 0.68 seconds
[0m12:39:07.291313 [debug] [MainThread]: Flushing usage events
[0m12:39:07.297939 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:07.303003 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:07.304546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:07.539366 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.292 seconds
[0m12:39:07.582834 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:39:07.587676 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:39:07.592962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:07.630916 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:39:07.633176 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:39:07.633687 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:39:07.643323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:39:07.651610 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m12:39:07.657403 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:39:07.660000 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m12:39:07.661236 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:39:07.667756 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m12:39:07.674051 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 5.61s]
[0m12:39:07.678410 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m12:39:07.681747 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.683976 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.685979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:07.694256 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:39:07.695885 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.697943 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:07.699530 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.700562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:07.701856 [debug] [MainThread]: On master: Close
[0m12:39:07.702385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:07.703654 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:07.705930 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m12:39:07.706482 [info ] [MainThread]: 
[0m12:39:07.707184 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.10 seconds (16.10s).
[0m12:39:07.708045 [debug] [MainThread]: Command end result
[0m12:39:07.709177 [info ] [MainThread]: 
[0m12:39:07.710427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:07.711165 [info ] [MainThread]: 
[0m12:39:07.711706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:07.713526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.709639, "process_user_time": 5.23401, "process_kernel_time": 0.349074, "process_mem_max_rss": "111864", "process_out_blocks": "1193", "process_in_blocks": "0"}
[0m12:39:07.714568 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:07.714475 after 19.71 seconds
[0m12:39:07.715496 [debug] [MainThread]: Flushing usage events
[0m12:39:08.352647 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m12:39:08.358315 [debug] [MainThread]: On master: COMMIT
[0m12:39:08.359326 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:08.360229 [debug] [MainThread]: On master: COMMIT
[0m12:39:08.358274 [debug] [MainThread]: SQL status: BEGIN in 5.016 seconds
[0m12:39:08.361093 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:08.361684 [debug] [MainThread]: On master: COMMIT
[0m12:39:08.363184 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:08.362417 [debug] [MainThread]: On master: Close
[0m12:39:08.363921 [debug] [MainThread]: On master: COMMIT
[0m12:39:08.365894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:08.367219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:08.367938 [debug] [MainThread]: On master: Close
[0m12:39:08.368184 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:08.369697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:08.370784 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m12:39:08.371912 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m12:39:08.376500 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:08.381472 [info ] [MainThread]: 
[0m12:39:08.383675 [info ] [MainThread]: 
[0m12:39:08.386394 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m12:39:08.387620 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m12:39:08.401397 [debug] [MainThread]: Command end result
[0m12:39:08.401735 [debug] [MainThread]: Command end result
[0m12:39:08.402361 [info ] [MainThread]: 
[0m12:39:08.404390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:08.403406 [info ] [MainThread]: 
[0m12:39:08.405283 [info ] [MainThread]: 
[0m12:39:08.406479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:08.407297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:08.408599 [info ] [MainThread]: 
[0m12:39:08.411367 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:08.411599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1484256, "process_user_time": 3.26137, "process_kernel_time": 0.407807, "process_mem_max_rss": "105524", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m12:39:08.413954 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:08.413701 after 7.15 seconds
[0m12:39:08.416326 [debug] [MainThread]: Flushing usage events
[0m12:39:08.420537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1410894, "process_user_time": 3.440957, "process_kernel_time": 0.312914, "process_mem_max_rss": "106104", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:39:08.424217 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:08.423984 after 7.15 seconds
[0m12:39:08.426315 [debug] [MainThread]: Flushing usage events
[0m12:39:10.576004 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:10.587050 | a4cf63e3-ae4c-4e98-a5ad-8f0677dadc1b ==============================
[0m12:39:10.587050 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:10.588155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:10.605844 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:10.614124 | 81d74b9b-7254-4c70-a7b6-fe835414cebf ==============================
[0m12:39:10.614124 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:10.615844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m12:39:10.861815 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:10.866827 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:10.895099 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:10.901755 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:11.145009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:11.146203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:11.166362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:11.168975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:11.237223 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:11.238881 [info ] [MainThread]: 
[0m12:39:11.240091 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:11.244550 [debug] [MainThread]: Command end result
[0m12:39:11.246065 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.74894804, "process_user_time": 1.948203, "process_kernel_time": 0.124766, "process_mem_max_rss": "97584", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:11.247622 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:11.247267 after 0.75 seconds
[0m12:39:11.250834 [debug] [MainThread]: Flushing usage events
[0m12:39:11.255895 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:11.261187 [info ] [MainThread]: 
[0m12:39:11.263976 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:11.268673 [debug] [MainThread]: Command end result
[0m12:39:11.272640 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7162756, "process_user_time": 1.979854, "process_kernel_time": 0.121741, "process_mem_max_rss": "97436", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:11.273325 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:11.273234 after 0.72 seconds
[0m12:39:11.273781 [debug] [MainThread]: Flushing usage events
[0m12:39:11.774576 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:11.788922 | 59844320-88bc-4a9d-aae1-f15880b35d22 ==============================
[0m12:39:11.788922 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:11.791908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m12:39:11.829422 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:11.840446 | d8a67554-f249-4d73-84c8-8b8650be1f48 ==============================
[0m12:39:11.840446 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:11.843195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:11.858165 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:11.871585 | a5947d38-f235-4e73-9146-3d8e472b10e9 ==============================
[0m12:39:11.871585 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:11.872934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m12:39:11.924668 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:11.930975 | a7f54348-f427-4ed0-bdbe-5ebe784dbcd5 ==============================
[0m12:39:11.930975 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:11.931651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m12:39:12.078659 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:12.099286 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:12.124139 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:12.129147 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:12.150622 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:12.176075 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:12.194014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:12.223114 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:12.319027 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m12:39:12.325968 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:12.349466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:39:12.350719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:39:12.380149 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:12.380778 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:12.382096 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:12.384219 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:12.386686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:12.389352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:12.389364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:12.390930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:12.395603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:12.396580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:12.404892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:12.406311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:12.452245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:12.454155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:12.471241 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:12.473032 [info ] [MainThread]: 
[0m12:39:12.474157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:12.474847 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:12.476391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:12.477922 [info ] [MainThread]: 
[0m12:39:12.478856 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:12.485729 [debug] [MainThread]: Command end result
[0m12:39:12.486674 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.770929, "process_user_time": 1.882891, "process_kernel_time": 0.189614, "process_mem_max_rss": "97484", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:12.487904 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:12.487759 after 0.77 seconds
[0m12:39:12.488377 [debug] [MainThread]: Flushing usage events
[0m12:39:12.492454 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:12.497467 [info ] [MainThread]: 
[0m12:39:12.499891 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:12.502566 [debug] [MainThread]: Command end result
[0m12:39:12.503711 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.71041214, "process_user_time": 1.956641, "process_kernel_time": 0.163735, "process_mem_max_rss": "97128", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:12.504466 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:12.504363 after 0.71 seconds
[0m12:39:12.505004 [debug] [MainThread]: Flushing usage events
[0m12:39:12.514796 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:12.518814 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:12.522116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:12.528839 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m12:39:12.528422 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:12.530517 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:12.532270 [info ] [MainThread]: 
[0m12:39:12.535729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:12.538049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:12.537442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:39:12.538255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:39:12.546788 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:12.559075 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:12.561491 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:12.563185 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:12.564591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:12.566242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:12.577062 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:39:12.578496 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:12.579362 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:12.584859 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m12:39:12.587309 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:12.588239 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:12.596866 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:12.597943 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:12.598810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:12.605802 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m12:39:12.607644 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:12.613949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:39:12.615234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:39:12.625827 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:12.629403 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:12.630554 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:12.632155 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:12.632735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:12.633416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:12.641968 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:39:12.643879 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:12.644959 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:12.646277 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:39:12.648272 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:12.648968 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:12.650496 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:12.652064 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:12.653166 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:12.655870 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m12:39:12.657463 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:12.658209 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:12.664678 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:12.665325 [debug] [MainThread]: On master: BEGIN
[0m12:39:12.665854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:12.671241 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:39:12.672575 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:12.673223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:12.677683 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m12:39:12.679801 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:12.680373 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:12.680935 [debug] [MainThread]: On master: BEGIN
[0m12:39:12.683068 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:12.683838 [debug] [MainThread]: On master: COMMIT
[0m12:39:12.684331 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:12.684691 [debug] [MainThread]: On master: COMMIT
[0m12:39:12.685303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:12.685886 [debug] [MainThread]: On master: Close
[0m12:39:12.686840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:12.688043 [info ] [MainThread]: 
[0m12:39:12.694852 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m12:39:12.696341 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m12:39:12.697452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m12:39:12.698061 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m12:39:12.705888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m12:39:12.709158 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m12:39:12.749634 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m12:39:12.754394 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:39:12.755592 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m12:39:12.757034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:12.766303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:39:12.767604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:39:12.768467 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m12:39:12.771515 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m12:39:12.779010 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:39:12.779840 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m12:39:12.781538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:12.803875 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:39:12.804506 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:39:12.805151 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:39:12.807303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:39:12.813934 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m12:39:12.818630 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:39:12.819186 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m12:39:12.819922 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:39:12.822451 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m12:39:12.824681 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.13s]
[0m12:39:12.825738 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m12:39:12.827252 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:12.827794 [debug] [MainThread]: On master: BEGIN
[0m12:39:12.828387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:17.402610 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m12:39:17.403990 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m12:39:17.407271 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:17.405968 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:17.409922 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:17.410399 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:17.419329 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:39:17.419789 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m12:39:17.424292 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:17.425806 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:17.426642 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:17.427346 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:17.441037 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.441678 [debug] [MainThread]: On master: BEGIN
[0m12:39:17.442281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:17.450414 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:39:17.452147 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.454023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:17.458866 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m12:39:17.464342 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:17.468450 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.469474 [debug] [MainThread]: On master: BEGIN
[0m12:39:17.471034 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:39:17.472189 [debug] [MainThread]: On master: COMMIT
[0m12:39:17.472889 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.473511 [debug] [MainThread]: On master: COMMIT
[0m12:39:17.474554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:17.475200 [debug] [MainThread]: On master: Close
[0m12:39:17.476634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:17.477310 [info ] [MainThread]: 
[0m12:39:17.493247 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m12:39:17.496153 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m12:39:17.497054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m12:39:17.497607 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m12:39:17.509030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m12:39:17.511241 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m12:39:17.566605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m12:39:17.568426 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:39:17.569079 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m12:39:17.569682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:17.575556 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m12:39:17.578441 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:17.579189 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:17.582911 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:39:17.586394 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:17.587210 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:17.599450 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.600477 [debug] [MainThread]: On master: BEGIN
[0m12:39:17.601453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:17.617965 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:39:17.638635 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.662581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:17.697066 [debug] [MainThread]: SQL status: SELECT 9 in 0.012 seconds
[0m12:39:17.701431 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:17.702782 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.703595 [debug] [MainThread]: On master: BEGIN
[0m12:39:17.704424 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:39:17.705027 [debug] [MainThread]: On master: COMMIT
[0m12:39:17.706014 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.706742 [debug] [MainThread]: On master: COMMIT
[0m12:39:17.707310 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:17.707893 [debug] [MainThread]: On master: Close
[0m12:39:17.710575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:17.712100 [info ] [MainThread]: 
[0m12:39:17.746382 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m12:39:17.751468 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m12:39:17.752826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m12:39:17.753710 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m12:39:17.774440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m12:39:17.776576 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m12:39:17.818309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m12:39:17.819958 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:39:17.820515 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m12:39:17.821010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:17.842244 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m12:39:17.846943 [debug] [MainThread]: On master: COMMIT
[0m12:39:17.848531 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:17.849944 [debug] [MainThread]: On master: COMMIT
[0m12:39:17.851324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:17.853065 [debug] [MainThread]: On master: Close
[0m12:39:17.857356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:17.858138 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:17.858801 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m12:39:17.860651 [info ] [MainThread]: 
[0m12:39:17.862075 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m12:39:17.865040 [debug] [MainThread]: Command end result
[0m12:39:17.866311 [info ] [MainThread]: 
[0m12:39:17.868395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:17.869754 [info ] [MainThread]: 
[0m12:39:17.870905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:17.876880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0277205, "process_user_time": 2.260369, "process_kernel_time": 0.182718, "process_mem_max_rss": "106372", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:39:17.878541 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:17.878398 after 6.03 seconds
[0m12:39:17.879578 [debug] [MainThread]: Flushing usage events
[0m12:39:20.155141 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:20.161626 | 094df948-0087-4e28-9c64-15ecb0244b6c ==============================
[0m12:39:20.161626 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:20.162330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:20.406637 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:20.425105 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:20.639950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:20.640580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:20.718280 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:20.720099 [info ] [MainThread]: 
[0m12:39:20.720525 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:20.722304 [debug] [MainThread]: Command end result
[0m12:39:20.723182 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.61643726, "process_user_time": 1.501489, "process_kernel_time": 0.113827, "process_mem_max_rss": "97740", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:20.723960 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:20.723798 after 0.62 seconds
[0m12:39:20.724448 [debug] [MainThread]: Flushing usage events
[0m12:39:22.581954 [debug] [Thread-1 (]: SQL status: BEGIN in 5.010 seconds
[0m12:39:22.586432 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:39:22.587495 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m12:39:22.605371 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.013 seconds
[0m12:39:22.627663 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:39:22.629748 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:39:22.630840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:39:22.653879 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m12:39:22.654696 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:39:22.655374 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m12:39:22.661887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:39:22.669842 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m12:39:22.674401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:39:22.674992 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m12:39:22.675855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:39:22.682911 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m12:39:22.686710 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 5.19s]
[0m12:39:22.689639 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m12:39:22.694264 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:22.695004 [debug] [MainThread]: On master: BEGIN
[0m12:39:22.696253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:22.836171 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m12:39:22.842719 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:39:22.844964 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m12:39:22.849511 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m12:39:22.865531 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:39:22.866487 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m12:39:22.867634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:39:22.893055 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m12:39:22.893768 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:39:22.894437 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m12:39:22.896242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:39:22.901938 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m12:39:22.906480 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:39:22.906979 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m12:39:22.907761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:39:22.912690 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m12:39:22.915696 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 5.16s]
[0m12:39:22.917728 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m12:39:22.920895 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:22.921452 [debug] [MainThread]: On master: BEGIN
[0m12:39:22.921971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:22.927454 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:39:22.930815 [debug] [MainThread]: On master: COMMIT
[0m12:39:22.931293 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:22.931776 [debug] [MainThread]: On master: COMMIT
[0m12:39:22.932767 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:22.933297 [debug] [MainThread]: On master: Close
[0m12:39:22.933962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:22.934350 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m12:39:22.934757 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:22.935257 [info ] [MainThread]: 
[0m12:39:22.936003 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.46 seconds (10.46s).
[0m12:39:22.937059 [debug] [MainThread]: Command end result
[0m12:39:22.937492 [info ] [MainThread]: 
[0m12:39:22.938215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:22.938690 [info ] [MainThread]: 
[0m12:39:22.939244 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:22.941527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.188504, "process_user_time": 2.211189, "process_kernel_time": 0.202709, "process_mem_max_rss": "106192", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:39:22.942944 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:22.942837 after 11.19 seconds
[0m12:39:22.943783 [debug] [MainThread]: Flushing usage events
[0m12:39:25.332492 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:25.338725 | 8f5f9ac0-7e2f-47a0-9891-e40d7acddcc6 ==============================
[0m12:39:25.338725 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:25.339636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:25.375800 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:25.381858 | 8d6595fe-4acf-428b-8c35-044dbf57bcfb ==============================
[0m12:39:25.381858 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:25.383804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:25.519317 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:25.543006 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:25.572258 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:25.600998 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:25.811373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:25.812086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:25.870021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:25.873236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:25.881110 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:25.885076 [info ] [MainThread]: 
[0m12:39:25.886325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:25.889811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:25.938174 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:25.941784 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:25.944687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:25.952938 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m12:39:25.954689 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:25.962801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:39:25.964046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:39:25.971679 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:25.971017 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:25.973332 [info ] [MainThread]: 
[0m12:39:25.973491 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:25.974267 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:25.973954 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:25.974762 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:25.975140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:25.975515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:25.976140 [debug] [MainThread]: Command end result
[0m12:39:25.977232 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.65022355, "process_user_time": 1.628584, "process_kernel_time": 0.181178, "process_mem_max_rss": "97304", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:25.977882 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:25.977767 after 0.65 seconds
[0m12:39:25.978294 [debug] [MainThread]: Flushing usage events
[0m12:39:25.981057 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:39:25.982810 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:25.986696 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:25.989647 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:25.990783 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:25.991655 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:27.706259 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m12:39:27.707732 [debug] [MainThread]: On master: COMMIT
[0m12:39:27.710470 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:27.722609 [debug] [MainThread]: On master: COMMIT
[0m12:39:27.723354 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:27.724197 [debug] [MainThread]: On master: Close
[0m12:39:27.725494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:27.726496 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m12:39:27.726958 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:27.727812 [info ] [MainThread]: 
[0m12:39:27.728555 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.48 seconds (20.48s).
[0m12:39:27.729870 [debug] [MainThread]: Command end result
[0m12:39:27.730361 [info ] [MainThread]: 
[0m12:39:27.731111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:27.731724 [info ] [MainThread]: 
[0m12:39:27.732898 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:27.736202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.229084, "process_user_time": 2.256469, "process_kernel_time": 0.159182, "process_mem_max_rss": "106844", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:39:27.737775 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:27.737610 after 21.23 seconds
[0m12:39:27.738672 [debug] [MainThread]: Flushing usage events
[0m12:39:30.231801 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:30.237399 | 97e6eddd-dcaa-48d0-bc59-72a845ffb969 ==============================
[0m12:39:30.237399 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:30.238086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:39:30.419922 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:30.440794 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:30.698465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:30.699462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:30.771482 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:30.773158 [info ] [MainThread]: 
[0m12:39:30.773815 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:30.775698 [debug] [MainThread]: Command end result
[0m12:39:30.776512 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5885669, "process_user_time": 1.433942, "process_kernel_time": 0.109838, "process_mem_max_rss": "97412", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:30.777159 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:30.777080 after 0.59 seconds
[0m12:39:30.777700 [debug] [MainThread]: Flushing usage events
[0m12:39:30.986715 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m12:39:30.995834 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:30.996481 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:31.000367 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m12:39:31.003976 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:31.004781 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:31.015893 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:31.016570 [debug] [MainThread]: On master: BEGIN
[0m12:39:31.017010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:31.022892 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:39:31.023566 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:31.024515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:31.028885 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m12:39:31.031299 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:31.032108 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:31.033937 [debug] [MainThread]: On master: BEGIN
[0m12:39:31.034917 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:39:31.035892 [debug] [MainThread]: On master: COMMIT
[0m12:39:31.036915 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:31.037460 [debug] [MainThread]: On master: COMMIT
[0m12:39:31.038238 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:31.038779 [debug] [MainThread]: On master: Close
[0m12:39:31.039632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:31.040759 [info ] [MainThread]: 
[0m12:39:31.051002 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m12:39:31.051837 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m12:39:31.052713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m12:39:31.053240 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m12:39:31.074861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m12:39:31.076969 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m12:39:31.119883 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m12:39:31.126267 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:39:31.127318 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m12:39:31.128663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:31.138149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:39:31.139742 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:39:31.140213 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m12:39:31.144614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:39:31.153086 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:39:31.154762 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m12:39:31.157612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:31.172321 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m12:39:31.173026 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:39:31.173514 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m12:39:31.175829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:39:31.187181 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m12:39:31.191636 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m12:39:31.192462 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m12:39:31.193068 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:39:31.196116 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m12:39:31.198871 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:39:31.199667 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m12:39:31.201200 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:31.201597 [debug] [MainThread]: On master: BEGIN
[0m12:39:31.201952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:36.209685 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m12:39:36.215002 [debug] [MainThread]: On master: COMMIT
[0m12:39:36.215646 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:36.216160 [debug] [MainThread]: On master: COMMIT
[0m12:39:36.216975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:36.217785 [debug] [MainThread]: On master: Close
[0m12:39:36.219144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:36.219695 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:36.220205 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m12:39:36.221031 [info ] [MainThread]: 
[0m12:39:36.221927 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m12:39:36.223291 [debug] [MainThread]: Command end result
[0m12:39:36.223905 [info ] [MainThread]: 
[0m12:39:36.224831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:36.225912 [info ] [MainThread]: 
[0m12:39:36.226824 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:36.229666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.945368, "process_user_time": 1.838899, "process_kernel_time": 0.168919, "process_mem_max_rss": "106472", "process_out_blocks": "35", "process_in_blocks": "0"}
[0m12:39:36.231384 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:36.231200 after 10.95 seconds
[0m12:39:36.232438 [debug] [MainThread]: Flushing usage events
[0m12:39:39.157767 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:39.165519 | 968017bd-cf1b-4e81-b5fe-02da735e78b4 ==============================
[0m12:39:39.165519 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:39.161340 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:39:39.168568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'send_anonymous_usage_stats': 'True'}


============================== 12:39:39.170201 | e8146ab6-69db-408d-8b7f-250b5106bbde ==============================
[0m12:39:39.170201 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:39.171880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:39.387673 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:39.392862 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:39.411417 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:39.418454 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:39.578943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:39.579596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:39.595883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:39.596408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:39.648106 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:39.649767 [info ] [MainThread]: 
[0m12:39:39.650492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:39.651459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:39.664880 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:39.669808 [info ] [MainThread]: 
[0m12:39:39.670504 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:39.672537 [debug] [MainThread]: Command end result
[0m12:39:39.673394 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.57092893, "process_user_time": 1.785306, "process_kernel_time": 0.160698, "process_mem_max_rss": "97180", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:39.674013 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:39.673919 after 0.57 seconds
[0m12:39:39.674473 [debug] [MainThread]: Flushing usage events
[0m12:39:39.685015 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:39.685969 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:39.687114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:44.707516 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.020 seconds
[0m12:39:44.710836 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:44.719991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:39:44.720738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:39:44.728997 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:44.731653 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:44.732111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:44.731198 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:44.733106 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:44.733654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:49.740087 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:39:49.740981 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:39:49.744848 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:49.748692 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:49.749606 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:49.749208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:49.753292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:39:49.756214 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:49.753643 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.004 seconds
[0m12:39:49.757039 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:49.758316 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:49.760174 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:49.768654 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:49.769203 [debug] [MainThread]: On master: BEGIN
[0m12:39:49.769716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:49.774866 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:39:49.775367 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:49.775910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:49.779373 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:39:49.781859 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:49.782378 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:49.782781 [debug] [MainThread]: On master: BEGIN
[0m12:39:49.783501 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:39:49.784045 [debug] [MainThread]: On master: COMMIT
[0m12:39:49.784432 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:49.784821 [debug] [MainThread]: On master: COMMIT
[0m12:39:49.785622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:49.786093 [debug] [MainThread]: On master: Close
[0m12:39:49.787228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:49.787973 [info ] [MainThread]: 
[0m12:39:49.797386 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m12:39:49.798406 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m12:39:49.799234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_customer)
[0m12:39:49.799746 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m12:39:49.808397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m12:39:49.812101 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m12:39:49.869177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m12:39:49.878889 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:39:49.880754 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m12:39:49.881255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:49.886382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:39:49.887203 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:39:49.891737 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m12:39:51.201493 [debug] [Thread-1 (]: SQL status: SELECT 258959 in 1.361 seconds
[0m12:39:51.229095 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:39:51.235051 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m12:39:51.240897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:51.261161 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m12:39:51.261790 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:39:51.262334 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m12:39:51.264439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:39:51.269523 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m12:39:51.273273 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m12:39:51.273699 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m12:39:51.274365 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:39:51.277432 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m12:39:51.279946 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 258959[0m in 1.48s]
[0m12:39:51.280967 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m12:39:51.283057 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:51.283563 [debug] [MainThread]: On master: BEGIN
[0m12:39:51.283935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:51.289217 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:39:51.289721 [debug] [MainThread]: On master: COMMIT
[0m12:39:51.290078 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:51.290431 [debug] [MainThread]: On master: COMMIT
[0m12:39:51.290908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:51.291335 [debug] [MainThread]: On master: Close
[0m12:39:51.291953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:51.292486 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:39:51.292875 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m12:39:51.293331 [info ] [MainThread]: 
[0m12:39:51.293854 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.64 seconds (11.64s).
[0m12:39:51.294628 [debug] [MainThread]: Command end result
[0m12:39:51.295032 [info ] [MainThread]: 
[0m12:39:51.295727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:51.296164 [info ] [MainThread]: 
[0m12:39:51.296723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:51.298679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.246169, "process_user_time": 2.020392, "process_kernel_time": 0.16043, "process_mem_max_rss": "106492", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:39:51.299782 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:51.299639 after 12.25 seconds
[0m12:39:51.300465 [debug] [MainThread]: Flushing usage events
[0m12:39:53.680212 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:53.687358 | 221c9399-2252-4ed5-9093-19910e0a82aa ==============================
[0m12:39:53.687358 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:53.684616 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:39:53.690787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 12:39:53.692011 | ada7fe21-a8dc-4ee1-bb61-34c431dff3d5 ==============================
[0m12:39:53.692011 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:53.694425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m12:39:53.691765 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:39:53.699745 | 92a50eba-c378-400e-bafe-f63433fab736 ==============================
[0m12:39:53.699745 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:39:53.702414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:39:53.899552 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:53.901624 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:53.908913 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:53.920833 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:53.927784 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:53.934367 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:39:54.119106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:54.119991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:54.125916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:54.127270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:54.141011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:54.142375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:54.232050 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:54.233081 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:54.233519 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:39:54.236444 [info ] [MainThread]: 
[0m12:39:54.237395 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:54.237381 [info ] [MainThread]: 
[0m12:39:54.238066 [info ] [MainThread]: 
[0m12:39:54.239334 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:54.238498 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:54.240101 [debug] [MainThread]: Command end result
[0m12:39:54.240940 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59976876, "process_user_time": 1.60091, "process_kernel_time": 0.167183, "process_mem_max_rss": "97676", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:39:54.240422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:54.240980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:39:54.241712 [debug] [MainThread]: Command `dbt test` succeeded at 12:39:54.241602 after 0.60 seconds
[0m12:39:54.242502 [debug] [MainThread]: Flushing usage events
[0m12:39:54.277824 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:54.277885 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:39:54.284233 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:54.284303 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:39:54.284787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:54.285253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:54.296534 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m12:39:54.298014 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:54.303611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:39:54.304315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:39:54.309850 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:54.312637 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:54.313077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:54.312044 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:54.313818 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:54.314555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:54.318326 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:39:54.319010 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:54.319668 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:54.324195 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.004 seconds
[0m12:39:54.325979 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:54.326715 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:59.298795 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m12:39:59.301398 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:39:59.308975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:39:59.309687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:39:59.318074 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:59.320571 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:59.321536 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:39:59.322200 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:39:59.322791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:59.323385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:59.326576 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m12:39:59.327846 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:59.328936 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:59.329209 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:39:59.330154 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:39:59.330451 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:39:59.330950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:39:59.331508 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:39:59.332079 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:39:59.333207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:39:59.335104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:59.334883 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:59.335779 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:59.335583 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m12:39:59.336892 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:39:59.338338 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:39:59.338920 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:39:59.339310 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:39:59.342515 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.343046 [debug] [MainThread]: On master: BEGIN
[0m12:39:59.343498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:59.346884 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.347346 [debug] [MainThread]: On master: BEGIN
[0m12:39:59.347729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:59.348072 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:39:59.348615 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.349102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:59.352893 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:39:59.367249 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:59.374408 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.376249 [debug] [MainThread]: On master: BEGIN
[0m12:39:59.384423 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:59.384906 [debug] [MainThread]: On master: COMMIT
[0m12:39:59.385234 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:59.389218 [debug] [MainThread]: On master: COMMIT
[0m12:39:59.400864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:59.401338 [debug] [MainThread]: On master: Close
[0m12:39:59.401877 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:59.406737 [info ] [MainThread]: 
[0m12:39:59.438219 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m12:39:59.438939 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m12:39:59.439579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m12:39:59.440109 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m12:39:59.459854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m12:39:59.461526 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m12:39:59.511600 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m12:39:59.513083 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m12:39:59.513513 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m12:39:59.513876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:59.518813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:39:59.519423 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m12:39:59.520009 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m12:40:04.363788 [debug] [MainThread]: SQL status: BEGIN in 5.015 seconds
[0m12:40:04.366561 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:04.367791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:04.375115 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m12:40:04.383475 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:04.384485 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:04.385061 [debug] [MainThread]: On master: BEGIN
[0m12:40:04.389349 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:40:04.389948 [debug] [MainThread]: On master: COMMIT
[0m12:40:04.390429 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:04.390885 [debug] [MainThread]: On master: COMMIT
[0m12:40:04.391576 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:04.392263 [debug] [MainThread]: On master: Close
[0m12:40:04.393693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:04.394990 [info ] [MainThread]: 
[0m12:40:04.407109 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m12:40:04.408230 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m12:40:04.408933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m12:40:04.409599 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m12:40:04.443339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:40:04.445834 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m12:40:04.518842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:40:04.523296 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:40:04.524450 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m12:40:04.525149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:04.531836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:40:04.532925 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:40:04.533635 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m12:40:05.318821 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.797 seconds
[0m12:40:05.352643 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m12:40:05.354390 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m12:40:05.354886 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m12:40:05.385542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m12:40:05.391628 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m12:40:05.396090 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.95s]
[0m12:40:05.398371 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m12:40:05.402659 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:05.404666 [debug] [MainThread]: On master: BEGIN
[0m12:40:05.405261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:05.413321 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:40:05.414130 [debug] [MainThread]: On master: COMMIT
[0m12:40:05.414619 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:05.415038 [debug] [MainThread]: On master: COMMIT
[0m12:40:05.415603 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:05.416119 [debug] [MainThread]: On master: Close
[0m12:40:05.416782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:05.417200 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:40:05.417671 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m12:40:05.418259 [info ] [MainThread]: 
[0m12:40:05.418874 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m12:40:05.420430 [debug] [MainThread]: Command end result
[0m12:40:05.420902 [info ] [MainThread]: 
[0m12:40:05.421656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:05.422265 [info ] [MainThread]: 
[0m12:40:05.422947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:05.425623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.787974, "process_user_time": 1.835935, "process_kernel_time": 0.180865, "process_mem_max_rss": "106768", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m12:40:05.427087 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:05.426973 after 11.79 seconds
[0m12:40:05.427927 [debug] [MainThread]: Flushing usage events
[0m12:40:06.320207 [debug] [Thread-1 (]: SQL status: SELECT 158959 in 1.785 seconds
[0m12:40:06.344122 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m12:40:06.346936 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m12:40:06.349469 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m12:40:06.357354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:40:06.362550 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m12:40:06.365842 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 158959[0m in 1.95s]
[0m12:40:06.367220 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m12:40:06.371501 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:06.375310 [debug] [MainThread]: On master: BEGIN
[0m12:40:06.375749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:06.383717 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:40:06.386436 [debug] [MainThread]: On master: COMMIT
[0m12:40:06.386934 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:06.387329 [debug] [MainThread]: On master: COMMIT
[0m12:40:06.387873 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:06.388401 [debug] [MainThread]: On master: Close
[0m12:40:06.391027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:06.391970 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m12:40:06.394423 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:40:06.397553 [info ] [MainThread]: 
[0m12:40:06.400631 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 12.16 seconds (12.16s).
[0m12:40:06.401673 [debug] [MainThread]: Command end result
[0m12:40:06.405693 [info ] [MainThread]: 
[0m12:40:06.412287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:06.415929 [info ] [MainThread]: 
[0m12:40:06.417595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:06.431440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.794947, "process_user_time": 1.87493, "process_kernel_time": 0.187998, "process_mem_max_rss": "106880", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m12:40:06.433653 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:06.433472 after 12.80 seconds
[0m12:40:06.435507 [debug] [MainThread]: Flushing usage events
[0m12:40:08.071729 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:40:08.077862 | b47820de-47e1-44a3-81cb-9f326b527174 ==============================
[0m12:40:08.077862 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:40:08.079047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:40:08.289689 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:40:08.313769 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:40:08.592325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:08.593026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:08.667416 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:40:08.669142 [info ] [MainThread]: 
[0m12:40:08.670319 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:08.672703 [debug] [MainThread]: Command end result
[0m12:40:08.673647 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.66066605, "process_user_time": 1.762852, "process_kernel_time": 0.166368, "process_mem_max_rss": "97724", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:40:08.674316 [debug] [MainThread]: Command `dbt test` succeeded at 12:40:08.674238 after 0.66 seconds
[0m12:40:08.674815 [debug] [MainThread]: Flushing usage events
[0m12:40:08.922938 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:40:08.929226 | 9c0ab2f5-0f7d-4fef-88c1-0879fadc47b0 ==============================
[0m12:40:08.929226 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:40:08.931257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m12:40:08.963780 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:40:08.972807 | 2faf50d4-d367-4399-a29e-ad25c8400228 ==============================
[0m12:40:08.972807 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:40:08.973655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:40:09.154227 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:40:09.188877 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:40:09.196332 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:40:09.227954 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:40:09.392942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:09.393603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:09.415564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:09.416105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:09.517045 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:40:09.522453 [info ] [MainThread]: 
[0m12:40:09.524541 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:09.527089 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:40:09.527663 [debug] [MainThread]: Command end result
[0m12:40:09.533924 [info ] [MainThread]: 
[0m12:40:09.534759 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6642443, "process_user_time": 1.606446, "process_kernel_time": 0.09739, "process_mem_max_rss": "97652", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:40:09.540327 [debug] [MainThread]: Command `dbt test` succeeded at 12:40:09.539858 after 0.67 seconds
[0m12:40:09.541622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:09.544415 [debug] [MainThread]: Flushing usage events
[0m12:40:09.546105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:40:09.640542 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:40:09.642430 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:40:09.644367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:14.673116 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.028 seconds
[0m12:40:14.691945 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:40:14.704254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:40:14.705097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:40:14.723984 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:40:14.724497 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:40:14.725042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:14.721580 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:40:14.725973 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:40:14.726645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:14.731918 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:40:14.732695 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:40:14.733264 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:40:14.736174 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:40:14.737558 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:40:14.738134 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:40:19.737354 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m12:40:19.738431 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:40:19.738926 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:40:19.741528 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m12:40:19.743379 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:40:19.743974 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:40:19.752393 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:19.753269 [debug] [MainThread]: On master: BEGIN
[0m12:40:19.753827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:24.776278 [debug] [MainThread]: SQL status: BEGIN in 5.019 seconds
[0m12:40:24.787995 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:24.793840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:24.800213 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:40:24.803701 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:24.804392 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:24.804827 [debug] [MainThread]: On master: BEGIN
[0m12:40:24.805589 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:40:24.806140 [debug] [MainThread]: On master: COMMIT
[0m12:40:24.806579 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:24.807071 [debug] [MainThread]: On master: COMMIT
[0m12:40:24.807606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:24.808068 [debug] [MainThread]: On master: Close
[0m12:40:24.809026 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:24.809705 [info ] [MainThread]: 
[0m12:40:24.820004 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m12:40:24.820884 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m12:40:24.821585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m12:40:24.822181 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m12:40:24.831760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m12:40:24.833657 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m12:40:24.876248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m12:40:24.878036 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:40:24.878564 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m12:40:24.879003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:24.884741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:40:24.885422 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:40:24.885900 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m12:40:26.136261 [debug] [Thread-1 (]: SQL status: SELECT 1158959 in 1.249 seconds
[0m12:40:26.165453 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:40:26.173333 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m12:40:26.190635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m12:40:26.215348 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m12:40:26.218148 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:40:26.218811 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m12:40:26.227764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:40:26.236688 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m12:40:26.241679 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m12:40:26.242341 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m12:40:26.243415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:40:26.247703 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m12:40:26.250938 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1158959[0m in 1.43s]
[0m12:40:26.253073 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m12:40:26.258177 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:26.262144 [debug] [MainThread]: On master: BEGIN
[0m12:40:26.262544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:26.269256 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:40:26.275312 [debug] [MainThread]: On master: COMMIT
[0m12:40:26.275696 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:26.276032 [debug] [MainThread]: On master: COMMIT
[0m12:40:26.276477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:26.276797 [debug] [MainThread]: On master: Close
[0m12:40:26.277330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:26.277692 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m12:40:26.278001 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:40:26.278390 [info ] [MainThread]: 
[0m12:40:26.280804 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.74 seconds (16.74s).
[0m12:40:26.281786 [debug] [MainThread]: Command end result
[0m12:40:26.282679 [info ] [MainThread]: 
[0m12:40:26.283394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:26.285158 [info ] [MainThread]: 
[0m12:40:26.285791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:26.287961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.383432, "process_user_time": 1.888186, "process_kernel_time": 0.125474, "process_mem_max_rss": "106200", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:40:26.289456 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:26.289326 after 17.39 seconds
[0m12:40:26.290367 [debug] [MainThread]: Flushing usage events
[0m12:40:28.767123 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:40:28.768522 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:40:28.773722 | 1bc3e262-f9a6-4631-8779-556ce6e8265a ==============================
[0m12:40:28.773722 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:40:28.774542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 12:40:28.774880 | a3af4334-2a56-4f38-9f62-b74f72236ed1 ==============================
[0m12:40:28.774880 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:40:28.780322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:40:29.044290 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:40:29.053690 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:40:29.073628 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:40:29.079321 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:40:29.270096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:29.270612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:29.302021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:29.303828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:29.345294 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:40:29.346866 [info ] [MainThread]: 
[0m12:40:29.348429 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:29.350308 [debug] [MainThread]: Command end result
[0m12:40:29.361302 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.63568145, "process_user_time": 1.422902, "process_kernel_time": 0.115231, "process_mem_max_rss": "97764", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:40:29.366662 [debug] [MainThread]: Command `dbt test` succeeded at 12:40:29.366304 after 0.64 seconds
[0m12:40:29.378671 [debug] [MainThread]: Flushing usage events
[0m12:40:29.380171 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:40:29.388847 [info ] [MainThread]: 
[0m12:40:29.406248 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:29.410730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:40:29.462709 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:40:29.463650 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:40:29.464610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:29.472398 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m12:40:29.475243 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:40:29.482276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:40:29.483007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:40:29.489946 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:40:29.492355 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:40:29.493040 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:40:29.493561 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:40:29.494117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:29.494642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:34.512563 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m12:40:34.523419 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:40:34.527473 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:40:34.525336 [debug] [ThreadPool]: SQL status: BEGIN in 5.031 seconds
[0m12:40:34.528136 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:40:34.528543 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:40:34.530917 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:40:34.531245 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m12:40:34.533208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:40:34.534996 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:40:34.535765 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:40:34.536240 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:40:34.546149 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:34.546774 [debug] [MainThread]: On master: BEGIN
[0m12:40:34.547273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:34.551883 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:40:34.552417 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:34.552885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:34.556645 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m12:40:34.559083 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:34.559747 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:34.560165 [debug] [MainThread]: On master: BEGIN
[0m12:40:34.560881 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:40:34.561425 [debug] [MainThread]: On master: COMMIT
[0m12:40:34.561823 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:34.562242 [debug] [MainThread]: On master: COMMIT
[0m12:40:34.562757 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:34.563288 [debug] [MainThread]: On master: Close
[0m12:40:34.567378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:34.568028 [info ] [MainThread]: 
[0m12:40:34.575559 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m12:40:34.576401 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m12:40:34.577144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m12:40:34.577695 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m12:40:34.586221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m12:40:34.587893 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m12:40:34.627073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m12:40:34.638674 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:40:34.639089 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m12:40:34.639440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:39.660714 [debug] [Thread-1 (]: SQL status: BEGIN in 5.021 seconds
[0m12:40:39.665745 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:40:39.666527 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m12:40:41.448636 [debug] [Thread-1 (]: SQL status: SELECT 1158959 in 1.781 seconds
[0m12:40:41.474597 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:40:41.475731 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m12:40:41.476949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:40:41.496191 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m12:40:41.496972 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:40:41.497510 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m12:40:41.503440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:40:41.513938 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m12:40:41.521610 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m12:40:41.522988 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m12:40:41.523830 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:40:41.528545 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m12:40:41.534613 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1158959[0m in 6.96s]
[0m12:40:41.536331 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m12:40:41.539872 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:41.541781 [debug] [MainThread]: On master: BEGIN
[0m12:40:41.542346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:41.550530 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:40:41.551176 [debug] [MainThread]: On master: COMMIT
[0m12:40:41.551612 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:41.552169 [debug] [MainThread]: On master: COMMIT
[0m12:40:41.552814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:41.553728 [debug] [MainThread]: On master: Close
[0m12:40:41.556368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:41.557204 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m12:40:41.557556 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:40:41.558882 [info ] [MainThread]: 
[0m12:40:41.563189 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.15 seconds (12.15s).
[0m12:40:41.564038 [debug] [MainThread]: Command end result
[0m12:40:41.564476 [info ] [MainThread]: 
[0m12:40:41.565198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:41.568421 [info ] [MainThread]: 
[0m12:40:41.572277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:41.574605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.849841, "process_user_time": 1.620267, "process_kernel_time": 0.159069, "process_mem_max_rss": "106012", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:40:41.576286 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:41.576131 after 12.85 seconds
[0m12:40:41.578466 [debug] [MainThread]: Flushing usage events
[0m12:40:44.133116 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:40:44.139599 | ea466382-e1a1-4b18-a02a-87ec5099044f ==============================
[0m12:40:44.139599 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:40:44.145223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:44.371454 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:40:44.399552 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:40:44.714606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:44.716375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:44.818363 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:40:44.823150 [info ] [MainThread]: 
[0m12:40:44.825708 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:44.831311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:40:44.832272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:40:44.870368 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:40:44.870848 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:40:44.871425 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:40:44.871979 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:40:44.876192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:44.876747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:44.884268 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:40:44.885126 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:40:44.885683 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:40:44.890338 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:40:44.896285 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:40:44.899418 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:40:49.889246 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m12:40:49.895338 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:40:49.896225 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:40:49.900057 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.003 seconds
[0m12:40:49.902597 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:40:49.903336 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:40:49.912478 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:49.913242 [debug] [MainThread]: On master: BEGIN
[0m12:40:49.915655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:54.926823 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m12:40:54.928952 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:54.929883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:54.935129 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m12:40:54.939122 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:54.940988 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:54.941769 [debug] [MainThread]: On master: BEGIN
[0m12:40:54.943701 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:40:54.944873 [debug] [MainThread]: On master: COMMIT
[0m12:40:54.946045 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:54.946489 [debug] [MainThread]: On master: COMMIT
[0m12:40:54.948928 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:40:54.949358 [debug] [MainThread]: On master: Close
[0m12:40:54.950861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:54.951590 [info ] [MainThread]: 
[0m12:40:54.959792 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m12:40:54.960453 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m12:40:54.961124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m12:40:54.961762 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m12:40:54.970350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m12:40:54.972125 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m12:40:54.987784 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m12:40:54.996742 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m12:40:54.998692 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m12:40:55.000634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:55.006167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:40:55.006699 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m12:40:55.007145 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m12:40:55.339205 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.331 seconds
[0m12:40:55.382123 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m12:40:55.392885 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m12:40:55.401299 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.44s]
[0m12:40:55.402240 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m12:40:55.404097 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:55.404686 [debug] [MainThread]: On master: BEGIN
[0m12:40:55.405571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:55.411846 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:40:55.412827 [debug] [MainThread]: On master: COMMIT
[0m12:40:55.413246 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:55.413784 [debug] [MainThread]: On master: COMMIT
[0m12:40:55.415731 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:40:55.416105 [debug] [MainThread]: On master: Close
[0m12:40:55.422000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:55.423244 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:40:55.425677 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m12:40:55.429228 [info ] [MainThread]: 
[0m12:40:55.429899 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m12:40:55.430787 [debug] [MainThread]: Command end result
[0m12:40:55.431221 [info ] [MainThread]: 
[0m12:40:55.431736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:55.432152 [info ] [MainThread]: 
[0m12:40:55.432632 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:55.433824 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.356813, "process_user_time": 1.64342, "process_kernel_time": 0.147551, "process_mem_max_rss": "108368", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m12:40:55.434744 [debug] [MainThread]: Command `dbt test` succeeded at 12:40:55.434612 after 11.36 seconds
[0m12:40:55.437286 [debug] [MainThread]: Flushing usage events
[0m12:50:41.293373 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:50:41.299291 | 7509fbd2-de4c-4652-9c9f-e56f2c7e676d ==============================
[0m12:50:41.299291 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:50:41.304435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:41.410704 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m12:50:41.416602 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m12:50:41.425884 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-frxp2bof'
[0m12:50:41.429414 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m12:50:41.430464 [debug] [MainThread]: Creating symlink to local dependency.
[0m12:50:41.431028 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m12:50:41.431961 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.18210916, "process_user_time": 1.097629, "process_kernel_time": 0.120942, "process_mem_max_rss": "105912", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m12:50:41.432514 [debug] [MainThread]: Command `dbt deps` succeeded at 12:50:41.432431 after 0.18 seconds
[0m12:50:41.433569 [debug] [MainThread]: Flushing usage events
[0m12:50:43.512707 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:50:43.517917 | db9626b3-3d9b-4fb2-98a4-8c6029786486 ==============================
[0m12:50:43.517917 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:50:43.518704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:50:43.699099 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:50:43.714239 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:50:43.717314 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:50:45.430053 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:50:45.432250 [info ] [MainThread]: 
[0m12:50:45.433237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:50:45.434945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:50:45.464934 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:50:45.465630 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:50:45.466187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:45.487426 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m12:50:45.492706 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:50:45.494851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m12:50:45.496534 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m12:50:45.503091 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:50:45.504378 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m12:50:45.505361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:45.511570 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:50:45.512486 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:50:45.514416 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m12:50:45.515432 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:50:45.516408 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:50:45.516949 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:50:45.517470 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:50:45.518513 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:50:45.518965 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m12:50:45.525166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m12:50:45.525845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:50:45.533577 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:50:45.535885 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:50:45.536645 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:50:45.537578 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:50:45.543411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:45.544626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:50.555924 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m12:50:50.556864 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m12:50:50.564405 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:50:50.564918 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:50:50.561562 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:50:50.565489 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:50:50.569062 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:50:50.569384 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:50:50.571374 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:50:50.572437 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:50:50.572948 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:50:50.573380 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:50:50.581622 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:50.582153 [debug] [MainThread]: On master: BEGIN
[0m12:50:50.582547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:55.591433 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m12:50:55.596406 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:55.597042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:50:55.601089 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:50:55.604057 [debug] [MainThread]: On master: ROLLBACK
[0m12:50:55.604796 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:55.605702 [debug] [MainThread]: On master: BEGIN
[0m12:50:55.607268 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:50:55.607790 [debug] [MainThread]: On master: COMMIT
[0m12:50:55.612407 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:55.617402 [debug] [MainThread]: On master: COMMIT
[0m12:50:55.617890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:50:55.618269 [debug] [MainThread]: On master: Close
[0m12:50:55.619127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:55.619782 [info ] [MainThread]: 
[0m12:50:55.630065 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m12:50:55.630965 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m12:50:55.631632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m12:50:55.632161 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m12:50:55.632674 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m12:50:55.660534 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:50:55.661132 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m12:50:55.661677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:55.666669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:50:55.667242 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:50:55.667917 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m12:50:55.670508 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m12:50:55.741850 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:50:55.742591 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m12:50:55.745418 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m12:50:55.751611 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m12:50:55.778800 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:50:55.780083 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:50:55.780523 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:50:55.782227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:50:55.787848 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m12:50:55.789424 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.16s]
[0m12:50:55.790054 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m12:50:55.791685 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:55.792152 [debug] [MainThread]: On master: BEGIN
[0m12:50:55.792550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:55.797079 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:50:55.798790 [debug] [MainThread]: On master: COMMIT
[0m12:50:55.799224 [debug] [MainThread]: Using postgres connection "master"
[0m12:50:55.799830 [debug] [MainThread]: On master: COMMIT
[0m12:50:55.800400 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:50:55.800855 [debug] [MainThread]: On master: Close
[0m12:50:55.802093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:55.803327 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:50:55.803879 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m12:50:55.804383 [info ] [MainThread]: 
[0m12:50:55.807805 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m12:50:55.809735 [debug] [MainThread]: Command end result
[0m12:50:55.871204 [info ] [MainThread]: 
[0m12:50:55.871912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:55.872387 [info ] [MainThread]: 
[0m12:50:55.872970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:55.874324 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.4041815, "process_user_time": 3.04462, "process_kernel_time": 0.140662, "process_mem_max_rss": "113712", "process_out_blocks": "3516", "process_in_blocks": "0"}
[0m12:50:55.875493 [debug] [MainThread]: Command `dbt seed` succeeded at 12:50:55.875359 after 12.41 seconds
[0m12:50:55.876267 [debug] [MainThread]: Flushing usage events
[0m12:51:50.881685 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:51:50.895037 | 50bed398-d9e2-4bb3-a971-0a150ece746a ==============================
[0m12:51:50.895037 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:51:50.897799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'send_anonymous_usage_stats': 'True'}
[0m12:51:50.920757 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:51:50.931943 | ff1e0d4f-efbc-4fe0-991c-34af263b89af ==============================
[0m12:51:50.931943 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:51:50.932661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m12:51:50.927886 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:51:50.940967 | dda971fe-5ac2-4bc9-91f0-9a65831a284b ==============================
[0m12:51:50.940967 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:51:50.943313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:51:50.965357 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:51:50.978097 | 1214b1da-9b91-4489-9967-64b781dc246d ==============================
[0m12:51:50.978097 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:51:50.982413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:51.003038 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:51:51.020737 | 26b4a017-cac3-4cf9-b788-1b4aab8ebbb5 ==============================
[0m12:51:51.020737 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:51:51.023985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:51.020313 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:51:51.034618 | 0d9e8a62-ca89-4426-ace2-288a81b36d80 ==============================
[0m12:51:51.034618 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:51:51.039186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:51.040124 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:51:51.048249 | 9e07e57a-a3dd-4ce2-aff6-25311851f043 ==============================
[0m12:51:51.048249 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:51:51.052155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:51.266628 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:51:51.300439 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:51:51.312259 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:51:51.334968 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:51:51.336211 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:51:51.353939 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:51:51.373530 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:51:51.384959 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:51:51.439650 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:51:51.467923 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:51:51.473568 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:51:51.484504 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:51:51.547573 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:51:51.559699 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:51:51.566945 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:51:51.569466 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:51:51.596092 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:51:51.596887 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:51:51.612212 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:51:51.613796 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:51:51.618175 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:51:51.619551 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:51:51.689612 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:51:51.691785 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:51:51.727395 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:51:51.728554 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:51:51.746866 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:51:51.748148 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m12:51:54.324382 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:51:54.329815 [info ] [MainThread]: 
[0m12:51:54.331576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:54.332165 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:51:54.333944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:51:54.335794 [info ] [MainThread]: 
[0m12:51:54.337892 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:54.340807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:51:54.344605 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:51:54.349379 [info ] [MainThread]: 
[0m12:51:54.354899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:54.356758 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:51:54.357845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:51:54.362543 [info ] [MainThread]: 
[0m12:51:54.364143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:54.365759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:51:54.386568 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:51:54.390567 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:51:54.392511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.391244 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:51:54.394840 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:51:54.396335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.407357 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m12:51:54.407432 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m12:51:54.409676 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:51:54.410676 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:51:54.411512 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:51:54.411775 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:51:54.414234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.414401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:51:54.415850 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:51:54.418398 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:51:54.416161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:51:54.420852 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:51:54.421637 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:51:54.422837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.430376 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.431768 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:51:54.432621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.432460 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.431832 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m12:51:54.433614 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:51:54.434852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.435327 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:51:54.437505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:51:54.438942 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:51:54.440479 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m12:51:54.445117 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:51:54.445622 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:51:54.446310 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.447604 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:51:54.448188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m12:51:54.449344 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m12:51:54.449823 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:51:54.450171 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.451563 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:51:54.453201 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:54.454489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.455157 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.457136 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:54.460527 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.462201 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m12:51:54.463832 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:51:54.463304 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m12:51:54.465520 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:51:54.465177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.471557 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.473202 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:51:54.475190 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:51:54.477155 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:54.478590 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.480137 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:54.479957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m12:51:54.481114 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:51:54.482053 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m12:51:54.482308 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.483680 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:51:54.483805 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:51:54.485363 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:51:54.490428 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:54.492332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m12:51:54.492571 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:54.480790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:51:54.494539 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:54.496783 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:51:54.497839 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:51:54.493465 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.493484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:51:54.498522 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.504100 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:51:54.505607 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:51:54.504167 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.507106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.511379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m12:51:54.508309 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.510339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.511378 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:51:54.512830 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:51:54.514001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.515035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.516350 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:51:54.519363 [info ] [MainThread]: 
[0m12:51:54.520476 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:54.521264 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:51:54.512381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:51:54.523321 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.523896 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:51:54.522521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:51:54.524103 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:54.524740 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.520193 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.526402 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:54.527375 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.530248 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:51:54.531879 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m12:51:54.531313 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:51:54.532204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.532885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.533791 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:51:54.533456 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:51:54.534602 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:51:54.535123 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:51:54.537115 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:51:54.537905 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:51:54.540414 [info ] [MainThread]: 
[0m12:51:54.546524 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:54.548757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:51:54.562139 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:51:54.563014 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:51:54.566825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.576119 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m12:51:54.582225 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:51:54.584406 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:51:54.585142 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:51:54.586043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.589984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:51:54.602136 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m12:51:54.604566 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:51:54.590525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:51:54.603445 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.626542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:51:54.628711 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.644531 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:51:54.660055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.632119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:51:54.635878 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:51:54.678283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.669169 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.682307 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m12:51:54.681361 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.684117 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.684508 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:51:54.684969 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:54.683427 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:51:54.685417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.687166 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:51:54.686472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.688558 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:51:54.689489 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.692321 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:51:54.693706 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:51:54.695300 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:51:54.696889 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:51:54.698139 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.699101 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:51:54.700246 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:51:54.703891 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:51:54.705247 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:51:54.705328 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:51:54.706192 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:51:54.706769 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:51:54.713775 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:54.715207 [debug] [MainThread]: On master: BEGIN
[0m12:51:54.715969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:54.715962 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:51:54.718561 [info ] [MainThread]: 
[0m12:51:54.719341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:51:54.720931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:51:54.752581 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:51:54.755931 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:51:54.758876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.769338 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m12:51:54.770632 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:51:54.776051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:51:54.776787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:51:54.783273 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:54.786128 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.786731 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:51:54.787655 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:51:54.788208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:54.788674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:54.795487 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:51:54.796123 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:54.796517 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:51:54.801399 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:51:54.806868 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:51:54.808065 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:51:59.440344 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m12:51:59.446951 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:59.447500 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m12:51:59.448146 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:51:59.451162 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:59.454326 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m12:51:59.455132 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m12:51:59.459593 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m12:51:59.461580 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m12:51:59.474910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m12:51:59.476615 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:51:59.487551 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:59.492006 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:51:59.491068 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:59.493782 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:51:59.494202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:59.492868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:59.499668 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:51:59.502520 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:59.503022 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:59.505413 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:51:59.506877 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:51:59.507583 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:51:59.526295 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m12:51:59.527349 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m12:51:59.528776 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:59.529279 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:59.529397 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:51:59.529935 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:51:59.532298 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:51:59.532390 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:51:59.538688 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:51:59.539513 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:51:59.539646 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:51:59.540442 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:51:59.551105 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m12:51:59.552820 [debug] [ThreadPool]: SQL status: BEGIN in 5.021 seconds
[0m12:51:59.555279 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:59.556819 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:51:59.559169 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.558600 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:59.560265 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.559744 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.559562 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:51:59.561244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:59.561630 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.563139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:59.564115 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:51:59.564791 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:51:59.567798 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:51:59.570044 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:51:59.570860 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.569895 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:51:59.571379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:59.570998 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:51:59.572098 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:51:59.576618 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:51:59.582823 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:59.584892 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.585864 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.586672 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:51:59.587470 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.588048 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.588699 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.592476 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:51:59.593472 [debug] [MainThread]: On master: Close
[0m12:51:59.596618 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:59.597992 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.598956 [info ] [MainThread]: 
[0m12:51:59.599094 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.600181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:59.607942 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:51:59.610121 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.611385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:59.617866 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:51:59.620223 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:59.620285 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m12:51:59.621145 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.621438 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m12:51:59.621916 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.622484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m12:51:59.623803 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:51:59.624577 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m12:51:59.624847 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.625816 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.626897 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.627851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:51:59.628436 [debug] [MainThread]: On master: Close
[0m12:51:59.629888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:59.631875 [info ] [MainThread]: 
[0m12:51:59.636702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m12:51:59.642829 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m12:51:59.645599 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m12:51:59.647023 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m12:51:59.649676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m12:51:59.650662 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m12:51:59.662109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m12:51:59.664409 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m12:51:59.683642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m12:51:59.687561 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:51:59.688136 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m12:51:59.688679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:59.694914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:51:59.695932 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:51:59.696641 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m12:51:59.696015 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m12:51:59.697903 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:59.698556 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:59.702084 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:51:59.705106 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:51:59.705860 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:51:59.706961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m12:51:59.711976 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:51:59.712788 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m12:51:59.713451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:59.720337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:51:59.720599 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.721876 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:51:59.722223 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.722638 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m12:51:59.722771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:59.725899 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m12:51:59.724938 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m12:51:59.726846 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.727925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:59.730808 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:51:59.732215 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:51:59.733635 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:51:59.734359 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m12:51:59.733876 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.735370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:51:59.735289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:59.736905 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:59.738110 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.739682 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m12:51:59.739814 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.743017 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:51:59.743246 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:59.743669 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.743961 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.744467 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.745098 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.745396 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.746169 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:51:59.746522 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:51:59.747255 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.747678 [debug] [MainThread]: On master: Close
[0m12:51:59.747876 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.748470 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.749271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:59.750674 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:51:59.751143 [info ] [MainThread]: 
[0m12:51:59.751692 [debug] [MainThread]: On master: Close
[0m12:51:59.752861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:59.755401 [info ] [MainThread]: 
[0m12:51:59.757137 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m12:51:59.758791 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:51:59.761003 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m12:51:59.763077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:51:59.765647 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m12:51:59.767539 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m12:51:59.768835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m12:51:59.769481 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m12:51:59.769936 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m12:51:59.771708 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m12:51:59.772896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m12:51:59.773019 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m12:51:59.773491 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m12:51:59.780477 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m12:51:59.781935 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m12:51:59.783208 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m12:51:59.783964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:51:59.786224 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m12:51:59.786986 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m12:51:59.787952 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m12:51:59.797642 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.14s]
[0m12:51:59.796438 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m12:51:59.799313 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m12:51:59.809631 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.806323 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m12:51:59.814805 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:51:59.813962 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.815583 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:51:59.816214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:59.821844 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m12:51:59.828424 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:51:59.831971 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:51:59.831654 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:51:59.832820 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.834067 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.836049 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.838117 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:51:59.842229 [debug] [MainThread]: On master: Close
[0m12:51:59.844456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:59.845819 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m12:51:59.847127 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:51:59.848464 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.850366 [info ] [MainThread]: 
[0m12:51:59.851676 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.852079 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m12:51:59.852564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:59.853355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m12:51:59.854138 [debug] [MainThread]: Command end result
[0m12:51:59.856125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m12:51:59.855551 [info ] [MainThread]: 
[0m12:51:59.857832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:59.859441 [info ] [MainThread]: 
[0m12:51:59.859280 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:51:59.859878 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:51:59.860525 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:51:59.861000 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:59.861338 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m12:51:59.861142 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m12:51:59.862299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:59.861872 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.863019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:59.863420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.996688, "process_user_time": 5.342591, "process_kernel_time": 0.349447, "process_mem_max_rss": "112972", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m12:51:59.863669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:51:59.865421 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:59.865272 after 9.00 seconds
[0m12:51:59.867187 [debug] [MainThread]: Flushing usage events
[0m12:51:59.868533 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:51:59.870651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:51:59.871805 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:51:59.871839 [debug] [MainThread]: On master: ROLLBACK
[0m12:51:59.873097 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m12:51:59.873445 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.874708 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.876265 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:51:59.876630 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:51:59.877320 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.878185 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.878961 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.879983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:51:59.881017 [debug] [MainThread]: On master: Close
[0m12:51:59.882947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:59.884583 [info ] [MainThread]: 
[0m12:51:59.888278 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:51:59.890066 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m12:51:59.892384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:51:59.898182 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m12:51:59.899226 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m12:51:59.900211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m12:51:59.900820 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m12:51:59.908877 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:51:59.910789 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:51:59.911699 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m12:51:59.913322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:51:59.914624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m12:51:59.916879 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m12:51:59.922593 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m12:51:59.928299 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m12:51:59.929857 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m12:51:59.931501 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:51:59.949397 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m12:51:59.955572 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m12:51:59.957151 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m12:51:59.962396 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.963346 [debug] [MainThread]: On master: BEGIN
[0m12:51:59.964502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:59.969698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m12:51:59.972810 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:51:59.974300 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:51:59.973994 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.976593 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m12:51:59.976556 [debug] [MainThread]: Using postgres connection "master"
[0m12:51:59.978136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:59.978373 [debug] [MainThread]: On master: COMMIT
[0m12:51:59.979788 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:51:59.981612 [debug] [MainThread]: On master: Close
[0m12:51:59.982636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:59.983644 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m12:51:59.984381 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:51:59.985034 [info ] [MainThread]: 
[0m12:51:59.985507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:51:59.985983 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m12:51:59.986548 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:51:59.987169 [debug] [MainThread]: Command end result
[0m12:51:59.987388 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m12:51:59.987959 [info ] [MainThread]: 
[0m12:51:59.989388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:59.990683 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:51:59.991102 [info ] [MainThread]: 
[0m12:51:59.992393 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:51:59.994438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.05506, "process_user_time": 5.422898, "process_kernel_time": 0.332718, "process_mem_max_rss": "112704", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:51:59.995576 [debug] [MainThread]: Command `dbt run` succeeded at 12:51:59.995434 after 9.06 seconds
[0m12:51:59.996308 [debug] [MainThread]: Flushing usage events
[0m12:51:59.998546 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:51:59.999447 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m12:52:00.000925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:52:00.035508 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:52:00.037016 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:52:00.038397 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m12:52:00.047230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:52:00.060710 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m12:52:00.065997 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m12:52:00.066678 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m12:52:00.068534 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:52:00.075887 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.378 seconds
[0m12:52:00.077570 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m12:52:00.081824 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m12:52:00.084648 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m12:52:00.088483 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:00.089990 [debug] [MainThread]: On master: BEGIN
[0m12:52:00.091213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:00.091168 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:52:00.093504 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:52:00.095843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:00.101879 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:52:00.103755 [debug] [MainThread]: On master: COMMIT
[0m12:52:00.104770 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:00.105513 [debug] [MainThread]: On master: COMMIT
[0m12:52:00.106461 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:00.107906 [debug] [MainThread]: On master: Close
[0m12:52:00.109572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:00.111328 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m12:52:00.114009 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:52:00.115800 [info ] [MainThread]: 
[0m12:52:00.117562 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m12:52:00.119618 [debug] [MainThread]: Command end result
[0m12:52:00.120502 [info ] [MainThread]: 
[0m12:52:00.121876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:00.121986 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:52:00.123204 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:52:00.122907 [info ] [MainThread]: 
[0m12:52:00.123967 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m12:52:00.124284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:00.131183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.179868, "process_user_time": 5.429441, "process_kernel_time": 0.439092, "process_mem_max_rss": "111916", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m12:52:00.153076 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:00.152809 after 9.20 seconds
[0m12:52:00.158528 [debug] [MainThread]: Flushing usage events
[0m12:52:00.171856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.047 seconds
[0m12:52:00.200590 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m12:52:00.216363 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m12:52:00.227174 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m12:52:00.232778 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:52:00.243862 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m12:52:00.254253 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.62s]
[0m12:52:00.263696 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m12:52:00.271893 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:00.275584 [debug] [MainThread]: On master: BEGIN
[0m12:52:00.280005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:03.307183 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:03.318285 | 85726332-bf5e-4756-8776-0d6de16c1be4 ==============================
[0m12:52:03.318285 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:03.320118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:03.314355 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:03.322373 | 35c77868-8b88-4ee6-ad4b-2cae349ecead ==============================
[0m12:52:03.322373 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:03.323605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:52:03.324667 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:03.333822 | 9d1df3d7-9e3a-420e-b6c3-64695c9fc553 ==============================
[0m12:52:03.333822 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:03.336902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:03.342365 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:03.349843 | e46e03cb-601c-4be2-8629-76dc29ca3d6b ==============================
[0m12:52:03.349843 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:03.351008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:03.743293 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:03.744752 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:03.764975 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:03.780683 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:03.780880 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:03.780824 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:03.809254 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:03.819756 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:04.058039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:04.058843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:04.059149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:04.060102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:04.062556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:04.063139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:04.070605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:04.071636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:04.163904 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:04.164088 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:04.166611 [info ] [MainThread]: 
[0m12:52:04.168537 [info ] [MainThread]: 
[0m12:52:04.169289 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:04.169606 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:04.172119 [debug] [MainThread]: Command end result
[0m12:52:04.172012 [debug] [MainThread]: Command end result
[0m12:52:04.173999 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9577667, "process_user_time": 2.034881, "process_kernel_time": 0.166911, "process_mem_max_rss": "97296", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:04.173671 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.93256944, "process_user_time": 2.049267, "process_kernel_time": 0.135184, "process_mem_max_rss": "97636", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:04.174940 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:04.174809 after 0.96 seconds
[0m12:52:04.175323 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:04.175203 after 0.93 seconds
[0m12:52:04.176358 [debug] [MainThread]: Flushing usage events
[0m12:52:04.176123 [debug] [MainThread]: Flushing usage events
[0m12:52:04.177936 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:04.180976 [info ] [MainThread]: 
[0m12:52:04.183259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:04.185788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:52:04.195101 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:04.198646 [info ] [MainThread]: 
[0m12:52:04.201032 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:04.203772 [debug] [MainThread]: Command end result
[0m12:52:04.205252 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.97678095, "process_user_time": 2.05671, "process_kernel_time": 0.156399, "process_mem_max_rss": "97608", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:04.206105 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:04.205961 after 0.98 seconds
[0m12:52:04.206754 [debug] [MainThread]: Flushing usage events
[0m12:52:04.233147 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:52:04.234742 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:52:04.235584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:04.278742 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.043 seconds
[0m12:52:04.286267 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:52:04.299957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:52:04.301851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:52:04.313466 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:04.321062 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:04.322609 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:52:04.325175 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:52:04.329458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:04.330910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:04.343997 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:52:04.345100 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:52:04.346705 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:04.349536 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:52:04.348009 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:04.352514 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:52:04.357520 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:52:04.358594 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:52:04.362095 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:52:04.364955 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:52:04.367861 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:52:04.369198 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:52:04.380388 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.381929 [debug] [MainThread]: On master: BEGIN
[0m12:52:04.382905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:04.394352 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:52:04.396947 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.398600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:04.405278 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m12:52:04.408216 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:04.410009 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.411002 [debug] [MainThread]: On master: BEGIN
[0m12:52:04.412231 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:52:04.413254 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.414223 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.415140 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.416414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:04.417396 [debug] [MainThread]: On master: Close
[0m12:52:04.421842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:04.423893 [info ] [MainThread]: 
[0m12:52:04.435124 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m12:52:04.436397 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m12:52:04.437733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m12:52:04.438903 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m12:52:04.450485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m12:52:04.457582 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m12:52:04.520584 [debug] [ThreadPool]: SQL status: BEGIN in 5.025 seconds
[0m12:52:04.531577 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:04.533257 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:52:04.541238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m12:52:04.543043 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m12:52:04.564264 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:52:04.566363 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m12:52:04.569660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:04.585113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:52:04.592596 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:52:04.591253 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:52:04.600074 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:52:04.601088 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m12:52:04.610964 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:52:04.615273 [debug] [MainThread]: SQL status: BEGIN in 5.048 seconds
[0m12:52:04.630630 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:52:04.634104 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.636515 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m12:52:04.642751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:04.646653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:52:04.651756 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m12:52:04.659013 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.660144 [debug] [MainThread]: On master: BEGIN
[0m12:52:04.663256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:04.673014 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:04.675383 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.675993 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m12:52:04.677171 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:52:04.676622 [debug] [MainThread]: On master: BEGIN
[0m12:52:04.677710 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:52:04.678136 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m12:52:04.679636 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:52:04.679273 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.681550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:04.682335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:52:04.681062 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.686888 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.687902 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.688766 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:04.688969 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m12:52:04.691231 [debug] [MainThread]: On master: Close
[0m12:52:04.698928 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m12:52:04.704494 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:04.712624 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.713684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:04.715761 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m12:52:04.716378 [debug] [MainThread]: On master: BEGIN
[0m12:52:04.717231 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m12:52:04.717671 [info ] [MainThread]: 
[0m12:52:04.719370 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:52:04.720125 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:52:04.721153 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.723075 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.725198 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.725669 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m12:52:04.729145 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m12:52:04.727330 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:04.730562 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m12:52:04.731271 [debug] [MainThread]: On master: Close
[0m12:52:04.734759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:04.737458 [info ] [MainThread]: 
[0m12:52:04.740586 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.750594 [debug] [MainThread]: On master: BEGIN
[0m12:52:04.751878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:04.764364 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:52:04.766463 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m12:52:04.768627 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.778182 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:04.779463 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m12:52:04.780867 [debug] [MainThread]: On master: COMMIT
[0m12:52:04.783504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m12:52:04.788896 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:52:04.790275 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m12:52:04.793898 [debug] [MainThread]: On master: Close
[0m12:52:04.797553 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m12:52:04.797184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:04.798990 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m12:52:04.799043 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m12:52:04.801687 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:52:04.802794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m12:52:04.802850 [info ] [MainThread]: 
[0m12:52:04.804310 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m12:52:04.804587 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m12:52:04.806003 [debug] [MainThread]: Command end result
[0m12:52:04.807003 [info ] [MainThread]: 
[0m12:52:04.809643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:04.811018 [info ] [MainThread]: 
[0m12:52:04.812340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:04.814549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5578301, "process_user_time": 2.490567, "process_kernel_time": 0.159519, "process_mem_max_rss": "106564", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m12:52:04.817945 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:04.816842 after 1.56 seconds
[0m12:52:04.819896 [debug] [MainThread]: Flushing usage events
[0m12:52:04.820734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m12:52:04.823251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m12:52:04.825638 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m12:52:04.828520 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m12:52:04.906088 [debug] [Thread-1 (]: SQL status: BEGIN in 5.041 seconds
[0m12:52:04.911593 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:52:04.914170 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m12:52:04.917169 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:52:04.925489 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m12:52:04.937350 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:52:04.938164 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m12:52:04.939309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m12:52:04.941261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:04.943173 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:52:04.944516 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m12:52:04.946051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:04.957317 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:52:04.958990 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m12:52:04.960107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:52:04.980932 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:52:04.981816 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:52:04.982526 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m12:52:04.984053 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:52:04.990934 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m12:52:04.996415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m12:52:04.997050 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m12:52:04.998062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:52:05.004632 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m12:52:05.008537 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.24s]
[0m12:52:05.010338 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m12:52:05.018230 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:05.022857 [debug] [MainThread]: On master: BEGIN
[0m12:52:05.023589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:05.034386 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:52:05.036846 [debug] [MainThread]: On master: COMMIT
[0m12:52:05.037445 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:05.038071 [debug] [MainThread]: On master: COMMIT
[0m12:52:05.038571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:05.038913 [debug] [MainThread]: On master: Close
[0m12:52:05.041245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:05.041859 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m12:52:05.044837 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:52:05.045922 [info ] [MainThread]: 
[0m12:52:05.046532 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.53 seconds (10.53s).
[0m12:52:05.047571 [debug] [MainThread]: Command end result
[0m12:52:05.048043 [info ] [MainThread]: 
[0m12:52:05.049844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:05.050463 [info ] [MainThread]: 
[0m12:52:05.051071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:05.053921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.087683, "process_user_time": 5.367326, "process_kernel_time": 0.348975, "process_mem_max_rss": "113128", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m12:52:05.055826 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:05.055674 after 14.09 seconds
[0m12:52:05.056861 [debug] [MainThread]: Flushing usage events
[0m12:52:05.306748 [debug] [MainThread]: SQL status: BEGIN in 5.026 seconds
[0m12:52:05.319414 [debug] [MainThread]: On master: COMMIT
[0m12:52:05.320465 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:05.321610 [debug] [MainThread]: On master: COMMIT
[0m12:52:05.323616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:05.328819 [debug] [MainThread]: On master: Close
[0m12:52:05.331844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:05.336040 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m12:52:05.336761 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:52:05.338669 [info ] [MainThread]: 
[0m12:52:05.341852 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.00 seconds (11.00s).
[0m12:52:05.345120 [debug] [MainThread]: Command end result
[0m12:52:05.346015 [info ] [MainThread]: 
[0m12:52:05.360395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:05.364194 [info ] [MainThread]: 
[0m12:52:05.368044 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:05.380141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.550526, "process_user_time": 5.410955, "process_kernel_time": 0.421374, "process_mem_max_rss": "112764", "process_out_blocks": "1195", "process_in_blocks": "0"}
[0m12:52:05.382510 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:05.382315 after 14.55 seconds
[0m12:52:05.384023 [debug] [MainThread]: Flushing usage events
[0m12:52:08.784710 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:08.795348 | f8f0f0e3-a381-4056-914c-7c07e5ac15d8 ==============================
[0m12:52:08.795348 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:08.797001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:08.798042 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:08.809374 | fa900b07-3a69-426b-86f9-cb7a68485140 ==============================
[0m12:52:08.809374 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:08.811388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:08.804102 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:08.814204 | abee64bd-d095-436c-8dbb-c4f43a2ad661 ==============================
[0m12:52:08.814204 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:08.817405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m12:52:08.819975 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:08.826511 | b0184b53-8ea1-4273-bfb1-a1b520f063e3 ==============================
[0m12:52:08.826511 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:08.828144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:08.882467 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:08.896642 | 1c998934-6295-4b0b-8023-04a437861da5 ==============================
[0m12:52:08.896642 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:08.899506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:09.031384 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:09.062119 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:09.074018 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:09.073148 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:09.078666 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:09.100019 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:09.101043 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:09.110295 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:09.131648 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:09.162128 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:09.295813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:09.296913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:09.307572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:09.308480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:09.318486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:09.319121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:09.366773 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:09.380164 [info ] [MainThread]: 
[0m12:52:09.393943 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:09.395416 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:09.404380 [info ] [MainThread]: 
[0m12:52:09.405476 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:52:09.404940 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:09.409247 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:09.421204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:09.422249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:09.423090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:52:09.415865 [info ] [MainThread]: 
[0m12:52:09.440487 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:09.453936 [debug] [MainThread]: Command end result
[0m12:52:09.454435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:09.456068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:09.456547 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.70158446, "process_user_time": 2.125244, "process_kernel_time": 0.168244, "process_mem_max_rss": "97372", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:09.461550 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:09.461158 after 0.71 seconds
[0m12:52:09.462512 [debug] [MainThread]: Flushing usage events
[0m12:52:09.472426 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:52:09.474472 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:52:09.476463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:09.488260 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:52:09.489489 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:52:09.491062 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.015 seconds
[0m12:52:09.492494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:09.494606 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:52:09.502827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:52:09.508244 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m12:52:09.512981 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:52:09.504357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:52:09.514775 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:09.520236 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:52:09.518982 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:09.521039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:09.522070 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:52:09.522024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:52:09.523845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:09.531314 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:52:09.533083 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:09.523169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:52:09.534234 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:52:09.532752 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:09.535639 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:52:09.537040 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:09.539881 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:09.540370 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:52:09.540410 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m12:52:09.538806 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:52:09.541397 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:09.541639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:09.544545 [info ] [MainThread]: 
[0m12:52:09.542816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:09.545774 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:09.540973 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:52:09.546174 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:52:09.549124 [debug] [MainThread]: Command end result
[0m12:52:09.551408 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8117445, "process_user_time": 2.153235, "process_kernel_time": 0.212362, "process_mem_max_rss": "97228", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:09.550739 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:52:09.552242 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:09.553047 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:52:09.553691 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:09.553540 after 0.81 seconds
[0m12:52:09.555810 [info ] [MainThread]: 
[0m12:52:09.551578 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:52:09.557419 [debug] [MainThread]: Flushing usage events
[0m12:52:09.555880 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:09.558124 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:09.556654 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:52:09.562676 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:52:09.563905 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:52:09.570131 [debug] [MainThread]: Command end result
[0m12:52:09.570956 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:52:09.567952 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:09.573161 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.74260116, "process_user_time": 2.157217, "process_kernel_time": 0.210385, "process_mem_max_rss": "97548", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:09.574931 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:52:09.576560 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:09.575933 after 0.75 seconds
[0m12:52:09.575810 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m12:52:09.578068 [debug] [MainThread]: Flushing usage events
[0m12:52:09.579862 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:52:09.582148 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:09.585022 [debug] [MainThread]: On master: BEGIN
[0m12:52:09.580476 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m12:52:09.585546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:09.584937 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:52:09.586650 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:52:09.594418 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:52:09.596441 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:52:09.597608 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:09.598568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:09.604305 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:09.605298 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m12:52:09.605842 [debug] [MainThread]: On master: BEGIN
[0m12:52:09.608826 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:09.609081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:09.609945 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:09.610656 [debug] [MainThread]: On master: BEGIN
[0m12:52:09.611605 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:52:09.612274 [debug] [MainThread]: On master: COMMIT
[0m12:52:09.612758 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:09.613243 [debug] [MainThread]: On master: COMMIT
[0m12:52:09.613918 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:09.614735 [debug] [MainThread]: On master: Close
[0m12:52:09.615395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:09.616519 [info ] [MainThread]: 
[0m12:52:09.626965 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m12:52:09.628269 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m12:52:09.631671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m12:52:09.633994 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m12:52:09.644673 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m12:52:09.646996 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m12:52:09.698429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m12:52:09.701589 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:52:09.702700 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m12:52:09.703276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:09.714060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:52:09.714885 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:52:09.715415 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m12:52:09.730427 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.014 seconds
[0m12:52:09.738519 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:52:09.739298 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:52:09.741494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:09.758678 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m12:52:09.759840 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:52:09.761524 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m12:52:09.765107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:09.774163 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m12:52:09.778601 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m12:52:09.779415 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m12:52:09.785157 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m12:52:09.787570 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m12:52:09.789300 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.16s]
[0m12:52:09.791272 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m12:52:09.793933 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:09.794800 [debug] [MainThread]: On master: BEGIN
[0m12:52:09.795256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:09.803592 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:52:09.804560 [debug] [MainThread]: On master: COMMIT
[0m12:52:09.806569 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:09.807064 [debug] [MainThread]: On master: COMMIT
[0m12:52:09.811087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:09.811580 [debug] [MainThread]: On master: Close
[0m12:52:09.812254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:09.812799 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:52:09.813194 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m12:52:09.813754 [info ] [MainThread]: 
[0m12:52:09.816990 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m12:52:09.818178 [debug] [MainThread]: Command end result
[0m12:52:09.818635 [info ] [MainThread]: 
[0m12:52:09.819216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:09.819704 [info ] [MainThread]: 
[0m12:52:09.822939 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:09.825416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0964495, "process_user_time": 2.344149, "process_kernel_time": 0.225991, "process_mem_max_rss": "106220", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:52:09.826782 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:09.826639 after 1.10 seconds
[0m12:52:09.827889 [debug] [MainThread]: Flushing usage events
[0m12:52:09.966418 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m12:52:09.968561 [debug] [Thread-1 (]: SQL status: BEGIN in 5.019 seconds
[0m12:52:09.981952 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:52:09.980240 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:52:09.983542 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m12:52:09.984442 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m12:52:09.987811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:52:09.988533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m12:52:10.049226 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:52:10.050901 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m12:52:10.051963 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:52:10.052829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:52:10.052573 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m12:52:10.054947 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:52:10.070292 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:52:10.072180 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:52:10.072793 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m12:52:10.076696 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:52:10.077863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:52:10.078366 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:52:10.082964 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m12:52:10.084310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:52:10.089855 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m12:52:10.093804 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m12:52:10.100668 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m12:52:10.103196 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m12:52:10.103804 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m12:52:10.104485 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m12:52:10.104999 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:52:10.108944 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:52:10.113326 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m12:52:10.116665 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m12:52:10.118896 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.33s]
[0m12:52:10.120804 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 5.32s]
[0m12:52:10.122374 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m12:52:10.124227 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m12:52:10.138880 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:10.140573 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:10.143548 [debug] [MainThread]: On master: BEGIN
[0m12:52:10.143001 [debug] [MainThread]: On master: BEGIN
[0m12:52:10.145007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:10.145808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:10.160076 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:52:10.162099 [debug] [MainThread]: On master: COMMIT
[0m12:52:10.163824 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:10.163769 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m12:52:10.165041 [debug] [MainThread]: On master: COMMIT
[0m12:52:10.165260 [debug] [MainThread]: On master: COMMIT
[0m12:52:10.166706 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:52:10.167522 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:10.168146 [debug] [MainThread]: On master: Close
[0m12:52:10.168820 [debug] [MainThread]: On master: COMMIT
[0m12:52:10.169541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:10.170079 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:10.170491 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m12:52:10.170967 [debug] [MainThread]: On master: Close
[0m12:52:10.171299 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:52:10.171915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:10.172732 [info ] [MainThread]: 
[0m12:52:10.172926 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m12:52:10.173987 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.84 seconds (15.84s).
[0m12:52:10.174452 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:52:10.175363 [info ] [MainThread]: 
[0m12:52:10.175579 [debug] [MainThread]: Command end result
[0m12:52:10.176297 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.81 seconds (15.81s).
[0m12:52:10.176794 [info ] [MainThread]: 
[0m12:52:10.177996 [debug] [MainThread]: Command end result
[0m12:52:10.178824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:10.179320 [info ] [MainThread]: 
[0m12:52:10.179822 [info ] [MainThread]: 
[0m12:52:10.180664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:10.181196 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:10.181619 [info ] [MainThread]: 
[0m12:52:10.183970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.383541, "process_user_time": 5.702671, "process_kernel_time": 0.392491, "process_mem_max_rss": "113048", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m12:52:10.183907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:10.185251 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:10.185124 after 19.39 seconds
[0m12:52:10.187441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.37043, "process_user_time": 5.563927, "process_kernel_time": 0.372405, "process_mem_max_rss": "112028", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m12:52:10.188186 [debug] [MainThread]: Flushing usage events
[0m12:52:10.189450 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:10.189348 after 19.37 seconds
[0m12:52:10.190844 [debug] [MainThread]: Flushing usage events
[0m12:52:13.303492 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:13.310078 | 8022313d-aca7-4474-bab8-5c1df2f31ece ==============================
[0m12:52:13.310078 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:13.305399 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m12:52:13.310987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:13.307202 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:13.312211 | f377eccf-dd33-4e56-9e4c-d871c89b86ba ==============================
[0m12:52:13.312211 [info ] [MainThread]: Running with dbt=1.8.2


============================== 12:52:13.313796 | 207edf89-fa14-4f4f-a3ec-1bed8fb7a785 ==============================
[0m12:52:13.313796 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:13.317008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:13.317270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:13.328396 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:13.334123 | fb57bb97-1462-4f97-a6f4-aae25b859ead ==============================
[0m12:52:13.334123 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:13.334777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:13.549448 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:13.557893 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:13.576739 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:13.578705 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:13.584483 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:13.596402 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:13.605696 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:13.633188 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:13.836424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:13.837430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:13.837952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:13.838883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:13.854699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:13.855813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:13.888496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:13.889507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:13.923204 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:13.924949 [info ] [MainThread]: 
[0m12:52:13.925902 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:13.927946 [debug] [MainThread]: Command end result
[0m12:52:13.928772 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.67665225, "process_user_time": 1.659303, "process_kernel_time": 0.128575, "process_mem_max_rss": "97516", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:13.929746 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:13.929602 after 0.68 seconds
[0m12:52:13.930456 [debug] [MainThread]: Flushing usage events
[0m12:52:13.938073 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:13.938098 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:13.939972 [info ] [MainThread]: 
[0m12:52:13.940293 [info ] [MainThread]: 
[0m12:52:13.940983 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:13.941133 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:13.943217 [debug] [MainThread]: Command end result
[0m12:52:13.944327 [debug] [MainThread]: Command end result
[0m12:52:13.944438 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68540627, "process_user_time": 1.667811, "process_kernel_time": 0.134285, "process_mem_max_rss": "97276", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:13.945495 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:13.945388 after 0.69 seconds
[0m12:52:13.946111 [debug] [MainThread]: Flushing usage events
[0m12:52:13.945639 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6671211, "process_user_time": 1.728338, "process_kernel_time": 0.116528, "process_mem_max_rss": "97436", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:13.947908 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:13.947806 after 0.67 seconds
[0m12:52:13.950960 [debug] [MainThread]: Flushing usage events
[0m12:52:13.965801 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:13.969984 [info ] [MainThread]: 
[0m12:52:13.971439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:13.973453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:52:14.024054 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:52:14.026027 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:52:14.027042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:14.040644 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m12:52:14.049378 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:52:14.057915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:52:14.059060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:52:14.065737 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:14.073162 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:14.074348 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:52:14.076410 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:52:14.077492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:14.078157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:14.089284 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:52:14.091328 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:14.092510 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:52:14.096504 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m12:52:14.099110 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:52:14.100940 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:52:14.617465 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m12:52:14.620287 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:14.620947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:14.624630 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m12:52:14.629645 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:14.630699 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:14.631290 [debug] [MainThread]: On master: BEGIN
[0m12:52:14.632114 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:52:14.632853 [debug] [MainThread]: On master: COMMIT
[0m12:52:14.633493 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:14.633994 [debug] [MainThread]: On master: COMMIT
[0m12:52:14.635924 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:14.637441 [debug] [MainThread]: On master: Close
[0m12:52:14.638896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:14.639783 [info ] [MainThread]: 
[0m12:52:14.651420 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m12:52:14.658298 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m12:52:14.659773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m12:52:14.660503 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m12:52:14.671407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m12:52:14.672868 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m12:52:14.707335 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m12:52:14.709180 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:52:14.709807 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m12:52:14.710372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:14.715329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:52:14.716289 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:52:14.716775 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m12:52:14.718615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m12:52:14.725128 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:52:14.726233 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m12:52:14.727193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:52:14.740821 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:52:14.741868 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:52:14.742427 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m12:52:14.743679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:52:14.753375 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m12:52:14.785845 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m12:52:14.787186 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m12:52:14.794244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:52:14.811295 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m12:52:14.814237 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:52:14.818379 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m12:52:14.837193 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:14.838943 [debug] [MainThread]: On master: BEGIN
[0m12:52:14.839912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:14.845286 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:52:14.845902 [debug] [MainThread]: On master: COMMIT
[0m12:52:14.846390 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:14.846777 [debug] [MainThread]: On master: COMMIT
[0m12:52:14.847445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:14.848023 [debug] [MainThread]: On master: Close
[0m12:52:14.848554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:14.848998 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m12:52:14.849500 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:52:14.850065 [info ] [MainThread]: 
[0m12:52:14.850534 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m12:52:14.851325 [debug] [MainThread]: Command end result
[0m12:52:14.851733 [info ] [MainThread]: 
[0m12:52:14.852324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:14.852696 [info ] [MainThread]: 
[0m12:52:14.853153 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:14.854589 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.113014, "process_user_time": 2.3831, "process_kernel_time": 0.206781, "process_mem_max_rss": "105908", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:52:14.855401 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:14.855330 after 6.11 seconds
[0m12:52:14.855849 [debug] [MainThread]: Flushing usage events
[0m12:52:17.904698 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:17.911114 | b74d5b3a-9c7e-465d-97a1-ac48dc8bcf0d ==============================
[0m12:52:17.911114 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:17.912051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m12:52:17.913600 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:17.919644 | 1327dd9c-4465-43f2-82d8-8523a4f55408 ==============================
[0m12:52:17.919644 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:17.920470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m12:52:18.120833 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:18.129634 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:18.161645 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:18.186343 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:18.492791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:18.493635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:18.499950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:18.500838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:18.566013 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:18.568079 [info ] [MainThread]: 
[0m12:52:18.568697 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:18.569885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:52:18.573999 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:18.576491 [info ] [MainThread]: 
[0m12:52:18.577212 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:18.579674 [debug] [MainThread]: Command end result
[0m12:52:18.580828 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7153523, "process_user_time": 1.644486, "process_kernel_time": 0.102973, "process_mem_max_rss": "97712", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:18.581774 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:18.581609 after 0.72 seconds
[0m12:52:18.582457 [debug] [MainThread]: Flushing usage events
[0m12:52:18.625251 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:52:18.626182 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:52:18.626802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:18.636989 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m12:52:18.641875 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:52:18.649164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m12:52:18.649923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m12:52:18.656665 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:18.659920 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:52:18.659271 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:18.660493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:18.661062 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:52:18.662047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:19.095266 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m12:52:19.096950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:19.099971 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:52:19.102652 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m12:52:19.105668 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:52:19.106233 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:52:19.116148 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:19.116785 [debug] [MainThread]: On master: BEGIN
[0m12:52:19.117276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:19.122649 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:52:19.123155 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:19.123585 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:19.128492 [debug] [MainThread]: SQL status: SELECT 8 in 0.003 seconds
[0m12:52:19.131559 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:19.132042 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:19.132360 [debug] [MainThread]: On master: BEGIN
[0m12:52:19.132891 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:52:19.133324 [debug] [MainThread]: On master: COMMIT
[0m12:52:19.133649 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:19.133968 [debug] [MainThread]: On master: COMMIT
[0m12:52:19.134360 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:19.134695 [debug] [MainThread]: On master: Close
[0m12:52:19.139796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:19.141024 [info ] [MainThread]: 
[0m12:52:19.149818 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m12:52:19.152100 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m12:52:19.153275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m12:52:19.153780 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m12:52:19.162132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m12:52:19.163465 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m12:52:19.205978 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m12:52:19.211940 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:52:19.212439 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m12:52:19.212824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:19.219654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:52:19.220478 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:52:19.221063 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m12:52:19.223737 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:52:19.229831 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:52:19.230377 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m12:52:19.231181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:52:19.244397 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:52:19.248901 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:52:19.251167 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m12:52:19.253895 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:52:19.259945 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m12:52:19.263331 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m12:52:19.265035 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m12:52:19.265638 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:52:19.268573 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m12:52:19.270798 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m12:52:19.271748 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m12:52:19.273313 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:19.273802 [debug] [MainThread]: On master: BEGIN
[0m12:52:19.274205 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:19.281827 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:52:19.283041 [debug] [MainThread]: On master: COMMIT
[0m12:52:19.284902 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:19.285267 [debug] [MainThread]: On master: COMMIT
[0m12:52:19.285665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:19.285970 [debug] [MainThread]: On master: Close
[0m12:52:19.286399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:19.287624 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m12:52:19.288318 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m12:52:19.289318 [info ] [MainThread]: 
[0m12:52:19.289766 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m12:52:19.290744 [debug] [MainThread]: Command end result
[0m12:52:19.291077 [info ] [MainThread]: 
[0m12:52:19.291517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:19.292879 [info ] [MainThread]: 
[0m12:52:19.293488 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:19.295014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0374866, "process_user_time": 1.905575, "process_kernel_time": 0.13913, "process_mem_max_rss": "106300", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m12:52:19.295975 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:19.295857 after 6.04 seconds
[0m12:52:19.296632 [debug] [MainThread]: Flushing usage events
[0m12:52:21.933111 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:21.939378 | 6d5be95c-fb72-4dce-93d0-6919ddf36e42 ==============================
[0m12:52:21.939378 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:21.940230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:21.967578 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:21.973352 | 43342783-42d7-46c7-aebe-13864cd09b8a ==============================
[0m12:52:21.973352 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:21.973987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:22.116823 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:22.134704 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:22.155370 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:22.170657 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:22.345659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:22.351189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:22.438188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:22.439617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:22.475107 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:22.477041 [info ] [MainThread]: 
[0m12:52:22.477879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:22.478934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:52:22.519345 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:52:22.520299 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:52:22.520973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:22.526834 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:22.529324 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m12:52:22.528826 [info ] [MainThread]: 
[0m12:52:22.530656 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:52:22.531088 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:22.533342 [debug] [MainThread]: Command end result
[0m12:52:22.534221 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6220184, "process_user_time": 1.562216, "process_kernel_time": 0.109132, "process_mem_max_rss": "97380", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:22.534982 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:22.534865 after 0.62 seconds
[0m12:52:22.535463 [debug] [MainThread]: Flushing usage events
[0m12:52:22.538119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m12:52:22.538893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:52:22.552664 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:22.570760 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:22.574762 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:52:22.572634 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:52:22.578790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:22.576611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:22.585758 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:52:22.586665 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:52:22.587093 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:22.590403 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:52:22.589521 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:22.594603 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:52:22.596252 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m12:52:22.597080 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m12:52:22.598140 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:52:22.600822 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:52:22.602080 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:52:22.605804 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:52:22.617876 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:22.621970 [debug] [MainThread]: On master: BEGIN
[0m12:52:22.622617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:23.649983 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m12:52:23.652011 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m12:52:23.657259 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:52:23.660741 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:52:23.659010 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:52:23.663021 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:52:23.668272 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m12:52:23.674604 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:52:23.677588 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m12:52:23.679733 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:52:23.681692 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:52:23.685972 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:52:23.695141 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:23.695729 [debug] [MainThread]: On master: BEGIN
[0m12:52:23.696154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:27.628758 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m12:52:27.630838 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:27.632747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:27.637721 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m12:52:27.641070 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:27.645068 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:27.646486 [debug] [MainThread]: On master: BEGIN
[0m12:52:27.647382 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:52:27.647882 [debug] [MainThread]: On master: COMMIT
[0m12:52:27.649006 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:27.649460 [debug] [MainThread]: On master: COMMIT
[0m12:52:27.651672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:27.652598 [debug] [MainThread]: On master: Close
[0m12:52:27.654511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:27.657584 [info ] [MainThread]: 
[0m12:52:27.667803 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m12:52:27.670128 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m12:52:27.671712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m12:52:27.672421 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m12:52:27.681250 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m12:52:27.682488 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m12:52:27.715533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m12:52:27.716945 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:52:27.717358 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m12:52:27.717867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:28.702299 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m12:52:28.704377 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:28.704970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:28.708955 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m12:52:28.712214 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:28.712856 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:28.713311 [debug] [MainThread]: On master: BEGIN
[0m12:52:28.714242 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:52:28.715075 [debug] [MainThread]: On master: COMMIT
[0m12:52:28.715480 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:28.715947 [debug] [MainThread]: On master: COMMIT
[0m12:52:28.716516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:28.716946 [debug] [MainThread]: On master: Close
[0m12:52:28.717954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:52:28.718755 [info ] [MainThread]: 
[0m12:52:28.730162 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m12:52:28.731867 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m12:52:28.732755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m12:52:28.733305 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m12:52:28.742535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m12:52:28.745149 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m12:52:28.787882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m12:52:28.791029 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:52:28.791526 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m12:52:28.792046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:32.726549 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m12:52:32.727495 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m12:52:32.728175 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    --reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m12:52:32.729578 [debug] [Thread-1 (]: Postgres adapter: Postgres error: each UNION query must have the same number of columns
LINE 25:     0 AS sales_agent_key,
             ^

[0m12:52:32.730285 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: ROLLBACK
[0m12:52:32.731529 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m12:52:32.742320 [debug] [Thread-1 (]: Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 25:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m12:52:32.748805 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_salesagent ....................... [[31mERROR[0m in 5.07s]
[0m12:52:32.750663 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m12:52:32.753789 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:32.754336 [debug] [MainThread]: On master: BEGIN
[0m12:52:32.755179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:32.765053 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:52:32.766634 [debug] [MainThread]: On master: COMMIT
[0m12:52:32.766982 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:32.767252 [debug] [MainThread]: On master: COMMIT
[0m12:52:32.768685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:32.768989 [debug] [MainThread]: On master: Close
[0m12:52:32.769453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:32.770111 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:52:32.776360 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m12:52:32.777017 [info ] [MainThread]: 
[0m12:52:32.780671 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m12:52:32.781549 [debug] [MainThread]: Command end result
[0m12:52:32.781903 [info ] [MainThread]: 
[0m12:52:32.782376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:32.782705 [info ] [MainThread]: 
[0m12:52:32.783116 [error] [MainThread]:   Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 25:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m12:52:32.783632 [info ] [MainThread]: 
[0m12:52:32.785564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:52:32.787094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.913213, "process_user_time": 1.709289, "process_kernel_time": 0.124571, "process_mem_max_rss": "106600", "process_in_blocks": "472", "process_out_blocks": "30", "command_success": false}
[0m12:52:32.787895 [debug] [MainThread]: Command `dbt run` failed at 12:52:32.787810 after 10.91 seconds
[0m12:52:32.788459 [debug] [MainThread]: Flushing usage events
[0m12:52:33.798078 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m12:52:33.803708 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:52:33.804816 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m12:52:33.808786 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m12:52:33.816670 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:52:33.817253 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m12:52:33.818098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:52:33.834026 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:52:33.834639 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:52:33.835113 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m12:52:33.836294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:52:33.841966 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m12:52:33.846751 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m12:52:33.847354 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m12:52:33.848253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m12:52:33.852347 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m12:52:33.854841 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.12s]
[0m12:52:33.855879 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m12:52:33.857734 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:33.860105 [debug] [MainThread]: On master: BEGIN
[0m12:52:33.861099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:33.869304 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:52:33.869970 [debug] [MainThread]: On master: COMMIT
[0m12:52:33.870404 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:33.870879 [debug] [MainThread]: On master: COMMIT
[0m12:52:33.871361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:52:33.871835 [debug] [MainThread]: On master: Close
[0m12:52:33.872422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:33.872858 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m12:52:33.873177 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:52:33.873552 [info ] [MainThread]: 
[0m12:52:33.874000 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m12:52:33.874854 [debug] [MainThread]: Command end result
[0m12:52:33.875299 [info ] [MainThread]: 
[0m12:52:33.875996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:33.876565 [info ] [MainThread]: 
[0m12:52:33.877178 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:33.879311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.039583, "process_user_time": 1.816534, "process_kernel_time": 0.147452, "process_mem_max_rss": "106428", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m12:52:33.891555 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:33.891034 after 16.05 seconds
[0m12:52:33.892269 [debug] [MainThread]: Flushing usage events
[0m12:52:36.976766 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:52:36.982679 | 2bd8418a-5d2c-4aee-9893-90790bdb1088 ==============================
[0m12:52:36.982679 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:52:36.983678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:37.227333 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:37.257762 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m12:52:37.464688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:37.465331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:37.572228 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:52:37.574114 [info ] [MainThread]: 
[0m12:52:37.575927 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:37.580843 [debug] [MainThread]: Command end result
[0m12:52:37.583487 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6628319, "process_user_time": 1.589853, "process_kernel_time": 0.106192, "process_mem_max_rss": "97784", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m12:52:37.587272 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:37.587133 after 0.67 seconds
[0m12:52:37.587872 [debug] [MainThread]: Flushing usage events
[0m12:59:25.460101 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:59:25.466453 | e2731779-47d4-488e-988b-4b68cc2bede9 ==============================
[0m12:59:25.466453 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:59:25.467131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m12:59:25.565933 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m12:59:25.567504 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m12:59:25.571390 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c6ap248h'
[0m12:59:25.571830 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m12:59:25.572816 [debug] [MainThread]: Creating symlink to local dependency.
[0m12:59:25.573436 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m12:59:25.574444 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15346579, "process_user_time": 0.968178, "process_kernel_time": 0.11302, "process_mem_max_rss": "105912", "process_in_blocks": "152", "process_out_blocks": "11"}
[0m12:59:25.574967 [debug] [MainThread]: Command `dbt deps` succeeded at 12:59:25.574896 after 0.15 seconds
[0m12:59:25.575278 [debug] [MainThread]: Flushing usage events
[0m12:59:32.379999 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 12:59:32.385198 | a1e8467c-c00d-42c6-b87c-892e15681ee8 ==============================
[0m12:59:32.385198 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:59:32.385824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:59:32.546561 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:59:32.561587 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:59:32.563026 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:59:33.946064 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m12:59:33.947906 [info ] [MainThread]: 
[0m12:59:33.948507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:33.949360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m12:59:33.976274 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m12:59:33.976735 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m12:59:33.977096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:38.998185 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.021 seconds
[0m12:59:39.001053 [debug] [ThreadPool]: On list_sales_dw: Close
[0m12:59:39.002580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m12:59:39.003805 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m12:59:39.012139 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:59:39.012788 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m12:59:39.013389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:39.020746 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:59:39.021414 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:59:39.022027 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m12:59:39.023087 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m12:59:39.024217 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:59:39.024617 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m12:59:39.025035 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m12:59:39.026584 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:59:39.027076 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m12:59:39.032985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m12:59:39.033606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m12:59:39.039792 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:59:39.042102 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:59:39.042548 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m12:59:39.042956 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m12:59:39.043338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:39.043708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:39.049245 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:59:39.049742 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m12:59:39.050136 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m12:59:39.054222 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:59:39.055451 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m12:59:39.055976 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m12:59:44.059197 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m12:59:44.061773 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m12:59:44.062548 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:59:44.066394 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m12:59:44.067798 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m12:59:44.068491 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m12:59:44.075374 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:44.076082 [debug] [MainThread]: On master: BEGIN
[0m12:59:44.076696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:44.082443 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:59:44.082981 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:44.083452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:44.088985 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:59:44.090529 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:44.091111 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:44.091432 [debug] [MainThread]: On master: BEGIN
[0m12:59:44.091958 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:59:44.092314 [debug] [MainThread]: On master: COMMIT
[0m12:59:44.092619 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:44.093030 [debug] [MainThread]: On master: COMMIT
[0m12:59:44.093492 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:44.093849 [debug] [MainThread]: On master: Close
[0m12:59:44.094395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:59:44.094916 [info ] [MainThread]: 
[0m12:59:44.102016 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m12:59:44.102733 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m12:59:44.103346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m12:59:44.104119 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m12:59:44.104716 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m12:59:44.131315 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:59:44.132062 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m12:59:44.132655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:44.138487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:59:44.139098 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:59:44.139526 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m12:59:44.142033 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m12:59:44.202822 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:59:44.203502 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m12:59:44.205391 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m12:59:44.210234 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m12:59:44.225324 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:59:44.225756 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m12:59:44.226165 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m12:59:44.227395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:59:44.229055 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m12:59:44.230425 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.13s]
[0m12:59:44.231007 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m12:59:44.232198 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:44.232542 [debug] [MainThread]: On master: BEGIN
[0m12:59:44.232843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:49.244628 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m12:59:49.245622 [debug] [MainThread]: On master: COMMIT
[0m12:59:49.246397 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:49.246937 [debug] [MainThread]: On master: COMMIT
[0m12:59:49.247428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:49.247778 [debug] [MainThread]: On master: Close
[0m12:59:49.248408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:49.249208 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m12:59:49.249862 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m12:59:49.250311 [info ] [MainThread]: 
[0m12:59:49.250872 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m12:59:49.251864 [debug] [MainThread]: Command end result
[0m12:59:49.298774 [info ] [MainThread]: 
[0m12:59:49.299750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:49.300192 [info ] [MainThread]: 
[0m12:59:49.300581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:59:49.301672 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.955246, "process_user_time": 2.61164, "process_kernel_time": 0.113027, "process_mem_max_rss": "113868", "process_in_blocks": "24", "process_out_blocks": "3517"}
[0m12:59:49.302539 [debug] [MainThread]: Command `dbt seed` succeeded at 12:59:49.302387 after 16.96 seconds
[0m12:59:49.302957 [debug] [MainThread]: Flushing usage events
[0m13:00:55.139576 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:00:55.152470 | d59dd24e-296a-4b10-8033-91b1c569ec91 ==============================
[0m13:00:55.152470 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:55.155046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:00:55.171505 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:00:55.181985 | 2240603d-abc7-4203-a69c-d9f6088fc91e ==============================
[0m13:00:55.181985 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:55.176966 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:00:55.183169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 13:00:55.185204 | 6f4eb108-c954-4292-b9fb-c0057d40ce75 ==============================
[0m13:00:55.185204 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:55.188943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:55.189982 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:00:55.197341 | cf4f7e4d-bde2-40b8-9091-2cd3fa235e28 ==============================
[0m13:00:55.197341 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:55.198812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m13:00:55.200119 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:00:55.206034 | 3b5cd126-e54a-4135-bf91-d817241d801a ==============================
[0m13:00:55.206034 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:55.206849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:55.215340 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:00:55.221914 | 3002e941-49b6-461d-bde7-b53944789d49 ==============================
[0m13:00:55.221914 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:55.223391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:00:55.245215 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:00:55.254001 | 022c5793-0357-4c56-aef0-01e0032fff4f ==============================
[0m13:00:55.254001 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:00:55.255780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:55.412813 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:00:55.456185 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:00:55.514354 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:00:55.535953 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:00:55.538324 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:00:55.554215 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:00:55.572070 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:00:55.570174 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:00:55.574905 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:00:55.581716 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:00:55.588724 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:00:55.610148 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:00:55.629721 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:55.631518 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:00:55.637585 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:00:55.639518 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:00:55.732175 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:55.734614 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:00:55.738610 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:55.740826 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:00:55.762137 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:55.764593 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:00:55.787659 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:55.790889 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:00:55.802702 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:55.804233 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:00:55.809285 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:55.810007 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:00:57.513884 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:00:57.516711 [info ] [MainThread]: 
[0m13:00:57.518968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:57.522392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:00:57.530034 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:00:57.535369 [info ] [MainThread]: 
[0m13:00:57.539346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:57.542673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:00:57.560143 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:00:57.561336 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:00:57.562199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.579149 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m13:00:57.580717 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:00:57.582258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m13:00:57.583466 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:00:57.584259 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m13:00:57.584021 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:00:57.585294 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:00:57.589937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.590895 [info ] [MainThread]: 
[0m13:00:57.591588 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:00:57.593007 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m13:00:57.592893 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:57.593954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.595857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:00:57.609136 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.019 seconds
[0m13:00:57.610394 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:00:57.611298 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:00:57.611300 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:00:57.612904 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m13:00:57.614049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m13:00:57.614974 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m13:00:57.616959 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:00:57.616217 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m13:00:57.617862 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:00:57.618654 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:00:57.619474 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:00:57.622497 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m13:00:57.624004 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:00:57.623402 [info ] [MainThread]: 
[0m13:00:57.624975 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m13:00:57.624924 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:00:57.625592 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m13:00:57.626154 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:57.627110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.627591 [info ] [MainThread]: 
[0m13:00:57.629179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:57.628453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:00:57.632109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:00:57.633093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m13:00:57.635811 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:00:57.637362 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:00:57.637551 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:00:57.638704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.639076 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:00:57.639134 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:00:57.639666 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m13:00:57.641267 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m13:00:57.641304 [info ] [MainThread]: 
[0m13:00:57.643069 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:00:57.643625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:57.643941 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:00:57.644703 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:00:57.645174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:00:57.646031 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m13:00:57.634473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:00:57.649878 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m13:00:57.646809 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.657119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m13:00:57.655256 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.659549 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:00:57.661494 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:00:57.657772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:00:57.663724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.669074 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:00:57.669212 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:00:57.667463 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.667861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.670903 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:00:57.670288 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.671394 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:00:57.672519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.671801 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:00:57.672637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.672809 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:00:57.673583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.674353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.676884 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:00:57.678796 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:00:57.680913 [info ] [MainThread]: 
[0m13:00:57.680352 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:00:57.681533 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.682095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:00:57.682072 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m13:00:57.682559 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m13:00:57.682253 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:00:57.682732 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:00:57.682259 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:00:57.683948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:00:57.682640 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:00:57.684614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.684284 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:00:57.684300 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.685388 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:00:57.687776 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:00:57.685713 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.689909 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:00:57.686405 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:00:57.691605 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:00:57.691017 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:00:57.692811 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m13:00:57.693554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:00:57.693316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:00:57.695122 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:00:57.693795 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:00:57.695403 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:00:57.694674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:00:57.697737 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:00:57.694314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:00:57.702806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:00:57.701046 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:00:57.700878 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.702026 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.704045 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:00:57.703518 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.706623 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.707172 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:00:57.707573 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:00:57.708187 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:00:57.707204 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:00:57.709018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.708046 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:00:57.710502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.710813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.712553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.714251 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.715027 [debug] [MainThread]: On master: BEGIN
[0m13:00:57.703398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:00:57.715609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:57.718074 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:00:57.718638 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:00:57.714486 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.718855 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.719289 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.718209 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.719732 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:00:57.719961 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:00:57.719408 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:00:57.721250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.720314 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:00:57.722168 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:00:57.722365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.722881 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.722700 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:00:57.722960 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:00:57.723549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:00:57.724379 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:00:57.723291 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:00:57.725167 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:00:57.724703 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:00:57.725517 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.726057 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:00:57.726199 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:00:57.726595 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:00:57.727126 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:00:57.726561 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:00:57.727367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.728404 [debug] [MainThread]: On master: ROLLBACK
[0m13:00:57.729053 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.729468 [debug] [MainThread]: On master: BEGIN
[0m13:00:57.730554 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:00:57.730212 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:00:57.731756 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.732165 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.732605 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.732727 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:00:57.733365 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:00:57.732992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:00:57.733314 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m13:00:57.733731 [debug] [MainThread]: On master: Close
[0m13:00:57.735200 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:00:57.735228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:00:57.735911 [info ] [MainThread]: 
[0m13:00:57.738425 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.740238 [debug] [MainThread]: On master: BEGIN
[0m13:00:57.740876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:57.740398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:00:57.744820 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m13:00:57.745508 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m13:00:57.746146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m13:00:57.746663 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m13:00:57.740991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:00:57.749055 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:00:57.749528 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.749990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:00:57.747463 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.749657 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:00:57.750482 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:00:57.750883 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:00:57.751308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:57.751743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:57.753161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m13:00:57.753835 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:00:57.754855 [debug] [MainThread]: On master: ROLLBACK
[0m13:00:57.755530 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.755977 [debug] [MainThread]: On master: BEGIN
[0m13:00:57.755873 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:00:57.756624 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:00:57.756577 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:00:57.757141 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.757554 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.757468 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:00:57.757921 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.758030 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m13:00:57.758428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:00:57.758777 [debug] [MainThread]: On master: Close
[0m13:00:57.759240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:00:57.759610 [info ] [MainThread]: 
[0m13:00:57.759976 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:00:57.764150 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:00:57.764616 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:00:57.766919 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m13:00:57.767891 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m13:00:57.768762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m13:00:57.769323 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m13:00:57.776778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m13:00:57.778066 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m13:00:57.783590 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m13:00:57.789853 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:00:57.792552 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m13:00:57.792912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:57.797422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:00:57.798829 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:00:57.800199 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m13:00:57.802677 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:00:57.807672 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m13:00:57.808169 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:00:57.808651 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m13:00:57.809449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:00:57.810805 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:00:57.811765 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m13:00:57.813545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:57.817937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:00:57.819604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:00:57.821723 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m13:00:57.821836 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m13:00:57.822680 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:00:57.823128 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m13:00:57.823217 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:00:57.824646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:00:57.829054 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:00:57.829526 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m13:00:57.830250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:00:57.832794 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m13:00:57.841151 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m13:00:57.841617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:00:57.842022 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m13:00:57.843191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:00:57.843367 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:00:57.848494 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m13:00:57.848940 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m13:00:57.851242 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:00:57.852894 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:00:57.853283 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m13:00:57.853348 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m13:00:57.855199 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m13:00:57.855408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:00:57.855916 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m13:00:57.858285 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m13:00:57.860036 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m13:00:57.859559 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.860750 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m13:00:57.861108 [debug] [MainThread]: On master: BEGIN
[0m13:00:57.861525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:57.862321 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.862763 [debug] [MainThread]: On master: BEGIN
[0m13:00:57.863119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:57.866141 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:00:57.866686 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.867077 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.867212 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:00:57.867524 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.867940 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.868344 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:00:57.868759 [debug] [MainThread]: Using postgres connection "master"
[0m13:00:57.869150 [debug] [MainThread]: On master: Close
[0m13:00:57.869501 [debug] [MainThread]: On master: COMMIT
[0m13:00:57.870013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:57.870803 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:00:57.870523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:00:57.871618 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m13:00:57.871261 [debug] [MainThread]: On master: Close
[0m13:00:57.872124 [info ] [MainThread]: 
[0m13:00:57.872741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:57.873111 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m13:00:57.873506 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:00:57.874157 [debug] [MainThread]: Command end result
[0m13:00:57.874531 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m13:00:57.874912 [info ] [MainThread]: 
[0m13:00:57.875829 [info ] [MainThread]: 
[0m13:00:57.875477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:57.876190 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:00:57.876537 [info ] [MainThread]: 
[0m13:00:57.877318 [debug] [MainThread]: Command end result
[0m13:00:57.877694 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:00:57.878208 [info ] [MainThread]: 
[0m13:00:57.879034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7747314, "process_user_time": 3.810748, "process_kernel_time": 0.28659, "process_mem_max_rss": "112740", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m13:00:57.879489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:57.880086 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:57.879987 after 2.78 seconds
[0m13:00:57.880416 [info ] [MainThread]: 
[0m13:00:57.880847 [debug] [MainThread]: Flushing usage events
[0m13:00:57.881177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:00:57.883023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.685846, "process_user_time": 3.732512, "process_kernel_time": 0.240221, "process_mem_max_rss": "112496", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:00:57.885785 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:57.885691 after 2.69 seconds
[0m13:00:57.886127 [debug] [MainThread]: Flushing usage events
[0m13:01:02.658662 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.020 seconds
[0m13:01:02.661487 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:01:02.668524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:01:02.669526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:01:02.676836 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:02.680237 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:01:02.680781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:02.679714 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:02.681685 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:01:02.681814 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m13:01:02.682498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:02.682953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:02.683838 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:02.686625 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:01:02.687281 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:02.687556 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m13:01:02.687947 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:02.688463 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:01:02.689200 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:02.689329 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:02.689638 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:02.690293 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:02.691014 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:01:02.692925 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:02.693262 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:01:02.693781 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:02.695208 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:02.696579 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:02.698225 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.698938 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.699374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:02.703008 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.704019 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.704556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:02.705468 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:01:02.706153 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.706683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:02.711057 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:01:02.711561 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:01:02.711728 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.713310 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:02.713723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:02.714307 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.714844 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.715612 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:02.716297 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.716910 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.716502 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m13:01:02.717524 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.717447 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:01:02.718077 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:02.718621 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:02.719755 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:02.720178 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:02.720612 [debug] [MainThread]: On master: Close
[0m13:01:02.720923 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.721457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:02.722068 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.722474 [info ] [MainThread]: 
[0m13:01:02.723291 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:02.723248 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:01:02.724588 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.725888 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:02.727403 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.727750 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:02.728224 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.729327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:02.730567 [debug] [MainThread]: On master: Close
[0m13:01:02.732219 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:02.732964 [info ] [MainThread]: 
[0m13:01:02.733498 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m13:01:02.734410 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m13:01:02.734137 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m13:01:02.736779 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.737251 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m13:01:02.736631 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:02.737647 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.738190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m13:01:02.737281 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:02.738747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:02.739077 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m13:01:02.738617 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:02.739473 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:02.743108 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m13:01:02.742940 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m13:01:02.744318 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m13:01:02.744055 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:01:02.745456 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:01:02.747105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m13:01:02.747141 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.747590 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m13:01:02.747950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:02.748000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m13:01:02.746513 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:02.747872 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:02.752197 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:02.752889 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m13:01:02.752941 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:02.755115 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:01:02.758008 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:02.758875 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.759743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m13:01:02.760219 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.760868 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m13:01:02.761528 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:02.762410 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m13:01:02.762231 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:02.762605 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.762583 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.763284 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.763297 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:02.763717 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.764306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:02.764945 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.766061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:02.766488 [debug] [MainThread]: On master: Close
[0m13:01:02.766808 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:01:02.769072 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:02.768542 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:02.769622 [info ] [MainThread]: 
[0m13:01:02.770421 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:01:02.771353 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.770409 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:02.771992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:02.776276 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:01:02.778825 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:02.779726 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.780478 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.780593 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.780703 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m13:01:02.781173 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:02.781187 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.781827 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.781814 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m13:01:02.782483 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.782181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:02.783001 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.782994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m13:01:02.784736 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m13:01:02.784356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:02.785355 [debug] [MainThread]: On master: Close
[0m13:01:02.785656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m13:01:02.786037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:02.787400 [info ] [MainThread]: 
[0m13:01:02.789542 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:01:02.791768 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.792134 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:01:02.792385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:02.792704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m13:01:02.792816 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m13:01:02.793464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:02.794515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m13:01:02.794874 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:01:02.795633 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m13:01:02.796054 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:01:02.796209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:02.796658 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m13:01:02.796808 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m13:01:02.797572 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m13:01:02.797660 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:02.798271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m13:01:02.798636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:01:02.798711 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.799282 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:01:02.799245 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m13:01:02.799683 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.800166 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m13:01:02.800697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:01:02.803867 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:02.804790 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:01:02.805326 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.805516 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m13:01:02.805811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:01:02.806184 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.807358 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:01:02.807582 [debug] [MainThread]: On master: COMMIT
[0m13:01:02.808013 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:02.808307 [debug] [MainThread]: On master: Close
[0m13:01:02.809985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:02.810818 [info ] [MainThread]: 
[0m13:01:02.811423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m13:01:02.812046 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:01:02.813088 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m13:01:02.814238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:02.814776 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:01:02.815247 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m13:01:02.815674 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m13:01:02.818692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:02.819463 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m13:01:02.822856 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m13:01:02.823990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m13:01:02.824429 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m13:01:02.828700 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m13:01:02.827374 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m13:01:02.830918 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:01:02.831410 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m13:01:02.832198 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:01:02.831683 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m13:01:02.832839 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:01:02.832900 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m13:01:02.833244 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m13:01:02.833397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:02.833854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:02.834354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m13:01:02.835012 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m13:01:02.838346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:01:02.839261 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:01:02.839686 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m13:01:02.839951 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m13:01:02.840069 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m13:01:02.841348 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m13:01:02.844596 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:01:02.845870 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m13:01:02.846543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m13:01:02.846905 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:01:02.846896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:01:02.847557 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m13:01:02.848136 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:01:02.848154 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:01:02.850253 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m13:01:02.849172 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m13:01:02.852069 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m13:01:02.850616 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m13:01:02.852998 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m13:01:02.853625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:02.853731 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m13:01:02.855285 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m13:01:02.856224 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.856887 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.857262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:02.857266 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.857778 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.858167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:02.859364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:01:02.859897 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:01:02.860460 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m13:01:02.861933 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:01:02.867296 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:01:02.867797 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m13:01:02.868488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:02.871633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m13:01:02.880140 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m13:01:02.880690 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:01:02.881032 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m13:01:02.880834 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:01:02.881500 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m13:01:02.881953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:02.881987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:02.886729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:01:02.887764 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:01:02.888416 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m13:01:02.888847 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m13:01:02.890932 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.001 seconds
[0m13:01:02.893034 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:01:02.893429 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m13:01:02.893937 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:01:02.896057 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m13:01:02.897884 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:01:02.897366 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:01:02.898544 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m13:01:02.898931 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m13:01:02.899698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:02.900153 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.903719 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.907536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:02.913701 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m13:01:02.914225 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:01:02.914709 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m13:01:02.915714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:02.920808 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m13:01:02.924353 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:01:02.924769 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m13:01:02.925344 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:01:02.927255 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m13:01:02.928738 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.10s]
[0m13:01:02.929312 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m13:01:02.930414 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:02.930876 [debug] [MainThread]: On master: BEGIN
[0m13:01:02.931296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:03.076387 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.235 seconds
[0m13:01:03.082672 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:01:03.083216 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:01:03.084091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:03.099609 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m13:01:03.100339 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:01:03.100901 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m13:01:03.103053 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:01:03.108117 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m13:01:03.112218 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:01:03.112691 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m13:01:03.113293 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:01:03.115556 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m13:01:03.117024 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.33s]
[0m13:01:03.117717 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m13:01:03.119039 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.119503 [debug] [MainThread]: On master: BEGIN
[0m13:01:03.119978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:03.124308 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:01:03.124755 [debug] [MainThread]: On master: COMMIT
[0m13:01:03.125093 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:03.125410 [debug] [MainThread]: On master: COMMIT
[0m13:01:03.125915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:03.126265 [debug] [MainThread]: On master: Close
[0m13:01:03.126702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:03.127015 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m13:01:03.127310 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:01:03.127817 [info ] [MainThread]: 
[0m13:01:03.128290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m13:01:03.128987 [debug] [MainThread]: Command end result
[0m13:01:03.129341 [info ] [MainThread]: 
[0m13:01:03.129783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:03.130140 [info ] [MainThread]: 
[0m13:01:03.130519 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:03.131316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.034079, "process_user_time": 3.815456, "process_kernel_time": 0.270219, "process_mem_max_rss": "112288", "process_out_blocks": "1193", "process_in_blocks": "0"}
[0m13:01:03.131853 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:03.131783 after 8.03 seconds
[0m13:01:03.132214 [debug] [MainThread]: Flushing usage events
[0m13:01:05.536088 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:05.542263 | e3a69638-2cee-4845-8ade-5a9f77cd2d24 ==============================
[0m13:01:05.542263 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:05.543828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:05.576399 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:05.582209 | cb5863c0-6235-4128-a6bf-34860ee00b36 ==============================
[0m13:01:05.582209 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:05.582835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:05.610561 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:05.616249 | 7409e5a1-617e-41ab-8e74-ac53f1dba68d ==============================
[0m13:01:05.616249 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:05.616897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:05.637903 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:05.644203 | d2319b49-e8ba-4188-8d00-a5027fe758f6 ==============================
[0m13:01:05.644203 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:05.644971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:05.728026 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:05.749535 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:05.763761 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:05.785476 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:05.821823 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:05.845002 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:05.852083 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:05.862626 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:05.935896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:05.936567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:05.961579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:05.962204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:06.003269 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:06.008579 [info ] [MainThread]: 
[0m13:01:06.010344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:06.012509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:01:06.030510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:06.030402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:06.031006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:06.031131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:06.046379 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:01:06.047720 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:06.048384 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:01:06.050969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:06.050468 [info ] [MainThread]: 
[0m13:01:06.052847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:06.055322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:01:06.060541 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m13:01:06.063351 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:01:06.069969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:01:06.070606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:01:06.078002 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:06.080983 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:06.081569 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:01:06.082030 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:01:06.082423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:06.082893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:06.089507 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:01:06.090513 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:06.091033 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:01:06.091583 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:06.092286 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:06.093737 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:06.096205 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:01:06.097704 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:06.098210 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m13:01:06.099782 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:01:06.099010 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:06.100579 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:01:06.100129 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:06.101173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:06.102115 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:06.110508 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:06.111099 [debug] [MainThread]: On master: BEGIN
[0m13:01:06.111640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:06.116541 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:06.118097 [info ] [MainThread]: 
[0m13:01:06.118581 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:06.119203 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:06.120864 [info ] [MainThread]: 
[0m13:01:06.120918 [debug] [MainThread]: Command end result
[0m13:01:06.121360 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:06.122181 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5369963, "process_user_time": 1.331274, "process_kernel_time": 0.125343, "process_mem_max_rss": "97680", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:06.122731 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:06.122658 after 0.54 seconds
[0m13:01:06.123101 [debug] [MainThread]: Flushing usage events
[0m13:01:06.123296 [debug] [MainThread]: Command end result
[0m13:01:06.124985 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5554382, "process_user_time": 1.324436, "process_kernel_time": 0.112632, "process_mem_max_rss": "97556", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:06.127263 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:06.127037 after 0.56 seconds
[0m13:01:06.127990 [debug] [MainThread]: Flushing usage events
[0m13:01:07.863664 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m13:01:07.865161 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.866371 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:07.867536 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.868081 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m13:01:07.869080 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.869107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:07.869642 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:07.870699 [debug] [MainThread]: On master: Close
[0m13:01:07.872418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:07.871736 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.873386 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m13:01:07.873745 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:07.874891 [debug] [MainThread]: On master: Close
[0m13:01:07.874540 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:01:07.877753 [info ] [MainThread]: 
[0m13:01:07.877913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:07.878769 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m13:01:07.879128 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:01:07.880172 [debug] [MainThread]: Command end result
[0m13:01:07.880454 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m13:01:07.880784 [info ] [MainThread]: 
[0m13:01:07.881311 [info ] [MainThread]: 
[0m13:01:07.881624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:07.882547 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m13:01:07.883072 [info ] [MainThread]: 
[0m13:01:07.883773 [debug] [MainThread]: Command end result
[0m13:01:07.884119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:07.884472 [info ] [MainThread]: 
[0m13:01:07.885381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:07.885742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.8197365, "process_user_time": 3.753317, "process_kernel_time": 0.319798, "process_mem_max_rss": "112952", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m13:01:07.885993 [info ] [MainThread]: 
[0m13:01:07.887878 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:07.887768 after 12.82 seconds
[0m13:01:07.888174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:07.888716 [debug] [MainThread]: Flushing usage events
[0m13:01:07.890428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.767029, "process_user_time": 3.817178, "process_kernel_time": 0.286212, "process_mem_max_rss": "113176", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:01:07.895913 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:07.895761 after 12.77 seconds
[0m13:01:07.896424 [debug] [MainThread]: Flushing usage events
[0m13:01:07.913280 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m13:01:07.917633 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.918079 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:07.918454 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.918941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:07.919386 [debug] [MainThread]: On master: Close
[0m13:01:07.920107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:07.923775 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:01:07.924367 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m13:01:07.924851 [info ] [MainThread]: 
[0m13:01:07.925531 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m13:01:07.926555 [debug] [MainThread]: Command end result
[0m13:01:07.928498 [info ] [MainThread]: 
[0m13:01:07.929347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:07.930252 [info ] [MainThread]: 
[0m13:01:07.931849 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:07.933759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.798797, "process_user_time": 3.780228, "process_kernel_time": 0.263784, "process_mem_max_rss": "113292", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m13:01:07.934839 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:07.934730 after 12.80 seconds
[0m13:01:07.935685 [debug] [MainThread]: Flushing usage events
[0m13:01:07.937228 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m13:01:07.939711 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.942745 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:07.943313 [debug] [MainThread]: On master: COMMIT
[0m13:01:07.943939 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:07.944321 [debug] [MainThread]: On master: Close
[0m13:01:07.945113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:07.948662 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:01:07.949141 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m13:01:07.949805 [info ] [MainThread]: 
[0m13:01:07.950520 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m13:01:07.951929 [debug] [MainThread]: Command end result
[0m13:01:07.955824 [info ] [MainThread]: 
[0m13:01:07.956574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:07.956967 [info ] [MainThread]: 
[0m13:01:07.957392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:07.959220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.800905, "process_user_time": 3.804647, "process_kernel_time": 0.293053, "process_mem_max_rss": "112328", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m13:01:07.962360 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:07.962146 after 12.80 seconds
[0m13:01:07.965957 [debug] [MainThread]: Flushing usage events
[0m13:01:10.598262 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:10.604735 | eda1d4f4-051d-4afa-b3af-fc8c17b2ef80 ==============================
[0m13:01:10.604735 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:10.605387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m13:01:10.767600 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:10.781061 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:10.927564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:10.928183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:10.992197 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:10.993867 [info ] [MainThread]: 
[0m13:01:10.994267 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:10.995818 [debug] [MainThread]: Command end result
[0m13:01:10.996603 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43475282, "process_user_time": 1.247257, "process_kernel_time": 0.088733, "process_mem_max_rss": "98188", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:10.997113 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:10.997030 after 0.44 seconds
[0m13:01:10.997488 [debug] [MainThread]: Flushing usage events
[0m13:01:11.110223 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.009 seconds
[0m13:01:11.112976 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:01:11.117688 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m13:01:11.118806 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:11.119667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:11.119452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:01:11.123900 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m13:01:11.120223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:01:11.128560 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:11.126890 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:11.129253 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:11.131037 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:11.131161 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:01:11.130682 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:01:11.131510 [debug] [MainThread]: On master: BEGIN
[0m13:01:11.131563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:11.131909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:11.132806 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:01:11.134701 [debug] [MainThread]: On master: COMMIT
[0m13:01:11.136547 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:11.137024 [debug] [MainThread]: On master: COMMIT
[0m13:01:11.137523 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:01:11.138072 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:11.137539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:11.138496 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:11.138535 [debug] [MainThread]: On master: Close
[0m13:01:11.142039 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:11.142074 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:01:11.142774 [info ] [MainThread]: 
[0m13:01:11.144324 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:11.145105 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:11.151706 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m13:01:11.152542 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m13:01:11.153242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m13:01:11.153848 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m13:01:11.161418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m13:01:11.163320 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m13:01:11.192365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m13:01:11.194362 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:01:11.194997 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m13:01:11.195431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:15.797565 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:15.804152 | cec20bcf-d18f-4aa9-8e67-f1bc5c922308 ==============================
[0m13:01:15.804152 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:15.805113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:15.806024 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:15.814339 | e1bd5abe-942c-43e1-a191-6b9016c97876 ==============================
[0m13:01:15.814339 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:15.815525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:15.837159 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:01:15.838270 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:15.845561 | 37ec36fb-8707-4a3a-8e7f-999bc6c66d33 ==============================
[0m13:01:15.845561 [info ] [MainThread]: Running with dbt=1.8.2


============================== 13:01:15.845716 | ab140b65-0667-4185-b2de-67e4a2edbcd7 ==============================
[0m13:01:15.845716 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:15.846222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:15.846604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:15.841568 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:15.850740 | 630d8072-106c-4033-a38d-5f60cadcbd39 ==============================
[0m13:01:15.850740 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:15.851569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:15.981424 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:15.998645 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:15.998793 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:16.020831 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:16.030774 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:16.034922 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:16.052660 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:16.055130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:16.062109 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:16.077576 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:16.143364 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m13:01:16.144322 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:16.147606 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:16.150431 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m13:01:16.153296 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:16.154059 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:16.161668 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:16.162404 [debug] [MainThread]: On master: BEGIN
[0m13:01:16.163252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:16.169187 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:01:16.169956 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:16.171029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:16.174737 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m13:01:16.176021 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:16.176866 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:16.177522 [debug] [MainThread]: On master: BEGIN
[0m13:01:16.179183 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:16.180192 [debug] [MainThread]: On master: COMMIT
[0m13:01:16.181201 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:16.181613 [debug] [MainThread]: On master: COMMIT
[0m13:01:16.182228 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:16.182661 [debug] [MainThread]: On master: Close
[0m13:01:16.183476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:16.184117 [info ] [MainThread]: 
[0m13:01:16.196235 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m13:01:16.196564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:16.197050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:16.197963 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m13:01:16.199109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m13:01:16.199881 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m13:01:16.200608 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m13:01:16.203879 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:01:16.204510 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m13:01:16.206527 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:01:16.212690 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:01:16.213317 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m13:01:16.213401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m13:01:16.214286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:16.215334 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m13:01:16.226555 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m13:01:16.227373 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:01:16.228250 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m13:01:16.229573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:16.229656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:16.230347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:16.247891 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m13:01:16.249682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:16.250385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:16.254883 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:01:16.255591 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m13:01:16.256806 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:01:16.259100 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m13:01:16.261132 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 5.11s]
[0m13:01:16.260179 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m13:01:16.262108 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m13:01:16.263450 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:16.265647 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:01:16.265862 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:16.266314 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m13:01:16.265940 [info ] [MainThread]: 
[0m13:01:16.266705 [debug] [MainThread]: On master: BEGIN
[0m13:01:16.267016 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:16.266963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:16.267319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:16.268814 [debug] [MainThread]: Command end result
[0m13:01:16.270792 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5153165, "process_user_time": 1.343048, "process_kernel_time": 0.104314, "process_mem_max_rss": "97336", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:16.271794 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:16.271649 after 0.52 seconds
[0m13:01:16.272567 [debug] [MainThread]: Flushing usage events
[0m13:01:16.274131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:16.274937 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:01:16.275722 [debug] [MainThread]: On master: COMMIT
[0m13:01:16.275152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:16.277641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:01:16.276811 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:16.278694 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:01:16.279227 [debug] [MainThread]: On master: COMMIT
[0m13:01:16.281415 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m13:01:16.282746 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:16.284886 [debug] [MainThread]: On master: Close
[0m13:01:16.285666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:16.285173 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:01:16.289541 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:01:16.290001 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m13:01:16.291301 [info ] [MainThread]: 
[0m13:01:16.292242 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m13:01:16.295103 [debug] [MainThread]: Command end result
[0m13:01:16.295677 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:01:16.296546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:16.297621 [info ] [MainThread]: 
[0m13:01:16.298348 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m13:01:16.298608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:16.298596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:16.299811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:01:16.299845 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:16.300223 [info ] [MainThread]: 
[0m13:01:16.302273 [info ] [MainThread]: 
[0m13:01:16.304990 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:16.305272 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:16.307818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.813342, "process_user_time": 1.501225, "process_kernel_time": 0.133841, "process_mem_max_rss": "106332", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m13:01:16.308844 [debug] [MainThread]: Command end result
[0m13:01:16.310422 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:16.310286 after 10.82 seconds
[0m13:01:16.310954 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5487656, "process_user_time": 1.345907, "process_kernel_time": 0.074381, "process_mem_max_rss": "97332", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:16.311659 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m13:01:16.312105 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:16.311977 after 0.55 seconds
[0m13:01:16.311567 [debug] [MainThread]: Flushing usage events
[0m13:01:16.312790 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:01:16.313295 [debug] [MainThread]: Flushing usage events
[0m13:01:16.314990 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m13:01:16.320597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:01:16.327231 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:16.329878 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m13:01:16.331739 [info ] [MainThread]: 
[0m13:01:16.335573 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:16.336720 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:01:16.338648 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m13:01:16.339004 [debug] [MainThread]: Command end result
[0m13:01:16.340300 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5514634, "process_user_time": 1.354447, "process_kernel_time": 0.094143, "process_mem_max_rss": "97364", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:16.340940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:01:16.341380 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:16.341280 after 0.55 seconds
[0m13:01:16.343819 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m13:01:16.344202 [debug] [MainThread]: Flushing usage events
[0m13:01:16.347734 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m13:01:16.349140 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m13:01:16.350424 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:16.351729 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:16.353912 [info ] [MainThread]: 
[0m13:01:16.355185 [debug] [MainThread]: On master: BEGIN
[0m13:01:16.355983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:16.356227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:16.357777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:01:16.382154 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:16.387103 [info ] [MainThread]: 
[0m13:01:16.388410 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:16.391109 [debug] [MainThread]: Command end result
[0m13:01:16.392898 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.60056627, "process_user_time": 1.361804, "process_kernel_time": 0.105294, "process_mem_max_rss": "97536", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:16.393179 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:01:16.394090 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:16.393946 after 0.60 seconds
[0m13:01:16.394013 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:01:16.395462 [debug] [MainThread]: Flushing usage events
[0m13:01:16.395333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:16.409040 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m13:01:16.412282 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:01:16.420143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:01:16.422359 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:01:16.432410 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:16.434894 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:16.435986 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:01:16.437098 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:01:16.438198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:16.438898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:21.371633 [debug] [MainThread]: SQL status: BEGIN in 5.016 seconds
[0m13:01:21.373878 [debug] [MainThread]: On master: COMMIT
[0m13:01:21.374923 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:21.376900 [debug] [MainThread]: On master: COMMIT
[0m13:01:21.378200 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:21.382626 [debug] [MainThread]: On master: Close
[0m13:01:21.385076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:21.386524 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m13:01:21.387373 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:01:21.388481 [info ] [MainThread]: 
[0m13:01:21.389366 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.34 seconds (15.34s).
[0m13:01:21.390932 [debug] [MainThread]: Command end result
[0m13:01:21.392008 [info ] [MainThread]: 
[0m13:01:21.392983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:21.393760 [info ] [MainThread]: 
[0m13:01:21.394503 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:21.396086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.875215, "process_user_time": 1.527623, "process_kernel_time": 0.140688, "process_mem_max_rss": "106348", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m13:01:21.397187 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:21.397104 after 15.88 seconds
[0m13:01:21.397890 [debug] [MainThread]: Flushing usage events
[0m13:01:21.448726 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m13:01:21.449982 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m13:01:21.452392 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:21.450954 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:21.456497 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:21.457064 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:21.460720 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:01:21.461151 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m13:01:21.467012 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:21.465144 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:21.468073 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:21.468687 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:21.479954 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:21.480606 [debug] [MainThread]: On master: BEGIN
[0m13:01:21.481050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:23.458890 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:23.464734 | 70af92f6-43fb-48b8-8d5b-5eed9f24c491 ==============================
[0m13:01:23.464734 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:23.465408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:23.492217 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:23.502402 | cfcf9ff4-aec3-4315-841d-aad2bb1e16fb ==============================
[0m13:01:23.502402 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:23.503116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:23.656585 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:23.673136 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:23.692309 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:23.719773 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:23.919872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:23.920919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:23.942487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:23.946372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:23.998522 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:24.001369 [info ] [MainThread]: 
[0m13:01:24.002033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:24.004148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:01:24.027547 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:24.029064 [info ] [MainThread]: 
[0m13:01:24.029617 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:24.031625 [debug] [MainThread]: Command end result
[0m13:01:24.032417 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59741133, "process_user_time": 1.348322, "process_kernel_time": 0.108186, "process_mem_max_rss": "97860", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:24.033140 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:24.032952 after 0.60 seconds
[0m13:01:24.033726 [debug] [MainThread]: Flushing usage events
[0m13:01:24.043000 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:01:24.044653 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:01:24.045847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:24.057670 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m13:01:24.058964 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:01:24.064631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:01:24.065237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:01:24.070769 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:24.073161 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:24.073791 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:01:24.074302 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:01:24.074737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:24.075135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:24.080666 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:01:24.081341 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:24.081824 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:24.084618 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m13:01:24.085877 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:24.086465 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:26.486987 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m13:01:26.488799 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:26.491681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:26.496897 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m13:01:26.499345 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:26.500724 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:26.501200 [debug] [MainThread]: On master: BEGIN
[0m13:01:26.503575 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:26.504355 [debug] [MainThread]: On master: COMMIT
[0m13:01:26.505432 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:26.507125 [debug] [MainThread]: On master: COMMIT
[0m13:01:26.508565 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:26.508952 [debug] [MainThread]: On master: Close
[0m13:01:26.509647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:26.510213 [info ] [MainThread]: 
[0m13:01:26.518870 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m13:01:26.519775 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m13:01:26.520581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m13:01:26.521160 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m13:01:26.529315 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m13:01:26.530934 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m13:01:26.559764 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m13:01:26.561431 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:01:26.561915 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m13:01:26.562422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:28.721320 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:28.727611 | 726789de-5e80-44db-aafd-78524d083b7b ==============================
[0m13:01:28.727611 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:28.728393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:28.728556 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:28.736176 | 5328a090-9c6c-4d22-8b17-78c32be0f17e ==============================
[0m13:01:28.736176 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:28.736829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:28.892677 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:28.894611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:28.908258 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:28.913290 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:29.081676 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m13:01:29.082401 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:29.083196 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:29.085575 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:01:29.086796 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:29.085648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:29.085943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:29.087335 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:29.087272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:29.087620 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:29.092507 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:29.093019 [debug] [MainThread]: On master: BEGIN
[0m13:01:29.093445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:29.140946 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:29.142617 [info ] [MainThread]: 
[0m13:01:29.143315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:29.144318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:01:29.151013 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:29.153508 [info ] [MainThread]: 
[0m13:01:29.155575 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:29.157584 [debug] [MainThread]: Command end result
[0m13:01:29.158408 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4734494, "process_user_time": 1.248356, "process_kernel_time": 0.064327, "process_mem_max_rss": "97724", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:29.158922 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:29.158848 after 0.47 seconds
[0m13:01:29.159298 [debug] [MainThread]: Flushing usage events
[0m13:01:29.174101 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:01:29.174821 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:01:29.177377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:29.186487 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m13:01:29.191166 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:01:29.196465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:01:29.197083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:01:29.202743 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:29.205223 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:29.205814 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:01:29.206282 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:01:29.206641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:29.206971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:31.578249 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m13:01:31.579218 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:01:31.580009 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m13:01:31.584954 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:01:31.593849 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:01:31.594719 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m13:01:31.595831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:31.609956 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m13:01:31.610882 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:01:31.611527 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m13:01:31.612917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:31.619067 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m13:01:31.623635 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:01:31.624328 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m13:01:31.625291 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:01:31.629168 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m13:01:31.631876 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.11s]
[0m13:01:31.632862 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m13:01:31.634844 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:31.635379 [debug] [MainThread]: On master: BEGIN
[0m13:01:31.635876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:31.641275 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:01:31.641855 [debug] [MainThread]: On master: COMMIT
[0m13:01:31.642302 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:31.642765 [debug] [MainThread]: On master: COMMIT
[0m13:01:31.643356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:31.643741 [debug] [MainThread]: On master: Close
[0m13:01:31.644392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:31.644790 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:01:31.645293 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m13:01:31.645775 [info ] [MainThread]: 
[0m13:01:31.646153 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m13:01:31.646946 [debug] [MainThread]: Command end result
[0m13:01:31.647314 [info ] [MainThread]: 
[0m13:01:31.647802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:31.648161 [info ] [MainThread]: 
[0m13:01:31.648631 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:31.650169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.852524, "process_user_time": 1.539216, "process_kernel_time": 0.120565, "process_mem_max_rss": "105944", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m13:01:31.651212 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:31.651108 after 15.85 seconds
[0m13:01:31.651754 [debug] [MainThread]: Flushing usage events
[0m13:01:34.107339 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m13:01:34.109073 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.109717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:34.114535 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m13:01:34.117564 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:34.118130 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.118497 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.119094 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:34.119701 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.120133 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.120495 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.120852 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:34.121160 [debug] [MainThread]: On master: Close
[0m13:01:34.121850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:34.122385 [info ] [MainThread]: 
[0m13:01:34.130913 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m13:01:34.131726 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m13:01:34.132363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m13:01:34.132788 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m13:01:34.141400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m13:01:34.142860 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m13:01:34.176375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m13:01:34.177856 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:01:34.178278 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m13:01:34.178643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:34.184764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:01:34.185245 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:01:34.185828 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    --reseller_id AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    reseller_id AS reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m13:01:34.187130 [debug] [Thread-1 (]: Postgres adapter: Postgres error: each UNION query must have the same number of columns
LINE 25:     0 AS sales_agent_key,
             ^

[0m13:01:34.187654 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: ROLLBACK
[0m13:01:34.188482 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m13:01:34.190902 [debug] [Thread-1 (]: Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 25:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m13:01:34.193183 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_salesagent ....................... [[31mERROR[0m in 0.06s]
[0m13:01:34.193992 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m13:01:34.196016 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.196402 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.196740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:34.201707 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:01:34.202220 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.202721 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.203121 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.203668 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:34.204005 [debug] [MainThread]: On master: Close
[0m13:01:34.204533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:34.204869 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:01:34.205179 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m13:01:34.205630 [info ] [MainThread]: 
[0m13:01:34.206020 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.20 seconds (10.20s).
[0m13:01:34.206722 [debug] [MainThread]: Command end result
[0m13:01:34.207069 [info ] [MainThread]: 
[0m13:01:34.207583 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:01:34.208006 [info ] [MainThread]: 
[0m13:01:34.208586 [error] [MainThread]:   Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 25:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m13:01:34.209024 [info ] [MainThread]: 
[0m13:01:34.209513 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:01:34.210541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.793646, "process_user_time": 1.518901, "process_kernel_time": 0.097701, "process_mem_max_rss": "106492", "process_out_blocks": "29", "command_success": false, "process_in_blocks": "0"}
[0m13:01:34.211397 [debug] [MainThread]: Command `dbt run` failed at 13:01:34.211295 after 10.79 seconds
[0m13:01:34.211890 [debug] [MainThread]: Flushing usage events
[0m13:01:34.212485 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m13:01:34.213991 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m13:01:34.217510 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:34.218408 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:34.220393 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:34.221450 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:34.227152 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:01:34.228375 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m13:01:34.230640 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:34.232689 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:34.233822 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:34.234588 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:34.243644 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.244560 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.248416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:34.254225 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:01:34.254831 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.255368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:34.258583 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m13:01:34.260424 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:34.260924 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.261287 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.262100 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:34.262737 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.263249 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.263698 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.264377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:34.264791 [debug] [MainThread]: On master: Close
[0m13:01:34.265385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:34.265898 [info ] [MainThread]: 
[0m13:01:34.274117 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m13:01:34.274832 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m13:01:34.275368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m13:01:34.275736 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m13:01:34.283615 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m13:01:34.284913 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m13:01:34.316322 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m13:01:34.318070 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:01:34.318631 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m13:01:34.319014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:39.061728 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:39.067471 | 042d7ce1-32b0-47b8-bd5b-79cdc26756b6 ==============================
[0m13:01:39.067471 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:39.068068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:39.069365 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:39.074631 | bb5f6c3d-d693-4b58-b858-87db71ec6160 ==============================
[0m13:01:39.074631 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:39.075433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:39.239646 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:39.253681 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:39.267051 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:39.272559 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:39.323925 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m13:01:39.327447 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:01:39.329447 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m13:01:39.333314 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m13:01:39.338882 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:01:39.339392 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m13:01:39.340009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:39.353028 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m13:01:39.353563 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:01:39.354030 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m13:01:39.355518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:01:39.360441 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m13:01:39.363950 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:01:39.364434 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m13:01:39.365098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:01:39.367299 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m13:01:39.369235 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.09s]
[0m13:01:39.369985 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m13:01:39.371384 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:39.371829 [debug] [MainThread]: On master: BEGIN
[0m13:01:39.372163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:39.430152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:39.430152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:39.430709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:39.431020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:39.488330 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:39.490046 [info ] [MainThread]: 
[0m13:01:39.490859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:39.491673 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:39.493411 [info ] [MainThread]: 
[0m13:01:39.491987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:01:39.493911 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:39.495545 [debug] [MainThread]: Command end result
[0m13:01:39.496431 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48089302, "process_user_time": 1.25149, "process_kernel_time": 0.080159, "process_mem_max_rss": "97660", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:39.496994 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:39.496918 after 0.48 seconds
[0m13:01:39.497425 [debug] [MainThread]: Flushing usage events
[0m13:01:39.522545 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:01:39.524391 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:01:39.524803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:44.392843 [debug] [MainThread]: SQL status: BEGIN in 5.020 seconds
[0m13:01:44.395036 [debug] [MainThread]: On master: COMMIT
[0m13:01:44.396095 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:44.396884 [debug] [MainThread]: On master: COMMIT
[0m13:01:44.397726 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:44.398478 [debug] [MainThread]: On master: Close
[0m13:01:44.399790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:44.400509 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m13:01:44.401091 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:01:44.401976 [info ] [MainThread]: 
[0m13:01:44.402803 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.26 seconds (15.26s).
[0m13:01:44.404517 [debug] [MainThread]: Command end result
[0m13:01:44.405058 [info ] [MainThread]: 
[0m13:01:44.405810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:44.406232 [info ] [MainThread]: 
[0m13:01:44.406750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:44.409010 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.7230425, "process_user_time": 1.391962, "process_kernel_time": 0.095962, "process_mem_max_rss": "106312", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m13:01:44.410282 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:44.410147 after 15.72 seconds
[0m13:01:44.411009 [debug] [MainThread]: Flushing usage events
[0m13:01:44.546041 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.020 seconds
[0m13:01:44.554574 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:01:44.568284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:01:44.569392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:01:44.580312 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:44.583041 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:01:44.583453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:44.582612 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:44.584951 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:01:44.585353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:44.592710 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:01:44.593277 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:01:44.593784 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:01:44.597865 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:01:44.599414 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:01:44.599962 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:01:49.605635 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m13:01:49.608069 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:01:49.608919 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:01:49.613022 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:01:49.615491 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:01:49.616369 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:01:49.624740 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:49.625621 [debug] [MainThread]: On master: BEGIN
[0m13:01:49.626136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:49.633878 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:01:49.634576 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:49.635131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:49.639337 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m13:01:49.641462 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:49.642108 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:49.642546 [debug] [MainThread]: On master: BEGIN
[0m13:01:49.643071 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:01:49.643577 [debug] [MainThread]: On master: COMMIT
[0m13:01:49.644040 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:49.644440 [debug] [MainThread]: On master: COMMIT
[0m13:01:49.644924 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:49.645300 [debug] [MainThread]: On master: Close
[0m13:01:49.646325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:49.647032 [info ] [MainThread]: 
[0m13:01:49.656555 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m13:01:49.657649 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m13:01:49.658602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m13:01:49.659287 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m13:01:49.667877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m13:01:49.669790 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m13:01:49.704166 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m13:01:49.706474 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:01:49.707147 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m13:01:49.707965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:49.715230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:01:49.715947 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:01:49.716698 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m13:01:49.726395 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.009 seconds
[0m13:01:49.733813 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:01:49.734496 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:01:49.735546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:01:49.751975 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m13:01:49.752667 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:01:49.753284 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m13:01:49.755480 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:01:49.761362 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m13:01:49.765097 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:01:49.765670 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m13:01:49.766622 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:01:49.769117 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m13:01:49.771467 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.11s]
[0m13:01:49.772419 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m13:01:49.774355 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:49.774843 [debug] [MainThread]: On master: BEGIN
[0m13:01:49.775425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:52.255020 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:01:52.260624 | 176c870d-a4ea-469f-96c4-ae8f6d247dfb ==============================
[0m13:01:52.260624 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:52.261349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:52.413915 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:52.427936 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:01:52.570619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:52.571382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:52.637538 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:01:52.639336 [info ] [MainThread]: 
[0m13:01:52.639827 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:01:52.641636 [debug] [MainThread]: Command end result
[0m13:01:52.642440 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.423529, "process_user_time": 1.261565, "process_kernel_time": 0.092114, "process_mem_max_rss": "97784", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:01:52.642983 [debug] [MainThread]: Command `dbt test` succeeded at 13:01:52.642909 after 0.42 seconds
[0m13:01:52.643391 [debug] [MainThread]: Flushing usage events
[0m13:01:54.789381 [debug] [MainThread]: SQL status: BEGIN in 5.014 seconds
[0m13:01:54.790838 [debug] [MainThread]: On master: COMMIT
[0m13:01:54.791323 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:54.791696 [debug] [MainThread]: On master: COMMIT
[0m13:01:54.792174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:54.792546 [debug] [MainThread]: On master: Close
[0m13:01:54.793445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:54.794054 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m13:01:54.794395 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:01:54.794943 [info ] [MainThread]: 
[0m13:01:54.795544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m13:01:54.796775 [debug] [MainThread]: Command end result
[0m13:01:54.797288 [info ] [MainThread]: 
[0m13:01:54.797918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:54.798296 [info ] [MainThread]: 
[0m13:01:54.798779 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:54.800531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.79442, "process_user_time": 1.460537, "process_kernel_time": 0.093289, "process_mem_max_rss": "106200", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:01:54.801458 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:54.801345 after 15.80 seconds
[0m13:01:54.802072 [debug] [MainThread]: Flushing usage events
[0m13:02:02.444453 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:02:02.451177 | 51d72663-5d5e-4a13-8032-bb5c7ec329f6 ==============================
[0m13:02:02.451177 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:02:02.451889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:02:02.633743 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:02:02.647714 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:02:02.788554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:02.789134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:02.855102 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:02:02.856726 [info ] [MainThread]: 
[0m13:02:02.857155 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:02:02.858773 [debug] [MainThread]: Command end result
[0m13:02:02.859621 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45223913, "process_user_time": 1.366111, "process_kernel_time": 0.098742, "process_mem_max_rss": "97720", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:02:02.860323 [debug] [MainThread]: Command `dbt test` succeeded at 13:02:02.860208 after 0.45 seconds
[0m13:02:02.860810 [debug] [MainThread]: Flushing usage events
[0m13:10:49.195898 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:10:49.202363 | 05c383ed-a418-4db5-a4c9-02d0aa014f4d ==============================
[0m13:10:49.202363 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:10:49.203122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m13:10:49.292709 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m13:10:49.295728 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m13:10:49.299706 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v30ov6lx'
[0m13:10:49.300162 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m13:10:49.300926 [debug] [MainThread]: Creating symlink to local dependency.
[0m13:10:49.301360 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m13:10:49.302203 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1432652, "process_user_time": 1.012901, "process_kernel_time": 0.125235, "process_mem_max_rss": "106024", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m13:10:49.302654 [debug] [MainThread]: Command `dbt deps` succeeded at 13:10:49.302589 after 0.14 seconds
[0m13:10:49.302943 [debug] [MainThread]: Flushing usage events
[0m13:10:56.237560 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:10:56.242566 | a73ee5e0-7f13-4179-87ae-46025224cee5 ==============================
[0m13:10:56.242566 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:10:56.243114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:10:56.393419 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:10:56.405742 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:10:56.406904 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:10:57.918215 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:10:57.920343 [info ] [MainThread]: 
[0m13:10:57.922040 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:57.923144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:10:57.961058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:10:57.962116 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:10:57.965025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:57.973163 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m13:10:57.975988 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:10:57.977763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m13:10:57.980073 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m13:10:57.986108 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m13:10:57.986574 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m13:10:57.987016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:57.991754 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:10:57.992402 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m13:10:57.992817 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m13:10:57.993617 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m13:10:57.994537 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m13:10:57.994953 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m13:10:57.995378 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m13:10:57.996212 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m13:10:57.996583 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m13:10:58.001563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m13:10:58.002104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:10:58.008888 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:10:58.011296 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:10:58.011786 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:10:58.012229 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:10:58.012621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:58.013026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:58.018576 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:10:58.019043 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:10:58.019511 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:10:58.023066 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:10:58.024206 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:10:58.024775 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:03.024879 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m13:11:03.034430 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:03.037264 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:03.041563 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:11:03.044113 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:03.044816 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:03.059942 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:03.062085 [debug] [MainThread]: On master: BEGIN
[0m13:11:03.063570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:03.075835 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:11:03.077194 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:03.077836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:03.082170 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:11:03.084044 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:03.084614 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:03.084965 [debug] [MainThread]: On master: BEGIN
[0m13:11:03.085565 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:03.085993 [debug] [MainThread]: On master: COMMIT
[0m13:11:03.086268 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:03.086551 [debug] [MainThread]: On master: COMMIT
[0m13:11:03.087105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:03.087528 [debug] [MainThread]: On master: Close
[0m13:11:03.088295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:03.089588 [info ] [MainThread]: 
[0m13:11:03.099950 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m13:11:03.100805 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m13:11:03.101442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m13:11:03.101864 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m13:11:03.102297 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m13:11:03.134614 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:11:03.135256 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m13:11:03.135826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:03.141910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:11:03.142867 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:11:03.143905 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m13:11:03.148332 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m13:11:03.222410 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:11:03.223252 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m13:11:03.226301 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m13:11:03.234735 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m13:11:03.252824 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m13:11:03.253558 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:11:03.254048 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m13:11:03.255133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:03.257777 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m13:11:03.259834 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.16s]
[0m13:11:03.260738 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m13:11:03.262482 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:03.262912 [debug] [MainThread]: On master: BEGIN
[0m13:11:03.263244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:08.273395 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m13:11:08.274758 [debug] [MainThread]: On master: COMMIT
[0m13:11:08.275378 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:08.275885 [debug] [MainThread]: On master: COMMIT
[0m13:11:08.276677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:08.277226 [debug] [MainThread]: On master: Close
[0m13:11:08.278077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:08.278419 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:11:08.278697 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m13:11:08.279164 [info ] [MainThread]: 
[0m13:11:08.279744 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m13:11:08.280718 [debug] [MainThread]: Command end result
[0m13:11:08.335714 [info ] [MainThread]: 
[0m13:11:08.336433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:08.336817 [info ] [MainThread]: 
[0m13:11:08.337930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:08.342599 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.139885, "process_user_time": 2.819877, "process_kernel_time": 0.124303, "process_mem_max_rss": "113752", "process_out_blocks": "3516", "process_in_blocks": "0"}
[0m13:11:08.343794 [debug] [MainThread]: Command `dbt seed` succeeded at 13:11:08.343707 after 12.14 seconds
[0m13:11:08.344303 [debug] [MainThread]: Flushing usage events
[0m13:11:17.227855 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:17.235768 | 9c3b9263-24e8-489c-9a96-76a66fa81075 ==============================
[0m13:11:17.235768 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:17.239498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:17.247085 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:17.260686 | 7fe18053-d965-4d60-a8d1-607cc672d4a5 ==============================
[0m13:11:17.260686 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:17.263564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:17.267492 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:11:17.275465 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:17.282363 | cc311248-8193-425f-892e-974635149f31 ==============================
[0m13:11:17.282363 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:17.284808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 13:11:17.283913 | c1cc0735-ca89-41fd-a68f-c7048150c95d ==============================
[0m13:11:17.283913 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:17.286337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:17.329768 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:17.336073 | 2c30d23c-11fe-461a-877e-c2a90829c10e ==============================
[0m13:11:17.336073 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:17.337055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:17.342450 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:17.349821 | ae678d48-8347-4435-a313-612e9dd460b9 ==============================
[0m13:11:17.349821 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:17.351018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:17.374876 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:17.383664 | d0674ba7-83fd-4da4-bd80-00bc4597fd6d ==============================
[0m13:11:17.383664 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:17.385189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:17.461854 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:17.493705 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:17.496764 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:17.522132 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:17.527693 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:17.547660 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:17.570861 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:17.571728 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:17.585408 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:17.589546 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:17.602562 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:17.618051 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:17.647076 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:17.656442 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:11:17.660169 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:11:17.662862 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:11:17.663966 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:11:17.677002 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:17.703872 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:11:17.704636 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:11:17.713621 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:11:17.714676 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:11:17.731481 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:11:17.732541 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:11:17.745104 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:11:17.748706 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:11:17.801859 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:11:17.803903 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:11:19.324873 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:19.329057 [info ] [MainThread]: 
[0m13:11:19.333628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.335880 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:19.408181 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:19.410272 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.412638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.430006 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m13:11:19.432921 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:19.444844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m13:11:19.446883 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m13:11:19.450501 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:19.453187 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:19.460229 [info ] [MainThread]: 
[0m13:11:19.465388 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:11:19.466071 [info ] [MainThread]: 
[0m13:11:19.467730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.468935 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m13:11:19.469591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.470538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.470412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:19.472233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:19.481088 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:11:19.486431 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:11:19.489421 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m13:11:19.493676 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:19.497242 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m13:11:19.499732 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:11:19.500879 [info ] [MainThread]: 
[0m13:11:19.502595 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:11:19.503717 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:11:19.503887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.506048 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:11:19.506411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:19.507570 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m13:11:19.533195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m13:11:19.538037 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:19.538771 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.542455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.545659 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:19.538365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:19.546470 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.552577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.554940 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m13:11:19.547695 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.557556 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:19.554921 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.556296 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:19.561114 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:19.562325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.563473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.565656 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:19.567151 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.568750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.569579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:19.570308 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:11:19.571258 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.019 seconds
[0m13:11:19.571541 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.573885 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:19.572812 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:11:19.575656 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.575230 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m13:11:19.573894 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:19.578005 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:19.577531 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:19.576484 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:19.579178 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.581379 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:19.582195 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:11:19.580693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:19.583515 [info ] [MainThread]: 
[0m13:11:19.584300 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:19.585246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:11:19.585849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.582722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.586457 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:19.583417 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:19.586231 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.587105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:19.587826 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:19.587473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:19.588418 [info ] [MainThread]: 
[0m13:11:19.587571 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:19.589353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.590361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.589053 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:19.586469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:11:19.595451 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:19.592897 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.595071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:19.588490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:19.597370 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:19.598288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.596493 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.600669 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:19.596130 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.602963 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:11:19.603893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.603994 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:19.604512 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.604823 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.600545 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.605672 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:19.605568 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.605568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.606269 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:19.606711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:19.607489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.611219 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:11:19.612134 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:11:19.613705 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:11:19.615226 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.612744 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:11:19.614345 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:19.613521 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.615802 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:11:19.616448 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.616462 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:19.617623 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.617548 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:19.618223 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:19.618522 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:19.618778 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:19.623108 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:11:19.623614 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:11:19.624522 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:11:19.624293 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m13:11:19.629293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:19.626293 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:19.626388 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:19.629844 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.629242 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:19.627899 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:19.630764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.630357 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:19.630602 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:19.631608 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:19.631233 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:19.639071 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.639787 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.640043 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.640122 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:19.640606 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.641271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:19.641018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:19.641377 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m13:11:19.641250 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.642446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.642893 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:19.646265 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:11:19.646778 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.647353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:19.647681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:19.648594 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:19.650293 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:11:19.650322 [info ] [MainThread]: 
[0m13:11:19.651032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.651773 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:19.652001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:19.652505 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.652901 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.653448 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:19.654137 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.648451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:19.654524 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.654875 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.655366 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:19.655715 [debug] [MainThread]: On master: Close
[0m13:11:19.656332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:19.654026 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.657094 [info ] [MainThread]: 
[0m13:11:19.656641 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.657664 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:19.661346 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:19.662045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.662676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.665867 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m13:11:19.667110 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m13:11:19.668156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m13:11:19.668704 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m13:11:19.668687 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:11:19.669051 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:11:19.673234 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.673746 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.674212 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:19.674710 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:19.677324 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:11:19.677918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m13:11:19.677666 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:11:19.679080 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:19.679712 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.678947 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:19.680198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.680287 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m13:11:19.680148 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:19.680865 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:19.681691 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:19.686067 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m13:11:19.687178 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:19.687682 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.688175 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.688545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:19.694393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:19.697000 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:11:19.698483 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.699378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:19.702911 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:19.705724 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:19.706584 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.707408 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.708380 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:19.709281 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.709823 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.695760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:19.710763 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.711681 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:19.712460 [debug] [MainThread]: On master: Close
[0m13:11:19.713455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:19.715345 [info ] [MainThread]: 
[0m13:11:19.710177 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.724147 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:19.724633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.722780 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.725469 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:19.731773 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m13:11:19.726047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.733397 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m13:11:19.740092 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:11:19.739235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m13:11:19.741198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m13:11:19.742191 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:19.741541 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:11:19.744350 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m13:11:19.745241 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:19.746393 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:19.760529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m13:11:19.758427 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:19.766591 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:11:19.763056 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m13:11:19.768274 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m13:11:19.773495 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m13:11:19.774575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:19.769192 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:19.781534 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:19.777385 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:19.782607 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:19.786612 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:19.793514 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.794111 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.798073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:19.803934 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:11:19.806108 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.806727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:19.809807 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:19.811220 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:19.813451 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.813950 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.814607 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:19.815018 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.815323 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.815619 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.816073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:19.816538 [debug] [MainThread]: On master: Close
[0m13:11:19.817118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:19.816851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m13:11:19.817617 [info ] [MainThread]: 
[0m13:11:19.822987 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:11:19.823572 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m13:11:19.824127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:19.824523 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m13:11:19.825259 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m13:11:19.826025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m13:11:19.826657 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m13:11:19.835265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m13:11:19.836730 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m13:11:19.871567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m13:11:19.872902 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:11:19.873364 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m13:11:19.873728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:19.877927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:11:19.878466 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:11:19.878963 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m13:11:20.146670 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.267 seconds
[0m13:11:20.152755 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:11:20.153285 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:11:20.153965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:20.168631 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m13:11:20.169157 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:11:20.169611 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m13:11:20.172429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:11:20.177918 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m13:11:20.181241 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:11:20.181691 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m13:11:20.182305 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:11:20.184309 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m13:11:20.185891 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.36s]
[0m13:11:20.186581 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m13:11:20.187807 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:20.188197 [debug] [MainThread]: On master: BEGIN
[0m13:11:20.188512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:20.192742 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:11:20.194352 [debug] [MainThread]: On master: COMMIT
[0m13:11:20.195059 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:20.195451 [debug] [MainThread]: On master: COMMIT
[0m13:11:20.195895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:20.196273 [debug] [MainThread]: On master: Close
[0m13:11:20.196752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:20.197111 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m13:11:20.197449 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:11:20.197831 [info ] [MainThread]: 
[0m13:11:20.198238 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m13:11:20.198956 [debug] [MainThread]: Command end result
[0m13:11:20.199352 [info ] [MainThread]: 
[0m13:11:20.199747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:20.200125 [info ] [MainThread]: 
[0m13:11:20.200526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:20.201417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.879028, "process_user_time": 3.584881, "process_kernel_time": 0.231903, "process_mem_max_rss": "112916", "process_out_blocks": "1193", "process_in_blocks": "0"}
[0m13:11:20.201986 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:20.201895 after 2.88 seconds
[0m13:11:20.202352 [debug] [MainThread]: Flushing usage events
[0m13:11:24.603270 [debug] [ThreadPool]: SQL status: BEGIN in 5.023 seconds
[0m13:11:24.604910 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:24.605650 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:24.610701 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:11:24.612989 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:24.613889 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:24.616299 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m13:11:24.617274 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.618222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:24.621577 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:24.624020 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:24.622388 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.624770 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.625236 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.625886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:24.625546 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.627309 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:24.628103 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.628635 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.629045 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.629568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.630002 [debug] [MainThread]: On master: Close
[0m13:11:24.630708 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:24.631399 [info ] [MainThread]: 
[0m13:11:24.632776 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:24.636540 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.639817 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:24.642223 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m13:11:24.643265 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:24.643200 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m13:11:24.644781 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:24.645472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m13:11:24.646527 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.646581 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m13:11:24.647113 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.647749 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m13:11:24.647520 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.008 seconds
[0m13:11:24.648306 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:24.649265 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.649026 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.649808 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.650343 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.650300 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:24.650365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:24.651111 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.651910 [debug] [MainThread]: On master: Close
[0m13:11:24.652866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:24.654300 [info ] [MainThread]: 
[0m13:11:24.654957 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:24.656743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m13:11:24.657991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:24.660669 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m13:11:24.660734 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:24.663688 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.664171 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.665085 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:24.665074 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m13:11:24.665511 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.666111 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.659049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:24.667123 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.666650 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m13:11:24.667613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.668167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m13:11:24.666193 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:24.669277 [debug] [MainThread]: On master: Close
[0m13:11:24.668826 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m13:11:24.668817 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:24.669373 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:24.669969 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:24.670546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:24.670240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:24.671007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:24.672156 [info ] [MainThread]: 
[0m13:11:24.679207 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:11:24.680016 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:24.680651 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:24.683219 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m13:11:24.683981 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:11:24.684211 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m13:11:24.684545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m13:11:24.685104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m13:11:24.685559 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:24.685873 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m13:11:24.686847 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m13:11:24.686931 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:24.695033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m13:11:24.695997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m13:11:24.698004 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m13:11:24.697863 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:11:24.702826 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m13:11:24.704745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:24.712946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:11:24.713541 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:11:24.716464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m13:11:24.717024 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m13:11:24.718295 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:11:24.719378 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:11:24.718902 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m13:11:24.724034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:24.725180 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:11:24.726629 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m13:11:24.727602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:24.729670 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m13:11:24.732849 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:11:24.733497 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m13:11:24.732757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:11:24.734060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:24.734786 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:11:24.735311 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m13:11:24.737815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:11:24.739663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:11:24.740198 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:11:24.740818 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m13:11:24.742346 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:11:24.742212 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m13:11:24.742967 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:11:24.743537 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m13:11:24.744056 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:11:24.744900 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m13:11:24.745391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:24.748367 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:11:24.746138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:24.749712 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m13:11:24.750533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:24.752324 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m13:11:24.758483 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:11:24.759382 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m13:11:24.760280 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:24.762656 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m13:11:24.761760 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m13:11:24.762854 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m13:11:24.764357 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m13:11:24.764775 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:11:24.765119 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:11:24.765301 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m13:11:24.765394 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m13:11:24.765856 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m13:11:24.767002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:24.767341 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:24.767470 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.768647 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.770525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:24.773333 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m13:11:24.773376 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m13:11:24.776972 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:11:24.777461 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m13:11:24.777217 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:11:24.778050 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m13:11:24.778132 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:24.778560 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:11:24.778808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:24.779269 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.781120 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m13:11:24.781179 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m13:11:24.783019 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:11:24.783189 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m13:11:24.781452 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.783892 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m13:11:24.781561 [debug] [Thread-1 (]: SQL status: BEGIN in 5.010 seconds
[0m13:11:24.783936 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m13:11:24.784512 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.784581 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:11:24.785422 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.785340 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m13:11:24.785351 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.785806 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.785869 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.786370 [debug] [MainThread]: On master: Close
[0m13:11:24.786395 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.786582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:24.787056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:24.787221 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:11:24.787430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:24.787742 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:11:24.788369 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m13:11:24.789028 [info ] [MainThread]: 
[0m13:11:24.789502 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m13:11:24.790285 [debug] [MainThread]: Command end result
[0m13:11:24.791837 [info ] [MainThread]: 
[0m13:11:24.792064 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:11:24.792473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:24.792833 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.792943 [info ] [MainThread]: 
[0m13:11:24.793348 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:24.793313 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.793756 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:11:24.793836 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:24.794373 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.794577 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m13:11:24.794800 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.795040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.795322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:24.795546 [debug] [MainThread]: On master: Close
[0m13:11:24.795510 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.795367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.613454, "process_user_time": 3.488268, "process_kernel_time": 0.260243, "process_mem_max_rss": "112960", "process_out_blocks": "1183", "process_in_blocks": "0"}
[0m13:11:24.796058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:24.796446 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m13:11:24.796781 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:24.796667 after 7.61 seconds
[0m13:11:24.796794 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:11:24.796351 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.797274 [info ] [MainThread]: 
[0m13:11:24.797677 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m13:11:24.797582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.797211 [debug] [MainThread]: Flushing usage events
[0m13:11:24.798091 [debug] [MainThread]: On master: Close
[0m13:11:24.798245 [debug] [MainThread]: Command end result
[0m13:11:24.798812 [info ] [MainThread]: 
[0m13:11:24.799628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:24.798928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:24.800071 [info ] [MainThread]: 
[0m13:11:24.800139 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m13:11:24.800617 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:24.802512 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:11:24.803354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6537914, "process_user_time": 3.531948, "process_kernel_time": 0.290866, "process_mem_max_rss": "112572", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:11:24.804647 [info ] [MainThread]: 
[0m13:11:24.805323 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:24.805231 after 7.66 seconds
[0m13:11:24.806580 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m13:11:24.807169 [debug] [MainThread]: Flushing usage events
[0m13:11:24.807433 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m13:11:24.808050 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:11:24.808121 [debug] [MainThread]: Command end result
[0m13:11:24.809566 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m13:11:24.809869 [info ] [MainThread]: 
[0m13:11:24.810684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:24.811344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:24.811789 [info ] [MainThread]: 
[0m13:11:24.812559 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:24.814959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.612615, "process_user_time": 3.54179, "process_kernel_time": 0.237064, "process_mem_max_rss": "112492", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m13:11:24.816871 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:24.816761 after 7.61 seconds
[0m13:11:24.818567 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m13:11:24.818745 [debug] [MainThread]: Flushing usage events
[0m13:11:24.823051 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:11:24.823895 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m13:11:24.824818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:24.827001 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m13:11:24.828898 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m13:11:24.829354 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:11:24.831326 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 5.16s]
[0m13:11:24.832628 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m13:11:24.834045 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m13:11:24.835837 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m13:11:24.839071 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.839741 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.840624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:24.845682 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:11:24.846661 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m13:11:24.847814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:24.848843 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:11:24.853038 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.853846 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.856522 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.858702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.859046 [debug] [MainThread]: On master: Close
[0m13:11:24.859523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:24.859827 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:11:24.860085 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m13:11:24.860426 [info ] [MainThread]: 
[0m13:11:24.862580 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m13:11:24.863795 [debug] [MainThread]: Command end result
[0m13:11:24.864107 [info ] [MainThread]: 
[0m13:11:24.864701 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m13:11:24.865193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:24.865568 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:11:24.865868 [info ] [MainThread]: 
[0m13:11:24.866220 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m13:11:24.866562 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:24.867666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.686021, "process_user_time": 3.579416, "process_kernel_time": 0.253579, "process_mem_max_rss": "112920", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:11:24.868589 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:24.868485 after 7.69 seconds
[0m13:11:24.868536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:24.870596 [debug] [MainThread]: Flushing usage events
[0m13:11:24.875548 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m13:11:24.882594 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:11:24.884056 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m13:11:24.885378 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:11:24.888040 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m13:11:24.890072 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.15s]
[0m13:11:24.891232 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m13:11:24.894037 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.894686 [debug] [MainThread]: On master: BEGIN
[0m13:11:24.895207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:24.902203 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:24.903233 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.903811 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.904314 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.905152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:24.905673 [debug] [MainThread]: On master: Close
[0m13:11:24.906579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:24.909305 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:11:24.910053 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m13:11:24.910688 [info ] [MainThread]: 
[0m13:11:24.912170 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m13:11:24.913586 [debug] [MainThread]: Command end result
[0m13:11:24.914142 [info ] [MainThread]: 
[0m13:11:24.914944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:24.915529 [info ] [MainThread]: 
[0m13:11:24.916309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:24.917613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.634797, "process_user_time": 3.571137, "process_kernel_time": 0.214592, "process_mem_max_rss": "113108", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:11:24.918397 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:24.918295 after 7.64 seconds
[0m13:11:24.918996 [debug] [MainThread]: Flushing usage events
[0m13:11:27.512802 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:27.518135 | 974ed00f-b4f0-4754-a381-43c564cbf6dd ==============================
[0m13:11:27.518135 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:27.518751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m13:11:27.665748 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:27.678350 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:27.814803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:27.815392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:27.879314 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:27.880886 [info ] [MainThread]: 
[0m13:11:27.881311 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:27.882870 [debug] [MainThread]: Command end result
[0m13:11:27.883620 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.40723017, "process_user_time": 1.348092, "process_kernel_time": 0.111753, "process_mem_max_rss": "97884", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:27.884079 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:27.884014 after 0.41 seconds
[0m13:11:27.884424 [debug] [MainThread]: Flushing usage events
[0m13:11:29.690749 [debug] [ThreadPool]: SQL status: BEGIN in 5.019 seconds
[0m13:11:29.693208 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:29.694049 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:29.698815 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:11:29.702560 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:29.703291 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:29.712770 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:29.713356 [debug] [MainThread]: On master: BEGIN
[0m13:11:29.713829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:29.720683 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:29.721490 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:29.722012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:29.726823 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m13:11:29.728807 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:29.729612 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:29.730019 [debug] [MainThread]: On master: BEGIN
[0m13:11:29.730642 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:29.731238 [debug] [MainThread]: On master: COMMIT
[0m13:11:29.731764 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:29.732112 [debug] [MainThread]: On master: COMMIT
[0m13:11:29.732590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:29.732939 [debug] [MainThread]: On master: Close
[0m13:11:29.733814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:29.734575 [info ] [MainThread]: 
[0m13:11:29.744537 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m13:11:29.745536 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m13:11:29.746299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m13:11:29.746836 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m13:11:29.756801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m13:11:29.758612 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m13:11:29.787704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m13:11:29.789081 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:11:29.789541 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m13:11:29.790010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:29.795643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:11:29.796122 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:11:29.796443 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m13:11:29.798314 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:11:29.804895 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:11:29.805371 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m13:11:29.806054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:29.817816 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m13:11:29.818290 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:11:29.818682 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m13:11:29.819972 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:29.825198 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m13:11:29.828885 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:11:29.829375 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m13:11:29.830187 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:29.832934 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m13:11:29.835053 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m13:11:29.835857 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m13:11:29.837481 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:29.837894 [debug] [MainThread]: On master: BEGIN
[0m13:11:29.838245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:33.917044 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:33.928825 | e602d1ce-29b9-4b4d-b5e8-8c1ba392907a ==============================
[0m13:11:33.928825 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:33.930925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:33.931769 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:33.940824 | 12c4457b-ff4d-45fa-9a35-490277552684 ==============================
[0m13:11:33.940824 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:33.946164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:33.936623 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:33.955608 | 661047ba-04ac-40bb-928f-8b2ed15e6946 ==============================
[0m13:11:33.955608 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:33.958081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:33.972449 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:33.981138 | 2229577a-50e7-4a07-a86f-a346923dfe9a ==============================
[0m13:11:33.981138 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:33.979173 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:11:33.987894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 13:11:33.992365 | 96476396-95c4-4408-b55f-ef8a7e94f39a ==============================
[0m13:11:33.992365 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:33.994155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:34.013907 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:34.020306 | 43f6edb1-cdb7-4ef5-8ee9-049233abdafd ==============================
[0m13:11:34.020306 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:34.021625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:34.030233 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:34.039513 | 6627c6c2-46c2-4a15-a2e4-276a4c4e9209 ==============================
[0m13:11:34.039513 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:34.040492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m13:11:34.063662 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:34.076517 | 2400487b-824b-4407-9d05-5fe6ba9cefb8 ==============================
[0m13:11:34.076517 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:34.078014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:11:34.237504 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.256908 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.280671 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.291666 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.320219 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.320194 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.322871 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.331248 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.366219 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.371072 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.371647 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.384454 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:34.393625 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.399377 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.415953 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.423347 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:34.662855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.663685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.677149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.678707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.684372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.685525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.690904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.691628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.707970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.709050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.717915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.718948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.724083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.725228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.751651 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.754278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:34.755966 [info ] [MainThread]: 
[0m13:11:34.756434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:34.756681 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:34.761685 [debug] [MainThread]: Command end result
[0m13:11:34.764628 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9074482, "process_user_time": 2.22016, "process_kernel_time": 0.249222, "process_mem_max_rss": "97420", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:34.766054 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.767775 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:34.767364 after 0.91 seconds
[0m13:11:34.768210 [info ] [MainThread]: 
[0m13:11:34.769339 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.769786 [debug] [MainThread]: Flushing usage events
[0m13:11:34.769484 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.770436 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:34.773793 [info ] [MainThread]: 
[0m13:11:34.773284 [info ] [MainThread]: 
[0m13:11:34.776153 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:34.776708 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:34.778212 [debug] [MainThread]: Command end result
[0m13:11:34.779723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:34.779101 [debug] [MainThread]: Command end result
[0m13:11:34.780948 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9346661, "process_user_time": 2.346345, "process_kernel_time": 0.246874, "process_mem_max_rss": "97656", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:34.782622 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8881163, "process_user_time": 2.215751, "process_kernel_time": 0.216245, "process_mem_max_rss": "97616", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:34.783041 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:34.782928 after 0.94 seconds
[0m13:11:34.784154 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:34.784035 after 0.89 seconds
[0m13:11:34.785282 [debug] [MainThread]: Flushing usage events
[0m13:11:34.785874 [debug] [MainThread]: Flushing usage events
[0m13:11:34.799212 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.803681 [info ] [MainThread]: 
[0m13:11:34.805554 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:34.814192 [debug] [MainThread]: Command end result
[0m13:11:34.815731 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8428398, "process_user_time": 2.299311, "process_kernel_time": 0.22528, "process_mem_max_rss": "97244", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:34.817663 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:34.817373 after 0.84 seconds
[0m13:11:34.818827 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.819492 [debug] [MainThread]: Flushing usage events
[0m13:11:34.822544 [info ] [MainThread]: 
[0m13:11:34.824090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:34.828432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:34.838668 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.843075 [info ] [MainThread]: 
[0m13:11:34.848972 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:34.851908 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:34.855985 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:34.858849 [debug] [MainThread]: Command end result
[0m13:11:34.858706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:34.861032 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:34.863743 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9036341, "process_user_time": 2.233011, "process_kernel_time": 0.234676, "process_mem_max_rss": "97212", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:34.874117 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:34.873850 after 0.91 seconds
[0m13:11:34.876762 [debug] [MainThread]: Flushing usage events
[0m13:11:34.875451 [info ] [MainThread]: 
[0m13:11:34.875516 [debug] [MainThread]: SQL status: BEGIN in 5.036 seconds
[0m13:11:34.881211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:34.885254 [debug] [MainThread]: On master: COMMIT
[0m13:11:34.892219 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:34.893694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:34.890049 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.031 seconds
[0m13:11:34.894671 [debug] [MainThread]: On master: COMMIT
[0m13:11:34.901612 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:34.905251 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:11:34.913172 [debug] [MainThread]: On master: Close
[0m13:11:34.914532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:34.918652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:34.915714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:34.928599 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m13:11:34.931002 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:34.932446 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:11:34.933074 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:34.933904 [info ] [MainThread]: 
[0m13:11:34.934467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:34.927418 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:34.936505 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.34 seconds (15.34s).
[0m13:11:34.935385 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:34.942597 [debug] [MainThread]: Command end result
[0m13:11:34.938592 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:34.944001 [info ] [MainThread]: 
[0m13:11:34.947277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:34.942133 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:34.949209 [info ] [MainThread]: 
[0m13:11:34.945545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:34.949765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:34.951176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:34.953802 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.019 seconds
[0m13:11:34.961526 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:34.961712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.663647, "process_user_time": 3.611181, "process_kernel_time": 0.235095, "process_mem_max_rss": "112612", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:11:34.965076 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m13:11:34.974865 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:34.974561 after 17.68 seconds
[0m13:11:34.974944 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:34.970208 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m13:11:34.976580 [debug] [MainThread]: Flushing usage events
[0m13:11:34.976138 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:34.975315 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:34.977733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:34.980085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:34.981955 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:34.976721 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:34.984636 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:34.979914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:34.992392 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m13:11:34.994036 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:35.001137 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:34.994313 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m13:11:35.006580 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:35.009593 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.029 seconds
[0m13:11:35.011684 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:35.005063 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:35.004574 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:35.012819 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:35.014594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:35.014580 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:35.012172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:35.017879 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:35.024782 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:11:35.038465 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m13:11:35.043871 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:35.047466 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:35.049244 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:35.051001 [debug] [MainThread]: On master: BEGIN
[0m13:11:35.052488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:35.031686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:11:35.060507 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m13:11:35.064905 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:35.060511 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:35.066447 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:35.067794 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:35.065328 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:35.069217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:35.073016 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:35.074629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:35.091979 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m13:11:35.093780 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m13:11:35.097495 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:35.100330 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:35.103620 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:35.107525 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:35.119089 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m13:11:35.123928 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:35.124684 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m13:11:35.128569 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:35.130692 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:35.136572 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:35.158368 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:35.160298 [debug] [MainThread]: On master: BEGIN
[0m13:11:35.162169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:35.174986 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:11:35.176371 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:35.177239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:35.182468 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m13:11:35.184488 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:35.186714 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:35.187854 [debug] [MainThread]: On master: BEGIN
[0m13:11:35.189191 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:35.190735 [debug] [MainThread]: On master: COMMIT
[0m13:11:35.191482 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:35.192353 [debug] [MainThread]: On master: COMMIT
[0m13:11:35.193427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:35.194213 [debug] [MainThread]: On master: Close
[0m13:11:35.195395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:35.198203 [info ] [MainThread]: 
[0m13:11:35.210025 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m13:11:35.212190 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m13:11:35.213786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m13:11:35.215352 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m13:11:35.228016 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m13:11:35.232756 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m13:11:35.315231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m13:11:35.322585 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:11:35.323983 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m13:11:35.327738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:35.337851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:11:35.339799 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:11:35.343383 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m13:11:35.350331 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:11:35.362754 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:11:35.364209 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m13:11:35.368244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:11:35.397920 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m13:11:35.400819 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:11:35.403949 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m13:11:35.411015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:35.424041 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m13:11:35.432579 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:11:35.434170 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m13:11:35.435817 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:35.439987 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m13:11:35.446500 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.23s]
[0m13:11:35.449396 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m13:11:35.452150 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:35.452708 [debug] [MainThread]: On master: BEGIN
[0m13:11:35.453193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:40.044181 [debug] [ThreadPool]: SQL status: BEGIN in 5.031 seconds
[0m13:11:40.046520 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:40.047626 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:40.052607 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m13:11:40.056277 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:40.057214 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:40.067955 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.068785 [debug] [MainThread]: On master: BEGIN
[0m13:11:40.069489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:40.073729 [debug] [MainThread]: SQL status: BEGIN in 5.021 seconds
[0m13:11:40.075605 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.076328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:40.076201 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:40.077504 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.078090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:40.081314 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m13:11:40.081938 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m13:11:40.085724 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:40.086509 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.087033 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:40.087147 [debug] [MainThread]: On master: BEGIN
[0m13:11:40.088297 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.088821 [debug] [MainThread]: On master: BEGIN
[0m13:11:40.088928 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:40.089584 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.089772 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:40.090218 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.090688 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.091060 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.091341 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.091807 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.091889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:40.092328 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:40.092343 [debug] [MainThread]: On master: Close
[0m13:11:40.092799 [debug] [MainThread]: On master: Close
[0m13:11:40.093645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:40.094469 [info ] [MainThread]: 
[0m13:11:40.094687 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:40.101594 [info ] [MainThread]: 
[0m13:11:40.106192 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m13:11:40.112248 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m13:11:40.114641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m13:11:40.115302 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m13:11:40.116525 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m13:11:40.122313 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m13:11:40.127224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m13:11:40.128501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m13:11:40.129505 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m13:11:40.139748 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m13:11:40.146244 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m13:11:40.148826 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m13:11:40.172271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m13:11:40.173868 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:11:40.174362 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m13:11:40.174979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:40.180638 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m13:11:40.181492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:11:40.182355 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:11:40.182141 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:11:40.182831 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m13:11:40.183168 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m13:11:40.183557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:40.185238 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:11:40.189379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:11:40.190779 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:11:40.191065 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:11:40.191599 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m13:11:40.192106 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m13:11:40.192917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:40.193817 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:11:40.202868 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:11:40.204640 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m13:11:40.205477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:40.209643 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m13:11:40.211644 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:11:40.213569 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m13:11:40.214711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:40.220277 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m13:11:40.221545 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:11:40.222141 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m13:11:40.222604 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m13:11:40.223994 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m13:11:40.225886 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:11:40.227589 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m13:11:40.229874 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:40.232824 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m13:11:40.234884 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:11:40.232956 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m13:11:40.235698 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m13:11:40.237697 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.238740 [debug] [MainThread]: On master: BEGIN
[0m13:11:40.239583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:40.240303 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:11:40.241155 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m13:11:40.241896 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:40.244735 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m13:11:40.246939 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:11:40.245718 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:11:40.247711 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m13:11:40.248146 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.248525 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.248960 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.249579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:40.249607 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.250032 [debug] [MainThread]: On master: Close
[0m13:11:40.250394 [debug] [MainThread]: On master: BEGIN
[0m13:11:40.250953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:40.251348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:40.251714 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:11:40.252221 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m13:11:40.252708 [info ] [MainThread]: 
[0m13:11:40.253248 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m13:11:40.254064 [debug] [MainThread]: Command end result
[0m13:11:40.254501 [info ] [MainThread]: 
[0m13:11:40.255088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:40.255468 [info ] [MainThread]: 
[0m13:11:40.255960 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:40.257555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3474445, "process_user_time": 2.45482, "process_kernel_time": 0.286913, "process_mem_max_rss": "106044", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:11:40.256255 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:11:40.258488 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:40.258288 after 6.35 seconds
[0m13:11:40.258916 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.259490 [debug] [MainThread]: Flushing usage events
[0m13:11:40.259872 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.260705 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.261097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:40.264503 [debug] [MainThread]: On master: Close
[0m13:11:40.264979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:40.265263 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:11:40.265578 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m13:11:40.265889 [info ] [MainThread]: 
[0m13:11:40.266228 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m13:11:40.266872 [debug] [MainThread]: Command end result
[0m13:11:40.269557 [info ] [MainThread]: 
[0m13:11:40.270844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:40.271724 [info ] [MainThread]: 
[0m13:11:40.274874 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:40.276470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4144936, "process_user_time": 2.466061, "process_kernel_time": 0.264518, "process_mem_max_rss": "106272", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m13:11:40.278031 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:40.277776 after 6.42 seconds
[0m13:11:40.278946 [debug] [MainThread]: Flushing usage events
[0m13:11:40.471841 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m13:11:40.476743 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.478575 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:40.480672 [debug] [MainThread]: On master: COMMIT
[0m13:11:40.481373 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:40.481812 [debug] [MainThread]: On master: Close
[0m13:11:40.482844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:40.484900 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:11:40.486546 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m13:11:40.487456 [info ] [MainThread]: 
[0m13:11:40.490054 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m13:11:40.491630 [debug] [MainThread]: Command end result
[0m13:11:40.494690 [info ] [MainThread]: 
[0m13:11:40.495330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:40.495836 [info ] [MainThread]: 
[0m13:11:40.496704 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:40.499481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.478745, "process_user_time": 2.686756, "process_kernel_time": 0.285053, "process_mem_max_rss": "106332", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m13:11:40.500827 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:40.500691 after 6.48 seconds
[0m13:11:40.501790 [debug] [MainThread]: Flushing usage events
[0m13:11:43.086036 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:43.091532 | 8f0d0c28-fc1a-43c0-ab3c-29348acceff6 ==============================
[0m13:11:43.091532 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:43.092258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m13:11:43.247297 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:43.261869 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:43.400522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:43.401030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:43.464590 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:43.466339 [info ] [MainThread]: 
[0m13:11:43.466812 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:43.468392 [debug] [MainThread]: Command end result
[0m13:11:43.469200 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41922545, "process_user_time": 1.287443, "process_kernel_time": 0.130943, "process_mem_max_rss": "98028", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:43.469841 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:43.469737 after 0.42 seconds
[0m13:11:43.470259 [debug] [MainThread]: Flushing usage events
[0m13:11:47.673000 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:47.681928 | f1eda6ac-56eb-4494-a327-72b3262899f9 ==============================
[0m13:11:47.681928 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:47.682823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m13:11:47.719893 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:47.726950 | 0dfa09ec-df96-43ab-aa25-bfbf6540d195 ==============================
[0m13:11:47.726950 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:47.728314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:11:47.755805 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:11:47.758549 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:11:47.754772 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:47.763565 | e52303be-6211-4391-829c-41d279f6c883 ==============================
[0m13:11:47.763565 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:47.765232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 13:11:47.765565 | d710da43-0dfb-4c8a-a8e0-8c51afbbcd11 ==============================
[0m13:11:47.765565 [info ] [MainThread]: Running with dbt=1.8.2


============================== 13:11:47.765239 | e1751d21-a947-4179-a167-4697cbf0d237 ==============================
[0m13:11:47.765239 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:47.766780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:47.767125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:47.818418 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:11:47.827788 | f67f83db-06d9-43ca-a8db-01027e8b1f5e ==============================
[0m13:11:47.827788 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:11:47.829932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:11:47.939972 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:48.000331 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:48.025827 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:48.056810 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:48.089655 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:48.092643 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:48.097610 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:48.118788 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:48.124759 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:48.143398 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:48.156937 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:48.184105 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:11:48.282623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:48.283490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:48.307764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:48.308364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:48.349602 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:48.352753 [info ] [MainThread]: 
[0m13:11:48.353672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:48.354929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:48.362081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:48.362834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:48.376356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:48.377118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:48.381483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:48.382106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:48.391516 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:48.392789 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:48.393315 [info ] [MainThread]: 
[0m13:11:48.393954 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:48.394333 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:48.394911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:48.396437 [debug] [MainThread]: Command end result
[0m13:11:48.398127 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7410612, "process_user_time": 1.602751, "process_kernel_time": 0.129351, "process_mem_max_rss": "97852", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:48.399371 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:48.399143 after 0.74 seconds
[0m13:11:48.400323 [debug] [MainThread]: Flushing usage events
[0m13:11:48.408173 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m13:11:48.410800 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:48.417321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:11:48.429039 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:48.418086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:11:48.433110 [info ] [MainThread]: 
[0m13:11:48.431380 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:48.434421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:48.435476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:48.434258 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:48.437279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:48.435122 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:48.436962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:48.437375 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:48.439395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:48.441514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:48.446644 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:48.448935 [info ] [MainThread]: 
[0m13:11:48.448666 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:11:48.449775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:48.450157 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:48.451021 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:48.451228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:11:48.451931 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:48.455912 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m13:11:48.455423 [info ] [MainThread]: 
[0m13:11:48.460816 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:48.461296 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:48.462251 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:48.463378 [debug] [MainThread]: Command end result
[0m13:11:48.466973 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.75312006, "process_user_time": 1.598116, "process_kernel_time": 0.154035, "process_mem_max_rss": "97472", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:48.467571 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:48.467475 after 0.75 seconds
[0m13:11:48.468034 [debug] [MainThread]: Flushing usage events
[0m13:11:48.479744 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:48.480563 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:48.481329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:48.490051 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:11:48.491013 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:11:48.491971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:48.492326 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m13:11:48.494241 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:48.499863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:48.500644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:48.506695 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:48.509128 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:48.509615 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:48.509980 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:48.510317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:48.510707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:48.515264 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:11:48.517064 [info ] [MainThread]: 
[0m13:11:48.516765 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:11:48.517636 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:11:48.518145 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:48.518687 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:48.519939 [debug] [MainThread]: Command end result
[0m13:11:48.520827 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7749574, "process_user_time": 1.653346, "process_kernel_time": 0.135767, "process_mem_max_rss": "97852", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:11:48.521510 [debug] [MainThread]: Command `dbt test` succeeded at 13:11:48.521390 after 0.78 seconds
[0m13:11:48.521968 [debug] [MainThread]: Flushing usage events
[0m13:11:48.522320 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:11:48.523860 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:48.526124 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:53.462725 [debug] [ThreadPool]: SQL status: BEGIN in 5.019 seconds
[0m13:11:53.465689 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:53.466599 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:53.471011 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:11:53.473839 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:53.474674 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:53.482380 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.483049 [debug] [MainThread]: On master: BEGIN
[0m13:11:53.483513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:53.490675 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:53.491399 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.491942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:53.496399 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m13:11:53.499366 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:53.499997 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.500388 [debug] [MainThread]: On master: BEGIN
[0m13:11:53.501081 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:53.501623 [debug] [MainThread]: On master: COMMIT
[0m13:11:53.502056 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.502433 [debug] [MainThread]: On master: COMMIT
[0m13:11:53.503006 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:53.503555 [debug] [MainThread]: On master: Close
[0m13:11:53.504430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:53.505168 [info ] [MainThread]: 
[0m13:11:53.508786 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m13:11:53.513998 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:11:53.515353 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m13:11:53.516671 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m13:11:53.517520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m13:11:53.518124 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m13:11:53.519259 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m13:11:53.522298 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:53.522852 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:53.522206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:11:53.526080 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m13:11:53.528013 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:53.528669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m13:11:53.528749 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:53.530613 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m13:11:53.523602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:11:53.536494 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.532050 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:53.540127 [debug] [MainThread]: On master: BEGIN
[0m13:11:53.540192 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:53.541584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:53.540762 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:11:53.541659 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:11:53.543658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:53.542681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:53.549841 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:11:53.550604 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:11:53.551111 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:11:53.551281 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:11:53.551586 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.553314 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:53.554226 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m13:11:53.555975 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:11:53.556818 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:11:53.557250 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m13:11:53.559199 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:53.560114 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.560607 [debug] [MainThread]: On master: BEGIN
[0m13:11:53.561277 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:53.561760 [debug] [MainThread]: On master: COMMIT
[0m13:11:53.562162 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.562496 [debug] [MainThread]: On master: COMMIT
[0m13:11:53.562940 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:53.563364 [debug] [MainThread]: On master: Close
[0m13:11:53.564084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:53.564635 [info ] [MainThread]: 
[0m13:11:53.571840 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m13:11:53.573340 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m13:11:53.574258 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m13:11:53.574328 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:11:53.575021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m13:11:53.574982 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m13:11:53.575764 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m13:11:53.576283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:53.581792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:11:53.582401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:11:53.583113 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m13:11:53.583553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m13:11:53.585217 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m13:11:53.586887 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m13:11:53.593277 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:11:53.596301 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m13:11:53.597501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:53.610971 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m13:11:53.611756 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:11:53.612232 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m13:11:53.613971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:53.616913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m13:11:53.619299 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m13:11:53.623456 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:11:53.623864 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m13:11:53.624586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:53.624219 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:11:53.625425 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m13:11:53.626241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:11:53.628867 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m13:11:53.631054 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.11s]
[0m13:11:53.631789 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m13:11:53.633426 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.633863 [debug] [MainThread]: On master: BEGIN
[0m13:11:53.634414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:53.640047 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:11:53.640782 [debug] [MainThread]: On master: COMMIT
[0m13:11:53.641353 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:53.641796 [debug] [MainThread]: On master: COMMIT
[0m13:11:53.642276 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:53.642606 [debug] [MainThread]: On master: Close
[0m13:11:53.643218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:53.643668 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:11:53.644083 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m13:11:53.644580 [info ] [MainThread]: 
[0m13:11:53.645112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m13:11:53.645817 [debug] [MainThread]: Command end result
[0m13:11:53.646210 [info ] [MainThread]: 
[0m13:11:53.646690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:53.647214 [info ] [MainThread]: 
[0m13:11:53.647840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:53.649072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0277534, "process_user_time": 1.779254, "process_kernel_time": 0.156721, "process_mem_max_rss": "106744", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m13:11:53.649709 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:53.649626 after 6.03 seconds
[0m13:11:53.650109 [debug] [MainThread]: Flushing usage events
[0m13:11:58.559085 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m13:11:58.561349 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:11:58.562150 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:11:58.566492 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:11:58.569413 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:11:58.570299 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:11:58.581236 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.582248 [debug] [MainThread]: On master: BEGIN
[0m13:11:58.582880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:58.590289 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:58.591191 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.591730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:58.595673 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m13:11:58.598313 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:58.598979 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.599404 [debug] [MainThread]: On master: BEGIN
[0m13:11:58.600176 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:58.600834 [debug] [MainThread]: On master: COMMIT
[0m13:11:58.601319 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.601704 [debug] [MainThread]: On master: COMMIT
[0m13:11:58.602285 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:58.602774 [debug] [MainThread]: On master: Close
[0m13:11:58.603497 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:58.604169 [info ] [MainThread]: 
[0m13:11:58.613959 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m13:11:58.615231 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m13:11:58.616341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m13:11:58.617054 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m13:11:58.626484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m13:11:58.628431 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m13:11:58.632523 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m13:11:58.637202 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:11:58.638850 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id, --AS sales_agent_key,  -- alias reseller_id as sales_agent_key
    --reseller_id AS reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m13:11:58.640338 [debug] [Thread-1 (]: Postgres adapter: Postgres error: each UNION query must have the same number of columns
LINE 25:     0 AS sales_agent_key,
             ^

[0m13:11:58.641043 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: ROLLBACK
[0m13:11:58.642134 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m13:11:58.651410 [debug] [Thread-1 (]: Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 25:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m13:11:58.654658 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev.dim_salesagent ....................... [[31mERROR[0m in 5.08s]
[0m13:11:58.655676 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m13:11:58.658249 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.658710 [debug] [MainThread]: On master: BEGIN
[0m13:11:58.659139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:58.665880 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:11:58.666797 [debug] [MainThread]: On master: COMMIT
[0m13:11:58.667482 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.667943 [debug] [MainThread]: On master: COMMIT
[0m13:11:58.668607 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:58.669340 [debug] [MainThread]: On master: Close
[0m13:11:58.668913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m13:11:58.670016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:58.670815 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:11:58.671426 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m13:11:58.672053 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:11:58.672480 [info ] [MainThread]: 
[0m13:11:58.672899 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m13:11:58.673416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m13:11:58.674215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:58.678995 [debug] [MainThread]: Command end result
[0m13:11:58.679825 [info ] [MainThread]: 
[0m13:11:58.680552 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:11:58.681105 [info ] [MainThread]: 
[0m13:11:58.681889 [error] [MainThread]:   Database Error in model dim_salesagent (models/dim/dim_salesagent.sql)
  each UNION query must have the same number of columns
  LINE 25:     0 AS sales_agent_key,
               ^
  compiled code at target/run/dbtcomp/models/dim/dim_salesagent.sql
[0m13:11:58.682911 [info ] [MainThread]: 
[0m13:11:58.683903 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:11:58.686174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.993568, "process_user_time": 1.75736, "process_kernel_time": 0.159115, "process_mem_max_rss": "106292", "process_in_blocks": "472", "process_out_blocks": "30", "command_success": false}
[0m13:11:58.688483 [debug] [MainThread]: Command `dbt run` failed at 13:11:58.688346 after 11.00 seconds
[0m13:11:58.687547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m13:11:58.689441 [debug] [MainThread]: Flushing usage events
[0m13:11:58.690260 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:11:58.693499 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m13:11:58.720387 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.023 seconds
[0m13:11:58.733783 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:11:58.735263 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:11:58.736973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:58.755224 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m13:11:58.756180 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:11:58.756813 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m13:11:58.759218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:11:58.765455 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m13:11:58.770797 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:11:58.771441 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m13:11:58.772559 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:11:58.775347 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m13:11:58.778412 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.16s]
[0m13:11:58.779814 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m13:11:58.782268 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.782985 [debug] [MainThread]: On master: BEGIN
[0m13:11:58.783716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:58.791668 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:11:58.792563 [debug] [MainThread]: On master: COMMIT
[0m13:11:58.793020 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:58.793706 [debug] [MainThread]: On master: COMMIT
[0m13:11:58.794356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:58.794884 [debug] [MainThread]: On master: Close
[0m13:11:58.795539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:58.795996 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m13:11:58.796415 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:11:58.797102 [info ] [MainThread]: 
[0m13:11:58.797668 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.35 seconds (10.35s).
[0m13:11:58.798498 [debug] [MainThread]: Command end result
[0m13:11:58.798975 [info ] [MainThread]: 
[0m13:11:58.799569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:58.800018 [info ] [MainThread]: 
[0m13:11:58.800539 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:58.801915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.087957, "process_user_time": 1.830633, "process_kernel_time": 0.143302, "process_mem_max_rss": "106304", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:11:58.802835 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:58.802722 after 11.09 seconds
[0m13:11:58.803526 [debug] [MainThread]: Flushing usage events
[0m13:12:01.116298 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:12:01.121739 | 28ae30e3-5dae-426a-af04-3c786ecf6878 ==============================
[0m13:12:01.121739 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:12:01.122520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m13:12:01.305597 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:12:01.328039 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:12:01.484609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:01.485290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:01.560328 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:12:01.563187 [info ] [MainThread]: 
[0m13:12:01.564077 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:12:01.566837 [debug] [MainThread]: Command end result
[0m13:12:01.568681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49112538, "process_user_time": 1.407566, "process_kernel_time": 0.112204, "process_mem_max_rss": "97816", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:12:01.569540 [debug] [MainThread]: Command `dbt test` succeeded at 13:12:01.569384 after 0.49 seconds
[0m13:12:01.570184 [debug] [MainThread]: Flushing usage events
[0m13:12:06.007132 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:12:06.013552 | a9dbb716-b623-4e79-a3fb-187aa6050fcd ==============================
[0m13:12:06.013552 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:12:06.014222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:06.182521 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:12:06.196312 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:12:06.338448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:06.339021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:06.402136 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:12:06.403666 [info ] [MainThread]: 
[0m13:12:06.404170 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:12:06.405783 [debug] [MainThread]: Command end result
[0m13:12:06.406686 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44526625, "process_user_time": 1.28062, "process_kernel_time": 0.088111, "process_mem_max_rss": "97876", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:12:06.407306 [debug] [MainThread]: Command `dbt test` succeeded at 13:12:06.407227 after 0.45 seconds
[0m13:12:06.407688 [debug] [MainThread]: Flushing usage events
[0m13:20:06.277420 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:20:06.283335 | 90a9b341-1ec9-464e-ad68-ba200f6cc3d2 ==============================
[0m13:20:06.283335 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:20:06.283863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m13:20:06.428798 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m13:20:06.434098 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m13:20:06.450231 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-9fzgfh9n'
[0m13:20:06.450817 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m13:20:06.452050 [debug] [MainThread]: Creating symlink to local dependency.
[0m13:20:06.452613 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m13:20:06.453663 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.22376224, "process_user_time": 1.019287, "process_kernel_time": 0.103231, "process_mem_max_rss": "105948", "process_in_blocks": "152", "process_out_blocks": "11"}
[0m13:20:06.454221 [debug] [MainThread]: Command `dbt deps` succeeded at 13:20:06.454136 after 0.22 seconds
[0m13:20:06.454622 [debug] [MainThread]: Flushing usage events
[0m13:20:08.349349 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:20:08.354349 | 77e89240-c384-4864-8aba-7f93e5aa2a85 ==============================
[0m13:20:08.354349 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:20:08.354916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:20:08.516377 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:20:08.530527 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:20:08.532734 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:20:10.112491 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:20:10.114355 [info ] [MainThread]: 
[0m13:20:10.115010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:20:10.116022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:20:10.145026 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:20:10.145575 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:20:10.145996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:10.153548 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m13:20:10.157652 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:20:10.158567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m13:20:10.159578 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m13:20:10.165904 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m13:20:10.166330 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m13:20:10.166754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:15.171575 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m13:20:15.178345 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m13:20:15.179138 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m13:20:15.182310 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m13:20:15.183959 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m13:20:15.185554 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m13:20:15.187733 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m13:20:15.189615 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:20:15.190773 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m13:20:15.196560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m13:20:15.197264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:20:15.203468 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:20:15.207897 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:20:15.208432 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:20:15.212554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:15.212003 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:20:15.213385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:15.218367 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:20:15.221420 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:20:15.223316 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:20:15.228559 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:20:15.230309 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:20:15.231404 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:20:20.218468 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m13:20:20.219159 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:20:20.220017 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:20:20.230099 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:20:20.232922 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:20:20.236438 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:20:20.259028 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:20.268561 [debug] [MainThread]: On master: BEGIN
[0m13:20:20.269618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:20.278895 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:20:20.283403 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:20.284136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:20:20.289290 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:20:20.290519 [debug] [MainThread]: On master: ROLLBACK
[0m13:20:20.292330 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:20.292656 [debug] [MainThread]: On master: BEGIN
[0m13:20:20.294315 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:20:20.296328 [debug] [MainThread]: On master: COMMIT
[0m13:20:20.296632 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:20.296906 [debug] [MainThread]: On master: COMMIT
[0m13:20:20.297271 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:20:20.301960 [debug] [MainThread]: On master: Close
[0m13:20:20.303309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:20.306988 [info ] [MainThread]: 
[0m13:20:20.324347 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m13:20:20.325015 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m13:20:20.325835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m13:20:20.326262 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m13:20:20.326663 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m13:20:20.351249 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:20:20.351789 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m13:20:20.352230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:25.357568 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m13:20:25.358541 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:20:25.360515 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m13:20:25.363122 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m13:20:25.423689 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:20:25.427521 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m13:20:25.428858 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m13:20:25.434485 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m13:20:25.449839 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m13:20:25.450964 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m13:20:25.453095 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m13:20:25.455487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:20:25.457694 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m13:20:25.462667 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 5.14s]
[0m13:20:25.463246 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m13:20:25.464546 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:25.464985 [debug] [MainThread]: On master: BEGIN
[0m13:20:25.465334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:25.481411 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:20:25.505794 [debug] [MainThread]: On master: COMMIT
[0m13:20:25.506266 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:25.506577 [debug] [MainThread]: On master: COMMIT
[0m13:20:25.506970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:20:25.508033 [debug] [MainThread]: On master: Close
[0m13:20:25.509786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:25.518740 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:20:25.519439 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m13:20:25.519979 [info ] [MainThread]: 
[0m13:20:25.520996 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.41 seconds (15.41s).
[0m13:20:25.521785 [debug] [MainThread]: Command end result
[0m13:20:25.601361 [info ] [MainThread]: 
[0m13:20:25.601912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:25.602265 [info ] [MainThread]: 
[0m13:20:25.602617 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:20:25.603276 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 17.30759, "process_user_time": 2.72109, "process_kernel_time": 0.1103, "process_mem_max_rss": "113800", "process_in_blocks": "24", "process_out_blocks": "3516"}
[0m13:20:25.603900 [debug] [MainThread]: Command `dbt seed` succeeded at 13:20:25.603758 after 17.31 seconds
[0m13:20:25.604618 [debug] [MainThread]: Flushing usage events
[0m13:21:13.631340 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:13.645813 | d57dfa56-3592-4fb3-9131-47c817e15500 ==============================
[0m13:21:13.645813 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:13.648261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:13.649628 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:13.657703 | 4dd7047e-6dd0-4210-9d07-62ac13f1dca4 ==============================
[0m13:21:13.657703 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:13.662008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:13.676349 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:13.696319 | a97e09ec-82b7-44b3-aa24-01dceb21cfc5 ==============================
[0m13:21:13.696319 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:13.697913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:13.693217 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:13.704342 | 5712b940-5658-4ee3-a18c-faf24eeff989 ==============================
[0m13:21:13.704342 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:13.705729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:13.741340 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:13.751689 | 8b9eff0e-7b00-4641-9160-1294af6b86d6 ==============================
[0m13:21:13.751689 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:13.754814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:13.742053 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:21:13.748651 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:13.757386 | 609b1aca-9929-4798-9acd-3c1104251770 ==============================
[0m13:21:13.757386 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:13.758769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 13:21:13.760750 | 1281a18b-b6db-4a86-88ed-22f113d486a0 ==============================
[0m13:21:13.760750 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:13.761896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:13.856256 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:13.859004 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:13.899699 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:13.920405 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:13.923592 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:13.922679 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:13.940630 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:13.944685 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:13.999652 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:14.022498 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:14.032043 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:14.035736 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:21:14.036316 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:21:14.038719 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:14.054777 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:14.056227 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:21:14.058245 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:21:14.062449 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:21:14.063419 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:21:14.069104 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:14.076294 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:21:14.077132 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:21:14.132077 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:21:14.132863 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:21:14.165262 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:21:14.166048 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:21:14.173569 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:21:14.174455 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m13:21:15.695273 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:15.699214 [info ] [MainThread]: 
[0m13:21:15.702003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:15.704760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:15.747564 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:15.748862 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:15.750271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.767714 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m13:21:15.770358 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:15.772762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m13:21:15.774582 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m13:21:15.786001 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:21:15.789827 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m13:21:15.791190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:15.804132 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:15.807490 [info ] [MainThread]: 
[0m13:21:15.808535 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m13:21:15.809657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:15.810295 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:21:15.812488 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m13:21:15.813807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:15.820101 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m13:21:15.826759 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:21:15.828703 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m13:21:15.829555 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m13:21:15.834454 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m13:21:15.835588 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m13:21:15.847439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m13:21:15.849661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:15.861360 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:15.858688 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:15.866278 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:15.863030 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:15.867744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.867031 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:15.869188 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:15.870862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:15.871550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.881468 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:21:15.883268 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m13:21:15.883195 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:15.883299 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:15.885085 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:15.885516 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:15.886158 [info ] [MainThread]: 
[0m13:21:15.888120 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:15.888696 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:21:15.890974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:21:15.891673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:15.894003 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:15.895129 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:15.892169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:21:15.897521 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:15.900483 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:15.897707 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:15.901593 [info ] [MainThread]: 
[0m13:21:15.901574 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:15.902784 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:15.903273 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:15.904042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.905016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:15.905068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:15.908236 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:15.912678 [info ] [MainThread]: 
[0m13:21:15.912504 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:21:15.913611 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:15.913870 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:15.914685 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:15.915674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:15.916078 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:15.915483 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:15.918356 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:21:15.918732 [info ] [MainThread]: 
[0m13:21:15.920570 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:15.919308 [info ] [MainThread]: 
[0m13:21:15.920855 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:15.921124 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:15.921807 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:15.921449 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:15.921588 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:15.922212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.922562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:15.924674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:15.931774 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:15.932304 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:15.933258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.942799 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:15.943623 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:15.948011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.950193 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:15.952320 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:15.953781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.958799 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:15.959507 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:15.960214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:15.961188 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m13:21:15.963282 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:15.965132 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m13:21:15.970741 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:15.972036 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m13:21:15.975674 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:15.978224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:21:15.987185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:21:15.991541 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:15.992048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:15.988175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:21:15.992605 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:15.994857 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:15.997529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:21:15.997999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:15.992224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:21:16.001452 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:16.006448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:16.001256 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:16.011360 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:16.011852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:16.009681 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:16.007218 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:16.012901 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:21:16.020900 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:16.021072 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:16.021306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:16.005924 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:16.021332 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:16.021887 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:16.021356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:16.024349 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:16.024541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:16.025535 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:21:16.026212 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:16.027072 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:16.027041 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:16.028123 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:16.029050 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:16.028852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m13:21:16.029288 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:21:16.030759 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:16.031269 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:16.031773 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:16.032256 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:16.037097 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:16.040452 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:16.040971 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:16.046026 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:16.046589 [debug] [MainThread]: On master: BEGIN
[0m13:21:16.047098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:20.881167 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m13:21:20.884098 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:20.884650 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:20.887163 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:20.888442 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:20.888944 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:20.894597 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:20.898175 [debug] [MainThread]: On master: BEGIN
[0m13:21:20.898569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:20.914824 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m13:21:20.915442 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:20.915906 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:20.917846 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:20.918981 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:20.919530 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:20.924791 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:20.928069 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m13:21:20.928569 [debug] [MainThread]: On master: BEGIN
[0m13:21:20.929127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:20.929665 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:20.934708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:21:20.940056 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m13:21:20.935355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:20.942823 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:20.940798 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:20.943905 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:20.944427 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:20.944885 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:20.945255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:20.945666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:20.947744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:21:20.948291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:20.953484 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:20.955788 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:20.956876 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:20.958023 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:20.959835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:20.960402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:20.966336 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:21:20.966679 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:21:20.967716 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:20.968164 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:20.968666 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:20.969138 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:20.971177 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:20.971466 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:20.973298 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:20.974423 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:20.977909 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:20.978415 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:20.984218 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:20.984707 [debug] [MainThread]: On master: BEGIN
[0m13:21:20.985037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:20.989236 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:21:20.991624 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:20.993277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:21.012734 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:21:21.014091 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:21.013891 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m13:21:21.016275 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.016634 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:21.028225 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:21.027643 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.033729 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:21:21.036794 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m13:21:21.042839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:21.042110 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:21.029936 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:21.045084 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.045751 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.044287 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:21.038429 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m13:21:21.046190 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:21.046853 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.047883 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:21.050800 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:21:21.050146 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:21.056822 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m13:21:21.055907 [debug] [MainThread]: On master: Close
[0m13:21:21.049215 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:21.059979 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.061053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:21.066915 [info ] [MainThread]: 
[0m13:21:21.064272 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:21.065566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:21.080073 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:21.061946 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m13:21:21.081490 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:21.082571 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.078202 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:21.082854 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.083166 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.082559 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:21.083792 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.084037 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:21.084262 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:21.084423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:21.084611 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.085726 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.086231 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m13:21:21.086293 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.089855 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:21:21.090023 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m13:21:21.090230 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:21.090407 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.090853 [debug] [MainThread]: On master: Close
[0m13:21:21.091115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:21.091480 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:21.092010 [info ] [MainThread]: 
[0m13:21:21.091334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m13:21:21.092584 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.093333 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.093765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:21.093710 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m13:21:21.093737 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:21.097228 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:21.097797 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.098143 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:21:21.098379 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.098742 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.099006 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m13:21:21.099069 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:21.099278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:21.099628 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.100016 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.099716 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m13:21:21.100356 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.100770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m13:21:21.100942 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:21.101316 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m13:21:21.101378 [debug] [MainThread]: On master: Close
[0m13:21:21.101861 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:21:21.102123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:21.103320 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:21.103229 [info ] [MainThread]: 
[0m13:21:21.104111 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.104620 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.105130 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:21.105722 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.106142 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.106146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m13:21:21.106556 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.106987 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:21.107485 [debug] [MainThread]: On master: Close
[0m13:21:21.108793 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m13:21:21.110136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m13:21:21.109166 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:21.110293 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m13:21:21.111830 [info ] [MainThread]: 
[0m13:21:21.112133 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m13:21:21.112914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m13:21:21.114151 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m13:21:21.114445 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m13:21:21.119644 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m13:21:21.120421 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m13:21:21.121194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m13:21:21.121714 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m13:21:21.124172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m13:21:21.125443 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m13:21:21.129736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m13:21:21.136011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m13:21:21.136993 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m13:21:21.140907 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:21:21.141378 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m13:21:21.141739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:21.143183 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m13:21:21.146169 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:21:21.146812 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m13:21:21.146219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:21:21.147289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:21.147714 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:21:21.148648 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m13:21:21.151601 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:21:21.154497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m13:21:21.153139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:21:21.156799 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:21:21.157493 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m13:21:21.158027 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:21:21.159236 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:21:21.159725 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m13:21:21.160154 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m13:21:21.160348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:21.161026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:21.165024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m13:21:21.165124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:21:21.167867 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:21:21.168424 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m13:21:21.168710 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:21:21.169270 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m13:21:21.169751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:21.170110 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:21:21.173086 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m13:21:21.173563 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:21:21.173935 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m13:21:21.174547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:21:21.175098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:21.175547 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:21:21.175432 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:21:21.179936 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m13:21:21.179788 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m13:21:21.180755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:21.180959 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m13:21:21.181722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:21:21.184477 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m13:21:21.185162 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m13:21:21.185897 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:21.187832 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m13:21:21.189320 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:21:21.189736 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:21:21.190387 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m13:21:21.190799 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m13:21:21.191377 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m13:21:21.191825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:21.192009 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:21:21.192092 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.192633 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.192603 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m13:21:21.193641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:21.194594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:21.198353 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:21:21.199182 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.199649 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.200103 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.200339 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m13:21:21.200820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:21.202648 [debug] [MainThread]: On master: Close
[0m13:21:21.203544 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m13:21:21.204311 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m13:21:21.203973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:21.205248 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:21.205495 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m13:21:21.205832 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m13:21:21.206134 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:21:21.206557 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:21:21.206655 [info ] [MainThread]: 
[0m13:21:21.207044 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m13:21:21.207244 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m13:21:21.207340 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m13:21:21.208186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:21.208067 [debug] [MainThread]: Command end result
[0m13:21:21.209125 [info ] [MainThread]: 
[0m13:21:21.209451 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:21:21.209955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:21.210572 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m13:21:21.210863 [info ] [MainThread]: 
[0m13:21:21.211653 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:21.212571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5971813, "process_user_time": 3.32632, "process_kernel_time": 0.168241, "process_mem_max_rss": "112768", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m13:21:21.212332 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.213093 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:21.213006 after 7.60 seconds
[0m13:21:21.213362 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.213430 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m13:21:21.213714 [debug] [MainThread]: Flushing usage events
[0m13:21:21.213756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:21.217543 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m13:21:21.218012 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m13:21:21.218587 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:21.220642 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m13:21:21.222028 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:21:21.222669 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m13:21:21.223772 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.224173 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.224533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:21.392272 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.233 seconds
[0m13:21:21.397991 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:21:21.399045 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:21:21.401282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:21.415551 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m13:21:21.416726 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:21:21.418728 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m13:21:21.427145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:21:21.434032 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m13:21:21.437857 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m13:21:21.438360 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m13:21:21.439098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:21:21.441357 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m13:21:21.443020 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.34s]
[0m13:21:21.443732 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m13:21:21.445239 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.445903 [debug] [MainThread]: On master: BEGIN
[0m13:21:21.446619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:21.452450 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:21:21.452894 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.453193 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:21.456810 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.457601 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:21.458191 [debug] [MainThread]: On master: Close
[0m13:21:21.459093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:21.459783 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:21:21.460415 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m13:21:21.463749 [info ] [MainThread]: 
[0m13:21:21.464176 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m13:21:21.470317 [debug] [MainThread]: Command end result
[0m13:21:21.474013 [info ] [MainThread]: 
[0m13:21:21.475036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:21.475960 [info ] [MainThread]: 
[0m13:21:21.477038 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:21.481492 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.806671, "process_user_time": 3.214036, "process_kernel_time": 0.242167, "process_mem_max_rss": "112600", "process_out_blocks": "1193", "process_in_blocks": "0"}
[0m13:21:21.483899 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:21.483690 after 7.81 seconds
[0m13:21:21.484770 [debug] [MainThread]: Flushing usage events
[0m13:21:23.343222 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:23.348140 | 5960a7af-6fad-49bd-aa9e-5a2ddd1bf5fd ==============================
[0m13:21:23.348140 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:23.348776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m13:21:23.354938 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:23.359999 | 6c972398-a2fd-445d-b7c2-a93abf0fe0cc ==============================
[0m13:21:23.359999 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:23.360749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m13:21:23.534559 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:23.534693 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:23.555741 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:23.559868 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:23.802366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:23.803973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:23.804526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:23.805106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:23.865808 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:23.867861 [info ] [MainThread]: 
[0m13:21:23.868546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:23.869665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:23.882793 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:23.884807 [info ] [MainThread]: 
[0m13:21:23.885334 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:23.887643 [debug] [MainThread]: Command end result
[0m13:21:23.888925 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58454424, "process_user_time": 1.310084, "process_kernel_time": 0.103243, "process_mem_max_rss": "97608", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:23.889756 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:23.889675 after 0.59 seconds
[0m13:21:23.890733 [debug] [MainThread]: Flushing usage events
[0m13:21:23.924337 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:23.925181 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:23.925686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:23.942637 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:23.949617 | 1bde1df4-4a0a-4482-acba-64473305e9a1 ==============================
[0m13:21:23.949617 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:23.950352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:21:24.132032 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:24.152798 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:24.320692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:24.321210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:24.404198 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:24.417664 [info ] [MainThread]: 
[0m13:21:24.427656 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:24.431158 [debug] [MainThread]: Command end result
[0m13:21:24.438551 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5399401, "process_user_time": 1.276091, "process_kernel_time": 0.092933, "process_mem_max_rss": "97652", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:24.439664 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:24.439562 after 0.54 seconds
[0m13:21:24.441075 [debug] [MainThread]: Flushing usage events
[0m13:21:25.903712 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m13:21:25.905734 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:25.908723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:25.912243 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m13:21:25.914814 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:25.915852 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:25.916669 [debug] [MainThread]: On master: BEGIN
[0m13:21:25.922836 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:21:25.925690 [debug] [MainThread]: On master: COMMIT
[0m13:21:25.928749 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:25.929319 [debug] [MainThread]: On master: COMMIT
[0m13:21:25.933009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:25.940198 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m13:21:25.942139 [debug] [MainThread]: On master: Close
[0m13:21:25.945832 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:25.946697 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:25.950373 [info ] [MainThread]: 
[0m13:21:25.951268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:25.961126 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m13:21:25.992467 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:25.991603 [debug] [MainThread]: SQL status: SELECT 3 in 0.029 seconds
[0m13:21:25.971104 [debug] [ThreadPool]: SQL status: BEGIN in 5.025 seconds
[0m13:21:26.004770 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:26.006117 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:26.006595 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.002985 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:26.007341 [debug] [MainThread]: On master: BEGIN
[0m13:21:26.007258 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:26.008381 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:26.009317 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.010049 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.009878 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m13:21:26.010601 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.010182 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m13:21:26.011252 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:26.011777 [debug] [MainThread]: On master: Close
[0m13:21:26.011398 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m13:21:26.012753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:26.013931 [info ] [MainThread]: 
[0m13:21:26.010658 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:26.013738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m13:21:26.018876 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m13:21:26.013314 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:26.019454 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:26.020305 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:26.021036 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:26.023244 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m13:21:26.024398 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m13:21:26.025425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m13:21:26.026063 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m13:21:26.028285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m13:21:26.030079 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m13:21:26.030955 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.033794 [debug] [MainThread]: On master: BEGIN
[0m13:21:26.035701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m13:21:26.036115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:26.038470 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m13:21:26.043260 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:21:26.044806 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.047876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:26.052861 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m13:21:26.054729 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:26.056652 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.059623 [debug] [MainThread]: On master: BEGIN
[0m13:21:26.060225 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:26.060817 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.061378 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.062639 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.062795 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m13:21:26.066398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:26.066394 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m13:21:26.067380 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:21:26.067110 [debug] [MainThread]: On master: Close
[0m13:21:26.067970 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m13:21:26.068373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:26.068603 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:26.069186 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:21:26.069986 [info ] [MainThread]: 
[0m13:21:26.070423 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m13:21:26.072732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:26.077999 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m13:21:26.078744 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m13:21:26.078797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:21:26.079478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m13:21:26.079482 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:21:26.080050 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m13:21:26.080533 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m13:21:26.082103 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:21:26.087658 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:21:26.088170 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m13:21:26.088600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m13:21:26.088825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:26.093208 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m13:21:26.099848 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m13:21:26.100321 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:21:26.100653 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m13:21:26.101704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:26.107271 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m13:21:26.110597 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m13:21:26.111032 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m13:21:26.111693 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:26.114109 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m13:21:26.115782 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m13:21:26.116427 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m13:21:26.117804 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.118253 [debug] [MainThread]: On master: BEGIN
[0m13:21:26.118696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:26.121344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m13:21:26.122495 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:21:26.123059 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m13:21:26.122868 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:21:26.123569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:26.123895 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.124695 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.125059 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.125484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:26.125840 [debug] [MainThread]: On master: Close
[0m13:21:26.126985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:26.127329 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m13:21:26.127690 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:26.128083 [info ] [MainThread]: 
[0m13:21:26.128585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:21:26.128951 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m13:21:26.129353 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:21:26.129952 [debug] [MainThread]: Command end result
[0m13:21:26.130632 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m13:21:26.130969 [info ] [MainThread]: 
[0m13:21:26.131606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:26.131927 [info ] [MainThread]: 
[0m13:21:26.132258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:21:26.132683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:26.135260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.5023775, "process_user_time": 3.214619, "process_kernel_time": 0.217787, "process_mem_max_rss": "112612", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:21:26.136017 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:26.135906 after 12.50 seconds
[0m13:21:26.136701 [debug] [MainThread]: Flushing usage events
[0m13:21:26.139305 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:21:26.142899 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m13:21:26.147023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:26.159968 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m13:21:26.160756 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:21:26.161311 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m13:21:26.162717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:26.167708 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m13:21:26.170855 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m13:21:26.171208 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m13:21:26.171695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:26.173995 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m13:21:26.175670 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m13:21:26.176303 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m13:21:26.177701 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.178151 [debug] [MainThread]: On master: BEGIN
[0m13:21:26.178516 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:26.182848 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:21:26.183304 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.183734 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.184176 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.184679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:26.185041 [debug] [MainThread]: On master: Close
[0m13:21:26.185479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:26.185812 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:26.186109 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m13:21:26.186453 [info ] [MainThread]: 
[0m13:21:26.186885 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m13:21:26.187494 [debug] [MainThread]: Command end result
[0m13:21:26.187822 [info ] [MainThread]: 
[0m13:21:26.188230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:26.188573 [info ] [MainThread]: 
[0m13:21:26.188922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:26.189764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.503536, "process_user_time": 3.271115, "process_kernel_time": 0.177778, "process_mem_max_rss": "112980", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m13:21:26.190297 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:26.190229 after 12.50 seconds
[0m13:21:26.190833 [debug] [MainThread]: Flushing usage events
[0m13:21:26.220163 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m13:21:26.223745 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.224324 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.224835 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.225538 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:26.227238 [debug] [MainThread]: On master: Close
[0m13:21:26.228198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:26.228829 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:26.229527 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m13:21:26.229987 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m13:21:26.232276 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.231555 [info ] [MainThread]: 
[0m13:21:26.233078 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:26.236843 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m13:21:26.238385 [debug] [MainThread]: Command end result
[0m13:21:26.238810 [debug] [MainThread]: On master: COMMIT
[0m13:21:26.239276 [info ] [MainThread]: 
[0m13:21:26.240479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:26.240946 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:21:26.241376 [info ] [MainThread]: 
[0m13:21:26.241854 [debug] [MainThread]: On master: Close
[0m13:21:26.242352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:26.243902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:26.245378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.648982, "process_user_time": 3.266319, "process_kernel_time": 0.225033, "process_mem_max_rss": "112744", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m13:21:26.245803 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m13:21:26.246664 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:26.246530 after 12.65 seconds
[0m13:21:26.247109 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:26.247784 [debug] [MainThread]: Flushing usage events
[0m13:21:26.248474 [info ] [MainThread]: 
[0m13:21:26.249948 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m13:21:26.251021 [debug] [MainThread]: Command end result
[0m13:21:26.254809 [info ] [MainThread]: 
[0m13:21:26.255457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:26.255866 [info ] [MainThread]: 
[0m13:21:26.256241 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:26.257817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.562215, "process_user_time": 3.268012, "process_kernel_time": 0.216854, "process_mem_max_rss": "112544", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m13:21:26.261218 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:26.261043 after 12.57 seconds
[0m13:21:26.262540 [debug] [MainThread]: Flushing usage events
[0m13:21:28.274368 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:28.280037 | 175c3680-9639-49d4-a38c-65357b74b6b7 ==============================
[0m13:21:28.280037 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:28.282114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:28.300348 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:28.310999 | 40621269-4d1c-4e8e-8025-9804ffb8b8e4 ==============================
[0m13:21:28.310999 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:28.312576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:28.320003 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:28.326089 | 246d1fbc-6282-465b-8015-12a4b5531670 ==============================
[0m13:21:28.326089 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:28.329002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:28.331376 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:28.337780 | d4b67430-d529-450d-9ddb-87f05aee476b ==============================
[0m13:21:28.337780 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:28.339080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:28.341737 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:28.346997 | 76175caa-c6a7-47b3-81a9-395d2e14559b ==============================
[0m13:21:28.346997 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:28.350040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m13:21:28.351386 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:28.356764 | 208d6fe8-45a9-42be-9e43-b166fe81aeab ==============================
[0m13:21:28.356764 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:28.357494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:28.453451 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:28.530306 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:28.542019 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:28.568283 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:28.579490 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:28.606240 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:28.616845 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:28.642940 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:28.646024 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:28.666202 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:28.678602 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:28.706160 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:28.801733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:28.802484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:28.806735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:28.807691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:28.820238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:28.821062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:28.864033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:28.865072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:28.867167 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:28.870029 [info ] [MainThread]: 
[0m13:21:28.870901 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:28.873291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:28.873774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:28.875664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:28.881455 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:28.884043 [info ] [MainThread]: 
[0m13:21:28.885065 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:28.888635 [debug] [MainThread]: Command end result
[0m13:21:28.889728 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.60876, "process_user_time": 1.306772, "process_kernel_time": 0.087655, "process_mem_max_rss": "97436", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:28.890343 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:28.890273 after 0.61 seconds
[0m13:21:28.891338 [debug] [MainThread]: Flushing usage events
[0m13:21:28.900914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:28.901758 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:28.902680 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:28.902690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:28.904633 [info ] [MainThread]: 
[0m13:21:28.905641 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:28.908058 [debug] [MainThread]: Command end result
[0m13:21:28.909262 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68738735, "process_user_time": 1.28945, "process_kernel_time": 0.083222, "process_mem_max_rss": "97628", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:28.910139 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:28.910057 after 0.69 seconds
[0m13:21:28.910923 [debug] [MainThread]: Flushing usage events
[0m13:21:28.911309 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m13:21:28.913994 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:28.921013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:21:28.924995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:28.922614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:28.929806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:28.931322 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:28.928137 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:28.932712 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:28.934950 [info ] [MainThread]: 
[0m13:21:28.934693 [info ] [MainThread]: 
[0m13:21:28.931839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:28.935716 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:28.935862 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m13:21:28.936486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:28.932812 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:28.938220 [debug] [MainThread]: Command end result
[0m13:21:28.939133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:28.939681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6480996, "process_user_time": 1.356693, "process_kernel_time": 0.108858, "process_mem_max_rss": "97272", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:28.939819 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:28.940801 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:28.940704 after 0.65 seconds
[0m13:21:28.939773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:28.936822 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:28.941735 [debug] [MainThread]: Flushing usage events
[0m13:21:28.942665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:28.947705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:21:28.946774 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:21:28.950125 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:28.951894 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:28.948346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:28.954181 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:28.958962 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:21:28.959216 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:28.960265 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m13:21:28.960969 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:28.961724 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:28.962444 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:28.965392 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:28.966131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:28.967116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:28.966427 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:28.968155 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:28.971605 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:28.971701 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:28.972943 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:28.973733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:28.974996 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:28.976180 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:28.976450 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:21:28.978391 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:28.979893 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:28.984139 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:28.985288 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m13:21:28.987175 [debug] [MainThread]: On master: BEGIN
[0m13:21:28.987260 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:21:28.989262 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:28.988394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:28.989632 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:28.994903 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:28.997311 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:28.998019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:21:29.000353 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:21:29.000962 [info ] [MainThread]: 
[0m13:21:29.002113 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.002161 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:29.006367 [debug] [MainThread]: Command end result
[0m13:21:29.004013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:28.998811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:21:29.007687 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.70680016, "process_user_time": 1.374828, "process_kernel_time": 0.107849, "process_mem_max_rss": "97404", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:29.008883 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:29.008653 after 0.71 seconds
[0m13:21:29.009649 [debug] [MainThread]: Flushing usage events
[0m13:21:29.010668 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m13:21:29.011097 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:29.013628 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:29.013882 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:29.006885 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:29.015213 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:29.015890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:29.015160 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.016531 [debug] [MainThread]: On master: BEGIN
[0m13:21:29.014463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:29.018579 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:21:29.022141 [debug] [MainThread]: On master: COMMIT
[0m13:21:29.024044 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.024911 [debug] [MainThread]: On master: COMMIT
[0m13:21:29.024901 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:21:29.025562 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:29.026186 [debug] [MainThread]: On master: Close
[0m13:21:29.026153 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:21:29.027329 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:29.028161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:29.028767 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:29.030300 [info ] [MainThread]: 
[0m13:21:29.029713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:29.031161 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:29.034613 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m13:21:29.037423 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:29.035688 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:21:29.041397 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:29.039217 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:29.042295 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:29.042918 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m13:21:29.044331 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m13:21:29.045337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m13:21:29.046353 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m13:21:29.049620 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.050402 [debug] [MainThread]: On master: BEGIN
[0m13:21:29.051279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:29.054356 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m13:21:29.057708 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m13:21:29.060023 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:21:29.062729 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.065724 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:29.070714 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m13:21:29.072035 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:29.074855 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.075242 [debug] [MainThread]: On master: BEGIN
[0m13:21:29.075932 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:29.077083 [debug] [MainThread]: On master: COMMIT
[0m13:21:29.078716 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.082638 [debug] [MainThread]: On master: COMMIT
[0m13:21:29.083402 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:29.086843 [debug] [MainThread]: On master: Close
[0m13:21:29.087194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m13:21:29.087484 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:29.087924 [info ] [MainThread]: 
[0m13:21:29.089832 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:21:29.090697 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m13:21:29.091332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:29.105156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:21:29.113752 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:21:29.114145 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m13:21:29.119378 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m13:21:29.120193 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m13:21:29.121222 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:21:29.121355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m13:21:29.126114 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m13:21:29.132554 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:21:29.133482 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m13:21:29.134832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:29.143407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m13:21:29.153264 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m13:21:29.181857 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m13:21:29.183188 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:21:29.184292 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m13:21:29.188514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:21:29.196184 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m13:21:29.199437 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m13:21:29.199904 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m13:21:29.200383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:29.202301 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m13:21:29.202534 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m13:21:29.203946 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.16s]
[0m13:21:29.204970 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m13:21:29.205974 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:21:29.206426 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m13:21:29.206402 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:29.206766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:29.207039 [debug] [MainThread]: On master: BEGIN
[0m13:21:29.207485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:31.073833 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m13:21:31.074975 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:21:31.076680 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m13:21:31.078846 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m13:21:31.086393 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:21:31.086921 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m13:21:31.089726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:21:31.105225 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m13:21:31.105847 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:21:31.106295 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m13:21:31.107424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:31.114735 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m13:21:31.118415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m13:21:31.123148 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m13:21:31.123855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:21:31.126280 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m13:21:31.127901 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.11s]
[0m13:21:31.128573 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m13:21:31.130112 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:31.130601 [debug] [MainThread]: On master: BEGIN
[0m13:21:31.131049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:31.138665 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:21:31.142684 [debug] [MainThread]: On master: COMMIT
[0m13:21:31.143074 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:31.143350 [debug] [MainThread]: On master: COMMIT
[0m13:21:31.143728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:31.144026 [debug] [MainThread]: On master: Close
[0m13:21:31.144460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:31.144774 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:31.145033 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m13:21:31.145393 [info ] [MainThread]: 
[0m13:21:31.145775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.44 seconds (15.44s).
[0m13:21:31.146421 [debug] [MainThread]: Command end result
[0m13:21:31.150634 [info ] [MainThread]: 
[0m13:21:31.151125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:31.151460 [info ] [MainThread]: 
[0m13:21:31.151846 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:31.152881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.601397, "process_user_time": 3.235888, "process_kernel_time": 0.215793, "process_mem_max_rss": "112888", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m13:21:31.153446 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:31.153378 after 17.60 seconds
[0m13:21:31.153803 [debug] [MainThread]: Flushing usage events
[0m13:21:33.123534 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:33.129689 | 5d8c0e6b-ebf5-43db-b768-95c64e587ed4 ==============================
[0m13:21:33.129689 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:33.130911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:21:33.296658 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:33.310776 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:33.480471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:33.481570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:33.579428 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:33.580740 [info ] [MainThread]: 
[0m13:21:33.581229 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:33.582694 [debug] [MainThread]: Command end result
[0m13:21:33.583445 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49815938, "process_user_time": 1.242841, "process_kernel_time": 0.06394, "process_mem_max_rss": "97516", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:33.584105 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:33.584030 after 0.50 seconds
[0m13:21:33.584528 [debug] [MainThread]: Flushing usage events
[0m13:21:33.974973 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m13:21:33.976611 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:33.978659 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:33.981064 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m13:21:33.982402 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:33.983726 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:33.990735 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:33.995643 [debug] [MainThread]: On master: BEGIN
[0m13:21:33.997903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:34.004438 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:21:34.005016 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:34.005587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:34.008719 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m13:21:34.011358 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:34.011873 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:34.012230 [debug] [MainThread]: On master: BEGIN
[0m13:21:34.012970 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:34.013795 [debug] [MainThread]: On master: COMMIT
[0m13:21:34.015518 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:34.015867 [debug] [MainThread]: On master: COMMIT
[0m13:21:34.018887 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:21:34.021300 [debug] [MainThread]: On master: Close
[0m13:21:34.021934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:34.022475 [info ] [MainThread]: 
[0m13:21:34.028876 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m13:21:34.029478 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m13:21:34.030057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m13:21:34.030477 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m13:21:34.037126 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m13:21:34.038363 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m13:21:34.066527 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m13:21:34.074398 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:21:34.074774 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m13:21:34.078612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:34.083192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:21:34.083834 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:21:34.084645 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m13:21:34.086990 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:21:34.092215 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:21:34.093707 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m13:21:34.094368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:34.104657 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m13:21:34.105020 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:21:34.105306 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m13:21:34.106110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m13:21:34.110713 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m13:21:34.113764 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m13:21:34.114159 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m13:21:34.114704 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:34.116666 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m13:21:34.118157 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m13:21:34.118856 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m13:21:34.120126 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:34.120580 [debug] [MainThread]: On master: BEGIN
[0m13:21:34.120913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:34.214680 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m13:21:34.221022 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:21:34.221530 [debug] [MainThread]: SQL status: BEGIN in 5.014 seconds
[0m13:21:34.229361 [debug] [MainThread]: On master: COMMIT
[0m13:21:34.228745 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m13:21:34.230106 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:34.233554 [debug] [MainThread]: On master: COMMIT
[0m13:21:34.237882 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:21:34.242741 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:21:34.246328 [debug] [MainThread]: On master: Close
[0m13:21:34.246924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:34.250884 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:34.251210 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m13:21:34.251947 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:21:34.254444 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m13:21:34.255193 [info ] [MainThread]: 
[0m13:21:34.260489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:34.260285 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m13:21:34.265970 [debug] [MainThread]: Command end result
[0m13:21:34.267554 [info ] [MainThread]: 
[0m13:21:34.268130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:34.269033 [info ] [MainThread]: 
[0m13:21:34.270631 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:34.271583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0212173, "process_user_time": 1.536985, "process_kernel_time": 0.101508, "process_mem_max_rss": "106256", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:21:34.274448 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m13:21:34.275015 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:34.274927 after 6.02 seconds
[0m13:21:34.275544 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:21:34.276100 [debug] [MainThread]: Flushing usage events
[0m13:21:34.276644 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m13:21:34.281761 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:34.290603 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m13:21:34.295100 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m13:21:34.295657 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m13:21:34.296420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:34.298680 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m13:21:34.300290 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.18s]
[0m13:21:34.301730 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m13:21:34.303114 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:34.303663 [debug] [MainThread]: On master: BEGIN
[0m13:21:34.304068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:34.308547 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:21:34.309084 [debug] [MainThread]: On master: COMMIT
[0m13:21:34.309447 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:34.309844 [debug] [MainThread]: On master: COMMIT
[0m13:21:34.310370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:34.310921 [debug] [MainThread]: On master: Close
[0m13:21:34.311394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:34.311675 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m13:21:34.311915 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:34.312216 [info ] [MainThread]: 
[0m13:21:34.312589 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m13:21:34.313287 [debug] [MainThread]: Command end result
[0m13:21:34.313692 [info ] [MainThread]: 
[0m13:21:34.314134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:34.314543 [info ] [MainThread]: 
[0m13:21:34.314894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:34.315696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.02847, "process_user_time": 1.571928, "process_kernel_time": 0.09409, "process_mem_max_rss": "106000", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:21:34.316320 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:34.316236 after 6.03 seconds
[0m13:21:34.316659 [debug] [MainThread]: Flushing usage events
[0m13:21:36.084589 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:36.090391 | eb0e91c9-72f9-4f52-9298-2fb15376dec7 ==============================
[0m13:21:36.090391 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:36.091709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:36.102398 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:36.107682 | 85d9b787-5d7e-495f-98c4-af5ff4a56580 ==============================
[0m13:21:36.107682 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:36.108478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m13:21:36.113391 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:21:36.113789 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:36.118958 | 7f78ee34-9521-43be-81ab-f4400d272345 ==============================
[0m13:21:36.118958 [info ] [MainThread]: Running with dbt=1.8.2


============================== 13:21:36.120604 | 4629e9dc-148b-49dd-9b58-eaa0112c469a ==============================
[0m13:21:36.120604 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:36.120385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:36.121556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:36.252390 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:36.262209 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:36.268780 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:36.275112 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:36.282708 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:36.284664 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:36.296929 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:36.302977 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:36.504279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:36.504355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:36.505124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:36.505391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:36.506981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:36.508462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:36.507673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:36.509116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:36.560155 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:36.561723 [info ] [MainThread]: 
[0m13:21:36.563158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:36.563703 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:36.564658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:36.565211 [info ] [MainThread]: 
[0m13:21:36.568857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:36.569240 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:36.569798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:36.569935 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:36.571045 [info ] [MainThread]: 
[0m13:21:36.571873 [info ] [MainThread]: 
[0m13:21:36.571804 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:36.572464 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:36.574158 [debug] [MainThread]: Command end result
[0m13:21:36.574479 [debug] [MainThread]: Command end result
[0m13:21:36.575122 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5004829, "process_user_time": 1.250557, "process_kernel_time": 0.085448, "process_mem_max_rss": "97692", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:36.575379 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50608414, "process_user_time": 1.262501, "process_kernel_time": 0.0843, "process_mem_max_rss": "97492", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:36.575860 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:36.575751 after 0.50 seconds
[0m13:21:36.577772 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:36.577686 after 0.51 seconds
[0m13:21:36.577814 [debug] [MainThread]: Flushing usage events
[0m13:21:36.578639 [debug] [MainThread]: Flushing usage events
[0m13:21:36.595331 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:36.596301 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:36.596869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:36.597710 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:36.598438 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:36.599009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:36.602748 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m13:21:36.604080 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:36.604536 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m13:21:36.608693 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:36.608583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:21:36.614839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:21:36.609321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:21:36.614918 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:36.617172 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:36.617872 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:36.618453 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:36.618962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:36.619384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:36.615466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:36.620772 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:36.623003 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:36.623983 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:36.624371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:36.623564 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:36.625130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:36.629332 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:21:36.629993 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:36.630452 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:36.632652 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m13:21:36.633968 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:36.634594 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:39.127256 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m13:21:39.129760 [debug] [MainThread]: On master: COMMIT
[0m13:21:39.130339 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:39.130757 [debug] [MainThread]: On master: COMMIT
[0m13:21:39.131332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:39.131923 [debug] [MainThread]: On master: Close
[0m13:21:39.132735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:39.133202 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m13:21:39.133782 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:21:39.134334 [info ] [MainThread]: 
[0m13:21:39.134949 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m13:21:39.135960 [debug] [MainThread]: Command end result
[0m13:21:39.136405 [info ] [MainThread]: 
[0m13:21:39.136962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:39.137491 [info ] [MainThread]: 
[0m13:21:39.138055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:39.139146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.824135, "process_user_time": 1.477119, "process_kernel_time": 0.121921, "process_mem_max_rss": "106180", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m13:21:39.139929 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:39.139822 after 15.83 seconds
[0m13:21:39.140429 [debug] [MainThread]: Flushing usage events
[0m13:21:41.134120 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:41.139038 | 216837b4-a749-436f-b738-70541090d7dc ==============================
[0m13:21:41.139038 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:41.141704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m13:21:41.149964 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:41.157987 | 97d4a02d-6fa7-4d49-9f22-5a41b225a232 ==============================
[0m13:21:41.157987 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:41.159268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:41.302359 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:41.311363 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:41.333035 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:41.363192 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:41.544354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:41.545050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:41.545640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:41.546140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:41.598695 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:41.600707 [info ] [MainThread]: 
[0m13:21:41.601364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:41.602322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:41.605940 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:41.607368 [info ] [MainThread]: 
[0m13:21:41.608597 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:41.610363 [debug] [MainThread]: Command end result
[0m13:21:41.613179 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50729877, "process_user_time": 1.229936, "process_kernel_time": 0.061145, "process_mem_max_rss": "97536", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:41.613734 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:41.613656 after 0.51 seconds
[0m13:21:41.614091 [debug] [MainThread]: Flushing usage events
[0m13:21:41.623742 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m13:21:41.626464 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m13:21:41.626855 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:41.627810 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:41.628965 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m13:21:41.628635 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:41.629582 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:41.629552 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:41.629335 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:41.630914 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:41.631042 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:41.631788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:41.633087 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:41.632461 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:41.634426 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:41.633475 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m13:21:41.634910 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:41.634819 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:41.635964 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:41.636564 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:41.637057 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:41.640080 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:41.640629 [debug] [MainThread]: On master: BEGIN
[0m13:21:41.641056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:41.643681 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:41.645121 [debug] [MainThread]: On master: BEGIN
[0m13:21:41.645487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:46.650484 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.019 seconds
[0m13:21:46.651986 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m13:21:46.656483 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.657781 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m13:21:46.655662 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:46.667066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:46.679942 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.690645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:46.693122 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m13:21:46.692982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:21:46.696283 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:46.696224 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m13:21:46.697089 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.699848 [debug] [MainThread]: On master: BEGIN
[0m13:21:46.700545 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:46.701051 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.701423 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.693892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:21:46.701837 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.701748 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:46.702734 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:46.703277 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.703810 [debug] [MainThread]: On master: Close
[0m13:21:46.701588 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:46.704041 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:46.704160 [debug] [MainThread]: On master: BEGIN
[0m13:21:46.704581 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:46.704771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:46.705073 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:46.705597 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:46.705690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:46.706264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:46.706030 [info ] [MainThread]: 
[0m13:21:46.706322 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.710774 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.711189 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.711146 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:21:46.711743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:46.711778 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:46.712176 [debug] [MainThread]: On master: Close
[0m13:21:46.712350 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:46.715152 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:46.713772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:46.717213 [info ] [MainThread]: 
[0m13:21:46.717892 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:46.718605 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:46.719005 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m13:21:46.719966 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m13:21:46.720876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m13:21:46.721326 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m13:21:46.724690 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m13:21:46.725453 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m13:21:46.726352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m13:21:46.726966 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m13:21:46.729193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m13:21:46.733091 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m13:21:46.734893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m13:21:46.735987 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m13:21:46.768822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m13:21:46.768427 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m13:21:46.776162 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:21:46.776790 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m13:21:46.777265 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:21:46.777643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:46.778033 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m13:21:46.778593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:46.782472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:21:46.782813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:21:46.783085 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:21:46.783551 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key, 
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m13:21:46.783902 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:21:46.784404 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m13:21:46.786179 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m13:21:46.786269 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.001 seconds
[0m13:21:46.791297 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:21:46.791714 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m13:21:46.792258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:46.794221 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:21:46.796656 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m13:21:46.798907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:46.804898 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m13:21:46.805372 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:21:46.805809 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m13:21:46.807155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:46.812435 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m13:21:46.815901 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m13:21:46.817350 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m13:21:46.817868 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m13:21:46.818204 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:21:46.818826 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m13:21:46.819170 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:21:46.820627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:21:46.821605 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m13:21:46.823440 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.10s]
[0m13:21:46.824430 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m13:21:46.826634 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.827292 [debug] [MainThread]: On master: BEGIN
[0m13:21:46.827733 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m13:21:46.827970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:46.831970 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m13:21:46.832570 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m13:21:46.833163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:21:46.836380 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m13:21:46.838604 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.11s]
[0m13:21:46.836957 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:21:46.839337 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m13:21:46.839678 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.840166 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.840689 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.841094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:46.840928 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.841425 [debug] [MainThread]: On master: Close
[0m13:21:46.841725 [debug] [MainThread]: On master: BEGIN
[0m13:21:46.842191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:46.842487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:46.842787 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:21:46.843348 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m13:21:46.844247 [info ] [MainThread]: 
[0m13:21:46.844936 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m13:21:46.845639 [debug] [MainThread]: Command end result
[0m13:21:46.845990 [info ] [MainThread]: 
[0m13:21:46.846588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:46.847080 [info ] [MainThread]: 
[0m13:21:46.848116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:46.850684 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:21:46.848950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.801706, "process_user_time": 1.408994, "process_kernel_time": 0.091804, "process_mem_max_rss": "106024", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:21:46.851756 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:46.851578 after 10.80 seconds
[0m13:21:46.851094 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.853788 [debug] [MainThread]: Flushing usage events
[0m13:21:46.857548 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:46.857886 [debug] [MainThread]: On master: COMMIT
[0m13:21:46.858270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:46.858549 [debug] [MainThread]: On master: Close
[0m13:21:46.858971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:46.859265 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:21:46.859515 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m13:21:46.859862 [info ] [MainThread]: 
[0m13:21:46.860179 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m13:21:46.860766 [debug] [MainThread]: Command end result
[0m13:21:46.861074 [info ] [MainThread]: 
[0m13:21:46.864680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:46.865264 [info ] [MainThread]: 
[0m13:21:46.866021 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:46.866833 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.806047, "process_user_time": 1.422263, "process_kernel_time": 0.084193, "process_mem_max_rss": "106256", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:21:46.867382 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:46.867304 after 10.81 seconds
[0m13:21:46.867744 [debug] [MainThread]: Flushing usage events
[0m13:21:48.757373 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:21:48.757558 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:21:48.759391 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:48.763572 | 9feb3c35-e1e1-4bba-a1bb-8d0b0e037874 ==============================
[0m13:21:48.763572 [info ] [MainThread]: Running with dbt=1.8.2


============================== 13:21:48.763668 | 52bf35fe-6a97-4f62-907c-eb6b39b0489d ==============================
[0m13:21:48.763668 [info ] [MainThread]: Running with dbt=1.8.2


============================== 13:21:48.764816 | a3715c69-c628-4d85-87bc-2b784161e709 ==============================
[0m13:21:48.764816 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:48.765069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:21:48.764642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:48.765468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}
[0m13:21:48.941746 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:48.964479 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:48.966353 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:48.977108 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:48.982244 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:48.997674 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:49.165517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:49.166238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:49.175288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:49.175828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:49.186497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:49.187035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:49.232546 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:49.233954 [info ] [MainThread]: 
[0m13:21:49.234486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:49.235027 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:49.235959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:21:49.236785 [info ] [MainThread]: 
[0m13:21:49.237150 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:49.238635 [debug] [MainThread]: Command end result
[0m13:21:49.239316 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.523623, "process_user_time": 1.322242, "process_kernel_time": 0.084951, "process_mem_max_rss": "97484", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:49.239791 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:49.239725 after 0.52 seconds
[0m13:21:49.240118 [debug] [MainThread]: Flushing usage events
[0m13:21:49.247729 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:49.250619 [info ] [MainThread]: 
[0m13:21:49.251582 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:49.253095 [debug] [MainThread]: Command end result
[0m13:21:49.253767 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5345278, "process_user_time": 1.330887, "process_kernel_time": 0.08732, "process_mem_max_rss": "97424", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:49.254223 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:49.254160 after 0.54 seconds
[0m13:21:49.254598 [debug] [MainThread]: Flushing usage events
[0m13:21:49.263089 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:21:49.264007 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:21:49.264578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:49.273182 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m13:21:49.275004 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:21:49.280352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:21:49.281054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:21:49.286139 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:49.288715 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:49.289396 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:21:49.290705 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:21:49.292622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:49.294346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:49.299664 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:21:49.300318 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:21:49.300744 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:21:49.303073 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:21:49.304301 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:21:49.304913 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:21:51.721417 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m13:21:51.722549 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:51.723993 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:51.727348 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m13:21:51.729724 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:51.730377 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:51.739621 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.740231 [debug] [MainThread]: On master: BEGIN
[0m13:21:51.740682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:51.747354 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:21:51.749787 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.750310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:51.754287 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m13:21:51.756344 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:51.756861 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.757295 [debug] [MainThread]: On master: BEGIN
[0m13:21:51.757950 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:51.758462 [debug] [MainThread]: On master: COMMIT
[0m13:21:51.758975 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.759477 [debug] [MainThread]: On master: COMMIT
[0m13:21:51.760037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:51.760439 [debug] [MainThread]: On master: Close
[0m13:21:51.761213 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:51.761873 [info ] [MainThread]: 
[0m13:21:51.774652 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m13:21:51.775477 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m13:21:51.776391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m13:21:51.777360 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m13:21:51.785305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m13:21:51.786631 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m13:21:51.816744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m13:21:51.818226 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:21:51.818770 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m13:21:51.819302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:51.824419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:21:51.825038 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:21:51.825533 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m13:21:51.833062 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.007 seconds
[0m13:21:51.838817 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:21:51.839301 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m13:21:51.840132 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:51.853356 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m13:21:51.853845 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:21:51.854370 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m13:21:51.855376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m13:21:51.861027 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m13:21:51.864307 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m13:21:51.864794 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m13:21:51.865451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:21:51.868330 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m13:21:51.871433 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.09s]
[0m13:21:51.874496 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m13:21:51.876263 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:51.877277 [debug] [MainThread]: On master: BEGIN
[0m13:21:51.877957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:54.299830 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m13:21:54.301107 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:21:54.301695 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:54.304342 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m13:21:54.306050 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:21:54.306593 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:21:54.313474 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:54.315100 [debug] [MainThread]: On master: BEGIN
[0m13:21:54.315548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:54.320076 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:21:54.323990 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:54.327529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:54.330832 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m13:21:54.333879 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:54.334392 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:54.334805 [debug] [MainThread]: On master: BEGIN
[0m13:21:54.335439 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:21:54.335920 [debug] [MainThread]: On master: COMMIT
[0m13:21:54.336299 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:54.336732 [debug] [MainThread]: On master: COMMIT
[0m13:21:54.337243 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:54.337592 [debug] [MainThread]: On master: Close
[0m13:21:54.338130 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:54.338650 [info ] [MainThread]: 
[0m13:21:54.344533 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m13:21:54.345117 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m13:21:54.345627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m13:21:54.345989 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m13:21:54.361534 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m13:21:54.362808 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m13:21:54.391252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m13:21:54.392589 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m13:21:54.393034 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m13:21:54.393401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:56.889465 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m13:21:56.891533 [debug] [MainThread]: On master: COMMIT
[0m13:21:56.892225 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:56.892845 [debug] [MainThread]: On master: COMMIT
[0m13:21:56.893394 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:56.893781 [debug] [MainThread]: On master: Close
[0m13:21:56.894395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:56.894762 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m13:21:56.895073 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:21:56.895552 [info ] [MainThread]: 
[0m13:21:56.896106 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m13:21:56.896855 [debug] [MainThread]: Command end result
[0m13:21:56.897273 [info ] [MainThread]: 
[0m13:21:56.897778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:56.898138 [info ] [MainThread]: 
[0m13:21:56.898540 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:56.899645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.801163, "process_user_time": 1.377625, "process_kernel_time": 0.089626, "process_mem_max_rss": "106380", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m13:21:56.900380 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:56.900283 after 15.80 seconds
[0m13:21:56.900828 [debug] [MainThread]: Flushing usage events
[0m13:21:59.399917 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m13:21:59.400846 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m13:21:59.401485 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m13:21:59.404428 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:21:59.410446 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m13:21:59.410927 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m13:21:59.411670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:21:59.422674 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m13:21:59.424961 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m13:21:59.427102 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m13:21:59.444496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m13:21:59.456955 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m13:21:59.461532 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m13:21:59.466304 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m13:21:59.467476 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:21:59.475110 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m13:21:59.488682 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 5.14s]
[0m13:21:59.496981 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m13:21:59.504967 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:59.506292 [debug] [MainThread]: On master: BEGIN
[0m13:21:59.507620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:59.513494 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:21:59.513931 [debug] [MainThread]: On master: COMMIT
[0m13:21:59.514300 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:59.514619 [debug] [MainThread]: On master: COMMIT
[0m13:21:59.515019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:21:59.515374 [debug] [MainThread]: On master: Close
[0m13:21:59.515826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:59.516149 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:21:59.516470 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m13:21:59.516862 [info ] [MainThread]: 
[0m13:21:59.517288 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m13:21:59.518365 [debug] [MainThread]: Command end result
[0m13:21:59.518687 [info ] [MainThread]: 
[0m13:21:59.521313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:59.521621 [info ] [MainThread]: 
[0m13:21:59.522377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:59.523531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.809946, "process_user_time": 1.49317, "process_kernel_time": 0.099344, "process_mem_max_rss": "106572", "process_out_blocks": "35", "process_in_blocks": "0"}
[0m13:21:59.524522 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:59.524419 after 10.81 seconds
[0m13:21:59.527320 [debug] [MainThread]: Flushing usage events
[0m13:21:59.525270 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:21:59.530758 | bcf1a96d-c727-4b55-82c3-0d4ea83d348d ==============================
[0m13:21:59.530758 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:59.531363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m13:21:59.689047 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:59.703328 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:21:59.880451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:59.881036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:59.945077 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:21:59.946559 [info ] [MainThread]: 
[0m13:21:59.947464 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:59.949516 [debug] [MainThread]: Command end result
[0m13:21:59.950960 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48429513, "process_user_time": 1.231581, "process_kernel_time": 0.081302, "process_mem_max_rss": "97492", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:21:59.951754 [debug] [MainThread]: Command `dbt test` succeeded at 13:21:59.951684 after 0.49 seconds
[0m13:21:59.952849 [debug] [MainThread]: Flushing usage events
[0m13:22:01.359908 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:01.366144 | e9d6e380-eade-485e-8b1c-f0c873329c31 ==============================
[0m13:22:01.366144 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:01.367339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:22:01.364176 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:01.370844 | e5de33ff-fff7-45c5-8d1c-84c3c8421fa8 ==============================
[0m13:22:01.370844 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:01.371502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:01.534829 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:01.534964 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:01.548591 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:01.549527 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:01.723598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:01.724224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:01.742539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:01.743343 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:01.789449 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:01.791439 [info ] [MainThread]: 
[0m13:22:01.793266 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:22:01.795688 [debug] [MainThread]: Command end result
[0m13:22:01.796623 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49231663, "process_user_time": 1.211089, "process_kernel_time": 0.05915, "process_mem_max_rss": "97336", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:22:01.797585 [debug] [MainThread]: Command `dbt test` succeeded at 13:22:01.797510 after 0.49 seconds
[0m13:22:01.798207 [debug] [MainThread]: Flushing usage events
[0m13:22:01.798794 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:01.800601 [info ] [MainThread]: 
[0m13:22:01.801464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:22:01.803035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:22:01.836634 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:22:01.837439 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:22:01.838263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:01.846871 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m13:22:01.849689 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:22:01.854595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:22:01.855289 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:22:01.861428 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:01.863450 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:01.864527 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:22:01.864890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:01.864018 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:22:01.865870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:01.869417 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:22:01.869953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:01.870427 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:22:01.872888 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m13:22:01.874120 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:22:01.874727 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:22:06.871532 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m13:22:06.873953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:06.877112 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:22:06.879482 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:22:06.881016 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:22:06.881542 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:22:06.887625 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:06.888070 [debug] [MainThread]: On master: BEGIN
[0m13:22:06.888501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:11.900571 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m13:22:11.908422 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:11.910353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:22:11.914992 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m13:22:11.927471 [debug] [MainThread]: On master: ROLLBACK
[0m13:22:11.929036 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:11.933504 [debug] [MainThread]: On master: BEGIN
[0m13:22:11.934267 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:22:11.935679 [debug] [MainThread]: On master: COMMIT
[0m13:22:11.936096 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:11.936430 [debug] [MainThread]: On master: COMMIT
[0m13:22:11.936842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:11.937199 [debug] [MainThread]: On master: Close
[0m13:22:11.937742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:11.938240 [info ] [MainThread]: 
[0m13:22:11.946256 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m13:22:11.947009 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m13:22:11.947596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m13:22:11.948059 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m13:22:11.955407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m13:22:11.956503 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m13:22:11.985054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m13:22:11.986313 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m13:22:11.986694 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m13:22:11.987010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:11.991029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:22:11.991485 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m13:22:11.991819 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m13:22:13.141507 [debug] [Thread-1 (]: SQL status: SELECT 259331 in 1.149 seconds
[0m13:22:13.148065 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m13:22:13.149114 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m13:22:13.150889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:22:13.163927 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m13:22:13.169688 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m13:22:13.170387 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m13:22:13.184338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m13:22:13.193678 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m13:22:13.200243 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m13:22:13.200988 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m13:22:13.202699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:22:13.210902 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m13:22:13.215322 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259331[0m in 1.26s]
[0m13:22:13.217764 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m13:22:13.231459 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:13.236409 [debug] [MainThread]: On master: BEGIN
[0m13:22:13.239320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:13.249763 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:22:13.251326 [debug] [MainThread]: On master: COMMIT
[0m13:22:13.253675 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:13.254135 [debug] [MainThread]: On master: COMMIT
[0m13:22:13.255080 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:13.257732 [debug] [MainThread]: On master: Close
[0m13:22:13.259424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:13.259747 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m13:22:13.260020 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:22:13.261359 [info ] [MainThread]: 
[0m13:22:13.261831 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.46 seconds (11.46s).
[0m13:22:13.263568 [debug] [MainThread]: Command end result
[0m13:22:13.263990 [info ] [MainThread]: 
[0m13:22:13.264878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:13.265299 [info ] [MainThread]: 
[0m13:22:13.267033 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:22:13.268110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.963387, "process_user_time": 1.384823, "process_kernel_time": 0.082346, "process_mem_max_rss": "106116", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:22:13.268761 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:13.268674 after 11.96 seconds
[0m13:22:13.269203 [debug] [MainThread]: Flushing usage events
[0m13:22:15.118288 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m13:22:15.118266 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:15.123443 | 14ec074d-2eb8-4843-a322-653431245114 ==============================
[0m13:22:15.123443 [info ] [MainThread]: Running with dbt=1.8.2


============================== 13:22:15.124054 | a9783300-1182-48f2-bb97-b5eee9e2855b ==============================
[0m13:22:15.124054 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:15.124291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:15.124818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:15.124126 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:15.129917 | 1759f5ea-3b0f-4c7b-a8f4-023ff36c5517 ==============================
[0m13:22:15.129917 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:15.131764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:22:15.315242 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:15.315871 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:15.330088 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:15.335729 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:15.350585 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:15.370765 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:15.502236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:15.503095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:15.505886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:15.507303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:15.562070 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:15.565144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:15.565869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:15.566018 [info ] [MainThread]: 
[0m13:22:15.567371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:22:15.568985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:22:15.570288 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:15.571982 [info ] [MainThread]: 
[0m13:22:15.572630 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:22:15.574503 [debug] [MainThread]: Command end result
[0m13:22:15.575700 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5038439, "process_user_time": 1.300697, "process_kernel_time": 0.068457, "process_mem_max_rss": "97564", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:22:15.576366 [debug] [MainThread]: Command `dbt test` succeeded at 13:22:15.576262 after 0.50 seconds
[0m13:22:15.576865 [debug] [MainThread]: Flushing usage events
[0m13:22:15.597206 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:22:15.598296 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:22:15.599987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.611905 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m13:22:15.617529 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:22:15.620286 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:15.623987 [info ] [MainThread]: 
[0m13:22:15.625528 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:22:15.630808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:22:15.631060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:22:15.632449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:22:15.659352 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:15.654415 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:15.663418 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:22:15.659890 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:22:15.677485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.668954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:15.687127 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:22:15.690275 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:15.690752 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:22:15.692840 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:22:15.693982 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:22:15.697406 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:22:15.697909 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:22:15.698244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.698512 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:22:15.703977 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m13:22:15.705154 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:22:15.709706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:22:15.710271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:22:15.718581 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:15.721708 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:15.722238 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:22:15.722719 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:22:15.723147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:15.723613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:20.684215 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m13:22:20.694746 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:20.695241 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:22:20.697359 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m13:22:20.705316 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:22:20.708299 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:22:20.728072 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.728905 [debug] [MainThread]: On master: BEGIN
[0m13:22:20.729320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:20.729549 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m13:22:20.730327 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:20.732166 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:22:20.735499 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m13:22:20.736311 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:20.736667 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:22:20.737696 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:22:20.738836 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:22:20.740040 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:22:20.740539 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:22:20.742728 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.005 seconds
[0m13:22:20.745869 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:22:20.743685 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.748258 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:22:20.748299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:22:20.753660 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m13:22:20.755620 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.757666 [debug] [MainThread]: On master: ROLLBACK
[0m13:22:20.758071 [debug] [MainThread]: On master: BEGIN
[0m13:22:20.758496 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.758841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:20.759021 [debug] [MainThread]: On master: BEGIN
[0m13:22:20.759691 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:22:20.760276 [debug] [MainThread]: On master: COMMIT
[0m13:22:20.760877 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.762091 [debug] [MainThread]: On master: COMMIT
[0m13:22:20.763020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:20.763119 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:22:20.763488 [debug] [MainThread]: On master: Close
[0m13:22:20.763782 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.764313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:20.764353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:22:20.764850 [info ] [MainThread]: 
[0m13:22:20.767423 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m13:22:20.770738 [debug] [MainThread]: On master: ROLLBACK
[0m13:22:20.771374 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.771850 [debug] [MainThread]: On master: BEGIN
[0m13:22:20.772477 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m13:22:20.772514 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:22:20.773154 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m13:22:20.773644 [debug] [MainThread]: On master: COMMIT
[0m13:22:20.773840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_main)
[0m13:22:20.774249 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:20.774325 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m13:22:20.774825 [debug] [MainThread]: On master: COMMIT
[0m13:22:20.778151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:20.778479 [debug] [MainThread]: On master: Close
[0m13:22:20.778903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:20.779291 [info ] [MainThread]: 
[0m13:22:20.784743 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m13:22:20.785308 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m13:22:20.785882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m13:22:20.786367 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m13:22:20.792617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m13:22:20.794028 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m13:22:20.804577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m13:22:20.807180 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m13:22:20.834491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m13:22:20.835770 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m13:22:20.836250 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m13:22:20.836673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:20.840910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:22:20.841389 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m13:22:20.841814 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m13:22:20.846880 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m13:22:20.848502 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m13:22:20.849005 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m13:22:20.849463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:20.853141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:22:20.853604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m13:22:20.853999 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m13:22:22.092086 [debug] [Thread-1 (]: SQL status: SELECT 159331 in 1.238 seconds
[0m13:22:22.106559 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m13:22:22.107068 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m13:22:22.107459 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m13:22:22.130161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m13:22:22.132475 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m13:22:22.134397 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159331[0m in 1.35s]
[0m13:22:22.135416 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m13:22:22.136892 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:22.137393 [debug] [MainThread]: On master: BEGIN
[0m13:22:22.137812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:25.811245 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 4.969 seconds
[0m13:22:25.830847 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m13:22:25.831814 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m13:22:25.832652 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m13:22:25.846076 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m13:22:25.849020 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m13:22:25.852614 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.08s]
[0m13:22:25.853454 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m13:22:25.865880 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:25.872127 [debug] [MainThread]: On master: BEGIN
[0m13:22:25.876884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:25.890243 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:22:25.894297 [debug] [MainThread]: On master: COMMIT
[0m13:22:25.898373 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:25.899079 [debug] [MainThread]: On master: COMMIT
[0m13:22:25.899701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:25.900064 [debug] [MainThread]: On master: Close
[0m13:22:25.900506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:25.903141 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m13:22:25.904073 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:22:25.904476 [info ] [MainThread]: 
[0m13:22:25.905792 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.34 seconds (10.34s).
[0m13:22:25.906427 [debug] [MainThread]: Command end result
[0m13:22:25.910079 [info ] [MainThread]: 
[0m13:22:25.910805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:25.911332 [info ] [MainThread]: 
[0m13:22:25.911763 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:22:25.912774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.834612, "process_user_time": 1.47835, "process_kernel_time": 0.091829, "process_mem_max_rss": "106940", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m13:22:25.913462 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:25.913354 after 10.84 seconds
[0m13:22:25.913898 [debug] [MainThread]: Flushing usage events
[0m13:22:27.142089 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m13:22:27.144969 [debug] [MainThread]: On master: COMMIT
[0m13:22:27.145424 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:27.145749 [debug] [MainThread]: On master: COMMIT
[0m13:22:27.146505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:27.147077 [debug] [MainThread]: On master: Close
[0m13:22:27.152366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:27.152821 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:22:27.157075 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m13:22:27.157491 [info ] [MainThread]: 
[0m13:22:27.157860 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.53 seconds (11.53s).
[0m13:22:27.161617 [debug] [MainThread]: Command end result
[0m13:22:27.164299 [info ] [MainThread]: 
[0m13:22:27.171226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:27.177116 [info ] [MainThread]: 
[0m13:22:27.177620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:22:27.178603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.095472, "process_user_time": 1.467696, "process_kernel_time": 0.109242, "process_mem_max_rss": "107020", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m13:22:27.179151 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:27.179081 after 12.10 seconds
[0m13:22:27.189302 [debug] [MainThread]: Flushing usage events
[0m13:22:27.774356 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:27.779576 | 5ccc35be-c197-4b46-aec6-c7c7715915ff ==============================
[0m13:22:27.779576 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:27.780158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:22:27.949886 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:27.968648 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:28.137690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:28.139508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:28.249823 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:28.251275 [info ] [MainThread]: 
[0m13:22:28.251701 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:22:28.253222 [debug] [MainThread]: Command end result
[0m13:22:28.253830 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5819363, "process_user_time": 1.265771, "process_kernel_time": 0.072043, "process_mem_max_rss": "97544", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:22:28.254388 [debug] [MainThread]: Command `dbt test` succeeded at 13:22:28.254306 after 0.58 seconds
[0m13:22:28.254762 [debug] [MainThread]: Flushing usage events
[0m13:22:29.764111 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:29.769381 | dd83327c-0cb9-4821-bdc8-4c2620ef6be9 ==============================
[0m13:22:29.769381 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:29.771818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m13:22:29.770258 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:29.777635 | a47705b1-a0db-49fd-bb08-dcf45643b012 ==============================
[0m13:22:29.777635 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:29.778912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m13:22:29.945692 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:29.952090 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:29.967123 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:29.971356 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:30.127753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:30.128448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:30.129296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:30.130008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:30.186076 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:30.188438 [info ] [MainThread]: 
[0m13:22:30.189031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:22:30.191267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:22:30.194284 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:30.195690 [info ] [MainThread]: 
[0m13:22:30.196420 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:22:30.198146 [debug] [MainThread]: Command end result
[0m13:22:30.198864 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46578512, "process_user_time": 1.244798, "process_kernel_time": 0.061791, "process_mem_max_rss": "97588", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:22:30.199378 [debug] [MainThread]: Command `dbt test` succeeded at 13:22:30.199311 after 0.47 seconds
[0m13:22:30.199742 [debug] [MainThread]: Flushing usage events
[0m13:22:30.224453 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:22:30.225508 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:22:30.225903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:35.230857 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.005 seconds
[0m13:22:35.233425 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:22:35.239722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m13:22:35.240367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:22:35.247068 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:35.249349 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:22:35.248976 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:35.252341 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:22:35.252817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:35.251849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:40.257989 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m13:22:40.261014 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:40.262652 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:22:40.258613 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m13:22:40.264689 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:40.265590 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:22:40.266080 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m13:22:40.268095 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:22:40.268383 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:22:40.269088 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:22:40.270299 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:22:40.272811 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:22:40.277685 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:40.278391 [debug] [MainThread]: On master: BEGIN
[0m13:22:40.279042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:45.288482 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m13:22:45.289577 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:45.290179 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:22:45.296682 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m13:22:45.300131 [debug] [MainThread]: On master: ROLLBACK
[0m13:22:45.300669 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:45.302051 [debug] [MainThread]: On master: BEGIN
[0m13:22:45.302724 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:22:45.303346 [debug] [MainThread]: On master: COMMIT
[0m13:22:45.303782 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:45.304081 [debug] [MainThread]: On master: COMMIT
[0m13:22:45.304457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:45.304750 [debug] [MainThread]: On master: Close
[0m13:22:45.305271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:45.305737 [info ] [MainThread]: 
[0m13:22:45.313300 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m13:22:45.314073 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m13:22:45.314697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions)
[0m13:22:45.315162 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m13:22:45.325611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m13:22:45.326980 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m13:22:45.360227 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m13:22:45.363082 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m13:22:45.368531 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m13:22:45.372048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:45.376324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:22:45.376879 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m13:22:45.377372 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m13:22:46.277997 [debug] [Thread-1 (]: SQL status: SELECT 1159331 in 0.900 seconds
[0m13:22:46.287295 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m13:22:46.287993 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m13:22:46.288788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:22:46.303335 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m13:22:46.303860 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m13:22:46.304288 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m13:22:46.313152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m13:22:46.318972 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m13:22:46.322630 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m13:22:46.323133 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m13:22:46.323705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:22:46.326596 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m13:22:46.329063 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159331[0m in 1.01s]
[0m13:22:46.330196 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m13:22:46.332117 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:46.333530 [debug] [MainThread]: On master: BEGIN
[0m13:22:46.334074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:46.341883 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:22:46.342518 [debug] [MainThread]: On master: COMMIT
[0m13:22:46.343010 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:46.343644 [debug] [MainThread]: On master: COMMIT
[0m13:22:46.344509 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:46.348220 [debug] [MainThread]: On master: Close
[0m13:22:46.348970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:46.349420 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m13:22:46.349810 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m13:22:46.350311 [info ] [MainThread]: 
[0m13:22:46.350860 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.16 seconds (16.16s).
[0m13:22:46.353910 [debug] [MainThread]: Command end result
[0m13:22:46.354636 [info ] [MainThread]: 
[0m13:22:46.355478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:46.356266 [info ] [MainThread]: 
[0m13:22:46.356988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:22:46.358767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.637718, "process_user_time": 1.423431, "process_kernel_time": 0.073383, "process_mem_max_rss": "106368", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m13:22:46.360325 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:46.360151 after 16.64 seconds
[0m13:22:46.361121 [debug] [MainThread]: Flushing usage events
[0m13:22:48.861956 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:48.867530 | ea626f61-f201-47ff-b021-17a33fce69d5 ==============================
[0m13:22:48.867530 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:48.868727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:48.869576 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:22:48.875004 | ce4a06f1-19a2-487d-89bb-4998129d9533 ==============================
[0m13:22:48.875004 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:22:48.875611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:49.039190 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:49.039520 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:49.057570 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:49.057856 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:22:49.235795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:49.239078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:49.234198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:49.243125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:49.333847 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:49.336962 [info ] [MainThread]: 
[0m13:22:49.337539 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:22:49.338454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m13:22:49.347604 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:22:49.348962 [info ] [MainThread]: 
[0m13:22:49.349369 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:22:49.350902 [debug] [MainThread]: Command end result
[0m13:22:49.351575 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52916765, "process_user_time": 1.242401, "process_kernel_time": 0.070248, "process_mem_max_rss": "97204", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m13:22:49.352190 [debug] [MainThread]: Command `dbt test` succeeded at 13:22:49.352065 after 0.53 seconds
[0m13:22:49.352602 [debug] [MainThread]: Flushing usage events
[0m13:22:49.367754 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m13:22:49.373051 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m13:22:49.374726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:54.382038 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m13:22:54.384716 [debug] [ThreadPool]: On list_sales_dw: Close
[0m13:22:54.395465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m13:22:54.396137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:22:54.401583 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:54.404009 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:22:54.404361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:54.403607 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:54.405241 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:22:54.405675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:54.408605 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:22:54.409106 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:22:54.409550 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:22:54.411818 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m13:22:54.412960 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:22:54.413427 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:22:59.418869 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m13:22:59.421848 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:22:59.422258 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:22:59.424575 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m13:22:59.426414 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:22:59.426922 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:22:59.434540 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.434969 [debug] [MainThread]: On master: BEGIN
[0m13:22:59.435302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:59.439354 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:22:59.439897 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.440384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:22:59.443394 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m13:22:59.445350 [debug] [MainThread]: On master: ROLLBACK
[0m13:22:59.445754 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.446073 [debug] [MainThread]: On master: BEGIN
[0m13:22:59.446570 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:22:59.447023 [debug] [MainThread]: On master: COMMIT
[0m13:22:59.447402 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.447728 [debug] [MainThread]: On master: COMMIT
[0m13:22:59.448199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:22:59.448566 [debug] [MainThread]: On master: Close
[0m13:22:59.449059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:59.449600 [info ] [MainThread]: 
[0m13:22:59.456041 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m13:22:59.456644 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m13:22:59.457187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m13:22:59.457589 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m13:22:59.464735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m13:22:59.466154 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m13:22:59.498885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m13:22:59.500742 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m13:22:59.501167 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m13:22:59.501511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:59.506152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:22:59.506607 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m13:22:59.507042 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m13:23:00.879999 [debug] [Thread-1 (]: SQL status: SELECT 1159331 in 1.372 seconds
[0m13:23:00.888782 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m13:23:00.890020 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m13:23:00.890822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:23:00.904150 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m13:23:00.905502 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m13:23:00.905871 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m13:23:00.915436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m13:23:00.921703 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m13:23:00.924954 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m13:23:00.925378 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m13:23:00.925928 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:23:00.928741 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m13:23:00.930778 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159331[0m in 1.47s]
[0m13:23:00.932812 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m13:23:00.935975 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:00.936427 [debug] [MainThread]: On master: BEGIN
[0m13:23:00.936819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:00.945237 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:23:00.945905 [debug] [MainThread]: On master: COMMIT
[0m13:23:00.952912 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:00.954030 [debug] [MainThread]: On master: COMMIT
[0m13:23:00.955174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:23:00.955898 [debug] [MainThread]: On master: Close
[0m13:23:00.956479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:00.957718 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:23:00.958131 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m13:23:00.958621 [info ] [MainThread]: 
[0m13:23:00.959245 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.62 seconds (11.62s).
[0m13:23:00.959879 [debug] [MainThread]: Command end result
[0m13:23:00.960276 [info ] [MainThread]: 
[0m13:23:00.960743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:00.961268 [info ] [MainThread]: 
[0m13:23:00.962270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:00.963571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.1308975, "process_user_time": 1.394862, "process_kernel_time": 0.084598, "process_mem_max_rss": "106372", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m13:23:00.964927 [debug] [MainThread]: Command `dbt run` succeeded at 13:23:00.964839 after 12.13 seconds
[0m13:23:00.966253 [debug] [MainThread]: Flushing usage events
[0m13:23:03.074913 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 13:23:03.080291 | 2c8e8755-a1c5-4367-bfde-19c0bd634600 ==============================
[0m13:23:03.080291 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:23:03.081008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:03.299060 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:23:03.319729 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m13:23:03.496594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:03.498093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:03.573115 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m13:23:03.575801 [info ] [MainThread]: 
[0m13:23:03.576379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:23:03.581562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m13:23:03.582197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m13:23:03.614637 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:23:03.618159 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m13:23:03.618913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:03.615070 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:23:03.623862 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m13:23:03.624597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:03.631952 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:23:03.635688 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m13:23:03.640301 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m13:23:03.632524 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:23:03.644467 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m13:23:03.646565 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:23:03.647105 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m13:23:03.655926 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m13:23:03.656730 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.003 seconds
[0m13:23:03.661037 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m13:23:03.672813 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m13:23:03.684964 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m13:23:03.698518 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:03.699329 [debug] [MainThread]: On master: BEGIN
[0m13:23:03.699763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:03.704190 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:23:03.704605 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:03.705030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:23:03.707938 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m13:23:03.709746 [debug] [MainThread]: On master: ROLLBACK
[0m13:23:03.710180 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:03.710492 [debug] [MainThread]: On master: BEGIN
[0m13:23:03.711007 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:23:03.711443 [debug] [MainThread]: On master: COMMIT
[0m13:23:03.711803 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:03.712190 [debug] [MainThread]: On master: COMMIT
[0m13:23:03.712757 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:23:03.713165 [debug] [MainThread]: On master: Close
[0m13:23:03.713656 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:03.714052 [info ] [MainThread]: 
[0m13:23:03.720182 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m13:23:03.720714 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m13:23:03.721259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m13:23:03.721742 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m13:23:03.728707 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m13:23:03.730340 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m13:23:03.748910 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m13:23:03.750655 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m13:23:03.751168 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m13:23:03.751726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:03.757944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:23:03.759113 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m13:23:03.759954 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m13:23:03.924808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.164 seconds
[0m13:23:03.929555 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m13:23:03.930144 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m13:23:03.930869 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.21s]
[0m13:23:03.931614 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m13:23:03.933213 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:03.934125 [debug] [MainThread]: On master: BEGIN
[0m13:23:03.934497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:03.944008 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:23:03.945073 [debug] [MainThread]: On master: COMMIT
[0m13:23:03.946341 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:03.946816 [debug] [MainThread]: On master: COMMIT
[0m13:23:03.947332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:23:03.947732 [debug] [MainThread]: On master: Close
[0m13:23:03.948278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:03.948600 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m13:23:03.948913 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m13:23:03.949237 [info ] [MainThread]: 
[0m13:23:03.949624 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:23:03.950339 [debug] [MainThread]: Command end result
[0m13:23:03.950754 [info ] [MainThread]: 
[0m13:23:03.951199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:03.951599 [info ] [MainThread]: 
[0m13:23:03.952047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:03.952812 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9198785, "process_user_time": 1.359858, "process_kernel_time": 0.112988, "process_mem_max_rss": "108304", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m13:23:03.953387 [debug] [MainThread]: Command `dbt test` succeeded at 13:23:03.953303 after 0.92 seconds
[0m13:23:03.953725 [debug] [MainThread]: Flushing usage events
[0m14:13:48.052438 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:13:48.057404 | 795dcd4c-0835-4874-b1e3-24fe636c653e ==============================
[0m14:13:48.057404 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:13:48.058205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m14:13:48.130446 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m14:13:48.134114 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m14:13:48.138778 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qln13a9o'
[0m14:13:48.140897 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m14:13:48.141718 [debug] [MainThread]: Creating symlink to local dependency.
[0m14:13:48.142192 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m14:13:48.142954 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13178037, "process_user_time": 0.827826, "process_kernel_time": 0.090734, "process_mem_max_rss": "106028", "process_out_blocks": "11", "process_in_blocks": "0"}
[0m14:13:48.143543 [debug] [MainThread]: Command `dbt deps` succeeded at 14:13:48.143415 after 0.13 seconds
[0m14:13:48.144094 [debug] [MainThread]: Flushing usage events
[0m14:13:49.927289 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:13:49.931080 | 43279763-9730-4036-987a-1575985ed4c0 ==============================
[0m14:13:49.931080 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:13:49.933586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:13:50.057937 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:13:50.073205 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:13:50.074087 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:13:51.283794 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:13:51.286355 [info ] [MainThread]: 
[0m14:13:51.286854 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:51.287482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:13:51.309261 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:13:51.312301 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:13:51.312621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:51.318487 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m14:13:51.321495 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:13:51.322788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m14:13:51.323743 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m14:13:51.328253 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m14:13:51.328694 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m14:13:51.329547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:56.337690 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m14:13:56.338838 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m14:13:56.342992 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m14:13:56.343796 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:13:56.345117 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m14:13:56.345456 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m14:13:56.345757 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m14:13:56.347265 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:13:56.349250 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m14:13:56.354658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m14:13:56.355086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:13:56.361657 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:13:56.363523 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:13:56.363740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:56.363247 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:13:56.364333 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:13:56.364650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:56.367871 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:13:56.368452 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:13:56.368715 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:13:56.371670 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:13:56.372548 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:13:56.372902 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:14:01.376756 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m14:14:01.378699 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:01.379234 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:14:01.381268 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:14:01.383687 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:14:01.384439 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:14:01.394156 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:01.394653 [debug] [MainThread]: On master: BEGIN
[0m14:14:01.394942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:06.399011 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m14:14:06.399648 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:06.400051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:06.402934 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:14:06.404431 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:06.404795 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:06.405121 [debug] [MainThread]: On master: BEGIN
[0m14:14:06.406053 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:14:06.409204 [debug] [MainThread]: On master: COMMIT
[0m14:14:06.409722 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:06.411177 [debug] [MainThread]: On master: COMMIT
[0m14:14:06.411639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:06.411955 [debug] [MainThread]: On master: Close
[0m14:14:06.412873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:06.413440 [info ] [MainThread]: 
[0m14:14:06.422536 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m14:14:06.423135 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m14:14:06.423647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m14:14:06.424011 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m14:14:06.424495 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m14:14:06.458487 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:14:06.460767 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m14:14:06.461219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:06.465959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:14:06.466524 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:14:06.466905 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m14:14:06.469134 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m14:14:06.515013 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:14:06.515861 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m14:14:06.518041 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m14:14:06.521955 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m14:14:06.538962 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m14:14:06.543454 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m14:14:06.543914 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m14:14:06.544906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:06.547589 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m14:14:06.549666 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.12s]
[0m14:14:06.550312 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m14:14:06.552752 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:06.553298 [debug] [MainThread]: On master: BEGIN
[0m14:14:06.553597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:06.560657 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:14:06.561126 [debug] [MainThread]: On master: COMMIT
[0m14:14:06.561396 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:06.561657 [debug] [MainThread]: On master: COMMIT
[0m14:14:06.561997 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:06.562274 [debug] [MainThread]: On master: Close
[0m14:14:06.562619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:06.562960 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m14:14:06.563303 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:14:06.563678 [info ] [MainThread]: 
[0m14:14:06.564088 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.28 seconds (15.28s).
[0m14:14:06.564852 [debug] [MainThread]: Command end result
[0m14:14:06.667449 [info ] [MainThread]: 
[0m14:14:06.668408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:06.671442 [info ] [MainThread]: 
[0m14:14:06.672048 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:14:06.673560 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.773771, "process_user_time": 2.072988, "process_kernel_time": 0.10425, "process_mem_max_rss": "113604", "process_out_blocks": "3517", "process_in_blocks": "0"}
[0m14:14:06.674509 [debug] [MainThread]: Command `dbt seed` succeeded at 14:14:06.674405 after 16.77 seconds
[0m14:14:06.675007 [debug] [MainThread]: Flushing usage events
[0m14:14:54.598559 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:14:54.607240 | 7ac328e2-d19f-4a10-a6d3-c3017e6fb1c6 ==============================
[0m14:14:54.607240 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:54.609309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:54.616298 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:14:54.623769 | 17eeb746-4fab-4708-b046-8de6c383302f ==============================
[0m14:14:54.623769 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:54.617369 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m14:14:54.625208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}


============================== 14:14:54.626950 | 31757d10-b99d-41f3-ba26-dcee5443e178 ==============================
[0m14:14:54.626950 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:54.628571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:54.627023 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:14:54.632628 | bf13c98a-7b2b-4fd1-bc2e-f359df5204f2 ==============================
[0m14:14:54.632628 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:54.633832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:54.633545 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:14:54.639785 | f78b5fc4-fde2-4b72-8e44-5a40d2f799f5 ==============================
[0m14:14:54.639785 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:54.641358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:14:54.652744 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:14:54.657795 | 58324324-c392-4376-be5e-94f1180d23d9 ==============================
[0m14:14:54.657795 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:54.658511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m14:14:54.663149 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:14:54.669504 | fa344fcf-fca6-4454-89b8-ccdc68cbb46d ==============================
[0m14:14:54.669504 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:14:54.670578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:54.786541 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:54.833649 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:14:54.848667 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:54.850744 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:54.890589 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:14:54.895670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:54.897060 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:14:54.905639 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:54.904545 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:54.907215 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:54.929308 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:14:54.930278 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:14:54.934866 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:14:54.950305 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:54.953396 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:14:54.955331 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:14:55.005226 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:55.006106 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:14:55.016416 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:55.018165 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:14:55.021790 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:55.022672 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:14:55.023719 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:55.024897 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:14:55.033068 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:55.033813 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:14:55.057348 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:14:55.058122 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m14:14:56.375516 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:14:56.381363 [info ] [MainThread]: 
[0m14:14:56.382741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:56.394436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:14:56.408447 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:14:56.417827 [info ] [MainThread]: 
[0m14:14:56.423043 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:56.428237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:14:56.437585 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:14:56.441811 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:14:56.445833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.451641 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:14:56.453219 [info ] [MainThread]: 
[0m14:14:56.456658 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:56.458197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:14:56.461706 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:14:56.462717 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:14:56.463812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.479590 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m14:14:56.483122 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:14:56.485116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m14:14:56.487148 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:14:56.488342 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m14:14:56.489141 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:14:56.489757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.495835 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:14:56.497024 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m14:14:56.499321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:56.502988 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m14:14:56.506587 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:14:56.508480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m14:14:56.508807 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:14:56.509610 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m14:14:56.509615 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:14:56.509768 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:14:56.514291 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:14:56.515274 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m14:14:56.514966 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m14:14:56.515462 [info ] [MainThread]: 
[0m14:14:56.516252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:56.516892 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:56.517320 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:14:56.520921 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m14:14:56.522233 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:14:56.521257 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:14:56.520255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:14:56.522997 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m14:14:56.523269 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:14:56.527147 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m14:14:56.524161 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m14:14:56.528536 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:14:56.527673 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m14:14:56.529780 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m14:14:56.530484 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m14:14:56.531914 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m14:14:56.533095 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m14:14:56.534823 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m14:14:56.538434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m14:14:56.541763 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:14:56.541382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m14:14:56.543847 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:14:56.539822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:14:56.546184 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:14:56.545456 [info ] [MainThread]: 
[0m14:14:56.547599 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.549464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.552357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:56.553538 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:14:56.551339 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:14:56.556344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:14:56.542905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:14:56.555699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:56.557670 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:14:56.557104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:14:56.553189 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.560651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.560910 [info ] [MainThread]: 
[0m14:14:56.559662 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:14:56.562988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:56.563824 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m14:14:56.561816 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:14:56.565645 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:14:56.565161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:14:56.565660 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:14:56.563176 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:14:56.565995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:56.566918 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.569866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:14:56.567061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.570966 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:14:56.570315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:14:56.577938 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:14:56.580269 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:14:56.580182 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:14:56.578964 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:14:56.575445 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.580789 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.581133 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:14:56.581481 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:14:56.580088 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:14:56.581168 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:14:56.581371 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:14:56.582339 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:14:56.583908 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:14:56.582944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.583227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:56.584343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.585967 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:14:56.586613 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:14:56.586871 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:14:56.587420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.587449 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:14:56.587509 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:14:56.589623 [info ] [MainThread]: 
[0m14:14:56.590128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:56.590801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:14:56.592543 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m14:14:56.593447 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:14:56.597337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:14:56.597810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:14:56.601826 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.603571 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:14:56.603969 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:14:56.604348 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:14:56.604706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:56.605052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.608781 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:14:56.609255 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.609698 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:14:56.610267 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:14:56.611764 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:14:56.610711 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:14:56.612651 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:14:56.612891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.613271 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:14:56.617341 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:14:56.618522 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:14:56.622151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:14:56.622570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:14:56.626396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:14:56.627986 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.628388 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:14:56.628810 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:14:56.629121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:56.629432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:56.633220 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:14:56.633526 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:14:56.633870 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:14:56.634209 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:14:56.634541 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:14:56.634848 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:14:56.636539 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:14:56.636761 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:14:56.637667 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:14:56.640546 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:14:56.641244 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:14:56.641515 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:14:56.647448 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:56.650529 [debug] [MainThread]: On master: BEGIN
[0m14:14:56.650864 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:01.486888 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.037 seconds
[0m14:15:01.515720 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:01.545986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:15:01.546691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:15:01.556839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:01.559595 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:01.558882 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:01.561877 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:01.561571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:01.562775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:01.568999 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m14:15:01.571565 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:01.572032 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:01.574144 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:15:01.578207 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:01.578660 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:01.589802 [debug] [ThreadPool]: SQL status: BEGIN in 5.019 seconds
[0m14:15:01.601496 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:01.602636 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:01.605920 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.607232 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.607436 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:15:01.607958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:01.613762 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m14:15:01.608145 [debug] [ThreadPool]: SQL status: BEGIN in 5.024 seconds
[0m14:15:01.616499 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:01.617189 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:01.611333 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.025 seconds
[0m14:15:01.618301 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:01.619223 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:01.621421 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:01.623648 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:01.623325 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:15:01.619932 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m14:15:01.631237 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:01.632946 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:01.636596 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:15:01.639566 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:01.624434 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:15:01.649049 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:01.653679 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:01.653219 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:01.655389 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:01.655441 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:01.656337 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:01.667827 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.670485 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.672356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:01.672482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:15:01.673481 [debug] [MainThread]: SQL status: BEGIN in 5.021 seconds
[0m14:15:01.678067 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.679438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:01.681738 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.682578 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.683936 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.685055 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.684574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:01.685020 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:15:01.685392 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m14:15:01.685704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:01.686259 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.673918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:15:01.687088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:01.687395 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:01.690777 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:15:01.690316 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:01.693064 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:01.692140 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:01.693345 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:15:01.691452 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:01.693959 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.694192 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.694150 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.693628 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:01.694934 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.694737 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.694927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:01.694505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:01.695534 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:01.695606 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:01.696628 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.695216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:01.697304 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.697228 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.698541 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.698305 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:15:01.699377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:01.699086 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.699903 [debug] [MainThread]: On master: Close
[0m14:15:01.700261 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.702390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:01.700795 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:01.703153 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:15:01.703938 [info ] [MainThread]: 
[0m14:15:01.704372 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.704243 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:01.704502 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:01.704937 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.705255 [debug] [MainThread]: On master: Close
[0m14:15:01.705828 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:01.706695 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:01.706836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:01.708187 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.709042 [info ] [MainThread]: 
[0m14:15:01.709470 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.709702 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:15:01.710562 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.712703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:01.713344 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:01.714001 [debug] [MainThread]: On master: Close
[0m14:15:01.715695 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:01.719040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:01.723160 [info ] [MainThread]: 
[0m14:15:01.738885 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m14:15:01.742521 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m14:15:01.743708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m14:15:01.744471 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m14:15:01.745044 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m14:15:01.745964 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m14:15:01.747083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m14:15:01.747916 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m14:15:01.752278 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m14:15:01.753661 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m14:15:01.754903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m14:15:01.755690 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m14:15:01.758007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m14:15:01.762867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m14:15:01.767237 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m14:15:01.767548 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m14:15:01.770435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m14:15:01.772365 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m14:15:01.811582 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m14:15:01.815307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m14:15:01.815038 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:15:01.816173 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m14:15:01.816924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:01.818255 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:15:01.819835 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m14:15:01.820842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:01.822604 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m14:15:01.826159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:15:01.826093 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:15:01.826790 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:15:01.827611 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m14:15:01.827467 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m14:15:01.828598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:01.831059 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:15:01.833143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:15:01.835712 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:15:01.836296 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m14:15:01.836242 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:15:01.836837 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m14:15:01.837535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:01.837572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:15:01.846122 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:15:01.846630 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m14:15:01.847022 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m14:15:01.847311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:01.847503 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:15:01.847986 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m14:15:01.848890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:01.853175 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m14:15:01.856146 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m14:15:01.856096 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m14:15:01.856484 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m14:15:01.856742 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:15:01.856997 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:01.859732 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m14:15:01.857343 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m14:15:01.861256 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:15:01.861849 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m14:15:01.862016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:15:01.863141 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.863509 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.863855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:01.866212 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m14:15:01.867261 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:15:01.867676 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.867966 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.868211 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.868526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:01.868763 [debug] [MainThread]: On master: Close
[0m14:15:01.869179 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m14:15:01.869102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:01.870064 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:15:01.870097 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m14:15:01.870381 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m14:15:01.870618 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:01.870722 [info ] [MainThread]: 
[0m14:15:01.871108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.28 seconds (5.28s).
[0m14:15:01.871824 [debug] [MainThread]: Command end result
[0m14:15:01.872327 [info ] [MainThread]: 
[0m14:15:01.872922 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:01.873327 [info ] [MainThread]: 
[0m14:15:01.873835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:01.873836 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m14:15:01.875517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2623134, "process_user_time": 2.981304, "process_kernel_time": 0.209196, "process_mem_max_rss": "112552", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m14:15:01.876135 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m14:15:01.876449 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:01.876328 after 7.26 seconds
[0m14:15:01.876946 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m14:15:01.877041 [debug] [MainThread]: Flushing usage events
[0m14:15:01.878696 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.879090 [debug] [MainThread]: On master: BEGIN
[0m14:15:01.879470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:01.883979 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:15:01.884481 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.884839 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:01.885158 [debug] [MainThread]: On master: COMMIT
[0m14:15:01.885566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:01.885910 [debug] [MainThread]: On master: Close
[0m14:15:01.886363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:01.886768 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:01.887189 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m14:15:01.887711 [info ] [MainThread]: 
[0m14:15:01.888314 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m14:15:01.889217 [debug] [MainThread]: Command end result
[0m14:15:01.889710 [info ] [MainThread]: 
[0m14:15:01.890811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:01.891320 [info ] [MainThread]: 
[0m14:15:01.892017 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:01.893892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2745066, "process_user_time": 3.050772, "process_kernel_time": 0.192917, "process_mem_max_rss": "112964", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m14:15:01.895139 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:01.895039 after 7.28 seconds
[0m14:15:01.895785 [debug] [MainThread]: Flushing usage events
[0m14:15:04.208987 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:04.212928 | e2eef9da-b0cd-44c3-93de-c4ac6233ec5c ==============================
[0m14:15:04.212928 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:04.213494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:04.218237 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:04.222919 | 23757df8-f629-42a3-8a97-f4b7d480a65e ==============================
[0m14:15:04.222919 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:04.223672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:04.217208 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:04.224924 | b0a477b2-4b05-486a-aa73-a551b5eebceb ==============================
[0m14:15:04.224924 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:04.225587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:04.350139 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:04.363574 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:04.363560 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:04.367861 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:04.380768 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:04.385906 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:04.533629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:04.536479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:04.540426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:04.544689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:04.568638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:04.569113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:04.588487 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:04.589749 [info ] [MainThread]: 
[0m14:15:04.590243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:04.590977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:04.600671 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:04.601968 [info ] [MainThread]: 
[0m14:15:04.602359 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:04.603660 [debug] [MainThread]: Command end result
[0m14:15:04.604202 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4142783, "process_user_time": 1.143979, "process_kernel_time": 0.105923, "process_mem_max_rss": "97800", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:04.604706 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:04.604626 after 0.41 seconds
[0m14:15:04.605073 [debug] [MainThread]: Flushing usage events
[0m14:15:04.615555 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:04.616216 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:04.616647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:04.619909 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:04.621043 [info ] [MainThread]: 
[0m14:15:04.621391 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:04.622696 [debug] [MainThread]: Command end result
[0m14:15:04.623243 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4356871, "process_user_time": 1.183805, "process_kernel_time": 0.09756, "process_mem_max_rss": "97740", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:04.623642 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:04.623587 after 0.44 seconds
[0m14:15:04.623901 [debug] [MainThread]: Flushing usage events
[0m14:15:06.575142 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m14:15:06.576367 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m14:15:06.577497 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:06.577821 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:06.577117 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:06.578254 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:06.580493 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:15:06.583791 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:06.580714 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:15:06.585234 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:06.584259 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:06.585744 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:06.594805 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.595258 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.595636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:06.599624 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:15:06.600035 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.600439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:06.602816 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m14:15:06.604166 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:06.604677 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.605016 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.605504 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:06.605890 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.606218 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.606542 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.606922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:06.607211 [debug] [MainThread]: On master: Close
[0m14:15:06.607939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:06.608455 [info ] [MainThread]: 
[0m14:15:06.615898 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m14:15:06.617772 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.618324 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:06.619571 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m14:15:06.620363 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m14:15:06.620937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m14:15:06.621623 [debug] [MainThread]: SQL status: SELECT 2 in 0.002 seconds
[0m14:15:06.621332 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m14:15:06.625566 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:06.626279 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.626683 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.627176 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:06.627735 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.628037 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.628327 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.628749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:06.629163 [debug] [MainThread]: On master: Close
[0m14:15:06.631282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:06.632047 [info ] [MainThread]: 
[0m14:15:06.635395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m14:15:06.637065 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m14:15:06.646304 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m14:15:06.649113 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m14:15:06.649913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m14:15:06.650589 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m14:15:06.665058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m14:15:06.666441 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m14:15:06.669713 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:15:06.670187 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m14:15:06.670547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:06.671155 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m14:15:06.677463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:15:06.679449 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:15:06.679845 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m14:15:06.682050 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:15:06.687730 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:15:06.689253 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m14:15:06.690513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:06.694284 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m14:15:06.695948 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.696655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:06.700397 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m14:15:06.702201 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m14:15:06.704697 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:06.704986 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m14:15:06.705920 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:06.705700 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:06.706066 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:15:06.706630 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.707490 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m14:15:06.707772 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.708137 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m14:15:06.708417 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:06.709061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:06.709798 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.711750 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:06.712177 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.712685 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:06.712911 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.714671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:06.715313 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m14:15:06.716116 [debug] [MainThread]: On master: Close
[0m14:15:06.716869 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m14:15:06.718851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:06.721112 [info ] [MainThread]: 
[0m14:15:06.721705 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:15:06.723102 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m14:15:06.724302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:06.726153 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m14:15:06.726104 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.726723 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m14:15:06.727505 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:06.727140 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.730825 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m14:15:06.729753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:15:06.733742 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:15:06.731279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:06.734231 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:15:06.735159 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m14:15:06.735095 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m14:15:06.740374 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:15:06.737517 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m14:15:06.741148 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.741483 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.741862 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.742143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:06.742497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:06.743793 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m14:15:06.744905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m14:15:06.745528 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m14:15:06.746031 [debug] [MainThread]: SQL status: SELECT 3 in 0.002 seconds
[0m14:15:06.749077 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:06.749704 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:15:06.750041 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.750799 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.756099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m14:15:06.759711 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.762756 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.773302 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m14:15:06.773341 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.775847 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:15:06.777078 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:15:06.790680 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.791920 [debug] [MainThread]: On master: Close
[0m14:15:06.797092 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.798856 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.799855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:06.800974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:06.806894 [debug] [MainThread]: On master: Close
[0m14:15:06.809642 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:06.810592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:06.816499 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m14:15:06.836609 [info ] [MainThread]: 
[0m14:15:06.837246 [info ] [MainThread]: 
[0m14:15:06.839377 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m14:15:06.839440 [debug] [Thread-1 (]: SQL status: BEGIN in 5.018 seconds
[0m14:15:06.841535 [debug] [MainThread]: Command end result
[0m14:15:06.841964 [info ] [MainThread]: 
[0m14:15:06.841531 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:15:06.843639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:06.844602 [info ] [MainThread]: 
[0m14:15:06.844229 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m14:15:06.845507 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:06.848415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.315087, "process_user_time": 2.885432, "process_kernel_time": 0.191122, "process_mem_max_rss": "112580", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m14:15:06.847450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:15:06.849675 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:06.849591 after 12.32 seconds
[0m14:15:06.850898 [debug] [MainThread]: Flushing usage events
[0m14:15:06.850889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m14:15:06.855669 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m14:15:06.858058 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:15:06.857275 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m14:15:06.859287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m14:15:06.859646 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m14:15:06.860606 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m14:15:06.860812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:06.862803 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:15:06.865886 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m14:15:06.868140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:06.873139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:15:06.874515 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:15:06.875865 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m14:15:06.879375 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:15:06.879709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m14:15:06.885313 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m14:15:06.886101 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:15:06.886383 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m14:15:06.886742 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m14:15:06.890125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:15:06.890545 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:15:06.892712 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m14:15:06.894830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:06.901497 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m14:15:06.908344 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m14:15:06.909370 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m14:15:06.910302 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m14:15:06.910852 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:06.911557 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:15:06.915563 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m14:15:06.917040 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m14:15:06.917672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:15:06.920891 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 5.17s]
[0m14:15:06.924011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m14:15:06.924849 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m14:15:06.927958 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:15:06.929245 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m14:15:06.929467 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m14:15:06.929999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:06.930456 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.931141 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.931509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:06.933396 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m14:15:06.933812 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m14:15:06.934352 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:06.937444 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m14:15:06.946492 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.19s]
[0m14:15:06.949479 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m14:15:06.955009 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.956064 [debug] [MainThread]: On master: BEGIN
[0m14:15:06.957217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:06.966364 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:15:06.967141 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.967743 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:06.968157 [debug] [MainThread]: On master: COMMIT
[0m14:15:06.968770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:06.969185 [debug] [MainThread]: On master: Close
[0m14:15:06.970107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:06.970937 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:06.972045 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m14:15:06.972643 [info ] [MainThread]: 
[0m14:15:06.973380 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.46 seconds (10.46s).
[0m14:15:06.974339 [debug] [MainThread]: Command end result
[0m14:15:06.974789 [info ] [MainThread]: 
[0m14:15:06.975535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:06.976235 [info ] [MainThread]: 
[0m14:15:06.977107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:06.979100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.397194, "process_user_time": 3.151006, "process_kernel_time": 0.196873, "process_mem_max_rss": "112688", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m14:15:06.980434 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:06.980325 after 12.40 seconds
[0m14:15:06.981415 [debug] [MainThread]: Flushing usage events
[0m14:15:07.003457 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.266 seconds
[0m14:15:07.012723 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:15:07.013702 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:15:07.015663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:07.053711 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m14:15:07.054432 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:15:07.055492 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m14:15:07.068436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:15:07.077387 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m14:15:07.080365 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m14:15:07.080888 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m14:15:07.081514 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:15:07.084826 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m14:15:07.090473 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.44s]
[0m14:15:07.091473 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m14:15:07.093486 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:07.093940 [debug] [MainThread]: On master: BEGIN
[0m14:15:07.094267 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:07.102606 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:15:07.104469 [debug] [MainThread]: On master: COMMIT
[0m14:15:07.105223 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:07.105792 [debug] [MainThread]: On master: COMMIT
[0m14:15:07.106533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:07.107644 [debug] [MainThread]: On master: Close
[0m14:15:07.111462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:07.113535 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m14:15:07.115691 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:15:07.118377 [info ] [MainThread]: 
[0m14:15:07.119793 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.70 seconds (10.70s).
[0m14:15:07.122216 [debug] [MainThread]: Command end result
[0m14:15:07.124596 [info ] [MainThread]: 
[0m14:15:07.125771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:07.126534 [info ] [MainThread]: 
[0m14:15:07.127732 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:07.130909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.542346, "process_user_time": 2.882498, "process_kernel_time": 0.219755, "process_mem_max_rss": "112528", "process_out_blocks": "1194", "process_in_blocks": "0"}
[0m14:15:07.132841 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:07.132721 after 12.54 seconds
[0m14:15:07.133764 [debug] [MainThread]: Flushing usage events
[0m14:15:09.375938 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m14:15:09.376941 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:09.383202 | 720a4b8a-421a-423c-bb33-f5496a4e88c6 ==============================
[0m14:15:09.383202 [info ] [MainThread]: Running with dbt=1.8.2


============================== 14:15:09.382905 | 760c7638-b582-4fd4-8215-f023083ad5ed ==============================
[0m14:15:09.382905 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:09.385637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:15:09.386595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:09.399178 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:09.403921 | fa488f3c-0276-41c2-a9ff-f3c4d1147bd2 ==============================
[0m14:15:09.403921 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:09.404688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:09.413188 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:09.417621 | 5756ca06-6e36-4172-a538-fed72075dce3 ==============================
[0m14:15:09.417621 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:09.418981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:09.418607 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:09.429719 | 6d392c3b-2eaa-46fd-b447-5af2ae1fa1f2 ==============================
[0m14:15:09.429719 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:09.431702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'send_anonymous_usage_stats': 'True'}
[0m14:15:09.568033 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:09.582794 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:09.595946 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:09.602739 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:09.605881 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:09.606387 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:09.626489 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:09.627512 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:09.634075 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:09.633307 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m14:15:09.648027 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:09.665138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:15:09.666842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:15:09.675971 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:09.684219 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:09.688519 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:09.691659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:09.681742 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:09.692718 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:09.693054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:09.700863 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:15:09.701341 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:09.702558 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:09.706906 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:15:09.708113 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:09.710993 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:09.797456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:09.798020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:09.803470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:09.804213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:09.811271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:09.812048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:09.816799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:09.817304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:09.849195 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:09.850943 [info ] [MainThread]: 
[0m14:15:09.851599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:09.852440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:09.857962 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:09.859699 [info ] [MainThread]: 
[0m14:15:09.860492 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:09.862266 [debug] [MainThread]: Command end result
[0m14:15:09.863263 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5256406, "process_user_time": 1.282928, "process_kernel_time": 0.115342, "process_mem_max_rss": "97116", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:09.863860 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:09.863786 after 0.53 seconds
[0m14:15:09.864343 [debug] [MainThread]: Flushing usage events
[0m14:15:09.864378 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:09.865894 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:09.866641 [info ] [MainThread]: 
[0m14:15:09.867754 [info ] [MainThread]: 
[0m14:15:09.867655 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:09.868228 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:09.868840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:09.870029 [debug] [MainThread]: Command end result
[0m14:15:09.870858 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.502368, "process_user_time": 1.288872, "process_kernel_time": 0.116059, "process_mem_max_rss": "97784", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:09.871479 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:09.871376 after 0.50 seconds
[0m14:15:09.871921 [debug] [MainThread]: Flushing usage events
[0m14:15:09.885335 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:09.886340 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:09.887530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:09.892030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:09.892814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:09.906132 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:09.908664 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:09.909144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:09.916163 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m14:15:09.917226 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:09.921483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:15:09.922126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:15:09.926664 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:09.928157 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:09.928578 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:09.928863 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:09.929115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:09.929394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:09.933902 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:15:09.934489 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:15:09.934716 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:09.935201 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:09.935658 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:09.936061 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:09.938150 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m14:15:09.939287 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:09.939549 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:15:09.940016 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:09.940728 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:09.941918 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:09.945834 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:09.946165 [debug] [MainThread]: On master: BEGIN
[0m14:15:09.946433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:09.953377 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:09.954926 [info ] [MainThread]: 
[0m14:15:09.955258 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:09.956544 [debug] [MainThread]: Command end result
[0m14:15:09.957447 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58303416, "process_user_time": 1.31763, "process_kernel_time": 0.138008, "process_mem_max_rss": "97496", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:09.958021 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:09.957968 after 0.58 seconds
[0m14:15:09.958389 [debug] [MainThread]: Flushing usage events
[0m14:15:11.948573 [debug] [MainThread]: SQL status: BEGIN in 5.015 seconds
[0m14:15:11.948674 [debug] [Thread-1 (]: SQL status: BEGIN in 5.016 seconds
[0m14:15:11.952396 [debug] [MainThread]: On master: COMMIT
[0m14:15:11.952514 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:15:11.953010 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:11.953141 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m14:15:11.953538 [debug] [MainThread]: On master: COMMIT
[0m14:15:11.954080 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:11.954808 [debug] [MainThread]: On master: Close
[0m14:15:11.956021 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m14:15:11.957371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:11.957986 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:11.958401 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m14:15:11.959925 [info ] [MainThread]: 
[0m14:15:11.961306 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.50 seconds (15.50s).
[0m14:15:11.964287 [debug] [MainThread]: Command end result
[0m14:15:11.964943 [info ] [MainThread]: 
[0m14:15:11.965896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:11.966390 [info ] [MainThread]: 
[0m14:15:11.967052 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:11.970618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.400225, "process_user_time": 3.049662, "process_kernel_time": 0.213154, "process_mem_max_rss": "112960", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m14:15:11.972043 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:11.971909 after 17.40 seconds
[0m14:15:11.973041 [debug] [MainThread]: Flushing usage events
[0m14:15:11.975051 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:15:11.975693 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m14:15:11.976459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:11.995538 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m14:15:11.996271 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:15:11.996806 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m14:15:11.997938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:12.004438 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m14:15:12.008762 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m14:15:12.009278 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m14:15:12.009962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:15:12.015731 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m14:15:12.027252 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.16s]
[0m14:15:12.029595 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m14:15:12.036676 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:12.037232 [debug] [MainThread]: On master: BEGIN
[0m14:15:12.037672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:12.042836 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:15:12.043359 [debug] [MainThread]: On master: COMMIT
[0m14:15:12.043749 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:12.044182 [debug] [MainThread]: On master: COMMIT
[0m14:15:12.044657 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:12.045200 [debug] [MainThread]: On master: Close
[0m14:15:12.045720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:12.046106 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m14:15:12.046475 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:15:12.047006 [info ] [MainThread]: 
[0m14:15:12.047494 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.49 seconds (15.49s).
[0m14:15:12.048359 [debug] [MainThread]: Command end result
[0m14:15:12.048853 [info ] [MainThread]: 
[0m14:15:12.049501 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:12.049836 [info ] [MainThread]: 
[0m14:15:12.050322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:12.052500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.496729, "process_user_time": 3.069635, "process_kernel_time": 0.220436, "process_mem_max_rss": "112972", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m14:15:12.053688 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:12.053582 after 17.50 seconds
[0m14:15:12.054873 [debug] [MainThread]: Flushing usage events
[0m14:15:13.993685 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:13.998934 | 14a09bbb-b4d9-41c3-b367-90be8b852cd3 ==============================
[0m14:15:13.998934 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:13.999346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:13.999179 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:14.002917 | 5bbdfd48-23bf-43e3-a326-88453bcdc826 ==============================
[0m14:15:14.002917 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:14.003416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:14.108245 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:14.111558 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:14.117625 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:14.121510 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:14.231088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:14.231571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:14.247282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:14.248543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:14.287349 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:14.290331 [info ] [MainThread]: 
[0m14:15:14.291219 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:14.294281 [debug] [MainThread]: Command end result
[0m14:15:14.300264 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3647292, "process_user_time": 0.950773, "process_kernel_time": 0.045036, "process_mem_max_rss": "97608", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:14.315345 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:14.315087 after 0.38 seconds
[0m14:15:14.323201 [debug] [MainThread]: Flushing usage events
[0m14:15:14.331880 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:14.332876 [info ] [MainThread]: 
[0m14:15:14.333200 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:14.334294 [debug] [MainThread]: Command end result
[0m14:15:14.335019 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.40754145, "process_user_time": 0.972938, "process_kernel_time": 0.058235, "process_mem_max_rss": "97984", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:14.335607 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:14.335524 after 0.41 seconds
[0m14:15:14.336092 [debug] [MainThread]: Flushing usage events
[0m14:15:14.697675 [debug] [ThreadPool]: SQL status: BEGIN in 5.004 seconds
[0m14:15:14.698875 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:14.699348 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:14.701172 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m14:15:14.703133 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:14.703524 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:14.710397 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:14.710792 [debug] [MainThread]: On master: BEGIN
[0m14:15:14.711076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:14.894739 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m14:15:14.902566 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:14.939695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:15:14.948669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:15:14.961340 [debug] [MainThread]: SQL status: BEGIN in 5.014 seconds
[0m14:15:14.966587 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:14.971031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:14.967197 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:14.973976 [debug] [MainThread]: SQL status: SELECT 5 in 0.002 seconds
[0m14:15:14.975086 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:14.980846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:14.974729 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:14.982142 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:14.982705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:14.988973 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:14.989908 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:15:14.989956 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:14.990494 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:14.990866 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:14.990614 [debug] [MainThread]: On master: BEGIN
[0m14:15:14.991283 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:15:14.991679 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:14.991650 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:14.992279 [debug] [MainThread]: On master: COMMIT
[0m14:15:14.992019 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:14.992683 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:14.993046 [debug] [MainThread]: On master: COMMIT
[0m14:15:14.992401 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:15:14.993344 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:14.994592 [debug] [MainThread]: On master: Close
[0m14:15:14.994191 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:14.994421 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m14:15:14.995714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:14.997286 [info ] [MainThread]: 
[0m14:15:14.995564 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:14.996882 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:15.001477 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:15.005424 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m14:15:15.006175 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m14:15:15.006657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m14:15:15.006664 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:15.007081 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m14:15:15.007299 [debug] [MainThread]: On master: BEGIN
[0m14:15:15.007697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:15.014585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m14:15:15.015959 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m14:15:15.042675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m14:15:15.044948 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:15:15.045308 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m14:15:15.045663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:19.719322 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m14:15:19.723031 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:19.723563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:19.726384 [debug] [MainThread]: SQL status: SELECT 5 in 0.002 seconds
[0m14:15:19.728730 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:19.729188 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:19.729518 [debug] [MainThread]: On master: BEGIN
[0m14:15:19.730028 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:19.730452 [debug] [MainThread]: On master: COMMIT
[0m14:15:19.730795 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:19.731058 [debug] [MainThread]: On master: COMMIT
[0m14:15:19.731360 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:19.731634 [debug] [MainThread]: On master: Close
[0m14:15:19.732559 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:19.733190 [info ] [MainThread]: 
[0m14:15:19.742174 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m14:15:19.742980 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m14:15:19.743584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m14:15:19.743990 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m14:15:19.751431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m14:15:19.753169 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m14:15:19.779892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m14:15:19.780901 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:15:19.781242 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m14:15:19.781578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:19.785216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:15:19.785596 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:15:19.785968 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m14:15:19.788226 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:15:19.792193 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:15:19.792606 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m14:15:19.793287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:19.801575 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m14:15:19.802027 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:15:19.802405 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m14:15:19.803393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:19.807186 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m14:15:19.809630 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m14:15:19.809941 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m14:15:19.810376 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:19.812673 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m14:15:19.814067 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m14:15:19.814658 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m14:15:19.815968 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:19.816279 [debug] [MainThread]: On master: BEGIN
[0m14:15:19.816678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:19.819977 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:15:19.820347 [debug] [MainThread]: On master: COMMIT
[0m14:15:19.820630 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:19.820953 [debug] [MainThread]: On master: COMMIT
[0m14:15:19.821268 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:19.821480 [debug] [MainThread]: On master: Close
[0m14:15:19.821789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:19.822020 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m14:15:19.822225 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:15:19.822536 [info ] [MainThread]: 
[0m14:15:19.822878 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.23 seconds (15.23s).
[0m14:15:19.823396 [debug] [MainThread]: Command end result
[0m14:15:19.823708 [info ] [MainThread]: 
[0m14:15:19.824167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:19.825801 [info ] [MainThread]: 
[0m14:15:19.827103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:19.828335 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.64788, "process_user_time": 1.32362, "process_kernel_time": 0.142248, "process_mem_max_rss": "106124", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m14:15:19.829072 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:19.828985 after 15.65 seconds
[0m14:15:19.829624 [debug] [MainThread]: Flushing usage events
[0m14:15:20.014961 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m14:15:20.016782 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:20.019125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:20.021557 [debug] [MainThread]: SQL status: SELECT 7 in 0.002 seconds
[0m14:15:20.023715 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:20.024143 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:20.024451 [debug] [MainThread]: On master: BEGIN
[0m14:15:20.025012 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:20.025468 [debug] [MainThread]: On master: COMMIT
[0m14:15:20.025858 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:20.026173 [debug] [MainThread]: On master: COMMIT
[0m14:15:20.026521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:20.026878 [debug] [MainThread]: On master: Close
[0m14:15:20.027711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:20.028291 [info ] [MainThread]: 
[0m14:15:20.036857 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m14:15:20.037555 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m14:15:20.038185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m14:15:20.038700 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m14:15:20.046223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m14:15:20.047613 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m14:15:20.051008 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m14:15:20.055415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:15:20.056248 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m14:15:20.057961 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:15:20.065053 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:15:20.065802 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m14:15:20.067670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:20.077252 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m14:15:20.076365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m14:15:20.077795 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:15:20.079539 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m14:15:20.079265 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:15:20.079991 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m14:15:20.082791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:15:20.083840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:20.088431 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m14:15:20.094293 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m14:15:20.095520 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m14:15:20.096232 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:20.101755 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m14:15:20.105102 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 5.10s]
[0m14:15:20.105998 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m14:15:20.108634 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:20.109186 [debug] [MainThread]: On master: BEGIN
[0m14:15:20.109688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:20.113977 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:15:20.114992 [debug] [MainThread]: On master: COMMIT
[0m14:15:20.115735 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:20.116129 [debug] [MainThread]: On master: COMMIT
[0m14:15:20.116548 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:20.116884 [debug] [MainThread]: On master: Close
[0m14:15:20.117342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:20.117701 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:20.118005 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m14:15:20.118403 [info ] [MainThread]: 
[0m14:15:20.118936 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m14:15:20.119726 [debug] [MainThread]: Command end result
[0m14:15:20.120101 [info ] [MainThread]: 
[0m14:15:20.120624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:20.120944 [info ] [MainThread]: 
[0m14:15:20.121343 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:20.122986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.762793, "process_user_time": 1.414264, "process_kernel_time": 0.149239, "process_mem_max_rss": "106504", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m14:15:20.123781 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:20.123705 after 10.76 seconds
[0m14:15:20.124360 [debug] [MainThread]: Flushing usage events
[0m14:15:21.948818 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m14:15:21.950092 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:21.956440 | 17289c12-177e-439f-bce4-1a40ae01eabd ==============================
[0m14:15:21.956440 [info ] [MainThread]: Running with dbt=1.8.2


============================== 14:15:21.956877 | a3c980c1-a0e0-447e-a1a5-7db218f9126c ==============================
[0m14:15:21.956877 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:21.957083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m14:15:21.957803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:21.954109 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m14:15:21.956384 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:21.959868 | 2d136422-7d49-4ead-a4c4-d305a1eb265f ==============================
[0m14:15:21.959868 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:21.960528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 14:15:21.960904 | 24598970-5833-4b25-9f65-d068969e0fdc ==============================
[0m14:15:21.960904 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:21.961831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:22.114126 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:22.118095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:22.126689 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:22.136507 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:22.165684 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:22.170695 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:22.184551 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:22.190829 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:22.286463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:22.287084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:22.291257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:22.291744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:22.338378 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:22.341018 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:22.341451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:22.342332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:22.341959 [info ] [MainThread]: 
[0m14:15:22.343265 [info ] [MainThread]: 
[0m14:15:22.343061 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:22.343718 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:22.345227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:22.345052 [debug] [MainThread]: Command end result
[0m14:15:22.345597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:22.346348 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4257887, "process_user_time": 1.006086, "process_kernel_time": 0.060064, "process_mem_max_rss": "97692", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:22.346041 [debug] [MainThread]: Command end result
[0m14:15:22.346800 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:22.346711 after 0.43 seconds
[0m14:15:22.347194 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4296765, "process_user_time": 1.007966, "process_kernel_time": 0.071997, "process_mem_max_rss": "97596", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:22.347676 [debug] [MainThread]: Flushing usage events
[0m14:15:22.348129 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:22.348041 after 0.43 seconds
[0m14:15:22.349076 [debug] [MainThread]: Flushing usage events
[0m14:15:22.388897 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:22.390938 [info ] [MainThread]: 
[0m14:15:22.391565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:22.392005 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:22.392980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:22.393661 [info ] [MainThread]: 
[0m14:15:22.394356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:22.395022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:22.421006 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:22.421999 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:22.421910 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:22.422600 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:22.422751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:22.423878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:22.431106 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m14:15:22.432630 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:22.437762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:15:22.438254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:15:22.443923 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:22.446811 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:22.447325 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:22.451711 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:22.453695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:22.452269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:22.466466 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:15:22.469963 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:22.470928 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:22.475237 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:15:22.481666 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:22.488398 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:25.144739 [debug] [Thread-1 (]: SQL status: BEGIN in 5.049 seconds
[0m14:15:25.169095 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:15:25.175097 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m14:15:25.199675 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:15:25.210772 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:15:25.216034 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m14:15:25.218072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:25.227889 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m14:15:25.250956 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:15:25.258469 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m14:15:25.272540 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m14:15:25.291065 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m14:15:25.298781 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m14:15:25.299625 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m14:15:25.304392 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:25.312839 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m14:15:25.315225 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.28s]
[0m14:15:25.316327 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m14:15:25.318104 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.318493 [debug] [MainThread]: On master: BEGIN
[0m14:15:25.318851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:25.322720 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:15:25.323196 [debug] [MainThread]: On master: COMMIT
[0m14:15:25.323515 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:25.323855 [debug] [MainThread]: On master: COMMIT
[0m14:15:25.324214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:25.324550 [debug] [MainThread]: On master: Close
[0m14:15:25.325063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:25.325377 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m14:15:25.325666 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:25.326028 [info ] [MainThread]: 
[0m14:15:25.326435 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.47 seconds (15.47s).
[0m14:15:25.327199 [debug] [MainThread]: Command end result
[0m14:15:25.327586 [info ] [MainThread]: 
[0m14:15:25.328051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:25.328351 [info ] [MainThread]: 
[0m14:15:25.328827 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:25.330365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.988972, "process_user_time": 1.560882, "process_kernel_time": 0.124538, "process_mem_max_rss": "106324", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m14:15:25.331277 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:25.331214 after 15.99 seconds
[0m14:15:25.331763 [debug] [MainThread]: Flushing usage events
[0m14:15:26.967977 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:26.972333 | eeaf87f0-d7ad-49dd-b3e5-1f11c0d38f9d ==============================
[0m14:15:26.972333 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:26.972812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:26.986301 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:26.991025 | aeb8d2ec-d257-457a-a181-50e1b14e5521 ==============================
[0m14:15:26.991025 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:26.991481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:15:27.109086 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:27.124422 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:27.175197 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:27.190935 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:27.235039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:27.235408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:27.277507 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:27.279096 [info ] [MainThread]: 
[0m14:15:27.279831 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:27.280923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:27.318453 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:27.318963 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:27.319278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:27.338323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:27.338861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:27.391469 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:27.392692 [info ] [MainThread]: 
[0m14:15:27.392988 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:27.394116 [debug] [MainThread]: Command end result
[0m14:15:27.394696 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4451352, "process_user_time": 0.991572, "process_kernel_time": 0.064623, "process_mem_max_rss": "97592", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:27.395163 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:27.395102 after 0.45 seconds
[0m14:15:27.395444 [debug] [MainThread]: Flushing usage events
[0m14:15:27.438680 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m14:15:27.443501 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:27.458378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:15:27.466517 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m14:15:27.477348 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:27.478089 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:27.485780 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m14:15:27.478939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:15:27.490119 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:27.488181 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:27.494566 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:27.493823 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:27.495915 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:27.496407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:27.495284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:27.499032 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:27.508473 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:15:27.510018 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:15:27.510802 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:27.512733 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:27.514813 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:27.515315 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:27.517531 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:15:27.517595 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:27.517917 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m14:15:27.518975 [debug] [MainThread]: On master: BEGIN
[0m14:15:27.518722 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:27.523987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:27.523660 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:27.524437 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:27.525285 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:27.530738 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:27.529963 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:15:27.531170 [debug] [MainThread]: On master: BEGIN
[0m14:15:27.531473 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:27.531742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:27.532043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:27.535146 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m14:15:27.536617 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:27.537104 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:27.537779 [debug] [MainThread]: On master: BEGIN
[0m14:15:27.543950 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:15:27.544925 [debug] [MainThread]: On master: COMMIT
[0m14:15:27.546787 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:27.548803 [debug] [MainThread]: On master: COMMIT
[0m14:15:27.549391 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:27.549913 [debug] [MainThread]: On master: Close
[0m14:15:27.551013 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:27.556902 [info ] [MainThread]: 
[0m14:15:27.565814 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m14:15:27.566416 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m14:15:27.566950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m14:15:27.567269 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m14:15:27.573328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m14:15:27.574501 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m14:15:27.598352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m14:15:27.600025 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:15:27.600379 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m14:15:27.600652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:27.605379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:15:27.605949 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:15:27.606299 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m14:15:27.613206 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.006 seconds
[0m14:15:27.618213 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:15:27.618589 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m14:15:27.619234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:27.631231 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m14:15:27.631623 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:15:27.631905 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m14:15:27.633087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:27.637140 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m14:15:27.640570 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m14:15:27.641043 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m14:15:27.643031 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:15:27.649695 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m14:15:27.651263 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.08s]
[0m14:15:27.651957 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m14:15:27.653125 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:27.653441 [debug] [MainThread]: On master: BEGIN
[0m14:15:27.653726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:32.324434 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.005 seconds
[0m14:15:32.326860 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:32.330998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:15:32.331437 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:15:32.335676 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:32.337553 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:32.337896 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:32.338233 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:32.338535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:32.338843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:32.341965 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:15:32.342337 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:32.342613 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:32.344836 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m14:15:32.345765 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:32.346156 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:32.542236 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m14:15:32.545125 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:32.545684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:32.547804 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m14:15:32.549728 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:32.550107 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:32.550382 [debug] [MainThread]: On master: BEGIN
[0m14:15:32.550825 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:32.551150 [debug] [MainThread]: On master: COMMIT
[0m14:15:32.551354 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:32.551548 [debug] [MainThread]: On master: COMMIT
[0m14:15:32.551905 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:32.552221 [debug] [MainThread]: On master: Close
[0m14:15:32.552845 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:32.553272 [info ] [MainThread]: 
[0m14:15:32.559399 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m14:15:32.560094 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m14:15:32.560670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m14:15:32.561084 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m14:15:32.567566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m14:15:32.568506 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m14:15:32.590954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m14:15:32.591945 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m14:15:32.592270 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m14:15:32.592495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:32.660260 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m14:15:32.661204 [debug] [MainThread]: On master: COMMIT
[0m14:15:32.662629 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:32.663800 [debug] [MainThread]: On master: COMMIT
[0m14:15:32.665212 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:32.666331 [debug] [MainThread]: On master: Close
[0m14:15:32.667242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:32.667588 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:15:32.667935 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m14:15:32.668470 [info ] [MainThread]: 
[0m14:15:32.669810 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m14:15:32.671978 [debug] [MainThread]: Command end result
[0m14:15:32.674945 [info ] [MainThread]: 
[0m14:15:32.676072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:32.676901 [info ] [MainThread]: 
[0m14:15:32.678568 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:32.684854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.767503, "process_user_time": 1.179218, "process_kernel_time": 0.076402, "process_mem_max_rss": "106404", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m14:15:32.686495 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:32.686350 after 10.77 seconds
[0m14:15:32.690226 [debug] [MainThread]: Flushing usage events
[0m14:15:34.141807 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:34.145565 | 006131de-8b5a-4172-9a03-9f42a79afc03 ==============================
[0m14:15:34.145565 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:34.146077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:34.269147 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:34.285114 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:34.495332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:34.495951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:34.544684 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:34.546092 [info ] [MainThread]: 
[0m14:15:34.546670 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:34.547807 [debug] [MainThread]: Command end result
[0m14:15:34.548491 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43537605, "process_user_time": 0.993248, "process_kernel_time": 0.085048, "process_mem_max_rss": "97588", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:34.549916 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:34.549841 after 0.44 seconds
[0m14:15:34.550211 [debug] [MainThread]: Flushing usage events
[0m14:15:37.342470 [debug] [ThreadPool]: SQL status: BEGIN in 5.003 seconds
[0m14:15:37.345749 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:37.346102 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:37.347751 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:15:37.348829 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:37.351463 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:37.358258 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.358998 [debug] [MainThread]: On master: BEGIN
[0m14:15:37.359335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:37.364243 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:15:37.364717 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.365076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:37.367631 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m14:15:37.368978 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:37.369364 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.369772 [debug] [MainThread]: On master: BEGIN
[0m14:15:37.370253 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:37.371687 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.373717 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.374036 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.374426 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:37.374705 [debug] [MainThread]: On master: Close
[0m14:15:37.375197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:37.375612 [info ] [MainThread]: 
[0m14:15:37.380741 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m14:15:37.381226 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m14:15:37.381675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m14:15:37.382075 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m14:15:37.387783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m14:15:37.388626 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m14:15:37.413087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m14:15:37.414200 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:15:37.414496 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m14:15:37.414741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:37.417996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:15:37.418480 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:15:37.418830 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m14:15:37.420985 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.001 seconds
[0m14:15:37.426300 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:15:37.426735 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m14:15:37.427240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:37.437213 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m14:15:37.438787 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:15:37.441567 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m14:15:37.442499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:37.446297 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m14:15:37.448581 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m14:15:37.448867 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m14:15:37.449740 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:15:37.451387 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m14:15:37.452551 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.07s]
[0m14:15:37.453092 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m14:15:37.454074 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.454356 [debug] [MainThread]: On master: BEGIN
[0m14:15:37.454562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:37.457843 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:15:37.458199 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.458464 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.458681 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.460178 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:37.460411 [debug] [MainThread]: On master: Close
[0m14:15:37.460748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:37.460987 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:37.461188 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m14:15:37.461503 [info ] [MainThread]: 
[0m14:15:37.461926 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.18 seconds (10.18s).
[0m14:15:37.464533 [debug] [MainThread]: Command end result
[0m14:15:37.464818 [info ] [MainThread]: 
[0m14:15:37.465156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:37.465453 [info ] [MainThread]: 
[0m14:15:37.465725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:37.466601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.531504, "process_user_time": 1.085808, "process_kernel_time": 0.079985, "process_mem_max_rss": "106320", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m14:15:37.467217 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:37.467126 after 10.53 seconds
[0m14:15:37.467557 [debug] [MainThread]: Flushing usage events
[0m14:15:37.596813 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m14:15:37.604827 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m14:15:37.605292 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key, 
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m14:15:37.613796 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m14:15:37.634151 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m14:15:37.637835 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m14:15:37.651577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:15:37.680256 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m14:15:37.683949 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m14:15:37.685229 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m14:15:37.686748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:37.699496 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m14:15:37.701844 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m14:15:37.702152 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m14:15:37.704999 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:15:37.708429 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m14:15:37.710246 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 5.15s]
[0m14:15:37.711595 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m14:15:37.712957 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.713334 [debug] [MainThread]: On master: BEGIN
[0m14:15:37.714239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:37.719861 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:15:37.720305 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.720633 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:37.720972 [debug] [MainThread]: On master: COMMIT
[0m14:15:37.721326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:37.721659 [debug] [MainThread]: On master: Close
[0m14:15:37.722092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:37.722396 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m14:15:37.722801 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:37.726310 [info ] [MainThread]: 
[0m14:15:37.726740 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.33 seconds (15.33s).
[0m14:15:37.727430 [debug] [MainThread]: Command end result
[0m14:15:37.727715 [info ] [MainThread]: 
[0m14:15:37.728164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:37.728534 [info ] [MainThread]: 
[0m14:15:37.728934 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:37.730009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.807259, "process_user_time": 1.16358, "process_kernel_time": 0.079655, "process_mem_max_rss": "106308", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m14:15:37.730630 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:37.730563 after 15.81 seconds
[0m14:15:37.731051 [debug] [MainThread]: Flushing usage events
[0m14:15:39.193930 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m14:15:39.195023 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:39.198272 | 01303b99-f39e-4f7a-9804-8b97e280e143 ==============================
[0m14:15:39.198272 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:39.198915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 14:15:39.199732 | 2f990b59-f3d5-49e6-8908-6a46978c66ac ==============================
[0m14:15:39.199732 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:39.200259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:39.204839 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:39.209597 | dbca23a8-5563-447f-913d-b62dfdf6b5c9 ==============================
[0m14:15:39.209597 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:39.211799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:39.346800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:39.357666 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:39.363564 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:39.379851 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:39.385272 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:39.400818 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:39.494290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:39.494730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:39.512322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:39.513701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:39.567014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:39.568941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:39.597890 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:39.599321 [info ] [MainThread]: 
[0m14:15:39.599881 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:39.600306 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:39.602076 [debug] [MainThread]: Command end result
[0m14:15:39.601158 [info ] [MainThread]: 
[0m14:15:39.603002 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4434274, "process_user_time": 1.002846, "process_kernel_time": 0.059465, "process_mem_max_rss": "97316", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:39.603297 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:39.603946 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:39.603611 after 0.44 seconds
[0m14:15:39.605205 [debug] [MainThread]: Flushing usage events
[0m14:15:39.606566 [debug] [MainThread]: Command end result
[0m14:15:39.607776 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4496963, "process_user_time": 1.021252, "process_kernel_time": 0.051619, "process_mem_max_rss": "97160", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:39.608919 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:39.608554 after 0.45 seconds
[0m14:15:39.611750 [debug] [MainThread]: Flushing usage events
[0m14:15:39.623169 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:39.625579 [info ] [MainThread]: 
[0m14:15:39.626255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:39.627901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:39.658045 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:39.658928 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:39.660596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:39.672861 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m14:15:39.677249 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:39.682908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m14:15:39.696264 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:39.697068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:15:39.700764 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:39.709068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:39.708014 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:39.710725 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:39.714330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:39.720560 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m14:15:39.723525 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:39.729088 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:39.729895 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m14:15:39.738298 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:39.736067 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m14:15:39.738700 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:39.740969 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:39.744347 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:15:39.752005 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:39.750930 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:39.756672 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:39.763582 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:39.763985 [debug] [MainThread]: On master: BEGIN
[0m14:15:39.764234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:39.767741 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:15:39.768262 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:39.768653 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:39.771184 [debug] [MainThread]: SQL status: SELECT 9 in 0.002 seconds
[0m14:15:39.772538 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:39.773042 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:39.773419 [debug] [MainThread]: On master: BEGIN
[0m14:15:39.773973 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:39.774304 [debug] [MainThread]: On master: COMMIT
[0m14:15:39.774650 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:39.774996 [debug] [MainThread]: On master: COMMIT
[0m14:15:39.775376 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:39.775671 [debug] [MainThread]: On master: Close
[0m14:15:39.776121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:39.776680 [info ] [MainThread]: 
[0m14:15:39.781556 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m14:15:39.782049 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m14:15:39.782470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_customers)
[0m14:15:39.782818 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m14:15:39.799027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m14:15:39.801051 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m14:15:39.825333 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m14:15:39.830895 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m14:15:39.831328 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m14:15:39.831730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:39.835034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:15:39.835471 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m14:15:39.835870 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m14:15:39.838059 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:15:39.842069 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m14:15:39.842559 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m14:15:39.843314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:39.853077 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m14:15:39.854883 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m14:15:39.855206 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m14:15:39.856105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:39.860054 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m14:15:39.863187 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m14:15:39.863783 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m14:15:39.864391 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:15:39.866465 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m14:15:39.867819 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:15:39.868550 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m14:15:39.871006 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:39.871488 [debug] [MainThread]: On master: BEGIN
[0m14:15:39.872238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:39.881757 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:15:39.882141 [debug] [MainThread]: On master: COMMIT
[0m14:15:39.882387 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:39.882633 [debug] [MainThread]: On master: COMMIT
[0m14:15:39.882956 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:39.883206 [debug] [MainThread]: On master: Close
[0m14:15:39.883558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:39.883795 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:15:39.884031 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m14:15:39.884288 [info ] [MainThread]: 
[0m14:15:39.884580 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:15:39.885155 [debug] [MainThread]: Command end result
[0m14:15:39.885462 [info ] [MainThread]: 
[0m14:15:39.886430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:39.888738 [info ] [MainThread]: 
[0m14:15:39.891751 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:39.892766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7244254, "process_user_time": 1.148286, "process_kernel_time": 0.082451, "process_mem_max_rss": "106548", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m14:15:39.893906 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:39.893825 after 0.73 seconds
[0m14:15:39.894782 [debug] [MainThread]: Flushing usage events
[0m14:15:42.112608 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:42.116567 | c4c9da7f-dec7-4834-a396-6e92701ced89 ==============================
[0m14:15:42.116567 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:42.117077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:42.122197 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:15:42.126273 | 4111980a-5296-46cb-a85b-8de168084dc0 ==============================
[0m14:15:42.126273 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:15:42.126996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'send_anonymous_usage_stats': 'True'}
[0m14:15:42.312695 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:42.321791 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:42.332998 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:42.334727 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:15:42.462615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:42.463116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:42.470099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:42.470546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:42.510841 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:42.511313 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:15:42.513309 [info ] [MainThread]: 
[0m14:15:42.514464 [info ] [MainThread]: 
[0m14:15:42.514877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:42.515033 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:42.516188 [debug] [MainThread]: Command end result
[0m14:15:42.516829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:15:42.516952 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42793953, "process_user_time": 1.017146, "process_kernel_time": 0.062315, "process_mem_max_rss": "97640", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:15:42.517440 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:42.517388 after 0.43 seconds
[0m14:15:42.517712 [debug] [MainThread]: Flushing usage events
[0m14:15:42.538044 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:15:42.539122 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:15:42.539427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:42.548428 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m14:15:42.552434 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:15:42.561605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:15:42.568944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:15:42.707898 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:42.712142 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:15:42.712628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:42.711504 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:42.725234 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:15:42.727452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:42.731454 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:15:42.731963 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:15:42.732314 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:15:42.735034 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:15:42.736965 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:15:42.737466 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:15:47.739488 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m14:15:47.741058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:15:47.741504 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:15:47.743224 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.001 seconds
[0m14:15:47.744407 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:15:47.744830 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:15:47.750297 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:47.750702 [debug] [MainThread]: On master: BEGIN
[0m14:15:47.750979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:47.754294 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:15:47.754822 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:47.755193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:47.757682 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m14:15:47.760180 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:47.760525 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:47.760773 [debug] [MainThread]: On master: BEGIN
[0m14:15:47.761156 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:47.761462 [debug] [MainThread]: On master: COMMIT
[0m14:15:47.761731 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:47.761979 [debug] [MainThread]: On master: COMMIT
[0m14:15:47.762267 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:47.762505 [debug] [MainThread]: On master: Close
[0m14:15:47.762872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:47.763290 [info ] [MainThread]: 
[0m14:15:47.772642 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m14:15:47.773683 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m14:15:47.774863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_customer)
[0m14:15:47.775236 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m14:15:47.780991 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m14:15:47.781947 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m14:15:47.811519 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m14:15:47.815357 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m14:15:47.815724 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m14:15:47.816029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:52.849163 [debug] [Thread-1 (]: SQL status: BEGIN in 5.032 seconds
[0m14:15:52.857183 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m14:15:52.857657 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m14:15:53.830092 [debug] [Thread-1 (]: SQL status: SELECT 259471 in 0.968 seconds
[0m14:15:53.845559 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m14:15:53.846045 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m14:15:53.847308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:53.861173 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m14:15:53.861604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m14:15:53.862041 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m14:15:53.868472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:15:53.873317 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m14:15:53.875896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m14:15:53.876161 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m14:15:53.877119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:15:53.880895 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m14:15:53.882975 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259471[0m in 6.11s]
[0m14:15:53.883858 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m14:15:53.886429 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:53.886740 [debug] [MainThread]: On master: BEGIN
[0m14:15:53.887005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:58.897762 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m14:15:58.899515 [debug] [MainThread]: On master: COMMIT
[0m14:15:58.900392 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:58.900892 [debug] [MainThread]: On master: COMMIT
[0m14:15:58.901949 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:58.903055 [debug] [MainThread]: On master: Close
[0m14:15:58.903986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:58.904341 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:15:58.904655 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m14:15:58.907526 [info ] [MainThread]: 
[0m14:15:58.908127 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.39 seconds (16.39s).
[0m14:15:58.909202 [debug] [MainThread]: Command end result
[0m14:15:58.909638 [info ] [MainThread]: 
[0m14:15:58.910385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:58.910788 [info ] [MainThread]: 
[0m14:15:58.914035 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:58.916583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.849592, "process_user_time": 1.215656, "process_kernel_time": 0.080975, "process_mem_max_rss": "105000", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m14:15:58.917859 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:58.917737 after 16.85 seconds
[0m14:15:58.918697 [debug] [MainThread]: Flushing usage events
[0m14:16:00.988396 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:16:00.993152 | dc06c35a-eacd-47a7-9c5f-ba6032f3b7d1 ==============================
[0m14:16:00.993152 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:00.993725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:01.003320 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:16:01.008129 | d1cbf49a-93e1-4c6c-b9fd-6e1b18963c94 ==============================
[0m14:16:01.008129 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:01.009345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:16:01.008907 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:16:01.015932 | 258d4138-8020-4d98-9037-3ca876c8c1b8 ==============================
[0m14:16:01.015932 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:01.016421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m14:16:01.125212 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:01.140978 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:01.142510 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:01.143377 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:01.163439 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:01.167207 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:01.341374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:01.341985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:01.359358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:01.360086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:01.370500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:01.371077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:01.404684 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:01.406903 [info ] [MainThread]: 
[0m14:16:01.407261 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:16:01.408465 [debug] [MainThread]: Command end result
[0m14:16:01.409187 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45168555, "process_user_time": 1.074337, "process_kernel_time": 0.117036, "process_mem_max_rss": "97488", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:16:01.409718 [debug] [MainThread]: Command `dbt test` succeeded at 14:16:01.409636 after 0.45 seconds
[0m14:16:01.410712 [debug] [MainThread]: Flushing usage events
[0m14:16:01.421913 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:01.424978 [info ] [MainThread]: 
[0m14:16:01.426968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:01.428927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:16:01.428968 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:01.430986 [info ] [MainThread]: 
[0m14:16:01.431727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:01.433155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:16:01.467721 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:16:01.470711 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:16:01.471249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:01.472773 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:16:01.473597 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:16:01.475531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:01.487129 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m14:16:01.488396 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:16:01.493946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:16:01.494427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:16:01.499175 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:01.504281 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:01.506565 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:16:01.507702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:01.507239 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:16:01.508851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:06.488194 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m14:16:06.500007 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:16:06.515036 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m14:16:06.520178 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:06.520559 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:16:06.522309 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m14:16:06.523350 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m14:16:06.523008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:16:06.523639 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:06.525269 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:16:06.525722 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:16:06.526317 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:16:06.528812 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:16:06.529867 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:16:06.530553 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:16:06.523616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:16:06.530467 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:06.532355 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:06.535552 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:06.534640 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:16:06.535970 [debug] [MainThread]: On master: BEGIN
[0m14:16:06.535671 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:16:06.536537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:06.536269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:06.536786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:06.540459 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:16:06.540446 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:16:06.544060 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:06.544063 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:06.544621 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:16:06.544982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:06.546824 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:16:06.547974 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m14:16:06.548024 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:16:06.549722 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:06.550081 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:16:06.550396 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:06.550724 [debug] [MainThread]: On master: BEGIN
[0m14:16:06.551180 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:16:06.551822 [debug] [MainThread]: On master: COMMIT
[0m14:16:06.552208 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:06.552600 [debug] [MainThread]: On master: COMMIT
[0m14:16:06.553045 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:06.553622 [debug] [MainThread]: On master: Close
[0m14:16:06.556573 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:06.557448 [info ] [MainThread]: 
[0m14:16:06.563012 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m14:16:06.563713 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m14:16:06.564209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m14:16:06.564593 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m14:16:06.580624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m14:16:06.581959 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m14:16:06.615668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m14:16:06.620205 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m14:16:06.620649 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m14:16:06.621079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:06.624760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:16:06.625209 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m14:16:06.625686 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m14:16:08.017918 [debug] [Thread-1 (]: SQL status: SELECT 159471 in 1.391 seconds
[0m14:16:08.033725 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m14:16:08.035940 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m14:16:08.036393 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m14:16:08.054693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m14:16:08.061246 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m14:16:08.062908 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159471[0m in 1.50s]
[0m14:16:08.064577 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m14:16:08.065915 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:08.066548 [debug] [MainThread]: On master: BEGIN
[0m14:16:08.066943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:11.554318 [debug] [ThreadPool]: SQL status: BEGIN in 5.017 seconds
[0m14:16:11.562676 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:11.567773 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:16:11.570270 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.002 seconds
[0m14:16:11.579842 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:16:11.583695 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:16:11.592123 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.596099 [debug] [MainThread]: On master: BEGIN
[0m14:16:11.596507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:11.600520 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:16:11.600915 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.601377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:11.604073 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m14:16:11.605796 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:11.606169 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.606517 [debug] [MainThread]: On master: BEGIN
[0m14:16:11.607002 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:16:11.607326 [debug] [MainThread]: On master: COMMIT
[0m14:16:11.607696 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.607986 [debug] [MainThread]: On master: COMMIT
[0m14:16:11.608281 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:11.608507 [debug] [MainThread]: On master: Close
[0m14:16:11.608932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:11.609341 [info ] [MainThread]: 
[0m14:16:11.616767 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m14:16:11.617385 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m14:16:11.617948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_main)
[0m14:16:11.618297 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m14:16:11.635487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m14:16:11.636581 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m14:16:11.668634 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m14:16:11.675257 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m14:16:11.675728 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m14:16:11.675982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:11.679536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:16:11.679896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m14:16:11.680301 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m14:16:13.073874 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m14:16:13.075879 [debug] [MainThread]: On master: COMMIT
[0m14:16:13.078087 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:13.078421 [debug] [MainThread]: On master: COMMIT
[0m14:16:13.079393 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:13.079768 [debug] [MainThread]: On master: Close
[0m14:16:13.080540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:13.082749 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m14:16:13.085608 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m14:16:13.086082 [info ] [MainThread]: 
[0m14:16:13.086697 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.66 seconds (11.66s).
[0m14:16:13.087624 [debug] [MainThread]: Command end result
[0m14:16:13.087943 [info ] [MainThread]: 
[0m14:16:13.088420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:13.089662 [info ] [MainThread]: 
[0m14:16:13.090082 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:16:13.093727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.118526, "process_user_time": 1.242043, "process_kernel_time": 0.124305, "process_mem_max_rss": "106752", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m14:16:13.094917 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:13.094810 after 12.12 seconds
[0m14:16:13.095471 [debug] [MainThread]: Flushing usage events
[0m14:16:15.726033 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:16:15.730340 | da377755-0200-4860-b2c2-2be325c09c0e ==============================
[0m14:16:15.730340 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:15.730897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:16:16.028245 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:16.046030 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:16.174363 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 4.493 seconds
[0m14:16:16.211924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:16.212721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:16.216850 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m14:16:16.218710 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m14:16:16.219938 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m14:16:16.225635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:16:16.230300 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m14:16:16.233801 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 4.61s]
[0m14:16:16.234889 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m14:16:16.238049 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:16.238453 [debug] [MainThread]: On master: BEGIN
[0m14:16:16.238805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:16.280480 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:16.282589 [info ] [MainThread]: 
[0m14:16:16.283113 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:16:16.285822 [debug] [MainThread]: Command end result
[0m14:16:16.286944 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59724927, "process_user_time": 1.209564, "process_kernel_time": 0.159456, "process_mem_max_rss": "97240", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:16:16.290194 [debug] [MainThread]: Command `dbt test` succeeded at 14:16:16.289297 after 0.60 seconds
[0m14:16:16.305937 [debug] [MainThread]: Flushing usage events
[0m14:16:21.255987 [debug] [MainThread]: SQL status: BEGIN in 5.016 seconds
[0m14:16:21.258451 [debug] [MainThread]: On master: COMMIT
[0m14:16:21.258777 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:21.259674 [debug] [MainThread]: On master: COMMIT
[0m14:16:21.260299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:21.260946 [debug] [MainThread]: On master: Close
[0m14:16:21.264418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:21.264823 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:16:21.265111 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m14:16:21.265678 [info ] [MainThread]: 
[0m14:16:21.266368 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 19.83 seconds (19.83s).
[0m14:16:21.267900 [debug] [MainThread]: Command end result
[0m14:16:21.268609 [info ] [MainThread]: 
[0m14:16:21.272249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:21.272773 [info ] [MainThread]: 
[0m14:16:21.273224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:16:21.275888 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.303606, "process_user_time": 1.27849, "process_kernel_time": 0.124534, "process_mem_max_rss": "106940", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m14:16:21.277352 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:21.277228 after 20.31 seconds
[0m14:16:21.278960 [debug] [MainThread]: Flushing usage events
[0m14:16:23.585143 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:16:23.592602 | 8551b9b9-d08f-4ec7-90b9-e436856d3f12 ==============================
[0m14:16:23.592602 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:23.593329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:23.604074 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:16:23.609643 | bfb7891b-6fa3-4175-aead-0cd17a34e18c ==============================
[0m14:16:23.609643 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:23.610990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:23.721458 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:23.728162 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:23.735149 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:23.745671 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:23.856895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:23.858095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:23.948215 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:23.949383 [info ] [MainThread]: 
[0m14:16:23.949889 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:23.950593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:16:23.960029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:23.960565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:23.980141 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:16:23.980658 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:16:23.981049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:24.013374 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:24.014609 [info ] [MainThread]: 
[0m14:16:24.015016 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:16:24.016312 [debug] [MainThread]: Command end result
[0m14:16:24.016859 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46025014, "process_user_time": 1.071662, "process_kernel_time": 0.062505, "process_mem_max_rss": "97268", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:16:24.017287 [debug] [MainThread]: Command `dbt test` succeeded at 14:16:24.017216 after 0.46 seconds
[0m14:16:24.018272 [debug] [MainThread]: Flushing usage events
[0m14:16:28.993069 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m14:16:28.999706 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:16:29.008794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:16:29.009247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:16:29.014616 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:29.017480 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:16:29.017835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:29.017065 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:29.018400 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:16:29.018831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:29.021384 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:16:29.021732 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:29.021999 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:16:29.024186 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:16:29.025053 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:16:29.026713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:16:34.028835 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m14:16:34.029856 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:34.030283 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:16:34.032034 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.001 seconds
[0m14:16:34.033864 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:16:34.034338 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:16:34.041050 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:34.041449 [debug] [MainThread]: On master: BEGIN
[0m14:16:34.041703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:39.053434 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m14:16:39.061577 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:39.063586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:39.067396 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m14:16:39.073258 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:39.073755 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:39.074039 [debug] [MainThread]: On master: BEGIN
[0m14:16:39.074500 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:16:39.075089 [debug] [MainThread]: On master: COMMIT
[0m14:16:39.075459 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:39.075873 [debug] [MainThread]: On master: COMMIT
[0m14:16:39.076311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:39.076901 [debug] [MainThread]: On master: Close
[0m14:16:39.078961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:39.079741 [info ] [MainThread]: 
[0m14:16:39.103150 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m14:16:39.104685 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m14:16:39.105434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m14:16:39.105826 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m14:16:39.114484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m14:16:39.115795 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m14:16:39.142342 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m14:16:39.143361 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m14:16:39.143631 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m14:16:39.143882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:44.150839 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m14:16:44.152186 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m14:16:44.155383 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m14:16:45.268751 [debug] [Thread-1 (]: SQL status: SELECT 1159471 in 1.112 seconds
[0m14:16:45.295091 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m14:16:45.297670 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m14:16:45.301486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:16:45.316175 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m14:16:45.317615 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m14:16:45.319593 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m14:16:45.321813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:16:45.329147 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m14:16:45.332110 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m14:16:45.335016 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m14:16:45.335667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:16:45.350869 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m14:16:45.355158 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159471[0m in 6.25s]
[0m14:16:45.358596 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m14:16:45.361772 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:45.362290 [debug] [MainThread]: On master: BEGIN
[0m14:16:45.362625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:45.371732 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:16:45.372267 [debug] [MainThread]: On master: COMMIT
[0m14:16:45.372785 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:45.378407 [debug] [MainThread]: On master: COMMIT
[0m14:16:45.378860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:45.379132 [debug] [MainThread]: On master: Close
[0m14:16:45.379603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:45.379862 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:16:45.380090 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m14:16:45.380514 [info ] [MainThread]: 
[0m14:16:45.380892 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.43 seconds (21.43s).
[0m14:16:45.381540 [debug] [MainThread]: Command end result
[0m14:16:45.381852 [info ] [MainThread]: 
[0m14:16:45.382405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:45.382678 [info ] [MainThread]: 
[0m14:16:45.384688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:16:45.386943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.845669, "process_user_time": 1.249299, "process_kernel_time": 0.10714, "process_mem_max_rss": "106084", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m14:16:45.389419 [debug] [MainThread]: Command `dbt run` succeeded at 14:16:45.389304 after 21.85 seconds
[0m14:16:45.390957 [debug] [MainThread]: Flushing usage events
[0m14:16:47.563408 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m14:16:47.566357 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:16:47.573815 | a88218ec-d7cd-4643-b966-fc46b6064fbc ==============================
[0m14:16:47.573815 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:47.576984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 14:16:47.578557 | 034498c5-44a7-4cd0-9c35-f5cdcf06c61a ==============================
[0m14:16:47.578557 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:16:47.579956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:47.847758 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:47.849970 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:47.878297 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:47.882779 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:16:48.150815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:48.151701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:48.152909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:48.154580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:48.208243 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:48.210084 [info ] [MainThread]: 
[0m14:16:48.210692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:48.211544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m14:16:48.214297 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:16:48.215890 [info ] [MainThread]: 
[0m14:16:48.216315 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:16:48.217753 [debug] [MainThread]: Command end result
[0m14:16:48.218529 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.74156237, "process_user_time": 1.332382, "process_kernel_time": 0.10516, "process_mem_max_rss": "97764", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m14:16:48.219027 [debug] [MainThread]: Command `dbt test` succeeded at 14:16:48.218961 after 0.74 seconds
[0m14:16:48.219452 [debug] [MainThread]: Flushing usage events
[0m14:16:48.243979 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m14:16:48.244651 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m14:16:48.245018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:48.253492 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m14:16:48.256124 [debug] [ThreadPool]: On list_sales_dw: Close
[0m14:16:48.261402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m14:16:48.261894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:16:48.266404 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:48.268209 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:48.268587 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:16:48.268939 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:16:48.269207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:48.269551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:48.277682 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:16:48.278108 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:16:48.278603 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:16:48.281276 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:16:48.282120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:16:48.282966 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:16:53.280052 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m14:16:53.283032 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:16:53.283590 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:16:53.288456 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m14:16:53.290825 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:16:53.291478 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:16:53.325285 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:53.335565 [debug] [MainThread]: On master: BEGIN
[0m14:16:53.340676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:58.350660 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m14:16:58.353062 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:58.356177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:58.359112 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m14:16:58.362910 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:58.365638 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:58.366298 [debug] [MainThread]: On master: BEGIN
[0m14:16:58.367461 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:16:58.368873 [debug] [MainThread]: On master: COMMIT
[0m14:16:58.370613 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:58.378831 [debug] [MainThread]: On master: COMMIT
[0m14:16:58.380931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:58.384720 [debug] [MainThread]: On master: Close
[0m14:16:58.392607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:58.403686 [info ] [MainThread]: 
[0m14:16:58.457189 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m14:16:58.459316 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m14:16:58.461715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m14:16:58.462124 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m14:16:58.471828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m14:16:58.473207 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m14:16:58.499988 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m14:16:58.505611 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m14:16:58.507756 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m14:16:58.511579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:03.516891 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m14:17:03.520661 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m14:17:03.522037 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    reseller_id,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m14:17:05.092617 [debug] [Thread-1 (]: SQL status: SELECT 1159471 in 1.568 seconds
[0m14:17:05.111922 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m14:17:05.112486 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m14:17:05.113490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:17:05.129744 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m14:17:05.132322 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m14:17:05.132676 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m14:17:05.137610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:17:05.143000 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m14:17:05.145840 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m14:17:05.146163 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m14:17:05.146683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:17:05.153507 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m14:17:05.156344 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159471[0m in 6.69s]
[0m14:17:05.157904 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m14:17:05.160881 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:05.161255 [debug] [MainThread]: On master: BEGIN
[0m14:17:05.161576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:05.170656 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:17:05.171138 [debug] [MainThread]: On master: COMMIT
[0m14:17:05.171409 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:05.171680 [debug] [MainThread]: On master: COMMIT
[0m14:17:05.172008 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:05.172286 [debug] [MainThread]: On master: Close
[0m14:17:05.172748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:05.173100 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:17:05.173371 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m14:17:05.173829 [info ] [MainThread]: 
[0m14:17:05.174371 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.96 seconds (16.96s).
[0m14:17:05.175326 [debug] [MainThread]: Command end result
[0m14:17:05.175697 [info ] [MainThread]: 
[0m14:17:05.176282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:05.177440 [info ] [MainThread]: 
[0m14:17:05.177894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:17:05.179968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.704403, "process_user_time": 1.533174, "process_kernel_time": 0.156021, "process_mem_max_rss": "106480", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m14:17:05.181316 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:05.181225 after 17.71 seconds
[0m14:17:05.182112 [debug] [MainThread]: Flushing usage events
[0m14:17:07.523493 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:17:07.527205 | 35cda961-74c1-4039-9688-4d1901ff06a9 ==============================
[0m14:17:07.527205 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:17:07.527716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:17:07.700310 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:17:07.732247 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m14:17:07.891480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:07.893533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:07.947064 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m14:17:07.950039 [info ] [MainThread]: 
[0m14:17:07.950617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:17:07.953994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m14:17:07.954830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m14:17:07.981917 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:17:07.982247 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:17:07.992503 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m14:17:07.988527 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m14:17:07.992849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:07.994812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:08.008097 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:17:08.008926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m14:17:08.009794 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m14:17:08.012679 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:17:08.016093 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m14:17:08.017092 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m14:17:13.000538 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m14:17:13.001830 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m14:17:13.004647 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:17:13.007482 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.002 seconds
[0m14:17:13.009387 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m14:17:13.011048 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m14:17:13.016646 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:13.020167 [debug] [MainThread]: On master: BEGIN
[0m14:17:13.020524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:18.034506 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m14:17:18.039813 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:18.041802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:17:18.051927 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m14:17:18.053731 [debug] [MainThread]: On master: ROLLBACK
[0m14:17:18.058485 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:18.058759 [debug] [MainThread]: On master: BEGIN
[0m14:17:18.060273 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:17:18.064353 [debug] [MainThread]: On master: COMMIT
[0m14:17:18.068635 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:18.069307 [debug] [MainThread]: On master: COMMIT
[0m14:17:18.076875 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:18.077340 [debug] [MainThread]: On master: Close
[0m14:17:18.078447 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:18.079073 [info ] [MainThread]: 
[0m14:17:18.087560 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m14:17:18.088072 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m14:17:18.088568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m14:17:18.088958 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m14:17:18.094890 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m14:17:18.097481 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m14:17:18.106418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m14:17:18.107860 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m14:17:18.108624 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m14:17:18.111145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:18.114658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:17:18.117070 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m14:17:18.117318 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m14:17:18.331519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.214 seconds
[0m14:17:18.334677 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m14:17:18.335184 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m14:17:18.335781 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.25s]
[0m14:17:18.336406 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m14:17:18.337563 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:18.337884 [debug] [MainThread]: On master: BEGIN
[0m14:17:18.338146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:18.342082 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:17:18.342553 [debug] [MainThread]: On master: COMMIT
[0m14:17:18.342924 [debug] [MainThread]: Using postgres connection "master"
[0m14:17:18.343258 [debug] [MainThread]: On master: COMMIT
[0m14:17:18.343640 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:17:18.343891 [debug] [MainThread]: On master: Close
[0m14:17:18.344265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:18.344534 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m14:17:18.344796 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m14:17:18.345140 [info ] [MainThread]: 
[0m14:17:18.345495 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m14:17:18.346065 [debug] [MainThread]: Command end result
[0m14:17:18.346340 [info ] [MainThread]: 
[0m14:17:18.346688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:18.346957 [info ] [MainThread]: 
[0m14:17:18.347235 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:17:18.347883 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.910555, "process_user_time": 1.090058, "process_kernel_time": 0.100667, "process_mem_max_rss": "108220", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m14:17:18.348461 [debug] [MainThread]: Command `dbt test` succeeded at 14:17:18.348360 after 10.91 seconds
[0m14:17:18.348803 [debug] [MainThread]: Flushing usage events
[0m06:36:42.922271 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:36:42.931818 | 708f4946-142b-418d-84f9-72dcd80fe1ea ==============================
[0m06:36:42.931818 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:36:42.933047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:36:43.032765 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m06:36:43.034509 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m06:36:43.045121 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-v00tla2y'
[0m06:36:43.045847 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m06:36:43.047485 [debug] [MainThread]: Creating symlink to local dependency.
[0m06:36:43.048188 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m06:36:43.049675 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17645817, "process_user_time": 1.035522, "process_kernel_time": 0.118601, "process_mem_max_rss": "106208", "process_in_blocks": "152", "process_out_blocks": "11"}
[0m06:36:43.050434 [debug] [MainThread]: Command `dbt deps` succeeded at 06:36:43.050279 after 0.18 seconds
[0m06:36:43.050872 [debug] [MainThread]: Flushing usage events
[0m06:36:50.042104 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:36:50.048100 | 585433c7-a55f-4fd2-a7b3-e04476785383 ==============================
[0m06:36:50.048100 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:36:50.051589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:36:50.255676 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:36:50.285761 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:36:50.291106 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:36:51.854856 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:36:51.857153 [info ] [MainThread]: 
[0m06:36:51.860576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:36:51.867143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:36:51.914319 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:36:51.915180 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:36:51.915944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:51.925782 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m06:36:51.927661 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:36:51.932366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m06:36:51.932897 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m06:36:51.938920 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:36:51.941376 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m06:36:51.941839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:51.947378 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:36:51.947878 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:36:51.948407 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m06:36:51.949955 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m06:36:51.950821 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m06:36:51.951202 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:36:51.951550 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m06:36:51.952484 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m06:36:51.952854 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m06:36:51.958673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m06:36:51.959239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:36:51.964462 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:36:51.966278 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:36:51.966757 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:36:51.967213 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:36:51.967587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:51.967952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:56.991305 [debug] [ThreadPool]: SQL status: BEGIN in 5.023 seconds
[0m06:36:56.987422 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m06:36:57.008125 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:36:57.009310 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:36:57.003823 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:36:57.017367 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:36:57.019598 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m06:36:57.021774 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m06:36:57.035491 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:36:57.031475 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:36:57.036852 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:36:57.036090 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:36:57.069028 [debug] [MainThread]: Using postgres connection "master"
[0m06:36:57.069828 [debug] [MainThread]: On master: BEGIN
[0m06:36:57.070347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:36:57.075751 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:36:57.076532 [debug] [MainThread]: Using postgres connection "master"
[0m06:36:57.077851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:36:57.085271 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:36:57.087994 [debug] [MainThread]: On master: ROLLBACK
[0m06:36:57.088601 [debug] [MainThread]: Using postgres connection "master"
[0m06:36:57.089037 [debug] [MainThread]: On master: BEGIN
[0m06:36:57.089668 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:36:57.090224 [debug] [MainThread]: On master: COMMIT
[0m06:36:57.090651 [debug] [MainThread]: Using postgres connection "master"
[0m06:36:57.091025 [debug] [MainThread]: On master: COMMIT
[0m06:36:57.091520 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:36:57.091906 [debug] [MainThread]: On master: Close
[0m06:36:57.092862 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:36:57.093865 [info ] [MainThread]: 
[0m06:36:57.105984 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m06:36:57.106771 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m06:36:57.107386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m06:36:57.107833 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m06:36:57.108311 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m06:36:57.138014 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:36:57.138649 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m06:36:57.139096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:57.143876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:36:57.144462 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:36:57.144920 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m06:36:57.147565 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m06:36:57.213949 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:36:57.215065 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m06:36:57.216729 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m06:36:57.221507 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m06:36:57.243877 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m06:36:57.245328 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:36:57.245827 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m06:36:57.246985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:36:57.250172 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m06:36:57.252300 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.14s]
[0m06:36:57.253188 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m06:36:57.254582 [debug] [MainThread]: Using postgres connection "master"
[0m06:36:57.255035 [debug] [MainThread]: On master: BEGIN
[0m06:36:57.255396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:36:57.262117 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:36:57.271018 [debug] [MainThread]: On master: COMMIT
[0m06:36:57.273043 [debug] [MainThread]: Using postgres connection "master"
[0m06:36:57.274116 [debug] [MainThread]: On master: COMMIT
[0m06:36:57.274871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:36:57.275367 [debug] [MainThread]: On master: Close
[0m06:36:57.277135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:57.277484 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m06:36:57.277974 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:36:57.278406 [info ] [MainThread]: 
[0m06:36:57.278940 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m06:36:57.280029 [debug] [MainThread]: Command end result
[0m06:36:57.353877 [info ] [MainThread]: 
[0m06:36:57.354767 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:36:57.355303 [info ] [MainThread]: 
[0m06:36:57.356683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:36:57.358400 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.3675137, "process_user_time": 2.856386, "process_kernel_time": 0.129243, "process_mem_max_rss": "113220", "process_in_blocks": "24", "process_out_blocks": "3516"}
[0m06:36:57.359476 [debug] [MainThread]: Command `dbt seed` succeeded at 06:36:57.359379 after 7.37 seconds
[0m06:36:57.360024 [debug] [MainThread]: Flushing usage events
[0m06:38:06.616647 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:06.625861 | 6953fe95-ac44-4330-a856-aa940520489d ==============================
[0m06:38:06.625861 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:06.620564 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:38:06.628206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 06:38:06.630161 | 010a2193-d5cd-451d-b681-ab22b3f0a2fc ==============================
[0m06:38:06.630161 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:06.632001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m06:38:06.625142 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:38:06.629592 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:06.637230 | d87ff830-a929-43a2-b84d-47b2c0adf167 ==============================
[0m06:38:06.637230 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:38:06.637999 | 2c3997d6-7cd6-4b36-9118-7f5dbfec1c53 ==============================
[0m06:38:06.637999 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:06.638630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:38:06.641574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:38:06.637457 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:38:06.636749 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:06.645089 | 2db10cea-d17f-477f-a1bf-da5b958580af ==============================
[0m06:38:06.645089 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:06.646053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 06:38:06.647540 | fe858b0c-558c-47ea-9e6b-671bb8207a3d ==============================
[0m06:38:06.647540 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:06.654976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:38:06.669771 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:06.677324 | bdaac4f1-baff-437f-becd-4463ee1c691d ==============================
[0m06:38:06.677324 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:06.678504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'send_anonymous_usage_stats': 'True'}
[0m06:38:06.888320 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:06.903084 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:06.919865 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:06.936021 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:06.936122 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:06.955710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:06.958388 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:06.972843 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:06.997960 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:07.001591 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:07.014066 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:07.025135 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:07.034585 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:07.049126 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:07.109639 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:38:07.112058 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:38:07.124474 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:38:07.127460 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:38:07.174013 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:38:07.175889 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:38:07.179832 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:38:07.181353 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:38:07.196736 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:38:07.198501 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:38:07.201180 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:38:07.202104 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:38:07.205406 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:38:07.206572 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:38:09.395249 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:09.402746 [info ] [MainThread]: 
[0m06:38:09.407309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:09.415641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:09.513372 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:09.544293 [info ] [MainThread]: 
[0m06:38:09.556539 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:09.563636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:09.672267 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:09.680927 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:09.682626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:09.688112 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:09.692220 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:09.693750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:09.705998 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.023 seconds
[0m06:38:09.709645 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:09.714310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m06:38:09.717067 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m06:38:09.737987 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:38:09.740199 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m06:38:09.742058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:09.757428 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m06:38:09.760572 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:38:09.761900 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m06:38:09.764464 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m06:38:09.766484 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m06:38:09.767556 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:38:09.769588 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m06:38:09.777017 [debug] [ThreadPool]: SQL status: COMMIT in 0.006 seconds
[0m06:38:09.781991 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m06:38:09.809057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m06:38:09.811162 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:09.825876 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:09.838257 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:09.836293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:09.842899 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:09.841262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:09.846467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:09.863364 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m06:38:09.865005 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:09.866756 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:09.876496 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m06:38:09.879263 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:09.881151 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:09.898392 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:09.910014 [info ] [MainThread]: 
[0m06:38:09.917368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:09.924625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:09.953797 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:09.961744 [info ] [MainThread]: 
[0m06:38:09.964744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:09.968275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:10.014419 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:10.016187 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:10.017199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.032438 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.015 seconds
[0m06:38:10.035498 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:10.044570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:38:10.046214 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:10.051833 [info ] [MainThread]: 
[0m06:38:10.052538 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:10.046282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:10.053631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:10.054267 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:10.055328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.057066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:10.058186 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:10.061082 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:10.062573 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:10.063738 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:10.068501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:10.070434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.073956 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m06:38:10.079283 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:10.081284 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m06:38:10.083982 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:10.085333 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m06:38:10.086205 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:10.088926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:10.093627 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:10.096447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:38:10.099250 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m06:38:10.101032 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m06:38:10.097796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:38:10.102607 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:10.105689 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:10.106860 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:10.109330 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:10.112938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:10.113532 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:10.118678 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:10.121081 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:10.118340 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:10.121676 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:10.122132 [debug] [MainThread]: On master: BEGIN
[0m06:38:10.121014 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:10.123584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:10.123132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.122460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:10.124247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.141241 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m06:38:10.141718 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m06:38:10.144283 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:10.144061 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:10.145241 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:10.146143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:10.157589 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m06:38:10.164862 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:10.167793 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:10.168048 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m06:38:10.173179 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:10.176688 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:10.177936 [debug] [MainThread]: On master: BEGIN
[0m06:38:10.180579 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:38:10.181822 [debug] [MainThread]: On master: COMMIT
[0m06:38:10.182682 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:10.183447 [debug] [MainThread]: On master: COMMIT
[0m06:38:10.184241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:10.186713 [debug] [MainThread]: On master: Close
[0m06:38:10.187680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:10.189497 [info ] [MainThread]: 
[0m06:38:10.190391 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:10.195546 [info ] [MainThread]: 
[0m06:38:10.196822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:10.198398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:10.202741 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m06:38:10.202337 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:10.204548 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m06:38:10.206549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m06:38:10.207051 [info ] [MainThread]: 
[0m06:38:10.207671 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m06:38:10.208346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:10.210174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:10.222179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m06:38:10.234716 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m06:38:10.258669 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:10.261036 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:10.261262 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:10.262933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.263557 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:10.266574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.283374 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.021 seconds
[0m06:38:10.281893 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.015 seconds
[0m06:38:10.286170 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:10.287733 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:10.294795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:38:10.296489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:38:10.300188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m06:38:10.295708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:10.297559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:10.305744 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m06:38:10.303041 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:10.307738 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m06:38:10.303578 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:10.308412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:10.307199 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:10.307850 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:10.308274 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:10.308931 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:10.309890 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:10.310078 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:10.311189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:10.311610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:10.312188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.312709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:10.321242 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m06:38:10.322797 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m06:38:10.323721 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:10.327394 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m06:38:10.324874 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:10.329965 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:10.329738 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:10.331888 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:10.330993 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:10.335648 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m06:38:10.336283 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m06:38:10.336927 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m06:38:10.340076 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:10.338818 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:10.340733 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:10.340217 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:10.341231 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:10.342104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:10.348360 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:10.350886 [debug] [MainThread]: On master: BEGIN
[0m06:38:10.353959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:14.738306 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.042 seconds
[0m06:38:14.777828 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:14.809069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:38:14.810105 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:38:14.828753 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:14.829261 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:14.829654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:14.826076 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:14.830661 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:14.831111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:14.866083 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m06:38:14.869591 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:14.870385 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:14.873948 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:38:14.879777 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:14.880589 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:14.897904 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.898705 [debug] [MainThread]: On master: BEGIN
[0m06:38:14.899237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:14.914462 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:38:14.915386 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.916217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:14.922046 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:38:14.926197 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:14.927114 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.927890 [debug] [MainThread]: On master: BEGIN
[0m06:38:14.929022 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:14.929834 [debug] [MainThread]: On master: COMMIT
[0m06:38:14.930605 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:14.931043 [debug] [MainThread]: On master: COMMIT
[0m06:38:14.931514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:14.931954 [debug] [MainThread]: On master: Close
[0m06:38:14.933092 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:14.934058 [info ] [MainThread]: 
[0m06:38:14.951177 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m06:38:14.952155 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m06:38:14.953022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m06:38:14.953592 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m06:38:14.962991 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m06:38:14.964970 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m06:38:14.995455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m06:38:14.997341 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:38:14.997843 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m06:38:14.998269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:15.137051 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m06:38:15.137631 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m06:38:15.143120 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:15.143997 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:15.147109 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:38:15.147180 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:15.152385 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:15.153305 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:15.164673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:38:15.165726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:38:15.188243 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.191053 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.191964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:15.201627 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m06:38:15.202301 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.203156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:15.205590 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:15.203867 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:15.206435 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:15.206982 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:15.207521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:15.208193 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m06:38:15.208082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:15.210191 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:15.210686 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.211147 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.211859 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:15.212463 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.212886 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.213295 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.213821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:15.214223 [debug] [MainThread]: On master: Close
[0m06:38:15.215342 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:15.216384 [info ] [MainThread]: 
[0m06:38:15.229410 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m06:38:15.230288 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m06:38:15.230999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m06:38:15.231592 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m06:38:15.242622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m06:38:15.244060 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m06:38:15.279594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m06:38:15.281578 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:38:15.282243 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m06:38:15.282899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:15.294038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m06:38:15.297867 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:38:15.299947 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m06:38:15.310598 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:38:15.322906 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:38:15.325454 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m06:38:15.328703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:15.329209 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m06:38:15.333584 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m06:38:15.334905 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id as geography_key, cityname as city_name, countryname as country_name, regionname
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m06:38:15.334248 [debug] [ThreadPool]: SQL status: BEGIN in 5.021 seconds
[0m06:38:15.336544 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:15.337179 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:15.338307 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m06:38:15.340401 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:38:15.348076 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:15.349375 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:15.356826 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m06:38:15.357827 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:38:15.358596 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m06:38:15.361617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:38:15.372273 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m06:38:15.373685 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m06:38:15.372462 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m06:38:15.377536 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m06:38:15.378305 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.378706 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.379097 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:38:15.379097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:38:15.379492 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.379815 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m06:38:15.379464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:15.380417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:15.380981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:38:15.386351 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m06:38:15.387381 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m06:38:15.389492 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m06:38:15.392274 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m06:38:15.392192 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.393667 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m06:38:15.394404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:15.395213 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:15.396354 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.396940 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.397328 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.397788 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.398435 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:38:15.398369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:15.398658 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m06:38:15.399071 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.399721 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.400691 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.401319 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:15.401828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:15.402147 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.402048 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m06:38:15.402488 [debug] [MainThread]: On master: Close
[0m06:38:15.402660 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.402960 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m06:38:15.403896 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:15.404811 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:38:15.404622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:15.405904 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.406041 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.405836 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m06:38:15.406265 [info ] [MainThread]: 
[0m06:38:15.406503 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.406783 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.407494 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.407845 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.407674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:15.408486 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:15.409011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:15.409602 [debug] [MainThread]: On master: Close
[0m06:38:15.409841 [debug] [MainThread]: On master: Close
[0m06:38:15.410888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:15.411746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:15.412406 [info ] [MainThread]: 
[0m06:38:15.413139 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m06:38:15.413959 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:15.415367 [info ] [MainThread]: 
[0m06:38:15.417084 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m06:38:15.418536 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m06:38:15.418851 [debug] [MainThread]: Command end result
[0m06:38:15.419673 [info ] [MainThread]: 
[0m06:38:15.421215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:15.422136 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m06:38:15.422649 [info ] [MainThread]: 
[0m06:38:15.423925 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m06:38:15.423403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:15.424317 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m06:38:15.425042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m06:38:15.425150 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m06:38:15.425886 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m06:38:15.425852 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m06:38:15.426101 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:38:15.426560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.856839, "process_user_time": 4.63292, "process_kernel_time": 0.32912, "process_mem_max_rss": "112932", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m06:38:15.426907 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m06:38:15.428063 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:15.427899 after 8.86 seconds
[0m06:38:15.428520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m06:38:15.429423 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m06:38:15.432234 [debug] [MainThread]: Flushing usage events
[0m06:38:15.444538 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m06:38:15.461251 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.24s]
[0m06:38:15.465907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m06:38:15.466210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m06:38:15.466580 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m06:38:15.469841 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m06:38:15.470307 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m06:38:15.472241 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.474313 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.475490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:15.486711 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:38:15.488571 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.490021 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.491330 [debug] [MainThread]: On master: COMMIT
[0m06:38:15.492688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:15.494932 [debug] [MainThread]: On master: Close
[0m06:38:15.497636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:15.500518 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:15.502647 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m06:38:15.505459 [info ] [MainThread]: 
[0m06:38:15.509143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m06:38:15.512183 [debug] [MainThread]: Command end result
[0m06:38:15.513499 [info ] [MainThread]: 
[0m06:38:15.516613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:15.519346 [info ] [MainThread]: 
[0m06:38:15.521709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:15.531341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.967955, "process_user_time": 4.696986, "process_kernel_time": 0.335643, "process_mem_max_rss": "112664", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m06:38:15.537183 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:15.536594 after 8.98 seconds
[0m06:38:15.540399 [debug] [MainThread]: Flushing usage events
[0m06:38:15.552786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m06:38:15.557490 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:38:15.559307 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m06:38:15.560473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:15.565334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m06:38:15.570426 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:38:15.571375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m06:38:15.571956 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m06:38:15.572576 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:38:15.573228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:15.574041 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m06:38:15.578245 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:38:15.589112 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:38:15.589983 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m06:38:15.591449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:38:15.612442 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m06:38:15.613350 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:38:15.614283 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m06:38:15.615665 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:15.623268 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m06:38:15.628051 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:38:15.628685 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m06:38:15.629513 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:38:15.642466 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m06:38:15.650618 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.22s]
[0m06:38:15.652948 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m06:38:15.658021 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:15.659040 [debug] [MainThread]: On master: BEGIN
[0m06:38:15.660061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:19.854310 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m06:38:19.857502 [debug] [ThreadPool]: SQL status: BEGIN in 5.028 seconds
[0m06:38:19.863135 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:19.863829 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:19.859838 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:19.866835 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:19.869228 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m06:38:19.875561 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:19.876054 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m06:38:19.878874 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:19.877095 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:19.879899 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:19.896144 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:19.897347 [debug] [MainThread]: On master: BEGIN
[0m06:38:19.898141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:19.906518 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:38:19.907903 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:19.908875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:19.916295 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m06:38:19.920569 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:19.921918 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:19.922584 [debug] [MainThread]: On master: BEGIN
[0m06:38:19.927094 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:19.927630 [debug] [MainThread]: On master: COMMIT
[0m06:38:19.928124 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:19.928538 [debug] [MainThread]: On master: COMMIT
[0m06:38:19.929112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:19.929508 [debug] [MainThread]: On master: Close
[0m06:38:19.930723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:19.931634 [info ] [MainThread]: 
[0m06:38:19.950286 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m06:38:19.953231 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m06:38:19.954001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m06:38:19.956682 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m06:38:19.968299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m06:38:19.969817 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m06:38:20.003012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m06:38:20.004366 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:38:20.005067 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m06:38:20.005843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:20.007231 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m06:38:20.010407 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:38:20.010718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:38:20.011191 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m06:38:20.011543 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:38:20.012140 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m06:38:20.014518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m06:38:20.016547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:38:20.026705 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:38:20.027534 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m06:38:20.028509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:20.034402 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:38:20.035292 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m06:38:20.038128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:38:20.050162 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m06:38:20.053286 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:38:20.056152 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m06:38:20.057656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:20.058852 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m06:38:20.059423 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:38:20.059899 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m06:38:20.060881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:38:20.064613 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m06:38:20.067466 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m06:38:20.071609 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:38:20.073880 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m06:38:20.076149 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:38:20.080930 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:38:20.081172 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m06:38:20.081678 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m06:38:20.083876 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m06:38:20.084725 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m06:38:20.085250 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:38:20.087124 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:20.089137 [debug] [MainThread]: On master: BEGIN
[0m06:38:20.090111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:20.091339 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m06:38:20.094843 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.14s]
[0m06:38:20.096265 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m06:38:20.100232 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:20.100795 [debug] [MainThread]: On master: BEGIN
[0m06:38:20.101220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:20.220509 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m06:38:20.222280 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m06:38:20.223720 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:20.224269 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:20.223178 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:20.224984 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:20.226747 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:38:20.231110 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:20.231467 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m06:38:20.231988 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:20.233456 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:20.236172 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:20.248716 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:20.249294 [debug] [MainThread]: On master: BEGIN
[0m06:38:20.249713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:20.595139 [debug] [Thread-1 (]: SQL status: BEGIN in 5.020 seconds
[0m06:38:20.598739 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:38:20.599606 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m06:38:20.679115 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m06:38:20.682212 [debug] [MainThread]: On master: COMMIT
[0m06:38:20.682884 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:20.683404 [debug] [MainThread]: On master: COMMIT
[0m06:38:20.683965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:20.684598 [debug] [MainThread]: On master: Close
[0m06:38:20.687182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:20.687680 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m06:38:20.688217 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:38:20.689466 [info ] [MainThread]: 
[0m06:38:20.690335 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.48 seconds (10.48s).
[0m06:38:20.692571 [debug] [MainThread]: Command end result
[0m06:38:20.693177 [info ] [MainThread]: 
[0m06:38:20.694167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:20.694656 [info ] [MainThread]: 
[0m06:38:20.695231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:20.698978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.1001625, "process_user_time": 4.897585, "process_kernel_time": 0.35565, "process_mem_max_rss": "112344", "process_out_blocks": "1180", "process_in_blocks": "0"}
[0m06:38:20.700994 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:20.700824 after 14.10 seconds
[0m06:38:20.702192 [debug] [MainThread]: Flushing usage events
[0m06:38:20.984995 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.384 seconds
[0m06:38:21.017067 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:38:21.017848 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m06:38:21.019174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:38:21.055644 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m06:38:21.063012 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:38:21.063528 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m06:38:21.074144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m06:38:21.116450 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m06:38:21.129927 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:38:21.131728 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m06:38:21.134898 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:38:21.143901 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m06:38:21.148213 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 5.72s]
[0m06:38:21.150349 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m06:38:21.157022 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:21.162950 [debug] [MainThread]: On master: BEGIN
[0m06:38:21.163819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:21.182721 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m06:38:21.183594 [debug] [MainThread]: On master: COMMIT
[0m06:38:21.184411 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:21.184981 [debug] [MainThread]: On master: COMMIT
[0m06:38:21.185535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:21.185960 [debug] [MainThread]: On master: Close
[0m06:38:21.186740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:21.187292 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:21.187757 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m06:38:21.188468 [info ] [MainThread]: 
[0m06:38:21.189156 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.99 seconds (10.99s).
[0m06:38:21.190341 [debug] [MainThread]: Command end result
[0m06:38:21.193657 [info ] [MainThread]: 
[0m06:38:21.196145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:21.197935 [info ] [MainThread]: 
[0m06:38:21.199066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:21.203198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.66297, "process_user_time": 4.949334, "process_kernel_time": 0.350965, "process_mem_max_rss": "112436", "process_out_blocks": "1192", "process_in_blocks": "0"}
[0m06:38:21.205801 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:21.205610 after 14.67 seconds
[0m06:38:21.207474 [debug] [MainThread]: Flushing usage events
[0m06:38:23.837620 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:38:23.838707 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:23.843843 | f62e8922-f7d9-422e-b17f-93539938170d ==============================
[0m06:38:23.843843 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:38:23.844563 | 6d51a9b2-588f-4835-af4e-d1b1ad215bd2 ==============================
[0m06:38:23.844563 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:23.846185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:38:23.845587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:38:23.880305 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:23.886642 | d741953a-6cca-4383-aa45-744ad670f9ab ==============================
[0m06:38:23.886642 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:23.887503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m06:38:24.056409 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:24.057859 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:24.073395 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:24.076904 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:24.086675 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:24.107811 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:24.332908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:24.333610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:24.342692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:24.343318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:24.361212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:24.361953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:24.401798 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:24.403525 [info ] [MainThread]: 
[0m06:38:24.404159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:24.405062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:24.413086 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:24.420257 [info ] [MainThread]: 
[0m06:38:24.421317 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:24.424745 [debug] [MainThread]: Command end result
[0m06:38:24.426325 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6335085, "process_user_time": 1.607778, "process_kernel_time": 0.193973, "process_mem_max_rss": "97340", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:24.427420 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:24.427262 after 0.63 seconds
[0m06:38:24.428082 [debug] [MainThread]: Flushing usage events
[0m06:38:24.437806 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:24.440236 [info ] [MainThread]: 
[0m06:38:24.441619 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:24.446887 [debug] [MainThread]: Command end result
[0m06:38:24.448571 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.61975825, "process_user_time": 1.634833, "process_kernel_time": 0.139326, "process_mem_max_rss": "97616", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:24.449866 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:24.449666 after 0.62 seconds
[0m06:38:24.450783 [debug] [MainThread]: Flushing usage events
[0m06:38:24.462070 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:24.466135 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:24.467371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:24.484979 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.018 seconds
[0m06:38:24.486608 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:24.492103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:38:24.492813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:24.499001 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:24.501293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:24.502011 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:24.502603 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:24.503173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:24.503682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:25.101828 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m06:38:25.111733 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.115815 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:25.118657 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.119978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:25.122847 [debug] [MainThread]: On master: Close
[0m06:38:25.133818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:25.140880 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m06:38:25.142517 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:25.125543 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m06:38:25.150573 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.150126 [info ] [MainThread]: 
[0m06:38:25.152036 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:25.153625 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.59 seconds (15.59s).
[0m06:38:25.154588 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.159499 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:38:25.163087 [debug] [MainThread]: On master: Close
[0m06:38:25.170448 [debug] [MainThread]: Command end result
[0m06:38:25.172756 [info ] [MainThread]: 
[0m06:38:25.174134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:25.174417 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:25.175197 [info ] [MainThread]: 
[0m06:38:25.175623 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m06:38:25.176268 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:25.176804 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:38:25.180920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.648895, "process_user_time": 4.489038, "process_kernel_time": 0.40514, "process_mem_max_rss": "112752", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m06:38:25.181976 [info ] [MainThread]: 
[0m06:38:25.183097 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:25.182754 after 18.65 seconds
[0m06:38:25.184694 [debug] [MainThread]: Flushing usage events
[0m06:38:25.185756 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.78 seconds (15.78s).
[0m06:38:25.190352 [debug] [MainThread]: Command end result
[0m06:38:25.194335 [info ] [MainThread]: 
[0m06:38:25.196260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:25.197969 [info ] [MainThread]: 
[0m06:38:25.199001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:25.204810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.664175, "process_user_time": 4.501199, "process_kernel_time": 0.377185, "process_mem_max_rss": "112704", "process_out_blocks": "1182", "process_in_blocks": "0"}
[0m06:38:25.209323 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:25.209035 after 18.67 seconds
[0m06:38:25.211974 [debug] [MainThread]: Flushing usage events
[0m06:38:25.277846 [debug] [MainThread]: SQL status: BEGIN in 5.025 seconds
[0m06:38:25.288829 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:25.293539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:25.309140 [debug] [MainThread]: SQL status: SELECT 4 in 0.012 seconds
[0m06:38:25.363506 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:25.366498 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:25.367317 [debug] [MainThread]: On master: BEGIN
[0m06:38:25.369101 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:38:25.370832 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.372645 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:25.374955 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.376659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:25.378939 [debug] [MainThread]: On master: Close
[0m06:38:25.386078 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:25.389737 [info ] [MainThread]: 
[0m06:38:25.443789 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m06:38:25.451364 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m06:38:25.454616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m06:38:25.456237 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m06:38:25.527184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m06:38:25.543578 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m06:38:25.658623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m06:38:25.667644 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:38:25.669298 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m06:38:25.671500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:25.700663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m06:38:25.702872 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:38:25.704795 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m06:38:25.717465 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m06:38:25.731638 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:38:25.733038 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m06:38:25.735506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:38:25.753716 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m06:38:25.754703 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:38:25.755711 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m06:38:25.758964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:25.767616 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m06:38:25.778415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:38:25.781515 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m06:38:25.785097 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:38:25.796482 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m06:38:25.802578 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.35s]
[0m06:38:25.804987 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m06:38:25.809118 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:25.810047 [debug] [MainThread]: On master: BEGIN
[0m06:38:25.811234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:25.819570 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:38:25.820439 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.820891 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:25.821300 [debug] [MainThread]: On master: COMMIT
[0m06:38:25.821843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:25.822574 [debug] [MainThread]: On master: Close
[0m06:38:25.823447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:25.824740 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:38:25.828080 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m06:38:25.830024 [info ] [MainThread]: 
[0m06:38:25.831994 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.78 seconds (15.78s).
[0m06:38:25.833380 [debug] [MainThread]: Command end result
[0m06:38:25.836006 [info ] [MainThread]: 
[0m06:38:25.837369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:25.840895 [info ] [MainThread]: 
[0m06:38:25.841589 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:25.845019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.263315, "process_user_time": 4.874164, "process_kernel_time": 0.384401, "process_mem_max_rss": "112696", "process_out_blocks": "1181", "process_in_blocks": "0"}
[0m06:38:25.847877 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:25.847614 after 19.27 seconds
[0m06:38:25.849497 [debug] [MainThread]: Flushing usage events
[0m06:38:28.645700 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:28.653752 | 5afdbcb5-07d1-4c8b-8946-11fca87c41fe ==============================
[0m06:38:28.653752 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:28.657963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'send_anonymous_usage_stats': 'True'}
[0m06:38:28.655291 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:28.665352 | 44f2616b-accb-4283-85ad-873fd08ef479 ==============================
[0m06:38:28.665352 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:28.666500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m06:38:28.889173 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:28.898414 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:28.914165 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:28.921719 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:29.087853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:29.088548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:29.107510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:29.108069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:29.159931 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:29.161870 [info ] [MainThread]: 
[0m06:38:29.163858 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:29.165426 [debug] [MainThread]: Command end result
[0m06:38:29.166197 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6374487, "process_user_time": 1.408592, "process_kernel_time": 0.119987, "process_mem_max_rss": "97716", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:29.166755 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:29.166684 after 0.64 seconds
[0m06:38:29.167102 [debug] [MainThread]: Flushing usage events
[0m06:38:29.183803 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:29.186622 [info ] [MainThread]: 
[0m06:38:29.187532 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:29.190238 [debug] [MainThread]: Command end result
[0m06:38:29.191790 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.64941627, "process_user_time": 1.432692, "process_kernel_time": 0.12502, "process_mem_max_rss": "97484", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:29.192654 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:29.192545 after 0.65 seconds
[0m06:38:29.193740 [debug] [MainThread]: Flushing usage events
[0m06:38:29.513943 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m06:38:29.516312 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m06:38:29.517873 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:29.518283 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:29.517394 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:29.518786 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:29.522294 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m06:38:29.522696 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m06:38:29.529892 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:29.528094 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:29.533999 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:29.534347 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:29.550475 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:29.551006 [debug] [MainThread]: On master: BEGIN
[0m06:38:29.551535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:33.882570 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:33.905061 | 5519f6d1-c341-47b5-8458-f248d163f2bc ==============================
[0m06:38:33.905061 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:33.907978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m06:38:33.996565 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:34.005051 | 1a43d50c-928b-466e-94b2-26aa715ece7d ==============================
[0m06:38:34.005051 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:34.006712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:38:34.059626 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:34.066464 | 5cbf94f2-1e7a-44c8-a2e5-47832cb45e1e ==============================
[0m06:38:34.066464 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:34.060774 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:38:34.063947 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:38:34.070202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 06:38:34.071404 | 189c2126-7062-40f8-a5d3-fcb5452944d0 ==============================
[0m06:38:34.071404 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:38:34.071786 | d32aea97-1bda-4eb8-851a-21c60cf54f45 ==============================
[0m06:38:34.071786 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:34.073194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:38:34.074119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:38:34.119070 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:34.142264 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:34.246181 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:34.270607 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:34.277349 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:34.283296 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:34.287569 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:34.308306 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:34.321003 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:34.341221 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:34.439756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:34.441840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:34.479024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:34.479695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:34.524947 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:34.527633 [info ] [MainThread]: 
[0m06:38:34.528621 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:34.529782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:34.555284 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:34.558697 [info ] [MainThread]: 
[0m06:38:34.560112 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:34.561508 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m06:38:34.566468 [debug] [MainThread]: Command end result
[0m06:38:34.566263 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.570849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:34.570997 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6339965, "process_user_time": 1.613861, "process_kernel_time": 0.172238, "process_mem_max_rss": "97516", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:34.572076 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:34.571951 after 0.64 seconds
[0m06:38:34.572934 [debug] [MainThread]: Flushing usage events
[0m06:38:34.573810 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:34.575269 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:34.577172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:34.579952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:34.580617 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m06:38:34.581274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:34.591641 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:34.594870 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.596391 [debug] [MainThread]: On master: BEGIN
[0m06:38:34.599305 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:38:34.600112 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.023 seconds
[0m06:38:34.601305 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.602919 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.604205 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.604109 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:34.606046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:34.606254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:34.607189 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:34.607583 [debug] [MainThread]: On master: Close
[0m06:38:34.613703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:34.615067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:38:34.615995 [info ] [MainThread]: 
[0m06:38:34.616202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:38:34.627881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:34.629124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:34.624024 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:34.629488 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:34.631521 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:34.632438 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:34.633208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:34.634054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:34.634578 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m06:38:34.637789 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m06:38:34.641991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m06:38:34.644053 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m06:38:34.644867 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m06:38:34.645629 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m06:38:34.647943 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:34.650251 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:34.651177 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:34.651972 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:34.656858 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m06:38:34.657647 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m06:38:34.663117 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m06:38:34.660980 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:34.663128 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:34.665228 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:34.666599 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m06:38:34.666167 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:34.672489 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:34.674223 [info ] [MainThread]: 
[0m06:38:34.677176 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:34.680085 [debug] [MainThread]: Command end result
[0m06:38:34.680157 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.682093 [debug] [MainThread]: On master: BEGIN
[0m06:38:34.681656 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6779624, "process_user_time": 1.655566, "process_kernel_time": 0.142164, "process_mem_max_rss": "97584", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:34.682986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:34.684280 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:34.684161 after 0.68 seconds
[0m06:38:34.687766 [debug] [MainThread]: Flushing usage events
[0m06:38:34.699447 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m06:38:34.701227 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.702586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:34.707036 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:34.708459 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m06:38:34.710748 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:34.710601 [info ] [MainThread]: 
[0m06:38:34.712518 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.712300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:34.713307 [debug] [MainThread]: On master: BEGIN
[0m06:38:34.713407 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:34.714978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:34.715571 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:34.716483 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.716762 [info ] [MainThread]: 
[0m06:38:34.717886 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.718879 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:34.719137 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.720728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m06:38:34.721301 [debug] [MainThread]: Command end result
[0m06:38:34.721533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:34.722547 [debug] [MainThread]: On master: Close
[0m06:38:34.722717 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.716549, "process_user_time": 1.676665, "process_kernel_time": 0.142694, "process_mem_max_rss": "97484", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:34.723999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:34.724905 [info ] [MainThread]: 
[0m06:38:34.725269 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:34.724927 after 0.72 seconds
[0m06:38:34.730362 [debug] [MainThread]: Flushing usage events
[0m06:38:34.730574 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:38:34.731575 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m06:38:34.732549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:34.734221 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m06:38:34.735884 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m06:38:34.737890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m06:38:34.738951 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m06:38:34.743313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m06:38:34.744868 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:38:34.748873 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m06:38:34.751198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m06:38:34.751802 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:34.753287 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m06:38:34.752852 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:34.755572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:38:34.757868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:34.764605 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:38:34.766755 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m06:38:34.768651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:38:34.781653 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m06:38:34.782528 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:38:34.784030 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m06:38:34.790413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:38:34.791710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m06:38:34.797071 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m06:38:34.801274 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:38:34.802137 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:38:34.802649 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m06:38:34.803435 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m06:38:34.803899 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:38:34.804371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:34.811937 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m06:38:34.814226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m06:38:34.815146 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.17s]
[0m06:38:34.816005 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:38:34.816654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m06:38:34.817225 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m06:38:34.819766 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.819838 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:38:34.820372 [debug] [MainThread]: On master: BEGIN
[0m06:38:34.823550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:34.826728 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:38:34.827542 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m06:38:34.829181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:38:34.833747 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m06:38:34.837840 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.838517 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.839255 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.842953 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:34.843372 [debug] [MainThread]: On master: Close
[0m06:38:34.843885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:34.844462 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m06:38:34.844961 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:38:34.845470 [info ] [MainThread]: 
[0m06:38:34.846267 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.44 seconds (10.44s).
[0m06:38:34.847418 [debug] [MainThread]: Command end result
[0m06:38:34.848082 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m06:38:34.847996 [info ] [MainThread]: 
[0m06:38:34.848647 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:38:34.849365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:34.849994 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m06:38:34.850455 [info ] [MainThread]: 
[0m06:38:34.851920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:34.852824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:38:34.860107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.070003, "process_user_time": 1.913634, "process_kernel_time": 0.199025, "process_mem_max_rss": "105980", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m06:38:34.862983 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:34.862615 after 11.07 seconds
[0m06:38:34.864309 [debug] [MainThread]: Flushing usage events
[0m06:38:34.866198 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m06:38:34.879400 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:38:34.885510 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m06:38:34.891287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:38:34.894655 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m06:38:34.897086 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m06:38:34.898759 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m06:38:34.901304 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.902801 [debug] [MainThread]: On master: BEGIN
[0m06:38:34.903338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:34.910346 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:38:34.916388 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.919217 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:34.919696 [debug] [MainThread]: On master: COMMIT
[0m06:38:34.920218 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:34.920605 [debug] [MainThread]: On master: Close
[0m06:38:34.922495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:34.924931 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m06:38:34.927976 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:34.928620 [info ] [MainThread]: 
[0m06:38:34.929370 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m06:38:34.930283 [debug] [MainThread]: Command end result
[0m06:38:34.931250 [info ] [MainThread]: 
[0m06:38:34.933276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:34.936038 [info ] [MainThread]: 
[0m06:38:34.937892 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:34.939979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1174499, "process_user_time": 1.954569, "process_kernel_time": 0.184905, "process_mem_max_rss": "106168", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m06:38:34.943811 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:34.943625 after 1.12 seconds
[0m06:38:34.945533 [debug] [MainThread]: Flushing usage events
[0m06:38:39.775872 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.016 seconds
[0m06:38:39.803998 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:39.829469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:38:39.830315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:38:39.860045 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:39.873848 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:39.861229 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:39.874909 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:39.878665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:39.874536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:39.892955 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:38:39.893398 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:39.893791 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:39.899562 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m06:38:39.902374 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:39.913071 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:44.077466 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:38:44.080571 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:44.085231 | 51ccccf3-6991-46e2-a078-9d48d71ab3df ==============================
[0m06:38:44.085231 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:44.086616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:38:44.081779 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:44.087809 | b2f27346-cb84-4656-9943-7c2aa4f38d19 ==============================
[0m06:38:44.087809 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:44.088998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 06:38:44.089619 | 1dce98e4-95bc-4102-93d1-e85cb358ba4a ==============================
[0m06:38:44.089619 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:44.094947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m06:38:44.097881 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:44.103948 | b86dc29b-8390-4369-b432-dc967090cb00 ==============================
[0m06:38:44.103948 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:44.104768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:38:44.412538 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:44.434295 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:44.451156 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:44.463192 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:44.462717 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:44.484158 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:44.489072 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:44.496947 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:44.674022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:44.674584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:44.697597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:44.698233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:44.711425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:44.712067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:44.723241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:44.723910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:44.747327 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:44.749070 [info ] [MainThread]: 
[0m06:38:44.749721 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:44.751512 [debug] [MainThread]: Command end result
[0m06:38:44.752398 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.72689617, "process_user_time": 1.980032, "process_kernel_time": 0.249306, "process_mem_max_rss": "97732", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:44.753256 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:44.753098 after 0.73 seconds
[0m06:38:44.753922 [debug] [MainThread]: Flushing usage events
[0m06:38:44.761402 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:44.763750 [info ] [MainThread]: 
[0m06:38:44.764945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:44.766155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:44.774031 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:44.775910 [info ] [MainThread]: 
[0m06:38:44.776782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:44.777758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:44.795990 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:44.798065 [info ] [MainThread]: 
[0m06:38:44.798781 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:44.800518 [debug] [MainThread]: Command end result
[0m06:38:44.801475 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.75721127, "process_user_time": 1.936523, "process_kernel_time": 0.242455, "process_mem_max_rss": "97424", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:44.801522 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:44.802124 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:44.802247 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:44.802149 after 0.76 seconds
[0m06:38:44.802571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:44.802926 [debug] [MainThread]: Flushing usage events
[0m06:38:44.807319 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:44.808401 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:44.810708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:44.821927 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m06:38:44.823857 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:44.832897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:38:44.833853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:38:44.840342 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:44.842610 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:44.843627 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:44.844188 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:44.844769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:44.845396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:44.853962 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:38:44.854387 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:38:44.855307 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:44.856199 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:44.856896 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:44.857494 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:44.861103 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m06:38:44.861410 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:38:44.862719 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:44.863841 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:44.864610 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:44.865146 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:44.873873 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.874467 [debug] [MainThread]: On master: BEGIN
[0m06:38:44.874874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:44.880510 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:38:44.881186 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.881665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:44.887529 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m06:38:44.889480 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:44.891502 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.893315 [debug] [MainThread]: On master: BEGIN
[0m06:38:44.897277 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:44.898075 [debug] [MainThread]: On master: COMMIT
[0m06:38:44.898627 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.899117 [debug] [MainThread]: On master: COMMIT
[0m06:38:44.899746 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:44.900230 [debug] [MainThread]: On master: Close
[0m06:38:44.896232 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m06:38:44.902247 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:44.901328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:44.903170 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:44.903659 [info ] [MainThread]: 
[0m06:38:44.906252 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m06:38:44.911968 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m06:38:44.914056 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:44.914151 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m06:38:44.915031 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:44.915082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_salesagent)
[0m06:38:44.917916 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m06:38:44.937304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m06:38:44.945962 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m06:38:44.946395 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.950889 [debug] [MainThread]: On master: BEGIN
[0m06:38:44.952846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:44.963088 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m06:38:44.964868 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.965922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:44.968961 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m06:38:44.973146 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:44.973949 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.974464 [debug] [MainThread]: On master: BEGIN
[0m06:38:44.975389 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:44.976113 [debug] [MainThread]: On master: COMMIT
[0m06:38:44.976635 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:44.977020 [debug] [MainThread]: On master: COMMIT
[0m06:38:44.977977 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:38:44.978539 [debug] [MainThread]: On master: Close
[0m06:38:44.979780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:44.981140 [info ] [MainThread]: 
[0m06:38:44.988984 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m06:38:44.995711 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:38:44.996739 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m06:38:45.001711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:45.021744 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m06:38:45.028961 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m06:38:45.031868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m06:38:45.030568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m06:38:45.032524 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:38:45.032876 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m06:38:45.032983 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    reseller_id AS sales_agent_key, 
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"

UNION ALL

SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m06:38:45.039186 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m06:38:45.047898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m06:38:45.051760 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m06:38:45.058519 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:38:45.063593 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m06:38:45.068493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:45.094085 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m06:38:45.095444 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:38:45.097384 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m06:38:45.099478 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:45.103240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m06:38:45.104395 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:38:45.104880 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m06:38:45.105348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:45.107157 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m06:38:45.110964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:38:45.111557 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:38:45.112198 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:38:45.112775 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m06:38:45.113415 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m06:38:45.114138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:38:45.116967 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m06:38:45.119750 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.20s]
[0m06:38:45.120630 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:38:45.121709 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m06:38:45.129336 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:45.131885 [debug] [MainThread]: On master: BEGIN
[0m06:38:45.132640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:45.132266 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:38:45.134223 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m06:38:45.135527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:45.156075 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m06:38:45.156815 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:38:45.157446 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m06:38:45.158952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:45.166766 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m06:38:45.171376 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:38:45.171980 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m06:38:45.172665 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:38:45.177385 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m06:38:45.179668 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m06:38:45.180474 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m06:38:45.182638 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:45.183251 [debug] [MainThread]: On master: BEGIN
[0m06:38:45.183630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:45.188706 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:45.189248 [debug] [MainThread]: On master: COMMIT
[0m06:38:45.189694 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:45.190096 [debug] [MainThread]: On master: COMMIT
[0m06:38:45.190551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:45.191016 [debug] [MainThread]: On master: Close
[0m06:38:45.191756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:45.192213 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:38:45.192726 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m06:38:45.193290 [info ] [MainThread]: 
[0m06:38:45.193921 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.48 seconds (10.48s).
[0m06:38:45.195016 [debug] [MainThread]: Command end result
[0m06:38:45.195477 [info ] [MainThread]: 
[0m06:38:45.196187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:45.196624 [info ] [MainThread]: 
[0m06:38:45.197214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:45.198944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.204385, "process_user_time": 1.971901, "process_kernel_time": 0.180468, "process_mem_max_rss": "106260", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m06:38:45.200018 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:45.199903 after 11.21 seconds
[0m06:38:45.200658 [debug] [MainThread]: Flushing usage events
[0m06:38:49.817284 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m06:38:49.822714 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:49.831345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:38:49.831992 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:49.848222 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:49.851320 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:49.851724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:49.850858 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:49.852520 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:49.853188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:49.856708 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:38:49.857266 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:49.857747 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:49.860216 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m06:38:49.861738 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:49.862282 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:50.145058 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m06:38:50.147082 [debug] [MainThread]: On master: COMMIT
[0m06:38:50.147701 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:50.148134 [debug] [MainThread]: On master: COMMIT
[0m06:38:50.148605 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:50.149095 [debug] [MainThread]: On master: Close
[0m06:38:50.150384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:50.150813 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m06:38:50.151247 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:50.152098 [info ] [MainThread]: 
[0m06:38:50.152845 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m06:38:50.154478 [debug] [MainThread]: Command end result
[0m06:38:50.155050 [info ] [MainThread]: 
[0m06:38:50.155766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:50.156169 [info ] [MainThread]: 
[0m06:38:50.156651 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:50.158910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.13276, "process_user_time": 2.172094, "process_kernel_time": 0.213256, "process_mem_max_rss": "106740", "process_out_blocks": "31", "process_in_blocks": "0"}
[0m06:38:50.159989 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:50.159833 after 6.13 seconds
[0m06:38:50.160683 [debug] [MainThread]: Flushing usage events
[0m06:38:52.687131 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:52.699125 | 52af9075-359d-46d5-ab7b-8f6e29e60b38 ==============================
[0m06:38:52.699125 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:52.701705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:38:52.702311 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:52.746121 | e7cc9fd0-4c47-496d-bd13-3ef5939049d0 ==============================
[0m06:38:52.746121 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:52.756179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:38:52.980383 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:52.980382 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:52.995731 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:52.995735 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:53.158740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:53.158984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:53.159320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:53.159665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:53.225459 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:53.227354 [info ] [MainThread]: 
[0m06:38:53.228116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:53.229240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:53.233127 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:53.234709 [info ] [MainThread]: 
[0m06:38:53.235165 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:53.236702 [debug] [MainThread]: Command end result
[0m06:38:53.237633 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58787423, "process_user_time": 1.385699, "process_kernel_time": 0.118918, "process_mem_max_rss": "97584", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:53.238558 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:53.238407 after 0.59 seconds
[0m06:38:53.239135 [debug] [MainThread]: Flushing usage events
[0m06:38:53.262126 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:53.263011 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:53.263556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:53.273023 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m06:38:53.274320 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:53.279455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:38:53.280109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:53.286030 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:53.288268 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:53.288825 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:53.289325 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:53.289785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:53.290172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:53.295138 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:38:53.295792 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:53.296384 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:53.299102 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m06:38:53.300594 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:53.310485 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:54.864699 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m06:38:54.866336 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:54.867041 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:54.870287 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:38:54.876101 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:54.876827 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:54.890505 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:54.891138 [debug] [MainThread]: On master: BEGIN
[0m06:38:54.891489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:54.897000 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:54.897588 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:54.898156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:54.902412 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m06:38:54.904600 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:54.905109 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:54.905449 [debug] [MainThread]: On master: BEGIN
[0m06:38:54.906090 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:54.906692 [debug] [MainThread]: On master: COMMIT
[0m06:38:54.907205 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:54.908522 [debug] [MainThread]: On master: COMMIT
[0m06:38:54.909780 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:54.910334 [debug] [MainThread]: On master: Close
[0m06:38:54.911449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:54.913579 [info ] [MainThread]: 
[0m06:38:54.931089 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m06:38:54.931985 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m06:38:54.932800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m06:38:54.933483 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m06:38:54.942877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m06:38:54.944368 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m06:38:54.976852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m06:38:54.982767 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:38:54.983238 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m06:38:54.983624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:54.987982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:38:54.988460 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:38:54.988885 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m06:38:54.992305 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m06:38:54.997779 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:38:54.998796 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m06:38:55.003131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:55.022086 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m06:38:55.025884 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:38:55.026488 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m06:38:55.027570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:55.033650 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m06:38:55.038471 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:38:55.039135 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m06:38:55.039940 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:38:55.042956 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m06:38:55.045634 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.11s]
[0m06:38:55.046579 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m06:38:55.048268 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:55.048794 [debug] [MainThread]: On master: BEGIN
[0m06:38:55.049285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:55.053857 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:55.054281 [debug] [MainThread]: On master: COMMIT
[0m06:38:55.054598 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:55.054918 [debug] [MainThread]: On master: COMMIT
[0m06:38:55.055377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:55.055700 [debug] [MainThread]: On master: Close
[0m06:38:55.056096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:55.056396 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:55.056707 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m06:38:55.057218 [info ] [MainThread]: 
[0m06:38:55.057697 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m06:38:55.058382 [debug] [MainThread]: Command end result
[0m06:38:55.058753 [info ] [MainThread]: 
[0m06:38:55.059285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:55.059666 [info ] [MainThread]: 
[0m06:38:55.060206 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:55.062008 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.034374, "process_user_time": 2.177271, "process_kernel_time": 0.25283, "process_mem_max_rss": "106352", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m06:38:55.062894 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:55.062789 after 11.04 seconds
[0m06:38:55.063388 [debug] [MainThread]: Flushing usage events
[0m06:38:57.816868 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:57.822683 | 848496a0-6fa0-4762-bd44-c433c17de378 ==============================
[0m06:38:57.822683 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:57.823331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}
[0m06:38:57.919252 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:38:57.924562 | 3f88663c-3842-4128-a38a-6b76cf48c6da ==============================
[0m06:38:57.924562 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:38:57.925875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:38:58.004206 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:58.020010 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:58.091362 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:38:58.110869 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:38:58.181423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:58.182040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:58.246075 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:58.250432 [info ] [MainThread]: 
[0m06:38:58.252809 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:38:58.255961 [debug] [MainThread]: Command end result
[0m06:38:58.260281 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48163557, "process_user_time": 1.31916, "process_kernel_time": 0.126206, "process_mem_max_rss": "97484", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:38:58.261654 [debug] [MainThread]: Command `dbt test` succeeded at 06:38:58.261529 after 0.48 seconds
[0m06:38:58.262218 [debug] [MainThread]: Flushing usage events
[0m06:38:58.287393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:38:58.289381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:38:58.309220 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m06:38:58.318245 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:58.318931 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:58.321809 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:38:58.326542 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:58.327101 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:58.340893 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:58.341765 [debug] [MainThread]: On master: BEGIN
[0m06:38:58.342192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:58.369786 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:38:58.371605 [info ] [MainThread]: 
[0m06:38:58.372378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:38:58.373404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:38:58.406183 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:38:58.406805 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:38:58.408488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:58.426037 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.017 seconds
[0m06:38:58.427321 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:38:58.440581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:38:58.451321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:38:58.455513 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:58.466079 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:38:58.466756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:38:58.458526 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:58.470618 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:38:58.471601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:38:58.480337 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:38:58.493234 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:38:58.484913 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:38:58.500022 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:38:58.500855 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:38:58.503074 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:38:58.503882 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m06:38:58.505873 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:38:58.506257 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:38:58.506993 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:38:58.508267 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:38:58.513573 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:38:58.520016 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:58.520641 [debug] [MainThread]: On master: BEGIN
[0m06:38:58.522005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:58.528789 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:38:58.530986 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:58.531633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:38:58.534818 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m06:38:58.536789 [debug] [MainThread]: On master: ROLLBACK
[0m06:38:58.537200 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:58.537461 [debug] [MainThread]: On master: BEGIN
[0m06:38:58.537927 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:38:58.538354 [debug] [MainThread]: On master: COMMIT
[0m06:38:58.538632 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:58.538875 [debug] [MainThread]: On master: COMMIT
[0m06:38:58.539216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:58.539511 [debug] [MainThread]: On master: Close
[0m06:38:58.540045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:38:58.540471 [info ] [MainThread]: 
[0m06:38:58.550103 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m06:38:58.550778 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m06:38:58.551847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_customers)
[0m06:38:58.553557 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m06:38:58.570134 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m06:38:58.571407 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m06:38:58.602012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m06:38:58.603574 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:38:58.604147 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m06:38:58.604572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:38:58.609078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:38:58.609534 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:38:58.609957 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m06:38:58.614379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:38:58.619561 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:38:58.620106 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m06:38:58.620863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:38:58.631339 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m06:38:58.631832 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:38:58.632247 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m06:38:58.633423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:38:58.638052 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m06:38:58.641093 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:38:58.641454 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m06:38:58.641971 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:38:58.643702 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m06:38:58.645474 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m06:38:58.646202 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m06:38:58.647713 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:58.648201 [debug] [MainThread]: On master: BEGIN
[0m06:38:58.648748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:38:58.654111 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:38:58.654734 [debug] [MainThread]: On master: COMMIT
[0m06:38:58.655118 [debug] [MainThread]: Using postgres connection "master"
[0m06:38:58.655476 [debug] [MainThread]: On master: COMMIT
[0m06:38:58.656023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:38:58.656392 [debug] [MainThread]: On master: Close
[0m06:38:58.656818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:38:58.657118 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:38:58.657393 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m06:38:58.657722 [info ] [MainThread]: 
[0m06:38:58.658057 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m06:38:58.658590 [debug] [MainThread]: Command end result
[0m06:38:58.658944 [info ] [MainThread]: 
[0m06:38:58.659331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:38:58.659644 [info ] [MainThread]: 
[0m06:38:58.660003 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:38:58.660688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7884945, "process_user_time": 1.492349, "process_kernel_time": 0.138236, "process_mem_max_rss": "106776", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m06:38:58.661256 [debug] [MainThread]: Command `dbt run` succeeded at 06:38:58.661164 after 0.79 seconds
[0m06:38:58.661651 [debug] [MainThread]: Flushing usage events
[0m06:39:03.067540 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:03.078260 | 8c7ab54b-88d6-4eaf-ac38-b61bccc89a78 ==============================
[0m06:39:03.078260 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:03.078825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:39:03.285974 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:03.305457 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:03.348802 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m06:39:03.350622 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:03.351707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:39:03.357412 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m06:39:03.368663 [debug] [MainThread]: On master: ROLLBACK
[0m06:39:03.369621 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:03.370131 [debug] [MainThread]: On master: BEGIN
[0m06:39:03.372103 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:39:03.372683 [debug] [MainThread]: On master: COMMIT
[0m06:39:03.373304 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:03.373817 [debug] [MainThread]: On master: COMMIT
[0m06:39:03.374509 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:03.375299 [debug] [MainThread]: On master: Close
[0m06:39:03.377996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:39:03.378735 [info ] [MainThread]: 
[0m06:39:03.396315 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m06:39:03.397933 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m06:39:03.398741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m06:39:03.400577 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m06:39:03.412356 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m06:39:03.413718 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m06:39:03.454321 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m06:39:03.459606 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:39:03.460882 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m06:39:03.463484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:03.470852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:39:03.472605 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:39:03.473898 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select  
    product_id as product_key, 
    product_name, 
    geography_key, 
    product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m06:39:03.484545 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.009 seconds
[0m06:39:03.490109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:03.491517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:03.497495 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:39:03.499087 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m06:39:03.500163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:39:03.516702 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m06:39:03.518050 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:39:03.519823 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m06:39:03.530348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:39:03.540161 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m06:39:03.546969 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:39:03.551071 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m06:39:03.551955 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:39:03.561444 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m06:39:03.573945 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:03.572938 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.17s]
[0m06:39:03.577413 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m06:39:03.576005 [info ] [MainThread]: 
[0m06:39:03.582818 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:39:03.586749 [debug] [MainThread]: Command end result
[0m06:39:03.591560 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5743679, "process_user_time": 1.452774, "process_kernel_time": 0.108581, "process_mem_max_rss": "97792", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:39:03.591368 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:03.592641 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:03.592494 after 0.58 seconds
[0m06:39:03.596517 [debug] [MainThread]: On master: BEGIN
[0m06:39:03.597480 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:39:03.596975 [debug] [MainThread]: Flushing usage events
[0m06:39:03.608212 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:39:03.608932 [debug] [MainThread]: On master: COMMIT
[0m06:39:03.610331 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:03.610966 [debug] [MainThread]: On master: COMMIT
[0m06:39:03.611835 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:03.612130 [debug] [MainThread]: On master: Close
[0m06:39:03.614889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:03.615930 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:39:03.616596 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m06:39:03.617724 [info ] [MainThread]: 
[0m06:39:03.618685 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m06:39:03.619955 [debug] [MainThread]: Command end result
[0m06:39:03.621737 [info ] [MainThread]: 
[0m06:39:03.622804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:03.623545 [info ] [MainThread]: 
[0m06:39:03.624841 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:39:03.628948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.979059, "process_user_time": 1.614764, "process_kernel_time": 0.126568, "process_mem_max_rss": "106484", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m06:39:03.630131 [debug] [MainThread]: Command `dbt run` succeeded at 06:39:03.630024 after 10.98 seconds
[0m06:39:03.630869 [debug] [MainThread]: Flushing usage events
[0m06:39:05.906942 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:05.912690 | acb8fff2-3d36-4f46-9256-220201554c5e ==============================
[0m06:39:05.912690 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:05.913556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:39:05.914445 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:05.920350 | a2b7ff0e-973e-475a-bc37-4ca1b7a7d3bd ==============================
[0m06:39:05.920350 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:05.921080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:39:06.113193 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:06.114853 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:06.132013 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:06.140214 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:06.336319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:06.336941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:06.341169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:06.341727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:06.398869 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:06.400447 [info ] [MainThread]: 
[0m06:39:06.401054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:39:06.401859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:39:06.405826 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:06.407232 [info ] [MainThread]: 
[0m06:39:06.408624 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:39:06.410923 [debug] [MainThread]: Command end result
[0m06:39:06.411758 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.538655, "process_user_time": 1.328429, "process_kernel_time": 0.081841, "process_mem_max_rss": "97708", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:39:06.414888 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:06.414760 after 0.54 seconds
[0m06:39:06.415306 [debug] [MainThread]: Flushing usage events
[0m06:39:06.432016 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:39:06.432794 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:39:06.433332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:06.439106 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:39:06.440319 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:39:06.448861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:39:06.449486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:39:06.454880 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:06.456950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:06.457473 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:39:06.457968 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:39:06.458460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:06.458929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:06.463254 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:39:06.463798 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:06.464212 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:39:06.466341 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m06:39:06.467670 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:39:06.468192 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:39:10.590585 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:10.595802 | d9458d46-70c4-4774-8669-0956993ecce1 ==============================
[0m06:39:10.595802 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:10.596410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'send_anonymous_usage_stats': 'True'}
[0m06:39:10.771174 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:10.787872 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:11.043618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:11.044182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:11.111399 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:11.112799 [info ] [MainThread]: 
[0m06:39:11.113221 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:39:11.114813 [debug] [MainThread]: Command end result
[0m06:39:11.115523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58517194, "process_user_time": 1.262149, "process_kernel_time": 0.084076, "process_mem_max_rss": "97612", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:39:11.115994 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:11.115932 after 0.59 seconds
[0m06:39:11.116326 [debug] [MainThread]: Flushing usage events
[0m06:39:11.472135 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m06:39:11.479605 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:11.480230 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:39:11.483018 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:39:11.485101 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:39:11.485990 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:39:11.493308 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:11.493775 [debug] [MainThread]: On master: BEGIN
[0m06:39:11.494126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:39:11.499538 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:39:11.505498 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:11.506011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:39:11.509486 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m06:39:11.511599 [debug] [MainThread]: On master: ROLLBACK
[0m06:39:11.512074 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:11.512503 [debug] [MainThread]: On master: BEGIN
[0m06:39:11.513494 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:39:11.513897 [debug] [MainThread]: On master: COMMIT
[0m06:39:11.514331 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:11.515690 [debug] [MainThread]: On master: COMMIT
[0m06:39:11.516164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:11.519723 [debug] [MainThread]: On master: Close
[0m06:39:11.520197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:39:11.520642 [info ] [MainThread]: 
[0m06:39:11.526576 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m06:39:11.527239 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m06:39:11.527875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m06:39:11.528437 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m06:39:11.535268 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m06:39:11.536349 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m06:39:11.570474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m06:39:11.571797 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:39:11.572217 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m06:39:11.572567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:11.576999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:39:11.579159 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:39:11.580621 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select  
    customer_key,
    customer_first_name, 
    customer_last_name, 
    customer_email, 
    sales_agent_key

from "sales_dw"."dev"."staging_customers"
  );
  
[0m06:39:12.834285 [debug] [Thread-1 (]: SQL status: SELECT 259196 in 1.251 seconds
[0m06:39:12.849361 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:39:12.851578 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m06:39:12.855021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:39:12.873441 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m06:39:12.874705 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:39:12.875688 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m06:39:12.879305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:39:12.885807 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m06:39:12.889603 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:39:12.890298 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m06:39:12.894451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:39:12.897676 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m06:39:12.900085 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259196[0m in 1.37s]
[0m06:39:12.901218 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m06:39:12.903071 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:12.903605 [debug] [MainThread]: On master: BEGIN
[0m06:39:12.904008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:39:12.912440 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:39:12.912822 [debug] [MainThread]: On master: COMMIT
[0m06:39:12.913133 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:12.913438 [debug] [MainThread]: On master: COMMIT
[0m06:39:12.914233 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:12.917551 [debug] [MainThread]: On master: Close
[0m06:39:12.917983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:12.918310 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:39:12.918609 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m06:39:12.918999 [info ] [MainThread]: 
[0m06:39:12.919358 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.52 seconds (6.52s).
[0m06:39:12.920085 [debug] [MainThread]: Command end result
[0m06:39:12.920414 [info ] [MainThread]: 
[0m06:39:12.921227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:12.925542 [info ] [MainThread]: 
[0m06:39:12.925933 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:39:12.926971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.060174, "process_user_time": 1.489555, "process_kernel_time": 0.096359, "process_mem_max_rss": "106576", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m06:39:12.927625 [debug] [MainThread]: Command `dbt run` succeeded at 06:39:12.927538 after 7.06 seconds
[0m06:39:12.928099 [debug] [MainThread]: Flushing usage events
[0m06:39:19.975901 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:19.981639 | 44d892db-8f56-4dfd-ad85-3a65ee507766 ==============================
[0m06:39:19.981639 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:19.984293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:39:20.011874 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:39:20.016166 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:20.021125 | 3214cb8a-39ab-41c4-9550-bb7bf6da6aa6 ==============================
[0m06:39:20.021125 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:39:20.021604 | 034b3048-cad7-4e1f-904f-1a761a6f5c25 ==============================
[0m06:39:20.021604 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:20.022180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:39:20.022675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:39:20.219971 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:20.237963 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:20.274230 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:20.288621 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:20.289672 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:20.309237 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:20.457076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:20.457679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:20.477197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:20.477929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:20.497780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:20.499536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:20.538858 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:20.541695 [info ] [MainThread]: 
[0m06:39:20.542547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:39:20.543846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:39:20.543974 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:20.545371 [info ] [MainThread]: 
[0m06:39:20.545853 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:39:20.547655 [debug] [MainThread]: Command end result
[0m06:39:20.548408 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6133687, "process_user_time": 1.279971, "process_kernel_time": 0.099008, "process_mem_max_rss": "97496", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:39:20.549056 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:20.548947 after 0.61 seconds
[0m06:39:20.549646 [debug] [MainThread]: Flushing usage events
[0m06:39:20.556800 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:20.558540 [info ] [MainThread]: 
[0m06:39:20.559194 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:39:20.561199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:39:20.577897 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:39:20.578580 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:39:20.579069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:20.586519 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m06:39:20.587728 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:39:20.592880 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:39:20.593524 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:39:20.593206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:39:20.594227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:20.593812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:39:20.600736 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:39:20.599698 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:20.605305 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:39:20.604447 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:20.605532 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:39:20.606776 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:39:20.607775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:20.609510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:20.611362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:39:20.612109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:39:20.626923 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:20.633823 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:39:20.634162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:20.629330 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:20.636045 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:39:20.636714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:20.648704 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:39:20.649968 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:20.650723 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:39:20.654649 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m06:39:20.656987 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:39:20.657851 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:39:25.620794 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m06:39:25.621376 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m06:39:25.622068 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:25.622624 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:25.623106 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:39:25.623647 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:39:25.625869 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:39:25.626164 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m06:39:25.627583 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:39:25.628863 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:39:25.629396 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:39:25.629819 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:39:25.637282 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:25.637805 [debug] [MainThread]: On master: BEGIN
[0m06:39:25.638262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:39:25.643295 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:39:25.642976 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m06:39:25.644025 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:25.644600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:39:25.644400 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:25.645302 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:39:25.647599 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:39:25.647631 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m06:39:25.650035 [debug] [MainThread]: On master: ROLLBACK
[0m06:39:25.649012 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:39:25.650689 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:39:25.650632 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:25.651155 [debug] [MainThread]: On master: BEGIN
[0m06:39:25.651876 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:39:25.652459 [debug] [MainThread]: On master: COMMIT
[0m06:39:25.652872 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:25.653300 [debug] [MainThread]: On master: COMMIT
[0m06:39:25.653865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:25.654408 [debug] [MainThread]: On master: Close
[0m06:39:25.655077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:39:25.656607 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:25.658478 [info ] [MainThread]: 
[0m06:39:25.658568 [debug] [MainThread]: On master: BEGIN
[0m06:39:25.663544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:39:25.665433 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m06:39:25.666083 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m06:39:25.666688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m06:39:25.667117 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m06:39:25.687451 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:39:25.693310 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m06:39:25.738064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:39:25.743919 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:39:25.745190 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m06:39:25.745717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:30.682525 [debug] [MainThread]: SQL status: BEGIN in 5.020 seconds
[0m06:39:30.690219 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:30.691760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:39:30.701751 [debug] [MainThread]: SQL status: SELECT 12 in 0.003 seconds
[0m06:39:30.714171 [debug] [MainThread]: On master: ROLLBACK
[0m06:39:30.719625 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:30.720562 [debug] [MainThread]: On master: BEGIN
[0m06:39:30.721456 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:39:30.725102 [debug] [MainThread]: On master: COMMIT
[0m06:39:30.731287 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:30.731950 [debug] [MainThread]: On master: COMMIT
[0m06:39:30.733269 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:30.733792 [debug] [MainThread]: On master: Close
[0m06:39:30.734978 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:39:30.735929 [info ] [MainThread]: 
[0m06:39:30.746753 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m06:39:30.748176 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m06:39:30.749008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m06:39:30.749534 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m06:39:30.751871 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m06:39:30.757407 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:39:30.758249 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m06:39:30.784249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m06:39:30.785770 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m06:39:30.846570 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m06:39:30.848107 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:39:30.848699 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m06:39:30.849385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:30.856266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:39:30.857244 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:39:30.859576 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m06:39:32.267757 [debug] [Thread-1 (]: SQL status: SELECT 159196 in 1.508 seconds
[0m06:39:32.299057 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m06:39:32.304139 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:39:32.304694 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m06:39:32.325693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m06:39:32.329739 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m06:39:32.332625 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159196[0m in 6.66s]
[0m06:39:32.334079 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m06:39:32.350517 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:32.355113 [debug] [MainThread]: On master: BEGIN
[0m06:39:32.360355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:39:32.375057 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:39:32.384969 [debug] [MainThread]: On master: COMMIT
[0m06:39:32.406509 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:32.415262 [debug] [MainThread]: On master: COMMIT
[0m06:39:32.417846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:32.423365 [debug] [MainThread]: On master: Close
[0m06:39:32.425532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:32.426286 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:39:32.426721 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m06:39:32.427299 [info ] [MainThread]: 
[0m06:39:32.427893 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.88 seconds (11.88s).
[0m06:39:32.429167 [debug] [MainThread]: Command end result
[0m06:39:32.429580 [info ] [MainThread]: 
[0m06:39:32.430236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:32.430902 [info ] [MainThread]: 
[0m06:39:32.431457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:39:32.433542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.468604, "process_user_time": 1.496296, "process_kernel_time": 0.102136, "process_mem_max_rss": "106948", "process_out_blocks": "34", "process_in_blocks": "0"}
[0m06:39:32.434619 [debug] [MainThread]: Command `dbt run` succeeded at 06:39:32.434502 after 12.47 seconds
[0m06:39:32.435256 [debug] [MainThread]: Flushing usage events
[0m06:39:36.205218 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.344 seconds
[0m06:39:36.229941 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m06:39:36.230507 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:39:36.231726 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m06:39:36.235961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m06:39:36.240643 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m06:39:36.243086 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.49s]
[0m06:39:36.244182 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m06:39:36.246418 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:36.246976 [debug] [MainThread]: On master: BEGIN
[0m06:39:36.248142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:39:36.254660 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:39:36.255504 [debug] [MainThread]: On master: COMMIT
[0m06:39:36.257891 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:36.258241 [debug] [MainThread]: On master: COMMIT
[0m06:39:36.258674 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:36.259007 [debug] [MainThread]: On master: Close
[0m06:39:36.259528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:36.259857 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m06:39:36.260649 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:39:36.261111 [info ] [MainThread]: 
[0m06:39:36.262372 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.70 seconds (15.70s).
[0m06:39:36.268737 [debug] [MainThread]: Command end result
[0m06:39:36.269245 [info ] [MainThread]: 
[0m06:39:36.269890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:36.270370 [info ] [MainThread]: 
[0m06:39:36.270922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:39:36.272642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.294098, "process_user_time": 1.537, "process_kernel_time": 0.104099, "process_mem_max_rss": "106820", "process_out_blocks": "33", "process_in_blocks": "0"}
[0m06:39:36.273642 [debug] [MainThread]: Command `dbt run` succeeded at 06:39:36.273542 after 16.30 seconds
[0m06:39:36.274409 [debug] [MainThread]: Flushing usage events
[0m06:39:39.263344 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:39.268785 | 0e5b921a-f022-42c1-b286-2f0a497225a3 ==============================
[0m06:39:39.268785 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:39.269364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:39:39.478369 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:39.496552 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:39.659614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:39.660458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:39.723427 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:39.725519 [info ] [MainThread]: 
[0m06:39:39.726923 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:39:39.728350 [debug] [MainThread]: Command end result
[0m06:39:39.729022 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51015997, "process_user_time": 1.271902, "process_kernel_time": 0.09221, "process_mem_max_rss": "97364", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:39:39.729498 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:39.729434 after 0.51 seconds
[0m06:39:39.729847 [debug] [MainThread]: Flushing usage events
[0m06:39:43.090775 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:43.096013 | ae7f5c9f-48a2-471e-bdc5-119e9804ab74 ==============================
[0m06:39:43.096013 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:43.096607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:39:43.112390 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:39:43.121029 | dc161fd4-9666-4fd5-baa0-71aec74f03ec ==============================
[0m06:39:43.121029 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:39:43.121932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:39:43.291980 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:43.318601 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:43.325930 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:39:43.349755 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:39:43.508119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:43.508738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:43.522529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:39:43.523876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:39:43.573969 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:43.575518 [info ] [MainThread]: 
[0m06:39:43.576134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:39:43.576967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:39:43.586595 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:39:43.589910 [info ] [MainThread]: 
[0m06:39:43.590882 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:39:43.593230 [debug] [MainThread]: Command end result
[0m06:39:43.594434 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52376276, "process_user_time": 1.231936, "process_kernel_time": 0.070881, "process_mem_max_rss": "97320", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:39:43.596101 [debug] [MainThread]: Command `dbt test` succeeded at 06:39:43.596001 after 0.53 seconds
[0m06:39:43.596985 [debug] [MainThread]: Flushing usage events
[0m06:39:43.608294 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:39:43.609003 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:39:43.609792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:43.619867 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m06:39:43.621195 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:39:43.625849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:39:43.626527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:39:43.631398 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:43.634209 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:39:43.634592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:43.633738 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:43.635261 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:39:43.635869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:43.639130 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:39:43.639623 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:39:43.640087 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:39:43.642746 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m06:39:43.644093 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:39:43.644568 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:39:48.669116 [debug] [ThreadPool]: SQL status: BEGIN in 5.033 seconds
[0m06:39:48.673221 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:39:48.677112 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:39:48.679217 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:39:48.680886 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:39:48.683192 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:39:48.688027 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:48.688522 [debug] [MainThread]: On master: BEGIN
[0m06:39:48.688941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:39:48.692953 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:39:48.693481 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:48.693953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:39:48.696882 [debug] [MainThread]: SQL status: SELECT 12 in 0.002 seconds
[0m06:39:48.698892 [debug] [MainThread]: On master: ROLLBACK
[0m06:39:48.699311 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:48.699615 [debug] [MainThread]: On master: BEGIN
[0m06:39:48.700178 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:39:48.700660 [debug] [MainThread]: On master: COMMIT
[0m06:39:48.701088 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:48.701462 [debug] [MainThread]: On master: COMMIT
[0m06:39:48.701913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:48.702250 [debug] [MainThread]: On master: Close
[0m06:39:48.702716 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:39:48.703396 [info ] [MainThread]: 
[0m06:39:48.709175 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m06:39:48.709733 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m06:39:48.710206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m06:39:48.710536 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m06:39:48.717444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m06:39:48.718648 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m06:39:48.753100 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m06:39:48.757188 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:39:48.757601 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m06:39:48.757973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:53.764203 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m06:39:53.765928 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:39:53.768620 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m06:39:54.880180 [debug] [Thread-1 (]: SQL status: SELECT 1159196 in 1.109 seconds
[0m06:39:54.891787 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:39:54.892310 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m06:39:54.893161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:39:54.911053 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m06:39:54.914757 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:39:54.916366 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m06:39:54.923417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m06:39:54.931944 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m06:39:54.938403 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:39:54.940126 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m06:39:54.940753 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:39:54.947938 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m06:39:54.950059 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159196[0m in 6.24s]
[0m06:39:54.951264 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m06:39:54.953094 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:54.953449 [debug] [MainThread]: On master: BEGIN
[0m06:39:54.953738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:39:54.958228 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:39:54.958843 [debug] [MainThread]: On master: COMMIT
[0m06:39:54.959439 [debug] [MainThread]: Using postgres connection "master"
[0m06:39:54.960013 [debug] [MainThread]: On master: COMMIT
[0m06:39:54.960595 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:39:54.961127 [debug] [MainThread]: On master: Close
[0m06:39:54.961953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:54.962509 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m06:39:54.962976 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:39:54.963396 [info ] [MainThread]: 
[0m06:39:54.963927 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.39 seconds (11.39s).
[0m06:39:54.964699 [debug] [MainThread]: Command end result
[0m06:39:54.966867 [info ] [MainThread]: 
[0m06:39:54.968241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:39:54.969181 [info ] [MainThread]: 
[0m06:39:54.969949 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:39:54.971377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.92532, "process_user_time": 1.422327, "process_kernel_time": 0.077126, "process_mem_max_rss": "106344", "process_out_blocks": "29", "process_in_blocks": "0"}
[0m06:39:54.972193 [debug] [MainThread]: Command `dbt run` succeeded at 06:39:54.972093 after 11.93 seconds
[0m06:39:54.973908 [debug] [MainThread]: Flushing usage events
[0m06:40:02.639267 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:02.646360 | 183410fc-8b63-4a27-815c-3fb8183cd415 ==============================
[0m06:40:02.646360 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:40:02.647069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:40:02.643086 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:02.648714 | 94384d11-44ba-4e09-8700-b2ca46da9a3b ==============================
[0m06:40:02.648714 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:40:02.651716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:40:02.896103 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:40:02.913560 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:40:02.918310 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:40:02.940637 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:40:03.157541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:40:03.159316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:40:03.191145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:40:03.191881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:40:03.232678 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:40:03.236648 [info ] [MainThread]: 
[0m06:40:03.238898 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:03.240003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:40:03.284526 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:40:03.287409 [info ] [MainThread]: 
[0m06:40:03.288416 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:40:03.291163 [debug] [MainThread]: Command end result
[0m06:40:03.292543 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68993765, "process_user_time": 1.385035, "process_kernel_time": 0.132825, "process_mem_max_rss": "97600", "process_out_blocks": "7", "process_in_blocks": "0"}
[0m06:40:03.294023 [debug] [MainThread]: Command `dbt test` succeeded at 06:40:03.293899 after 0.69 seconds
[0m06:40:03.294183 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:40:03.294827 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:40:03.294606 [debug] [MainThread]: Flushing usage events
[0m06:40:03.295271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:03.307231 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m06:40:03.309098 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:40:03.315795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:40:03.316463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:40:03.325638 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:03.327831 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:03.328280 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:40:03.328750 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:40:03.329627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:03.329199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:03.335147 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:40:03.338765 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:03.340624 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:40:03.345706 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:40:03.352261 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:40:03.354223 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:40:08.343793 [debug] [ThreadPool]: SQL status: BEGIN in 5.014 seconds
[0m06:40:08.345187 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:08.345837 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:40:08.348764 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m06:40:08.353347 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:40:08.354686 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:40:08.384045 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:08.387067 [debug] [MainThread]: On master: BEGIN
[0m06:40:08.388087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:08.396190 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:40:08.397455 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:08.398603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:40:08.403365 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m06:40:08.407624 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:08.409429 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:08.409856 [debug] [MainThread]: On master: BEGIN
[0m06:40:08.411800 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:40:08.412687 [debug] [MainThread]: On master: COMMIT
[0m06:40:08.413628 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:08.414023 [debug] [MainThread]: On master: COMMIT
[0m06:40:08.415714 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:08.416068 [debug] [MainThread]: On master: Close
[0m06:40:08.416625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:40:08.417603 [info ] [MainThread]: 
[0m06:40:08.427848 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m06:40:08.428616 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m06:40:08.429383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m06:40:08.429882 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m06:40:08.438545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m06:40:08.440196 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m06:40:08.487412 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m06:40:08.495748 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:40:08.498266 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m06:40:08.499607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:08.508110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m06:40:08.508866 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:40:08.509424 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    product_key,
    channel_key,
    bought_date_key,
    geography_key,
    reseller_id,
    total_amount,
    qty,
    product_price,
    commissionpaid,
    commissionpct,
    loaded_timestamp
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m06:40:10.045168 [debug] [Thread-1 (]: SQL status: SELECT 1159196 in 1.534 seconds
[0m06:40:10.058990 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:40:10.059641 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m06:40:10.060729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:40:10.077201 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m06:40:10.079505 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:40:10.082689 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m06:40:10.089902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m06:40:10.099200 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m06:40:10.105325 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:40:10.105960 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m06:40:10.106793 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:40:10.111561 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m06:40:10.114672 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159196[0m in 1.68s]
[0m06:40:10.116032 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m06:40:10.119136 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:10.119716 [debug] [MainThread]: On master: BEGIN
[0m06:40:10.120175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:40:10.129180 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m06:40:10.129860 [debug] [MainThread]: On master: COMMIT
[0m06:40:10.130364 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:10.130814 [debug] [MainThread]: On master: COMMIT
[0m06:40:10.131297 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:10.131666 [debug] [MainThread]: On master: Close
[0m06:40:10.132223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:10.132637 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m06:40:10.133069 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:40:10.133563 [info ] [MainThread]: 
[0m06:40:10.134128 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.89 seconds (6.89s).
[0m06:40:10.135073 [debug] [MainThread]: Command end result
[0m06:40:10.135508 [info ] [MainThread]: 
[0m06:40:10.136105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:10.136504 [info ] [MainThread]: 
[0m06:40:10.137060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:40:10.138980 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5433764, "process_user_time": 1.588576, "process_kernel_time": 0.166952, "process_mem_max_rss": "106156", "process_out_blocks": "30", "process_in_blocks": "0"}
[0m06:40:10.140095 [debug] [MainThread]: Command `dbt run` succeeded at 06:40:10.139985 after 7.54 seconds
[0m06:40:10.140680 [debug] [MainThread]: Flushing usage events
[0m06:40:17.283284 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:17.289079 | be4868a9-d906-4f0e-9aea-6d92389eadce ==============================
[0m06:40:17.289079 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:40:17.290669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:40:17.468518 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:40:17.503679 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:40:17.646041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:40:17.646558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:40:17.709951 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 539 macros
[0m06:40:17.712502 [info ] [MainThread]: 
[0m06:40:17.713070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:17.717193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:40:17.717950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:40:17.753660 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:17.754132 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:17.755046 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:40:17.756571 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:40:17.757256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:17.757826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:17.768888 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m06:40:17.769387 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:40:17.769902 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:17.770504 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:17.771229 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:40:17.772594 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:40:17.775985 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.003 seconds
[0m06:40:17.777545 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:40:17.777825 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:40:17.778391 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:40:17.779485 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:40:17.782226 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:40:17.787361 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:17.787846 [debug] [MainThread]: On master: BEGIN
[0m06:40:17.788252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:22.797061 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m06:40:22.801078 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:22.802398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:40:22.814567 [debug] [MainThread]: SQL status: SELECT 12 in 0.011 seconds
[0m06:40:22.825105 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:22.825769 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:22.826164 [debug] [MainThread]: On master: BEGIN
[0m06:40:22.826783 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:40:22.827360 [debug] [MainThread]: On master: COMMIT
[0m06:40:22.827879 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:22.828353 [debug] [MainThread]: On master: COMMIT
[0m06:40:22.828831 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:22.829198 [debug] [MainThread]: On master: Close
[0m06:40:22.830101 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:40:22.830726 [info ] [MainThread]: 
[0m06:40:22.842458 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m06:40:22.843499 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m06:40:22.844616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now test.dbtcomp.total_amount_is_non_negative)
[0m06:40:22.845818 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m06:40:22.855981 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m06:40:22.859410 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m06:40:22.873861 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m06:40:22.878524 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m06:40:22.879260 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m06:40:22.879945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:22.887830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m06:40:22.889091 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m06:40:22.889597 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m06:40:23.595628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.704 seconds
[0m06:40:23.605780 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m06:40:23.606533 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m06:40:23.607760 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.76s]
[0m06:40:23.608978 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m06:40:23.611375 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:23.611908 [debug] [MainThread]: On master: BEGIN
[0m06:40:23.612326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:40:23.617720 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:40:23.619563 [debug] [MainThread]: On master: COMMIT
[0m06:40:23.619963 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:23.620464 [debug] [MainThread]: On master: COMMIT
[0m06:40:23.620909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:23.621468 [debug] [MainThread]: On master: Close
[0m06:40:23.622514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:23.623102 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m06:40:23.624724 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:40:23.625181 [info ] [MainThread]: 
[0m06:40:23.628728 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.91 seconds (5.91s).
[0m06:40:23.629915 [debug] [MainThread]: Command end result
[0m06:40:23.630368 [info ] [MainThread]: 
[0m06:40:23.631664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:23.632533 [info ] [MainThread]: 
[0m06:40:23.634508 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:40:23.636741 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.3948383, "process_user_time": 1.37234, "process_kernel_time": 0.129126, "process_mem_max_rss": "108056", "process_out_blocks": "26", "process_in_blocks": "0"}
[0m06:40:23.639135 [debug] [MainThread]: Command `dbt test` succeeded at 06:40:23.639000 after 6.40 seconds
[0m06:40:23.639773 [debug] [MainThread]: Flushing usage events
