[0m06:40:10.486605 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:10.503548 | 3d548351-71fa-4890-ab94-24bb05ce17dc ==============================
[0m06:40:10.503548 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:40:10.504233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:40:10.580662 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m06:40:10.587455 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m06:40:10.590700 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_ryh18oj'
[0m06:40:10.592559 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m06:40:10.597740 [debug] [MainThread]: Creating symlink to local dependency.
[0m06:40:10.598832 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m06:40:10.600026 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17440638, "process_user_time": 0.82751, "process_kernel_time": 0.081148, "process_mem_max_rss": "105672", "process_in_blocks": "176", "process_out_blocks": "8"}
[0m06:40:10.601019 [debug] [MainThread]: Command `dbt deps` succeeded at 06:40:10.600928 after 0.18 seconds
[0m06:40:10.602080 [debug] [MainThread]: Flushing usage events
[0m06:40:12.499830 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:40:12.504336 | fa6e9cd0-9cb1-45fa-bbb4-ae9e9568e9f6 ==============================
[0m06:40:12.504336 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:40:12.506651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:40:12.638021 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:40:12.679122 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m06:40:12.693345 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:40:14.063819 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:40:14.065946 [info ] [MainThread]: 
[0m06:40:14.069227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:14.070133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:40:14.097050 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:40:14.100874 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:40:14.101484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:19.105995 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.007 seconds
[0m06:40:19.110407 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:40:19.112572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m06:40:19.113771 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m06:40:19.122482 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:40:19.123336 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m06:40:19.125928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:19.130532 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.134548 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:40:19.135318 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m06:40:19.136468 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m06:40:19.137384 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m06:40:19.137755 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m06:40:19.138238 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m06:40:19.139173 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m06:40:19.139600 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m06:40:19.143470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m06:40:19.143957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:40:19.150159 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:19.155145 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:40:19.153350 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:19.156461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:19.157503 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:40:19.158689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:19.162025 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:40:19.162788 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:40:19.164218 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:40:19.163738 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.165532 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:40:19.166219 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:40:19.166973 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:40:19.168303 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:40:19.168790 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:40:19.169325 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:40:19.170118 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:40:19.171072 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:40:19.175489 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.176079 [debug] [MainThread]: On master: BEGIN
[0m06:40:19.176457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:19.181152 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.181832 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.182505 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:40:19.185811 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:40:19.187335 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:19.187996 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.188460 [debug] [MainThread]: On master: BEGIN
[0m06:40:19.189261 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:40:19.189762 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.190250 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.190647 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.191256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:19.191731 [debug] [MainThread]: On master: Close
[0m06:40:19.192300 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:40:19.192829 [info ] [MainThread]: 
[0m06:40:19.198804 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m06:40:19.199642 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m06:40:19.202943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m06:40:19.203524 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m06:40:19.204099 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m06:40:19.231056 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.232340 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m06:40:19.233361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:19.238703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:40:19.239594 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.240174 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m06:40:19.243463 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m06:40:19.297798 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.298496 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m06:40:19.300403 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m06:40:19.306577 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m06:40:19.326205 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m06:40:19.327657 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m06:40:19.328143 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m06:40:19.329333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:40:19.330888 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m06:40:19.332310 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.13s]
[0m06:40:19.332893 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m06:40:19.333898 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.334262 [debug] [MainThread]: On master: BEGIN
[0m06:40:19.334513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:40:19.339038 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:40:19.344454 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.346732 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:19.348074 [debug] [MainThread]: On master: COMMIT
[0m06:40:19.349654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:40:19.350775 [debug] [MainThread]: On master: Close
[0m06:40:19.365826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:19.378212 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:40:19.397855 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m06:40:19.406860 [info ] [MainThread]: 
[0m06:40:19.413666 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m06:40:19.421590 [debug] [MainThread]: Command end result
[0m06:40:19.504374 [info ] [MainThread]: 
[0m06:40:19.504875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:19.505725 [info ] [MainThread]: 
[0m06:40:19.506088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:40:19.510184 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.0437093, "process_user_time": 2.234173, "process_kernel_time": 0.103146, "process_mem_max_rss": "113404", "process_in_blocks": "488", "process_out_blocks": "0"}
[0m06:40:19.510737 [debug] [MainThread]: Command `dbt seed` succeeded at 06:40:19.510657 after 7.04 seconds
[0m06:40:19.512002 [debug] [MainThread]: Flushing usage events
[0m06:41:16.493737 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.498962 | 2e54ed52-7e6b-4637-9ad8-01ff5082e136 ==============================
[0m06:41:16.498962 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.500236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.517835 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.535046 | 0a019ac3-fb60-4ada-9ed2-af78d00e5e24 ==============================
[0m06:41:16.535046 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.536217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.575030 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.594401 | 247d8f70-3087-4965-a13e-593fa694c391 ==============================
[0m06:41:16.594401 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.601185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.606463 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:41:16.608915 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.613584 | 94ea0d91-1a1e-4624-9c3f-d26a875e41a8 ==============================
[0m06:41:16.613584 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:41:16.614148 | 7985dc78-13d7-4d9a-a2ff-c1e17609c048 ==============================
[0m06:41:16.614148 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.603903 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:41:16.614882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellerscsv', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.615481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 06:41:16.616764 | 8df8bb5c-01f6-4922-95d8-8dabbc55ba34 ==============================
[0m06:41:16.616764 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.619764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.616316 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.622844 | fc0347a4-17c0-4d3d-873c-af0ddfcb2a40 ==============================
[0m06:41:16.622844 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.624033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.631216 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:16.636046 | fdab455b-4f47-4a9a-9439-8175c0c8884c ==============================
[0m06:41:16.636046 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:16.636566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:16.666469 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.677658 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.713027 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.736552 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.769830 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.772963 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.798567 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.802695 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.820694 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.827951 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.829277 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.832095 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.834140 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.837477 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.846435 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.851360 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.854872 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.859573 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:16.865450 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.878550 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:16.912767 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.913381 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.914091 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.914524 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.929740 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.930629 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.940867 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.941607 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.949440 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.950390 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:16.982474 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:41:16.983599 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:41:18.232730 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.236105 [info ] [MainThread]: 
[0m06:41:18.240084 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.241684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.251727 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.255725 [info ] [MainThread]: 
[0m06:41:18.258399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.260236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.281950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.282897 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.283931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.287850 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.288823 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.289772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.290723 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m06:41:18.295308 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.300286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m06:41:18.301775 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m06:41:18.302158 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m06:41:18.304513 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.310216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m06:41:18.308359 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.312505 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m06:41:18.313497 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m06:41:18.318374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.319455 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.320245 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m06:41:18.321268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.324381 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:41:18.325923 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.327144 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m06:41:18.329945 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:41:18.334537 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.335270 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m06:41:18.337130 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m06:41:18.339683 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m06:41:18.340799 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m06:41:18.344184 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m06:41:18.347423 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m06:41:18.348188 [debug] [ThreadPool]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_namespace_nspname_index"
DETAIL:  Key (nspname)=(dev) already exists.

[0m06:41:18.349211 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m06:41:18.350186 [debug] [ThreadPool]: On create_sales_dw_dev: ROLLBACK
[0m06:41:18.352900 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m06:41:18.355187 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m06:41:18.358207 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m06:41:18.357343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m06:41:18.362731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:18.364112 [debug] [MainThread]: Connection 'create_sales_dw_dev' was properly closed.
[0m06:41:18.365285 [info ] [MainThread]: 
[0m06:41:18.365382 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.358512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:18.366065 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m06:41:18.367453 [error] [MainThread]: Encountered an error:
Database Error
  duplicate key value violates unique constraint "pg_namespace_nspname_index"
  DETAIL:  Key (nspname)=(dev) already exists.
[0m06:41:18.367691 [info ] [MainThread]: 
[0m06:41:18.369102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8927099, "process_user_time": 2.398472, "process_kernel_time": 0.140177, "process_mem_max_rss": "111532", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:18.370260 [debug] [MainThread]: Command `dbt run` failed at 06:41:18.370148 after 1.89 seconds
[0m06:41:18.370537 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.371152 [debug] [MainThread]: Flushing usage events
[0m06:41:18.365463 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.373019 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.372413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.375184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.370661 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.382540 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.383168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.390094 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:41:18.391265 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.392810 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:18.396317 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:41:18.398367 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.399318 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:18.396886 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m06:41:18.405686 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:18.404654 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m06:41:18.406815 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:18.410519 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:18.415064 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.416586 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:18.416845 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.423277 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.426391 [info ] [MainThread]: 
[0m06:41:18.425091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.427046 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.427627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.428600 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.429670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.430477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:18.431251 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.435180 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m06:41:18.435266 [info ] [MainThread]: 
[0m06:41:18.437613 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.437846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.438801 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:41:18.441387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.443470 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.444588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:18.445107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:18.455086 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.456348 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.456711 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:41:18.445325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:18.457144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.458212 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:18.460153 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.456946 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.461118 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.460467 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.462646 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:18.464116 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.461660 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.465432 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.466277 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.463504 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.465360 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.466961 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m06:41:18.466737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.467690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.468194 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.465908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.471233 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.472618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:18.475216 [debug] [MainThread]: On master: Close
[0m06:41:18.476874 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m06:41:18.477967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:18.477575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:18.479139 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:18.480188 [info ] [MainThread]: 
[0m06:41:18.478501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:18.488212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:18.486990 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.492339 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m06:41:18.489572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:18.490282 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.496763 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m06:41:18.498440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m06:41:18.496075 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.495466 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.500378 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m06:41:18.499926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.498130 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.501093 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:18.505901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.500739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.505366 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:18.509708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m06:41:18.506564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:18.508651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.514187 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m06:41:18.515048 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:41:18.518461 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.519855 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m06:41:18.522956 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m06:41:18.516768 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:18.524502 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:18.524964 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:18.520354 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:18.526577 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.527852 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m06:41:18.525590 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:18.529320 [info ] [MainThread]: 
[0m06:41:18.531232 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:18.531727 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:18.531866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.531578 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m06:41:18.533307 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:18.534500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.534058 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:18.532666 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:18.534586 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:18.541309 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:18.545781 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.546465 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.546908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:18.549014 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.550419 [info ] [MainThread]: 
[0m06:41:18.550816 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m06:41:18.551037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.553075 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:41:18.553582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.554238 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.554657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:18.555464 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:18.557705 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m06:41:18.558107 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m06:41:18.558315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:18.559389 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:18.560109 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.560535 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.560560 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.561136 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.561423 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:18.561851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.562372 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.563148 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.563557 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.564042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:18.564533 [debug] [MainThread]: On master: Close
[0m06:41:18.565153 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:18.565538 [info ] [MainThread]: 
[0m06:41:18.571165 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m06:41:18.571827 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m06:41:18.572435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m06:41:18.573089 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m06:41:18.574920 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.575573 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.576054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.576487 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:18.578180 [info ] [MainThread]: 
[0m06:41:18.578473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m06:41:18.578886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:18.579563 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m06:41:18.579702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:18.600191 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:18.600858 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:18.601298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:18.602575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m06:41:18.604117 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.604568 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m06:41:18.604990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:18.609442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:18.610044 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.610667 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m06:41:18.614470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:41:18.619541 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.621517 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m06:41:18.622502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:18.635921 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m06:41:18.637178 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.641167 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m06:41:18.647672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:18.652080 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m06:41:18.659390 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m06:41:18.666729 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m06:41:18.672439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:18.674348 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m06:41:18.675761 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m06:41:18.679307 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m06:41:18.694468 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.695404 [debug] [MainThread]: On master: BEGIN
[0m06:41:18.699214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:18.703289 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:18.705286 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.706413 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:18.711207 [debug] [MainThread]: On master: COMMIT
[0m06:41:18.711870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:18.714189 [debug] [MainThread]: On master: Close
[0m06:41:18.715672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:18.716416 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:18.720132 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m06:41:18.720649 [info ] [MainThread]: 
[0m06:41:18.721036 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m06:41:18.721570 [debug] [MainThread]: Command end result
[0m06:41:18.721882 [info ] [MainThread]: 
[0m06:41:18.722287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:18.724214 [info ] [MainThread]: 
[0m06:41:18.726542 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:18.731245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1715221, "process_user_time": 2.550626, "process_kernel_time": 0.148709, "process_mem_max_rss": "112584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:18.733409 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:18.733328 after 2.17 seconds
[0m06:41:18.733829 [debug] [MainThread]: Flushing usage events
[0m06:41:20.149916 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:20.157389 | 5ea2485a-f6b9-4cde-bbff-e7e8dfa555e7 ==============================
[0m06:41:20.157389 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:20.158663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:20.158694 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:20.165747 | 49f1ebed-e152-4556-968f-b92f42ea8b33 ==============================
[0m06:41:20.165747 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:20.166470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:41:20.298319 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:20.304535 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:20.317783 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:20.324296 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:20.535476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:20.536099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:20.537184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:20.538566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:20.581121 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:20.582635 [info ] [MainThread]: 
[0m06:41:20.586349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:20.587090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:20.593384 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:20.595363 [info ] [MainThread]: 
[0m06:41:20.595792 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:20.597190 [debug] [MainThread]: Command end result
[0m06:41:20.597784 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5092478, "process_user_time": 0.976567, "process_kernel_time": 0.061603, "process_mem_max_rss": "96940", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:20.598286 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:20.598199 after 0.51 seconds
[0m06:41:20.598634 [debug] [MainThread]: Flushing usage events
[0m06:41:20.608950 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:20.610299 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:20.612305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:20.619375 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m06:41:20.621005 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:20.625358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:20.625899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:20.630365 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:20.632129 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:20.632561 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:20.632885 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:20.633225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:20.633539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:20.638189 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:20.640886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:20.641423 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:20.643494 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:20.646892 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:20.647455 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:23.476932 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m06:41:23.480820 [debug] [ThreadPool]: SQL status: BEGIN in 5.015 seconds
[0m06:41:23.482422 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.483042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.483481 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:23.483900 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:23.485788 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.486066 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.487044 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:23.487875 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:23.488325 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:23.488627 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:23.493004 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.493454 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.493749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:23.497502 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:23.498081 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.498530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:23.501635 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m06:41:23.503059 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:23.503700 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.504137 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.504769 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:23.505195 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.505492 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.505754 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.506175 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:23.506473 [debug] [MainThread]: On master: Close
[0m06:41:23.506914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:23.507239 [info ] [MainThread]: 
[0m06:41:23.513391 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellerscsv
[0m06:41:23.514376 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellerscsv ............................... [RUN]
[0m06:41:23.515191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellerscsv)
[0m06:41:23.515808 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellerscsv
[0m06:41:23.518351 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m06:41:23.523248 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.523845 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:23.524910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellerscsv"
[0m06:41:23.526136 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellerscsv
[0m06:41:23.526211 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.532120 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:23.534293 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:23.538850 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.540799 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.542049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:23.551441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellerscsv"
[0m06:41:23.553049 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.553491 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: BEGIN
[0m06:41:23.553857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:23.558262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:23.558896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.559485 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellerscsv"} */

  create view "sales_dw"."dev"."src_resellerscsv__dbt_tmp"
    
    
  as (
    WITH raw_resellercsv AS (

    SELECT * FROM "sales_dw"."import"."resellercsv"
)

SELECT transaction_id, product_name, number_of_purchased_postcards, total_amount, sales_channel, customer_first_name, customer_last_name, customer_email, office_location, created_date, imported_file, loaded_timestamp
FROM raw_resellercsv
  );
[0m06:41:23.562016 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m06:41:23.562867 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m06:41:23.566650 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.567627 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m06:41:23.568357 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m06:41:23.567910 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.569517 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:23.570846 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellerscsv"} */
alter table "sales_dw"."dev"."src_resellerscsv__dbt_tmp" rename to "src_resellerscsv"
[0m06:41:23.571889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:23.571508 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:23.574693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:23.575153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:23.580520 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.580888 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.005 seconds
[0m06:41:23.581460 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m06:41:23.582069 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: COMMIT
[0m06:41:23.582149 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:23.580307 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.583179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:23.582795 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.582385 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.583290 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:23.586864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:23.587639 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: COMMIT
[0m06:41:23.587319 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:23.587821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:23.588775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:23.589322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:23.587405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:23.593483 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:41:23.591917 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.594523 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.594288 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.595051 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:23.595006 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m06:41:23.594757 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:23.595703 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.595541 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellerscsv__dbt_backup"
[0m06:41:23.595240 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:23.596169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:23.596303 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m06:41:23.596542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:23.597201 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:23.598249 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:23.598545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:23.598676 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:23.600820 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellerscsv"
[0m06:41:23.601657 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellerscsv"} */
drop view if exists "sales_dw"."dev"."src_resellerscsv__dbt_backup" cascade
[0m06:41:23.603039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:23.604430 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m06:41:23.605438 [debug] [Thread-1 (]: On model.dbtcomp.src_resellerscsv: Close
[0m06:41:23.607392 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m06:41:23.608903 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellerscsv .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m06:41:23.609375 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m06:41:23.609898 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellerscsv
[0m06:41:23.610438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:23.611592 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.611831 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m06:41:23.612440 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m06:41:23.612829 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.613765 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:23.615156 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 5.12s]
[0m06:41:23.615824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:23.618961 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m06:41:23.629931 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.629916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:23.634019 [debug] [MainThread]: On master: BEGIN
[0m06:41:23.636382 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:23.636786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:23.636642 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m06:41:23.639120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:23.648393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:23.639714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:23.648531 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.654343 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.654771 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.655612 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:23.653932 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.656578 [debug] [MainThread]: On master: Close
[0m06:41:23.657861 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m06:41:23.661303 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:23.667386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:23.672478 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.687428 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:23.687963 [debug] [MainThread]: On master: COMMIT
[0m06:41:23.684138 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellerscsv' was properly closed.
[0m06:41:23.673715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:23.688556 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:23.691404 [debug] [MainThread]: On master: Close
[0m06:41:23.695325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:23.695834 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m06:41:23.697227 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:23.697637 [info ] [MainThread]: 
[0m06:41:23.698375 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m06:41:23.689420 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:23.701505 [debug] [MainThread]: Command end result
[0m06:41:23.701601 [info ] [MainThread]: 
[0m06:41:23.701900 [info ] [MainThread]: 
[0m06:41:23.702402 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.33 seconds (5.33s).
[0m06:41:23.702574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:23.703219 [info ] [MainThread]: 
[0m06:41:23.703361 [debug] [MainThread]: Command end result
[0m06:41:23.703761 [info ] [MainThread]: 
[0m06:41:23.703603 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:23.704227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:23.705131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2636833, "process_user_time": 2.541899, "process_kernel_time": 0.172471, "process_mem_max_rss": "112600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:23.705558 [info ] [MainThread]: 
[0m06:41:23.706156 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:23.706075 after 7.26 seconds
[0m06:41:23.706131 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m06:41:23.707270 [debug] [MainThread]: Flushing usage events
[0m06:41:23.706653 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:23.707708 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:23.712572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.164286, "process_user_time": 2.565055, "process_kernel_time": 0.149131, "process_mem_max_rss": "112440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:23.713117 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:23.713679 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:23.713599 after 7.17 seconds
[0m06:41:23.716194 [debug] [MainThread]: Flushing usage events
[0m06:41:23.717573 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:23.718813 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:23.719436 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:25.177599 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:25.184581 | 49314d00-cdf4-4187-8488-be89648abc42 ==============================
[0m06:41:25.184581 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:25.185264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:25.193318 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:25.197492 | 261d7f99-4005-4f8b-a1a2-89ca80a7bdc7 ==============================
[0m06:41:25.197492 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:25.198108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellerscsv', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:25.205326 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:25.209410 | 30eb3fd7-12c3-4217-b3f3-46dfacecab90 ==============================
[0m06:41:25.209410 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:25.209916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m06:41:25.331706 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:25.336606 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:25.350287 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:25.409130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:25.412045 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:25.415947 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:25.581339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:25.583399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:25.583828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:25.584625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:25.594547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:25.598833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:25.636136 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:25.637356 [info ] [MainThread]: 
[0m06:41:25.639212 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:25.640452 [debug] [MainThread]: Command end result
[0m06:41:25.640146 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m06:41:25.648295 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:25.648796 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:25.646864 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49786, "process_user_time": 0.964364, "process_kernel_time": 0.067025, "process_mem_max_rss": "97080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:25.653317 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:25.655427 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:25.654822 after 0.51 seconds
[0m06:41:25.656374 [debug] [MainThread]: Flushing usage events
[0m06:41:25.656961 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:25.655544 [info ] [MainThread]: 
[0m06:41:25.666291 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:25.666446 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:25.679237 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:25.673024 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:25.692525 [debug] [MainThread]: Command end result
[0m06:41:25.693207 [info ] [MainThread]: 
[0m06:41:25.696120 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5353696, "process_user_time": 1.011419, "process_kernel_time": 0.052332, "process_mem_max_rss": "97332", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:25.697058 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:25.696916 after 0.54 seconds
[0m06:41:25.696763 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:25.697456 [debug] [MainThread]: Flushing usage events
[0m06:41:25.698189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:25.697549 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:25.701161 [debug] [MainThread]: On master: BEGIN
[0m06:41:25.702259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:25.721132 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:25.721752 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:25.722252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:28.553279 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m06:41:28.556524 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.557136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:28.560710 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m06:41:28.561870 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:28.562384 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.562865 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.563769 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:28.564398 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.564997 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.565479 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.566042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:28.566567 [debug] [MainThread]: On master: Close
[0m06:41:28.567454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:28.568032 [info ] [MainThread]: 
[0m06:41:28.574407 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m06:41:28.577348 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m06:41:28.578107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m06:41:28.578637 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m06:41:28.587544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m06:41:28.589099 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m06:41:28.600670 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m06:41:28.603250 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:28.603197 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m06:41:28.603934 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:28.604126 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:28.604701 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:28.604992 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m06:41:28.605903 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:28.606328 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:28.606992 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:41:28.610760 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:28.610028 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:28.611340 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:28.611202 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:28.612168 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:28.612759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m06:41:28.613345 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:28.614374 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.614498 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:28.614889 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m06:41:28.615093 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:28.615375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:28.616056 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.616582 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.617116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:28.619695 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.620039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:41:28.620272 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.620612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.620701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:28.621062 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m06:41:28.622409 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:28.626613 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.627059 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m06:41:28.627658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:28.636131 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m06:41:28.638663 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.639599 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m06:41:28.643964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:41:28.656549 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m06:41:28.665722 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m06:41:28.666205 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m06:41:28.666837 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:28.667640 [debug] [ThreadPool]: SQL status: BEGIN in 5.019 seconds
[0m06:41:28.673244 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:28.670858 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m06:41:28.673647 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:28.679347 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:28.677058 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m06:41:28.681615 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:28.688244 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:28.687213 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m06:41:28.705103 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.705547 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.706127 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.706932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:28.707199 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.708338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:28.719502 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m06:41:28.720271 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m06:41:28.720699 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.721044 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.721511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:28.721917 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.722413 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.722815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:28.723114 [debug] [MainThread]: On master: Close
[0m06:41:28.723486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:28.723757 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m06:41:28.723993 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:28.724276 [info ] [MainThread]: 
[0m06:41:28.724686 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m06:41:28.725364 [debug] [MainThread]: Command end result
[0m06:41:28.725366 [debug] [MainThread]: SQL status: SELECT 4 in 0.003 seconds
[0m06:41:28.725780 [info ] [MainThread]: 
[0m06:41:28.726799 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:28.727186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:28.727602 [info ] [MainThread]: 
[0m06:41:28.727832 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.728143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:28.728469 [debug] [MainThread]: On master: BEGIN
[0m06:41:28.729126 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.223468, "process_user_time": 2.573941, "process_kernel_time": 0.142314, "process_mem_max_rss": "114720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:28.729701 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:28.729763 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:28.729690 after 12.22 seconds
[0m06:41:28.730269 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.730666 [debug] [MainThread]: Flushing usage events
[0m06:41:28.730997 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:28.736993 [debug] [MainThread]: On master: COMMIT
[0m06:41:28.740715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:28.742404 [debug] [MainThread]: On master: Close
[0m06:41:28.743522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:28.746317 [info ] [MainThread]: 
[0m06:41:28.753217 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m06:41:28.753929 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m06:41:28.754442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m06:41:28.754799 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m06:41:28.759647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m06:41:28.760648 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m06:41:28.783292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m06:41:28.784713 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:28.785169 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m06:41:28.785585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:30.104504 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:30.112095 | c683858d-9968-44ce-9bff-398f651722ab ==============================
[0m06:41:30.112095 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:30.112559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:30.241924 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:30.253799 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:30.396172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:30.398179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:30.483939 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:30.493177 [info ] [MainThread]: 
[0m06:41:30.495064 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:30.496967 [debug] [MainThread]: Command end result
[0m06:41:30.497785 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45461565, "process_user_time": 0.931585, "process_kernel_time": 0.063903, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:30.498619 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:30.498506 after 0.46 seconds
[0m06:41:30.500511 [debug] [MainThread]: Flushing usage events
[0m06:41:30.706606 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:41:30.707914 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.709029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:30.714327 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m06:41:30.716936 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:30.718822 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.720878 [debug] [MainThread]: On master: BEGIN
[0m06:41:30.721662 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:30.722952 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.724633 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.725206 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.727063 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m06:41:30.727817 [debug] [MainThread]: On master: Close
[0m06:41:30.728691 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:30.729109 [info ] [MainThread]: 
[0m06:41:30.729150 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m06:41:30.733642 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:30.736217 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m06:41:30.736900 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m06:41:30.737394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m06:41:30.737854 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m06:41:30.737492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:30.743736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m06:41:30.745065 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m06:41:30.737967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:30.746262 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:30.756122 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:30.751517 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:30.756571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:30.756881 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:30.757538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:30.769293 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m06:41:30.770834 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.771336 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m06:41:30.771739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:30.776505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:41:30.777190 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.777579 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m06:41:30.779129 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:30.784386 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.784953 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m06:41:30.785808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:30.794645 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m06:41:30.795436 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.795862 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m06:41:30.796605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:30.801169 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m06:41:30.804697 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m06:41:30.805262 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m06:41:30.805874 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:30.807538 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m06:41:30.808951 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m06:41:30.809726 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m06:41:30.810899 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.811317 [debug] [MainThread]: On master: BEGIN
[0m06:41:30.811668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:30.817730 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:41:30.818708 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.819498 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:30.820288 [debug] [MainThread]: On master: COMMIT
[0m06:41:30.821198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:30.821921 [debug] [MainThread]: On master: Close
[0m06:41:30.822940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:30.826848 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:30.829040 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m06:41:30.830213 [info ] [MainThread]: 
[0m06:41:30.844168 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m06:41:30.871910 [debug] [MainThread]: Command end result
[0m06:41:30.879254 [info ] [MainThread]: 
[0m06:41:30.880723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:30.882681 [info ] [MainThread]: 
[0m06:41:30.888604 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:30.889708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.785429, "process_user_time": 1.131447, "process_kernel_time": 0.079292, "process_mem_max_rss": "106020", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:30.891629 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:30.891073 after 10.79 seconds
[0m06:41:30.897262 [debug] [MainThread]: Flushing usage events
[0m06:41:32.263316 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:32.270692 | 6290197a-c09f-4d0b-b260-6e6c212c9607 ==============================
[0m06:41:32.270692 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:32.271251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:32.286981 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:32.291251 | a1a4042c-eab3-4d87-ae20-63e1e0882ee9 ==============================
[0m06:41:32.291251 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:32.291767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m06:41:32.399748 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:32.411416 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:32.411726 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:32.422822 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:32.577208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:32.588287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:32.611471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:32.611995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:32.653418 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:32.657884 [info ] [MainThread]: 
[0m06:41:32.658502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:32.659318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:32.662825 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:32.664326 [info ] [MainThread]: 
[0m06:41:32.664879 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:32.666273 [debug] [MainThread]: Command end result
[0m06:41:32.666890 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41222638, "process_user_time": 0.969314, "process_kernel_time": 0.078511, "process_mem_max_rss": "97336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:32.667389 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:32.667325 after 0.41 seconds
[0m06:41:32.667748 [debug] [MainThread]: Flushing usage events
[0m06:41:32.682038 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:32.685339 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:32.685918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:32.691532 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:41:32.692627 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:32.696312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:32.696860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:32.701720 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:32.703736 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:32.704288 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:32.704650 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:32.704986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:32.705315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:32.710024 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:32.710610 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:32.711099 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:32.713356 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m06:41:32.715669 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:32.716297 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:33.620826 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:41:33.621605 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.622202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:33.625116 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:41:33.625675 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.625959 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m06:41:33.626197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:33.627492 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:33.628068 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.628413 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.628898 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:33.629444 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.629647 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m06:41:33.629808 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.630275 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.630752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:33.631034 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:33.631208 [debug] [MainThread]: On master: Close
[0m06:41:33.631506 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.631825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:33.631946 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.632285 [info ] [MainThread]: 
[0m06:41:33.632689 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:33.633229 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.633688 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.634116 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.634628 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:33.635168 [debug] [MainThread]: On master: Close
[0m06:41:33.635855 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:33.636823 [info ] [MainThread]: 
[0m06:41:33.637756 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m06:41:33.638365 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m06:41:33.639030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m06:41:33.639576 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m06:41:33.641910 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m06:41:33.642601 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m06:41:33.643261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m06:41:33.643731 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m06:41:33.644941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m06:41:33.646279 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m06:41:33.649156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m06:41:33.650429 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m06:41:33.668675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m06:41:33.670239 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:33.670774 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m06:41:33.671295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:33.675033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m06:41:33.676402 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.676892 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m06:41:33.677355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:33.681518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:33.685417 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.686117 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m06:41:33.795085 [debug] [Thread-1 (]: SQL status: BEGIN in 5.009 seconds
[0m06:41:33.795726 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.796342 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m06:41:33.797930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:33.802422 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.813373 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m06:41:33.814189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:33.833551 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m06:41:33.850667 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.851648 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m06:41:33.864249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m06:41:33.875263 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m06:41:33.882932 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m06:41:33.889199 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m06:41:33.890328 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:33.892255 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m06:41:33.893891 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 5.14s]
[0m06:41:33.894658 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m06:41:33.895957 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.896430 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.896744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:33.911923 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.225 seconds
[0m06:41:33.916511 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.917021 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m06:41:33.917670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:33.927948 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m06:41:33.928589 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.929036 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m06:41:33.932444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:41:33.936657 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m06:41:33.939457 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m06:41:33.940019 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m06:41:33.940644 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:33.942395 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m06:41:33.943839 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.30s]
[0m06:41:33.944563 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m06:41:33.945817 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.946369 [debug] [MainThread]: On master: BEGIN
[0m06:41:33.946888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:33.951299 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:33.951797 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.952315 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:33.952774 [debug] [MainThread]: On master: COMMIT
[0m06:41:33.953343 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:33.953871 [debug] [MainThread]: On master: Close
[0m06:41:33.954528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:33.955031 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:33.955536 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m06:41:33.955961 [info ] [MainThread]: 
[0m06:41:33.956386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.41 seconds (15.41s).
[0m06:41:33.957015 [debug] [MainThread]: Command end result
[0m06:41:33.957356 [info ] [MainThread]: 
[0m06:41:33.957746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:33.958094 [info ] [MainThread]: 
[0m06:41:33.958457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:33.959146 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.40268, "process_user_time": 2.606535, "process_kernel_time": 0.147423, "process_mem_max_rss": "112836", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:33.959642 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:33.959583 after 17.40 seconds
[0m06:41:33.960025 [debug] [MainThread]: Flushing usage events
[0m06:41:35.765498 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m06:41:35.766381 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:35.766937 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m06:41:35.767346 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:35.768186 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:35.769145 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:35.770551 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:35.770878 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.001 seconds
[0m06:41:35.771837 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:35.772656 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:35.773150 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:35.773497 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:35.778348 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.778969 [debug] [MainThread]: On master: BEGIN
[0m06:41:35.779388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:35.784316 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:41:35.784917 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.785666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:35.790026 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m06:41:35.791287 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:35.791746 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.792119 [debug] [MainThread]: On master: BEGIN
[0m06:41:35.792605 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:35.793129 [debug] [MainThread]: On master: COMMIT
[0m06:41:35.793497 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:35.793886 [debug] [MainThread]: On master: COMMIT
[0m06:41:35.794292 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:35.794611 [debug] [MainThread]: On master: Close
[0m06:41:35.795086 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:35.795733 [info ] [MainThread]: 
[0m06:41:35.800799 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m06:41:35.801686 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m06:41:35.802443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m06:41:35.803098 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m06:41:35.811252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m06:41:35.812680 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m06:41:35.837632 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m06:41:35.840279 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:35.840790 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m06:41:35.841266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:36.218563 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:36.222811 | 86f8d2d6-9a8e-4c75-ae5c-0e7bde3dc318 ==============================
[0m06:41:36.222811 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:36.223393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:36.350935 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:36.374130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:36.502095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:36.502649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:36.551599 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:36.552801 [info ] [MainThread]: 
[0m06:41:36.553290 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:36.554534 [debug] [MainThread]: Command end result
[0m06:41:36.555174 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3647281, "process_user_time": 0.970889, "process_kernel_time": 0.048143, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:36.555622 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:36.555561 after 0.37 seconds
[0m06:41:36.555954 [debug] [MainThread]: Flushing usage events
[0m06:41:37.710163 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:41:37.710822 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:37.711251 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:37.713486 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:37.714483 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:37.714923 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:37.718998 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.722123 [debug] [MainThread]: On master: BEGIN
[0m06:41:37.724129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:37.740256 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m06:41:37.741045 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.741428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:37.745037 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m06:41:37.746945 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:37.748214 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.749105 [debug] [MainThread]: On master: BEGIN
[0m06:41:37.753927 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:37.760123 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.764079 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.765267 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.774765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:37.779721 [debug] [MainThread]: On master: Close
[0m06:41:37.780954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:37.782962 [info ] [MainThread]: 
[0m06:41:37.815866 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m06:41:37.817658 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m06:41:37.818202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m06:41:37.818639 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m06:41:37.824198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m06:41:37.825419 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m06:41:37.851048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m06:41:37.853921 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.854692 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m06:41:37.855255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:37.860957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m06:41:37.862377 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.863093 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m06:41:37.866600 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.002 seconds
[0m06:41:37.871367 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.871999 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m06:41:37.874360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:41:37.888762 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m06:41:37.889617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.890430 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m06:41:37.891342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:37.896925 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m06:41:37.899700 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m06:41:37.901349 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m06:41:37.902016 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:37.903838 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m06:41:37.905087 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.09s]
[0m06:41:37.905602 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m06:41:37.906675 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.907088 [debug] [MainThread]: On master: BEGIN
[0m06:41:37.907425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:37.911651 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:37.912265 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.916922 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:37.917374 [debug] [MainThread]: On master: COMMIT
[0m06:41:37.921505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:37.921912 [debug] [MainThread]: On master: Close
[0m06:41:37.922381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:37.922702 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:37.922932 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m06:41:37.923297 [info ] [MainThread]: 
[0m06:41:37.923611 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m06:41:37.924146 [debug] [MainThread]: Command end result
[0m06:41:37.924445 [info ] [MainThread]: 
[0m06:41:37.924777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:37.925143 [info ] [MainThread]: 
[0m06:41:37.925527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:37.926323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6960588, "process_user_time": 1.082618, "process_kernel_time": 0.087535, "process_mem_max_rss": "106168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:37.927011 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:37.926884 after 5.70 seconds
[0m06:41:37.927576 [debug] [MainThread]: Flushing usage events
[0m06:41:38.679682 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m06:41:38.682211 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.682743 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m06:41:38.684036 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:38.691214 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.693116 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m06:41:38.693752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:38.710854 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m06:41:38.711657 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.712173 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m06:41:38.714145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:38.718803 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m06:41:38.721784 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m06:41:38.722218 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m06:41:38.722698 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:38.724400 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m06:41:38.725721 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 5.09s]
[0m06:41:38.726345 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m06:41:38.727557 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:38.729838 [debug] [MainThread]: On master: BEGIN
[0m06:41:38.730220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:38.734630 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:38.735182 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.735515 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:38.735830 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.736222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:38.736579 [debug] [MainThread]: On master: Close
[0m06:41:38.736993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:38.737267 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:38.737502 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m06:41:38.737806 [info ] [MainThread]: 
[0m06:41:38.738251 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.21 seconds (20.21s).
[0m06:41:38.738875 [debug] [MainThread]: Command end result
[0m06:41:38.739788 [info ] [MainThread]: 
[0m06:41:38.740280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:38.743701 [info ] [MainThread]: 
[0m06:41:38.744365 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:38.748042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.199793, "process_user_time": 2.545127, "process_kernel_time": 0.163673, "process_mem_max_rss": "112452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:38.752651 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:38.752536 after 22.20 seconds
[0m06:41:38.755478 [debug] [MainThread]: Flushing usage events
[0m06:41:38.908804 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m06:41:38.913820 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.922236 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:38.922865 [debug] [MainThread]: On master: COMMIT
[0m06:41:38.926372 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:38.928459 [debug] [MainThread]: On master: Close
[0m06:41:38.930688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:38.932239 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m06:41:38.933843 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:41:38.934964 [info ] [MainThread]: 
[0m06:41:38.936778 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.36 seconds (20.36s).
[0m06:41:38.937442 [debug] [MainThread]: Command end result
[0m06:41:38.938351 [info ] [MainThread]: 
[0m06:41:38.939387 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:38.939712 [info ] [MainThread]: 
[0m06:41:38.940472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:38.941682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.381746, "process_user_time": 2.576135, "process_kernel_time": 0.149582, "process_mem_max_rss": "112944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:38.942865 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:38.942782 after 22.38 seconds
[0m06:41:38.943364 [debug] [MainThread]: Flushing usage events
[0m06:41:40.205115 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:40.209845 | 80619d76-ce1d-4488-a378-ee43bef244a8 ==============================
[0m06:41:40.209845 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:40.210560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:40.246906 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:40.251744 | 3eac90da-1f78-4789-b8d9-9cc3be11d897 ==============================
[0m06:41:40.251744 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:40.253311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:40.345821 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:40.359915 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:40.385180 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:40.399813 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:40.521198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:40.522176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:40.539740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:40.541428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:40.594155 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:40.595528 [info ] [MainThread]: 
[0m06:41:40.595926 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:40.597253 [debug] [MainThread]: Command end result
[0m06:41:40.605136 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42892003, "process_user_time": 0.977107, "process_kernel_time": 0.055664, "process_mem_max_rss": "97212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:40.605740 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:40.605671 after 0.43 seconds
[0m06:41:40.606155 [debug] [MainThread]: Flushing usage events
[0m06:41:40.630413 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:40.631692 [info ] [MainThread]: 
[0m06:41:40.636618 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:40.645342 [debug] [MainThread]: Command end result
[0m06:41:40.652640 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43735433, "process_user_time": 0.963686, "process_kernel_time": 0.065113, "process_mem_max_rss": "97168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:40.656294 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:40.656172 after 0.44 seconds
[0m06:41:40.656858 [debug] [MainThread]: Flushing usage events
[0m06:41:40.845592 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m06:41:40.859570 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.871354 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m06:41:40.899724 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m06:41:40.929555 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.931561 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m06:41:40.932542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:40.946247 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m06:41:40.947390 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.949101 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m06:41:40.950039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:40.954426 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m06:41:40.958132 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m06:41:40.958888 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m06:41:40.960844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:41:40.963917 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m06:41:40.966162 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.16s]
[0m06:41:40.968391 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m06:41:40.971006 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:40.971478 [debug] [MainThread]: On master: BEGIN
[0m06:41:40.971789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:40.982850 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:41:40.984693 [debug] [MainThread]: On master: COMMIT
[0m06:41:40.986045 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:40.987212 [debug] [MainThread]: On master: COMMIT
[0m06:41:40.987772 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:40.988790 [debug] [MainThread]: On master: Close
[0m06:41:40.989335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:40.990311 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m06:41:40.990783 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:40.991223 [info ] [MainThread]: 
[0m06:41:40.993955 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m06:41:40.994613 [debug] [MainThread]: Command end result
[0m06:41:40.994899 [info ] [MainThread]: 
[0m06:41:40.995277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:40.995614 [info ] [MainThread]: 
[0m06:41:40.995919 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:40.996727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.824938, "process_user_time": 1.115306, "process_kernel_time": 0.08797, "process_mem_max_rss": "106272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:40.997520 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:40.997439 after 15.83 seconds
[0m06:41:41.000473 [debug] [MainThread]: Flushing usage events
[0m06:41:41.300666 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:41.305311 | b1547134-194d-4a80-a7e8-deef848077f5 ==============================
[0m06:41:41.305311 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:41.306713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:41.360368 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:41.376533 | 3c7ad45a-8a1d-4d9e-b410-836076e2f632 ==============================
[0m06:41:41.376533 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:41.385262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:41.470144 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:41.482848 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:41.543959 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:41.559057 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:41.648344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:41.649052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:41.699242 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:41.703623 [info ] [MainThread]: 
[0m06:41:41.705171 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:41.709165 [debug] [MainThread]: Command end result
[0m06:41:41.711581 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43939695, "process_user_time": 1.010105, "process_kernel_time": 0.06332, "process_mem_max_rss": "97060", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:41.715763 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:41.715533 after 0.44 seconds
[0m06:41:41.717923 [debug] [MainThread]: Flushing usage events
[0m06:41:41.731272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:41.734729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:41.786941 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:41.788346 [info ] [MainThread]: 
[0m06:41:41.789171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:41.790156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:41.812942 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:41.813571 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:41.814044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:41.819735 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:41:41.820859 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:41.824644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:41:41.825276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:41:41.829480 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:41.831209 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:41.834041 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:41.836628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:41.834663 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:41.838609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:41.842326 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:41:41.844184 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:41.847167 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:41.849481 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m06:41:41.851513 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:41.852210 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:42.376752 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:42.381236 | 3bcfdb09-1ad0-4a4a-a793-81e6ebcdeef8 ==============================
[0m06:41:42.381236 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:42.381843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:42.399266 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:42.404080 | 781486e7-92b5-432e-9e38-0157702ea729 ==============================
[0m06:41:42.404080 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:42.404701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:41:42.503947 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:42.541814 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:42.549453 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:42.568343 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:42.701938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:42.705251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:42.714347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:42.714933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:42.755260 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:42.756422 [info ] [MainThread]: 
[0m06:41:42.756925 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:42.758346 [debug] [MainThread]: Command end result
[0m06:41:42.757513 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:42.759033 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41958967, "process_user_time": 0.95216, "process_kernel_time": 0.059258, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:42.759490 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:42.759433 after 0.42 seconds
[0m06:41:42.759818 [debug] [MainThread]: Flushing usage events
[0m06:41:42.760191 [info ] [MainThread]: 
[0m06:41:42.765242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:42.766432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:42.789619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:42.790300 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:42.790793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:42.797386 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m06:41:42.800351 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:42.804148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:42.804758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:42.808953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:42.811777 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:42.812340 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:42.812757 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:42.813098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:42.813547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:46.860872 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m06:41:46.862031 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:46.862618 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:46.864702 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:46.866218 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:46.866926 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:46.871382 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.871937 [debug] [MainThread]: On master: BEGIN
[0m06:41:46.872404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:46.876878 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:46.881144 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.882368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:46.887060 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m06:41:46.889237 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:46.891297 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.895516 [debug] [MainThread]: On master: BEGIN
[0m06:41:46.896104 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:46.896555 [debug] [MainThread]: On master: COMMIT
[0m06:41:46.896894 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.897179 [debug] [MainThread]: On master: COMMIT
[0m06:41:46.897754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:46.898171 [debug] [MainThread]: On master: Close
[0m06:41:46.898679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:46.899047 [info ] [MainThread]: 
[0m06:41:46.905474 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m06:41:46.906208 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m06:41:46.906866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m06:41:46.907409 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m06:41:46.913271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m06:41:46.914333 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m06:41:46.939661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m06:41:46.948138 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.948686 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m06:41:46.949042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:46.954380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:41:46.955019 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.958217 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m06:41:46.960736 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m06:41:46.966964 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.967748 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m06:41:46.968870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:46.977410 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m06:41:46.978019 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.978448 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m06:41:46.979193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:41:46.983520 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m06:41:46.986396 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m06:41:46.986948 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m06:41:46.987668 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:41:46.989626 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m06:41:46.991175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m06:41:46.991906 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m06:41:46.993181 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:46.995138 [debug] [MainThread]: On master: BEGIN
[0m06:41:46.995525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:47.821669 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m06:41:47.824985 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:47.826663 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m06:41:47.827193 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:47.828515 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:47.829584 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:47.830806 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:47.832099 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:47.832382 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m06:41:47.832924 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:47.834037 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:47.835172 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:47.840000 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:47.840578 [debug] [MainThread]: On master: BEGIN
[0m06:41:47.840930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:52.000796 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m06:41:52.002738 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.003321 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.003904 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.004559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:52.004986 [debug] [MainThread]: On master: Close
[0m06:41:52.005493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:52.005801 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m06:41:52.006056 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:52.006464 [info ] [MainThread]: 
[0m06:41:52.006958 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m06:41:52.007510 [debug] [MainThread]: Command end result
[0m06:41:52.007781 [info ] [MainThread]: 
[0m06:41:52.008128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:52.008482 [info ] [MainThread]: 
[0m06:41:52.008830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:52.009581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.701405, "process_user_time": 1.131767, "process_kernel_time": 0.085739, "process_mem_max_rss": "106160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:52.010124 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:52.010061 after 10.70 seconds
[0m06:41:52.010468 [debug] [MainThread]: Flushing usage events
[0m06:41:52.845658 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m06:41:52.846715 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.847170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:52.851704 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m06:41:52.853732 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:52.854384 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.854792 [debug] [MainThread]: On master: BEGIN
[0m06:41:52.855293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:52.855645 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.855979 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:52.856284 [debug] [MainThread]: On master: COMMIT
[0m06:41:52.856822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:52.857280 [debug] [MainThread]: On master: Close
[0m06:41:52.857831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:52.858302 [info ] [MainThread]: 
[0m06:41:52.863391 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m06:41:52.864031 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m06:41:52.864666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m06:41:52.866045 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m06:41:52.872396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m06:41:52.874799 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m06:41:52.900018 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m06:41:52.901220 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:52.901622 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m06:41:52.901954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:54.063150 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:54.070045 | d52e388d-7a2a-44cb-ac02-285a03386b94 ==============================
[0m06:41:54.070045 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:54.067060 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:41:54.070934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 06:41:54.071878 | 51938829-8f4c-4333-a0ae-a81bba976402 ==============================
[0m06:41:54.071878 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:54.073726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}
[0m06:41:54.200205 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:54.210596 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:54.222711 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:54.232731 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:54.440263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:54.440884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:54.460284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:54.460897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:54.507738 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:54.508317 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:54.509586 [info ] [MainThread]: 
[0m06:41:54.510873 [info ] [MainThread]: 
[0m06:41:54.511627 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:41:54.511941 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:54.513823 [debug] [MainThread]: Command end result
[0m06:41:54.512862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:41:54.514629 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4852063, "process_user_time": 0.99444, "process_kernel_time": 0.062594, "process_mem_max_rss": "97592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:54.515200 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:54.515128 after 0.49 seconds
[0m06:41:54.515556 [debug] [MainThread]: Flushing usage events
[0m06:41:54.538279 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:41:54.541179 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:41:54.542963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:54.551888 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m06:41:54.552999 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:41:54.556661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:41:54.557335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:41:54.561942 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:54.565759 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:41:54.566257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:54.565210 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:54.566988 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:41:54.567549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:54.570853 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:54.571463 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:41:54.572156 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:41:54.572670 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:41:54.573641 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:41:54.574206 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:41:54.574927 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:41:54.576095 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:41:54.576431 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m06:41:54.577849 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:41:54.576944 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:41:54.578405 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:41:54.583702 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.584287 [debug] [MainThread]: On master: BEGIN
[0m06:41:54.584592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:41:54.589269 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:41:54.590764 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.591258 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:41:54.598368 [debug] [MainThread]: SQL status: SELECT 10 in 0.007 seconds
[0m06:41:54.603396 [debug] [MainThread]: On master: ROLLBACK
[0m06:41:54.604143 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.607535 [debug] [MainThread]: On master: BEGIN
[0m06:41:54.608463 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:41:54.608954 [debug] [MainThread]: On master: COMMIT
[0m06:41:54.609533 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.609985 [debug] [MainThread]: On master: COMMIT
[0m06:41:54.610521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:54.610900 [debug] [MainThread]: On master: Close
[0m06:41:54.611384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:41:54.611871 [info ] [MainThread]: 
[0m06:41:54.618257 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m06:41:54.619286 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m06:41:54.620056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m06:41:54.620802 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m06:41:54.626989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m06:41:54.628240 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m06:41:54.653024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m06:41:54.654403 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.654797 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m06:41:54.655100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:41:54.659519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:41:54.660200 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.660716 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m06:41:54.663739 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m06:41:54.668404 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.669013 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m06:41:54.669791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:54.679768 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m06:41:54.680215 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.680684 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m06:41:54.681769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:41:54.686065 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m06:41:54.689538 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m06:41:54.690042 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m06:41:54.690816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:54.692736 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m06:41:54.694182 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.07s]
[0m06:41:54.694999 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m06:41:54.696266 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:54.696779 [debug] [MainThread]: On master: BEGIN
[0m06:41:54.697751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:57.908465 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m06:41:57.911014 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:57.911750 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m06:41:57.929432 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.017 seconds
[0m06:41:57.941285 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:57.959785 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m06:41:57.969707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:41:57.995423 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m06:41:57.996791 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:57.997135 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m06:41:58.007448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:41:58.011835 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m06:41:58.014902 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m06:41:58.015492 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m06:41:58.016257 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:41:58.018521 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m06:41:58.019997 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 5.15s]
[0m06:41:58.020651 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m06:41:58.021741 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:58.022217 [debug] [MainThread]: On master: BEGIN
[0m06:41:58.022595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:41:58.026770 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:41:58.028990 [debug] [MainThread]: On master: COMMIT
[0m06:41:58.029537 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:58.030155 [debug] [MainThread]: On master: COMMIT
[0m06:41:58.030702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:58.031054 [debug] [MainThread]: On master: Close
[0m06:41:58.031683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:58.032054 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:58.032680 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m06:41:58.033344 [info ] [MainThread]: 
[0m06:41:58.033836 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m06:41:58.034401 [debug] [MainThread]: Command end result
[0m06:41:58.034723 [info ] [MainThread]: 
[0m06:41:58.035090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:58.035401 [info ] [MainThread]: 
[0m06:41:58.035681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:58.036390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.666834, "process_user_time": 1.117414, "process_kernel_time": 0.065493, "process_mem_max_rss": "106156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:58.036839 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:58.036777 after 15.67 seconds
[0m06:41:58.037170 [debug] [MainThread]: Flushing usage events
[0m06:41:59.325350 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:41:59.329704 | 39ba597d-5671-4cad-8ebf-e35ca8360d0c ==============================
[0m06:41:59.329704 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:41:59.330292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:41:59.455849 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:41:59.473838 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:41:59.666328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:41:59.666887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:41:59.710590 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m06:41:59.711366 [debug] [MainThread]: On master: COMMIT
[0m06:41:59.711794 [debug] [MainThread]: Using postgres connection "master"
[0m06:41:59.712112 [debug] [MainThread]: On master: COMMIT
[0m06:41:59.712544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:41:59.713168 [debug] [MainThread]: On master: Close
[0m06:41:59.713702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:59.714105 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:41:59.714400 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m06:41:59.714885 [info ] [MainThread]: 
[0m06:41:59.715414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m06:41:59.716038 [debug] [MainThread]: Command end result
[0m06:41:59.716377 [info ] [MainThread]: 
[0m06:41:59.716799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:41:59.717243 [info ] [MainThread]: 
[0m06:41:59.717688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:41:59.718448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6856337, "process_user_time": 1.145944, "process_kernel_time": 0.075579, "process_mem_max_rss": "108356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:59.719028 [debug] [MainThread]: Command `dbt run` succeeded at 06:41:59.718950 after 5.69 seconds
[0m06:41:59.719701 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:41:59.719999 [debug] [MainThread]: Flushing usage events
[0m06:41:59.720973 [info ] [MainThread]: 
[0m06:41:59.725357 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:41:59.727355 [debug] [MainThread]: Command end result
[0m06:41:59.728158 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43064854, "process_user_time": 0.927249, "process_kernel_time": 0.062016, "process_mem_max_rss": "97464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:41:59.729559 [debug] [MainThread]: Command `dbt test` succeeded at 06:41:59.729479 after 0.43 seconds
[0m06:41:59.730014 [debug] [MainThread]: Flushing usage events
[0m06:42:01.503405 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:42:01.504949 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:01.509324 | 22be9c16-345c-41a3-b4d7-a03cb830371c ==============================
[0m06:42:01.509324 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:42:01.509674 | 634f23bc-343b-4254-a787-721b78b629bf ==============================
[0m06:42:01.509674 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:01.510147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:01.510659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:42:01.643670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:01.652496 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:01.661583 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:01.663953 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:01.889664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:01.889670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:01.890465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:01.890779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:01.939288 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:01.941183 [info ] [MainThread]: 
[0m06:42:01.941973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:01.943025 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:01.942979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:01.944415 [info ] [MainThread]: 
[0m06:42:01.947468 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:01.952416 [debug] [MainThread]: Command end result
[0m06:42:01.954023 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48018008, "process_user_time": 1.015012, "process_kernel_time": 0.05774, "process_mem_max_rss": "97592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:01.954855 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:01.954725 after 0.48 seconds
[0m06:42:01.955430 [debug] [MainThread]: Flushing usage events
[0m06:42:01.971045 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:01.972338 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:01.973102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:01.978783 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:42:01.980215 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:01.984770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:42:01.985426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:42:01.991891 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:01.994274 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:01.994658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:01.993793 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:01.995564 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:01.995971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:01.999408 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:02.000101 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:02.000664 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:02.003120 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:02.004466 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:02.005037 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:07.005239 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m06:42:07.006051 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:07.006487 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:07.008620 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m06:42:07.009821 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:07.010277 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:07.015036 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.015625 [debug] [MainThread]: On master: BEGIN
[0m06:42:07.015945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:07.020311 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:07.020965 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.021529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:07.026159 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m06:42:07.028780 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:07.030424 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.031281 [debug] [MainThread]: On master: BEGIN
[0m06:42:07.032178 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:07.032770 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.033840 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.037018 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.037824 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:07.038562 [debug] [MainThread]: On master: Close
[0m06:42:07.039274 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:07.039768 [info ] [MainThread]: 
[0m06:42:07.045284 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m06:42:07.045927 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m06:42:07.046377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m06:42:07.046686 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m06:42:07.059801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m06:42:07.060945 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m06:42:07.083698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m06:42:07.085072 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.085452 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m06:42:07.085786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:07.090109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:42:07.090748 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.091316 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_csv  AS (

    SELECT  
    
    customer_first_name, 
    customer_last_name ,
    customer_email,
    split_part(split_part(imported_file, '_', 3),'.',1)::int AS reseller_id,
    transaction_id

    FROM "sales_dw"."dev"."src_resellerscsv"
)
,

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (


select reseller_id, transaction_id as customer_id , customer_first_name, customer_last_name, customer_email  from customers_csv

union 

select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m06:42:07.095248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m06:42:07.103854 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.104379 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m06:42:07.105475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:42:07.114507 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m06:42:07.117238 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.118448 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m06:42:07.119573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:42:07.124015 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m06:42:07.128761 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m06:42:07.129420 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m06:42:07.132446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m06:42:07.134309 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m06:42:07.135572 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m06:42:07.136076 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m06:42:07.137345 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.137864 [debug] [MainThread]: On master: BEGIN
[0m06:42:07.138275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:07.142358 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:07.142974 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.144418 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:07.145552 [debug] [MainThread]: On master: COMMIT
[0m06:42:07.147339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:07.149941 [debug] [MainThread]: On master: Close
[0m06:42:07.151320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:07.153396 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:42:07.153748 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m06:42:07.154240 [info ] [MainThread]: 
[0m06:42:07.156078 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m06:42:07.159209 [debug] [MainThread]: Command end result
[0m06:42:07.160583 [info ] [MainThread]: 
[0m06:42:07.162920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:07.164353 [info ] [MainThread]: 
[0m06:42:07.165322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:07.166570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6988263, "process_user_time": 1.11282, "process_kernel_time": 0.072089, "process_mem_max_rss": "106172", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:07.168661 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:07.168546 after 5.70 seconds
[0m06:42:07.169604 [debug] [MainThread]: Flushing usage events
[0m06:42:09.462902 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:09.467220 | fadd562f-6ce8-44e8-a84d-7be6219ba6ab ==============================
[0m06:42:09.467220 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:09.469436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:42:09.498246 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:09.502269 | 550ee30e-e9f5-4895-8ebe-c47d8d142103 ==============================
[0m06:42:09.502269 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:09.502864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:42:09.597506 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:09.616479 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:09.635768 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:09.649121 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:09.850049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:09.850615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:09.878637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:09.879657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:09.915798 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:09.917107 [info ] [MainThread]: 
[0m06:42:09.917595 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:09.920558 [debug] [MainThread]: Command end result
[0m06:42:09.921434 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4916179, "process_user_time": 0.989077, "process_kernel_time": 0.053111, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:09.922105 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:09.922013 after 0.49 seconds
[0m06:42:09.922629 [debug] [MainThread]: Flushing usage events
[0m06:42:09.926753 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:09.928313 [info ] [MainThread]: 
[0m06:42:09.928822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:09.929675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:09.953644 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:09.954285 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:09.954845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:09.960968 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m06:42:09.962060 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:09.967155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:09.967784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:09.972409 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:09.974904 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:09.975166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:09.974486 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:09.975813 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:09.976355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:09.979803 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:09.980302 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:09.980812 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:09.983616 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m06:42:09.985121 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:09.985981 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:14.987133 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m06:42:14.988421 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:14.989028 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:14.991687 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:14.993070 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:14.993603 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:14.998609 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:14.999270 [debug] [MainThread]: On master: BEGIN
[0m06:42:14.999703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:15.004517 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:15.005219 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:15.005617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:15.010697 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:42:15.012731 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:15.013205 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:15.013531 [debug] [MainThread]: On master: BEGIN
[0m06:42:15.013993 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:15.014512 [debug] [MainThread]: On master: COMMIT
[0m06:42:15.015023 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:15.015386 [debug] [MainThread]: On master: COMMIT
[0m06:42:15.016286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:15.016744 [debug] [MainThread]: On master: Close
[0m06:42:15.017443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:15.018043 [info ] [MainThread]: 
[0m06:42:15.023823 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m06:42:15.024573 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m06:42:15.026531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m06:42:15.032415 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m06:42:15.039159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m06:42:15.040758 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m06:42:15.066780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m06:42:15.068165 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:15.068671 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m06:42:15.069151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:20.068867 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m06:42:20.073867 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.076096 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m06:42:20.830032 [debug] [Thread-1 (]: SQL status: SELECT 200000 in 0.752 seconds
[0m06:42:20.839802 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.840311 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m06:42:20.840988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:20.851330 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m06:42:20.851870 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.852228 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m06:42:20.859031 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m06:42:20.863393 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m06:42:20.866273 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m06:42:20.866707 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m06:42:20.867216 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:42:20.869139 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m06:42:20.870636 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 200000[0m in 5.84s]
[0m06:42:20.871418 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m06:42:20.872583 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:20.873082 [debug] [MainThread]: On master: BEGIN
[0m06:42:20.873430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:20.878464 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:20.879076 [debug] [MainThread]: On master: COMMIT
[0m06:42:20.881873 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:20.882966 [debug] [MainThread]: On master: COMMIT
[0m06:42:20.884834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:20.885815 [debug] [MainThread]: On master: Close
[0m06:42:20.889183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:20.890068 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:42:20.890418 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m06:42:20.890813 [info ] [MainThread]: 
[0m06:42:20.891198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.96 seconds (10.96s).
[0m06:42:20.891777 [debug] [MainThread]: Command end result
[0m06:42:20.892066 [info ] [MainThread]: 
[0m06:42:20.892448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:20.892833 [info ] [MainThread]: 
[0m06:42:20.893255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:20.894073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.440477, "process_user_time": 1.124712, "process_kernel_time": 0.077117, "process_mem_max_rss": "106304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:20.894651 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:20.894568 after 11.44 seconds
[0m06:42:20.895036 [debug] [MainThread]: Flushing usage events
[0m06:42:22.722829 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:22.728285 | 9b75072e-4447-4e5d-98a0-797faddb82bf ==============================
[0m06:42:22.728285 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:22.727364 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:42:22.731072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 06:42:22.732201 | b034870f-c3bb-4371-855b-13591cbaf561 ==============================
[0m06:42:22.732201 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:22.734635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m06:42:22.735034 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m06:42:22.735137 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:22.742221 | 0cebd9b1-a351-4461-9e4f-31c90616b352 ==============================
[0m06:42:22.742221 [info ] [MainThread]: Running with dbt=1.8.2


============================== 06:42:22.742478 | ad68b189-3bfa-4960-9980-4a149777b27c ==============================
[0m06:42:22.742478 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:22.743031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m06:42:22.743957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_csv', 'send_anonymous_usage_stats': 'True'}
[0m06:42:22.864871 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.877167 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:22.891701 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.904174 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.906101 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:22.912591 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:22.916477 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:22.930865 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:23.027115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.027746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.042993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.043892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.063979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.064587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.107125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:23.109440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:23.127340 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.136566 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.141584 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.155758 [info ] [MainThread]: 
[0m06:42:23.156873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:23.156474 [info ] [MainThread]: 
[0m06:42:23.155397 [info ] [MainThread]: 
[0m06:42:23.158224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:23.157710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:23.157625 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:23.159135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:23.164215 [debug] [MainThread]: Command end result
[0m06:42:23.165818 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5012487, "process_user_time": 1.016279, "process_kernel_time": 0.060432, "process_mem_max_rss": "97344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:23.167984 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:23.167863 after 0.50 seconds
[0m06:42:23.168449 [debug] [MainThread]: Flushing usage events
[0m06:42:23.169139 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:23.171838 [info ] [MainThread]: 
[0m06:42:23.173050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:23.176141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:23.183736 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:23.185899 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:23.186397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:23.195178 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m06:42:23.197031 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:23.200332 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:23.200919 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:23.201228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:23.202406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:23.202965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:23.207349 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:23.209968 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:23.210187 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:23.210861 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:23.211510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:23.210579 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:23.211254 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:23.212475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:23.212998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:28.209478 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.008 seconds
[0m06:42:28.210844 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:28.214659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m06:42:28.217599 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:42:28.218323 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.218926 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m06:42:28.220011 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.008 seconds
[0m06:42:28.219289 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:28.215187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:42:28.220225 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.221689 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:28.222154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:28.220756 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.222981 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m06:42:28.222917 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.223923 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:28.225981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:28.225111 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:28.225406 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:28.225388 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:28.227063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:28.226293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:28.227051 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:28.226558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:28.231564 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m06:42:28.232224 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.228163 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:28.232828 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:28.230951 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:28.233053 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:28.232969 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.233821 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:28.234515 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:28.235209 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m06:42:28.235143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:28.235701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:28.236555 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:28.237289 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:28.237743 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.238338 [debug] [MainThread]: On master: BEGIN
[0m06:42:28.238796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:28.240380 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:42:28.240972 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:28.241481 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:28.242992 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:28.243396 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:42:28.243524 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.244117 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:28.244507 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:28.248180 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:28.249014 [debug] [MainThread]: SQL status: SELECT 14 in 0.004 seconds
[0m06:42:28.251029 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:28.253691 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.254112 [debug] [MainThread]: On master: BEGIN
[0m06:42:28.254665 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:28.255252 [debug] [MainThread]: On master: COMMIT
[0m06:42:28.255593 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.255896 [debug] [MainThread]: On master: COMMIT
[0m06:42:28.256295 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:28.256684 [debug] [MainThread]: On master: Close
[0m06:42:28.257124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:28.257454 [info ] [MainThread]: 
[0m06:42:28.262419 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.263011 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m06:42:28.263536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m06:42:28.264087 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.279626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.281266 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.316211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.319074 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.319466 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m06:42:28.319855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:28.327213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m06:42:28.327633 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.328112 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 

  

trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  



)


SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m06:42:28.634945 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.306 seconds
[0m06:42:28.645896 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m06:42:28.646423 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m06:42:28.646752 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m06:42:28.647509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m06:42:28.649042 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m06:42:28.650733 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 0[0m in 0.39s]
[0m06:42:28.651416 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m06:42:28.652695 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:28.653166 [debug] [MainThread]: On master: BEGIN
[0m06:42:28.653514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:33.231600 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:42:33.232619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:33.233062 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:33.235377 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m06:42:33.238498 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:33.239015 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:33.239776 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:42:33.240396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:33.240896 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:33.242761 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.001 seconds
[0m06:42:33.243890 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:33.243145 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.244367 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.244653 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:33.245042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:33.249588 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:33.250264 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.253824 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.254129 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.255074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:33.254870 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:33.259639 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:33.262333 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.266803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:33.265057 [debug] [MainThread]: SQL status: SELECT 14 in 0.007 seconds
[0m06:42:33.285109 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:33.288105 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.288454 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.295493 [debug] [MainThread]: SQL status: SELECT 14 in 0.015 seconds
[0m06:42:33.297487 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:33.298047 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.298375 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.298915 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:33.302854 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.303728 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.305887 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.309598 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.313040 [debug] [MainThread]: On master: Close
[0m06:42:33.313569 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:33.314425 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m06:42:33.315104 [info ] [MainThread]: 
[0m06:42:33.328916 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.342601 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.346566 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.348218 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.350563 [debug] [MainThread]: On master: Close
[0m06:42:33.351919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:33.354211 [info ] [MainThread]: 
[0m06:42:33.358889 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.360123 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_csv ...... [RUN]
[0m06:42:33.361182 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m06:42:33.360854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_csv)
[0m06:42:33.361755 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m06:42:33.362122 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.362316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m06:42:33.362825 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m06:42:33.377945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.378237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m06:42:33.379512 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.379595 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m06:42:33.412841 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.414255 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.414698 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: BEGIN
[0m06:42:33.415155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:33.417630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m06:42:33.419305 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:42:33.419874 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m06:42:33.420345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:42:33.420855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:33.421236 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.422050 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_csv"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_csv"
  
  
    as
  
  (
    


WITH 





resellers_csv AS (
  SELECT
    SPLIT_PART(SPLIT_PART(imported_file, '.', '-2'), '_', '-1') :: INT AS reseller_id,
    transaction_id,
    product_name,
    total_amount,
    number_of_purchased_postcards,
    created_date,
    office_location,
    sales_channel,
    loaded_timestamp
  FROM
    "sales_dw"."import"."resellercsv"

      



),
trans_csv AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    transaction_id,
    reseller_id,
    product_name,
    total_amount,
    number_of_purchased_postcards,
    created_date,
    office_location,
    sales_channel,
    loaded_timestamp
  FROM
    resellers_csv
)


SELECT
  t.customer_key,
  transaction_id,
  product_key,
  channel_key,
  t.reseller_id,
  to_char(
    created_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  number_of_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct AS commission_pct,
  loaded_timestamp
FROM
  trans_csv t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m06:42:33.425232 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m06:42:33.437112 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: COMMIT
[0m06:42:33.437626 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_csv"
[0m06:42:33.438018 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: COMMIT
[0m06:42:33.439027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:33.440417 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_csv: Close
[0m06:42:33.441720 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_csv . [[32mSELECT 0[0m in 0.08s]
[0m06:42:33.442397 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_csv
[0m06:42:33.443528 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.443944 [debug] [MainThread]: On master: BEGIN
[0m06:42:33.444246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:33.448270 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:33.448722 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.449096 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.449617 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.450162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.450598 [debug] [MainThread]: On master: Close
[0m06:42:33.451038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:33.451359 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_csv' was properly closed.
[0m06:42:33.451650 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:42:33.451986 [info ] [MainThread]: 
[0m06:42:33.452339 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m06:42:33.452908 [debug] [MainThread]: Command end result
[0m06:42:33.453244 [info ] [MainThread]: 
[0m06:42:33.453568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:33.453846 [info ] [MainThread]: 
[0m06:42:33.454117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:33.454692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.773054, "process_user_time": 1.17522, "process_kernel_time": 0.070614, "process_mem_max_rss": "106304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:33.455119 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:33.455064 after 10.77 seconds
[0m06:42:33.455411 [debug] [MainThread]: Flushing usage events
[0m06:42:33.657646 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m06:42:33.658538 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.659072 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:33.659515 [debug] [MainThread]: On master: COMMIT
[0m06:42:33.660377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:33.660927 [debug] [MainThread]: On master: Close
[0m06:42:33.662091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:33.663804 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m06:42:33.664902 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:42:33.665310 [info ] [MainThread]: 
[0m06:42:33.666050 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m06:42:33.666851 [debug] [MainThread]: Command end result
[0m06:42:33.667162 [info ] [MainThread]: 
[0m06:42:33.667486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:33.667914 [info ] [MainThread]: 
[0m06:42:33.668255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:33.668997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.991073, "process_user_time": 1.118725, "process_kernel_time": 0.073159, "process_mem_max_rss": "108152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:33.669639 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:33.669558 after 10.99 seconds
[0m06:42:33.670015 [debug] [MainThread]: Flushing usage events
[0m06:42:35.670978 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:35.675430 | 26363fd5-b03a-44bd-b43c-69f3be8faad3 ==============================
[0m06:42:35.675430 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:35.677688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:42:35.676066 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:35.680442 | 7b051f5a-0592-4cf9-897f-7eb6d44a9dc8 ==============================
[0m06:42:35.680442 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:35.680982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_csv', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:35.861357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:35.864395 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:35.875648 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:35.878511 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:36.028945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:36.029400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:36.029837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:36.030795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:36.083847 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:36.084598 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:36.085719 [info ] [MainThread]: 
[0m06:42:36.086801 [info ] [MainThread]: 
[0m06:42:36.086967 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:36.087489 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:36.089129 [debug] [MainThread]: Command end result
[0m06:42:36.090169 [debug] [MainThread]: Command end result
[0m06:42:36.091441 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44430062, "process_user_time": 0.939982, "process_kernel_time": 0.062197, "process_mem_max_rss": "97220", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:36.096129 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45988885, "process_user_time": 0.954093, "process_kernel_time": 0.052114, "process_mem_max_rss": "97440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:36.099372 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:36.099122 after 0.45 seconds
[0m06:42:36.118034 [debug] [MainThread]: Flushing usage events
[0m06:42:36.112244 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:36.111929 after 0.48 seconds
[0m06:42:36.125439 [debug] [MainThread]: Flushing usage events
[0m06:42:38.425719 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m06:42:38.426740 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:42:38.427392 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m06:42:43.483017 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.055 seconds
[0m06:42:43.502841 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m06:42:43.504987 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m06:42:43.505393 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m06:42:43.510706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m06:42:43.512244 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m06:42:43.514049 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 10.15s]
[0m06:42:43.517931 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m06:42:43.519245 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:43.520304 [debug] [MainThread]: On master: BEGIN
[0m06:42:43.520685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:43.525958 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:42:43.527748 [debug] [MainThread]: On master: COMMIT
[0m06:42:43.531256 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:43.532451 [debug] [MainThread]: On master: COMMIT
[0m06:42:43.534542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:43.534930 [debug] [MainThread]: On master: Close
[0m06:42:43.536233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:43.537419 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m06:42:43.538165 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:42:43.539493 [info ] [MainThread]: 
[0m06:42:43.540889 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 20.38 seconds (20.38s).
[0m06:42:43.541587 [debug] [MainThread]: Command end result
[0m06:42:43.542089 [info ] [MainThread]: 
[0m06:42:43.542534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:43.545314 [info ] [MainThread]: 
[0m06:42:43.545710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:43.546419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.860962, "process_user_time": 1.143426, "process_kernel_time": 0.070519, "process_mem_max_rss": "106688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:43.546929 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:43.546862 after 20.86 seconds
[0m06:42:43.547251 [debug] [MainThread]: Flushing usage events
[0m06:42:45.823005 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:45.830530 | 59d6a090-2b86-4628-98b1-79222fc305b8 ==============================
[0m06:42:45.830530 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:45.831073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m06:42:45.840509 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:45.845223 | 6e8e33cb-c6ae-481c-8476-80f47a891d9b ==============================
[0m06:42:45.845223 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:45.845878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:42:46.014175 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:46.017847 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:46.029573 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:46.035789 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:46.184935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:46.185461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:46.205704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:46.208805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:46.249360 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:46.253526 [info ] [MainThread]: 
[0m06:42:46.254109 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:46.254590 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:46.256109 [debug] [MainThread]: Command end result
[0m06:42:46.257352 [info ] [MainThread]: 
[0m06:42:46.257985 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46832046, "process_user_time": 1.02423, "process_kernel_time": 0.055941, "process_mem_max_rss": "97448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:46.258021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:46.258724 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:46.258621 after 0.47 seconds
[0m06:42:46.259648 [debug] [MainThread]: Flushing usage events
[0m06:42:46.259629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:46.283569 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:46.284301 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:46.284725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:51.295904 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m06:42:51.297816 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:51.302221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:51.302843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:51.307454 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:51.309198 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:51.309577 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:51.309939 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:51.310237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:51.310564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:51.316029 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m06:42:51.316653 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:51.317175 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:42:51.319519 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m06:42:51.320740 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:42:51.321348 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:42:56.314458 [debug] [ThreadPool]: SQL status: BEGIN in 5.004 seconds
[0m06:42:56.316150 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:56.316497 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:42:56.318425 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m06:42:56.319517 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:42:56.320037 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:42:56.324099 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.324519 [debug] [MainThread]: On master: BEGIN
[0m06:42:56.324896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:56.328835 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:42:56.329409 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.329897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:42:56.335260 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:42:56.337260 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:56.337796 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.338299 [debug] [MainThread]: On master: BEGIN
[0m06:42:56.338851 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:56.339290 [debug] [MainThread]: On master: COMMIT
[0m06:42:56.339651 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:56.340109 [debug] [MainThread]: On master: COMMIT
[0m06:42:56.340597 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:56.340923 [debug] [MainThread]: On master: Close
[0m06:42:56.341385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:56.341874 [info ] [MainThread]: 
[0m06:42:56.347217 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m06:42:56.347856 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m06:42:56.348368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions)
[0m06:42:56.348995 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m06:42:56.355477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m06:42:56.356725 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m06:42:56.383569 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m06:42:56.395794 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:56.396228 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m06:42:56.396572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:56.401003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m06:42:56.401516 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:56.404610 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_csv"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m06:42:57.141132 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.732 seconds
[0m06:42:57.146212 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:57.147248 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m06:42:57.150937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:57.164090 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m06:42:57.164674 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:57.166833 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m06:42:57.196124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m06:42:57.202685 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m06:42:57.208703 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m06:42:57.212822 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m06:42:57.213510 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m06:42:57.215411 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m06:42:57.219153 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1000000[0m in 0.87s]
[0m06:42:57.222779 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m06:42:57.224251 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:57.228960 [debug] [MainThread]: On master: BEGIN
[0m06:42:57.230862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:57.246113 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m06:42:57.252260 [debug] [MainThread]: On master: COMMIT
[0m06:42:57.252635 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:57.252962 [debug] [MainThread]: On master: COMMIT
[0m06:42:57.255710 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:42:57.256153 [debug] [MainThread]: On master: Close
[0m06:42:57.264573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:57.264916 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m06:42:57.265188 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m06:42:57.266901 [info ] [MainThread]: 
[0m06:42:57.267989 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.01 seconds (11.01s).
[0m06:42:57.275542 [debug] [MainThread]: Command end result
[0m06:42:57.281158 [info ] [MainThread]: 
[0m06:42:57.282239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:42:57.293825 [info ] [MainThread]: 
[0m06:42:57.294289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:42:57.295027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.504413, "process_user_time": 1.151582, "process_kernel_time": 0.06869, "process_mem_max_rss": "106332", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:57.295513 [debug] [MainThread]: Command `dbt run` succeeded at 06:42:57.295451 after 11.50 seconds
[0m06:42:57.295922 [debug] [MainThread]: Flushing usage events
[0m06:42:58.637839 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:58.642231 | 8c218d54-548c-478f-b9c3-e8986fb48cf8 ==============================
[0m06:42:58.642231 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:58.642980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m06:42:58.643520 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:42:58.652209 | d7b7cc7b-dcde-4b7c-b34c-8e25d482b06c ==============================
[0m06:42:58.652209 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:42:58.652743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m06:42:58.776646 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:58.788814 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:58.800059 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:42:58.811168 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:42:58.959200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:58.959909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:58.968060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:58.970086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:59.010263 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:59.011459 [info ] [MainThread]: 
[0m06:42:59.011999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:59.012695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m06:42:59.023474 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:42:59.028310 [info ] [MainThread]: 
[0m06:42:59.030222 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:42:59.034879 [debug] [MainThread]: Command end result
[0m06:42:59.034318 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m06:42:59.036566 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44232193, "process_user_time": 0.949552, "process_kernel_time": 0.062838, "process_mem_max_rss": "97452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:42:59.037636 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:59.038130 [debug] [MainThread]: Command `dbt test` succeeded at 06:42:59.037911 after 0.44 seconds
[0m06:42:59.039090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:59.039300 [debug] [MainThread]: Flushing usage events
[0m06:42:59.048086 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m06:42:59.050497 [debug] [ThreadPool]: On list_sales_dw: Close
[0m06:42:59.061019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:42:59.069918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m06:42:59.075608 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:42:59.083166 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:42:59.084177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:59.082732 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:42:59.098742 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:42:59.099240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:04.097015 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m06:43:04.106796 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m06:43:04.110094 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:43:04.112116 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:43:04.110998 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:43:04.121965 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:43:04.118456 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m06:43:04.127870 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:43:04.131138 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.004 seconds
[0m06:43:04.135514 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:43:04.133194 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:43:04.138816 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:43:04.149565 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:04.157203 [debug] [MainThread]: On master: BEGIN
[0m06:43:04.157526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:09.171995 [debug] [MainThread]: SQL status: BEGIN in 5.014 seconds
[0m06:43:09.175247 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.176140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:09.181842 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:43:09.193236 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:09.193850 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.210059 [debug] [MainThread]: On master: BEGIN
[0m06:43:09.218851 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:43:09.224287 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.224953 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:09.225279 [debug] [MainThread]: On master: COMMIT
[0m06:43:09.225733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:09.226051 [debug] [MainThread]: On master: Close
[0m06:43:09.226515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:09.229986 [info ] [MainThread]: 
[0m06:43:09.242128 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m06:43:09.246609 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m06:43:09.250542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m06:43:09.251530 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m06:43:09.260281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m06:43:09.266060 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m06:43:09.296057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m06:43:09.297757 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:09.298224 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m06:43:09.298604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:14.311058 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m06:43:14.315530 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:14.317913 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m06:43:15.157078 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.826 seconds
[0m06:43:15.168177 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:15.170832 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m06:43:15.173957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:15.192082 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m06:43:15.197560 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:15.199137 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m06:43:15.287089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.087 seconds
[0m06:43:15.292480 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m06:43:15.302540 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m06:43:15.309277 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m06:43:15.313848 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:43:15.319481 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m06:43:15.321849 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1000000[0m in 6.07s]
[0m06:43:15.322808 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m06:43:15.325743 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:15.326301 [debug] [MainThread]: On master: BEGIN
[0m06:43:15.326915 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:15.334946 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:43:15.338822 [debug] [MainThread]: On master: COMMIT
[0m06:43:15.340852 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:15.341148 [debug] [MainThread]: On master: COMMIT
[0m06:43:15.341533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:15.341822 [debug] [MainThread]: On master: Close
[0m06:43:15.342187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:15.342482 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m06:43:15.342733 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:43:15.345767 [info ] [MainThread]: 
[0m06:43:15.346143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.33 seconds (16.33s).
[0m06:43:15.346635 [debug] [MainThread]: Command end result
[0m06:43:15.348423 [info ] [MainThread]: 
[0m06:43:15.348937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:15.352200 [info ] [MainThread]: 
[0m06:43:15.352756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:43:15.354712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.765676, "process_user_time": 1.111532, "process_kernel_time": 0.069089, "process_mem_max_rss": "106152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:43:15.355233 [debug] [MainThread]: Command `dbt run` succeeded at 06:43:15.355164 after 16.77 seconds
[0m06:43:15.355581 [debug] [MainThread]: Flushing usage events
[0m06:43:17.071868 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:43:17.082510 | e4663c40-2a23-48ba-8132-a15917e99490 ==============================
[0m06:43:17.082510 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:43:17.085183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:17.222708 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m06:43:17.234593 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m06:43:17.446727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:17.447329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:17.499630 [info ] [MainThread]: Found 21 models, 1 test, 1 seed, 7 sources, 531 macros
[0m06:43:17.503616 [info ] [MainThread]: 
[0m06:43:17.505343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:17.510249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m06:43:17.510917 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m06:43:17.539155 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:43:17.539469 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:43:17.539908 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m06:43:17.540287 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m06:43:17.540601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:17.540994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:22.546174 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m06:43:22.546874 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m06:43:22.547862 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m06:43:22.548290 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m06:43:22.547424 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m06:43:22.552202 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m06:43:22.551902 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m06:43:22.553672 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m06:43:22.554234 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m06:43:22.554504 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.002 seconds
[0m06:43:22.556046 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m06:43:22.556467 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m06:43:22.561857 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.568210 [debug] [MainThread]: On master: BEGIN
[0m06:43:22.568671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:22.573143 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:43:22.573731 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.574134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:22.579400 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m06:43:22.581307 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:22.581876 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.582184 [debug] [MainThread]: On master: BEGIN
[0m06:43:22.582692 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:43:22.583197 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.583526 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.583820 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.584209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:22.584483 [debug] [MainThread]: On master: Close
[0m06:43:22.584961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:43:22.585309 [info ] [MainThread]: 
[0m06:43:22.590514 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.591131 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m06:43:22.591644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m06:43:22.592040 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.597840 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.599137 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.609091 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.612880 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.613462 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m06:43:22.614181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:22.618723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m06:43:22.619365 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m06:43:22.619957 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m06:43:22.746089 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.126 seconds
[0m06:43:22.749219 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m06:43:22.749872 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m06:43:22.750467 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.16s]
[0m06:43:22.751029 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m06:43:22.752229 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.752707 [debug] [MainThread]: On master: BEGIN
[0m06:43:22.753098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:22.759945 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:43:22.764351 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.767709 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:22.768481 [debug] [MainThread]: On master: COMMIT
[0m06:43:22.769058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:22.770826 [debug] [MainThread]: On master: Close
[0m06:43:22.771416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:22.771948 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m06:43:22.775638 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m06:43:22.776133 [info ] [MainThread]: 
[0m06:43:22.776519 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m06:43:22.777108 [debug] [MainThread]: Command end result
[0m06:43:22.777484 [info ] [MainThread]: 
[0m06:43:22.777886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:22.778244 [info ] [MainThread]: 
[0m06:43:22.778732 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:43:22.779465 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.740628, "process_user_time": 1.027292, "process_kernel_time": 0.070917, "process_mem_max_rss": "110224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:43:22.780035 [debug] [MainThread]: Command `dbt test` succeeded at 06:43:22.779951 after 5.74 seconds
[0m06:43:22.780434 [debug] [MainThread]: Flushing usage events
[0m07:04:56.993673 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:04:56.998079 | 467871ce-b443-4fe5-978c-4167c1c8b1b6 ==============================
[0m07:04:56.998079 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:04:56.998545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:04:57.090368 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:04:57.093228 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:04:57.102177 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7d314z3n'
[0m07:04:57.102639 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:04:57.103475 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:04:57.104008 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:04:57.104880 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14612137, "process_user_time": 0.779651, "process_kernel_time": 0.047282, "process_mem_max_rss": "105512", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:04:57.105395 [debug] [MainThread]: Command `dbt deps` succeeded at 07:04:57.105330 after 0.15 seconds
[0m07:04:57.107005 [debug] [MainThread]: Flushing usage events
[0m07:05:04.019899 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:05:04.024085 | 1eb12641-1f1b-4ab3-9b24-f41b65d0e047 ==============================
[0m07:05:04.024085 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:05:04.024566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:05:04.152159 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:05:04.163285 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:05:04.167668 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:05:05.201231 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:05:05.202548 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2215595, "process_user_time": 1.712001, "process_kernel_time": 0.06848, "process_mem_max_rss": "105436", "process_in_blocks": "48", "command_success": false, "process_out_blocks": "0"}
[0m07:05:05.206285 [debug] [MainThread]: Command `dbt seed` failed at 07:05:05.206178 after 1.23 seconds
[0m07:05:05.206804 [debug] [MainThread]: Flushing usage events
[0m07:06:18.632694 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:06:18.638240 | b531f5a2-94e0-4578-891a-461bd38bff89 ==============================
[0m07:06:18.638240 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:06:18.638993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m07:06:18.710424 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:06:18.711992 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:06:18.719011 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kg_peg40'
[0m07:06:18.722495 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:06:18.723304 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:06:18.724610 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:06:18.725506 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12797384, "process_user_time": 0.793089, "process_kernel_time": 0.047605, "process_mem_max_rss": "105500", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:06:18.727529 [debug] [MainThread]: Command `dbt deps` succeeded at 07:06:18.727434 after 0.13 seconds
[0m07:06:18.727935 [debug] [MainThread]: Flushing usage events
[0m07:06:25.324558 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:06:25.329136 | b1df4915-05ec-4b95-a5a3-d2de5cd77cc4 ==============================
[0m07:06:25.329136 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:06:25.329847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:06:25.468719 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:06:25.503119 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:06:25.506745 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:06:26.546281 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:06:26.548006 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2555717, "process_user_time": 1.868565, "process_kernel_time": 0.07947, "process_mem_max_rss": "105428", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:06:26.548969 [debug] [MainThread]: Command `dbt seed` failed at 07:06:26.548864 after 1.26 seconds
[0m07:06:26.550118 [debug] [MainThread]: Flushing usage events
[0m07:10:11.619853 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:10:11.625147 | fbe7b6c7-e71b-4e2e-b956-aea9d374790c ==============================
[0m07:10:11.625147 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:10:11.625767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:10:11.762954 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:10:11.852447 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:10:11.861703 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:10:12.863446 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:10:12.865012 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.280898, "process_user_time": 1.756347, "process_kernel_time": 0.100477, "process_mem_max_rss": "105436", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:10:12.865782 [debug] [MainThread]: Command `dbt seed` failed at 07:10:12.865666 after 1.28 seconds
[0m07:10:12.867344 [debug] [MainThread]: Flushing usage events
[0m07:14:19.165155 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:14:19.169629 | 6430dc43-9fd6-4953-82f4-37c7a2185627 ==============================
[0m07:14:19.169629 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:14:19.170228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m07:14:19.236131 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:14:19.238829 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:14:19.251342 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tnwzplj9'
[0m07:14:19.252068 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:14:19.252961 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:14:19.253421 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:14:19.254175 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12258896, "process_user_time": 0.770048, "process_kernel_time": 0.048065, "process_mem_max_rss": "105776", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m07:14:19.254731 [debug] [MainThread]: Command `dbt deps` succeeded at 07:14:19.254652 after 0.12 seconds
[0m07:14:19.255060 [debug] [MainThread]: Flushing usage events
[0m07:14:21.342696 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:14:21.347540 | ec9e707a-d987-4055-a295-29fb2092ef51 ==============================
[0m07:14:21.347540 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:14:21.350497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m07:14:21.482216 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:14:21.493572 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:14:21.497285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:14:22.496131 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_transactions' (models/staging/staging_transactions.sql) depends on a node named 'staging_transactions_resellers_csv' which was not found
[0m07:14:22.498972 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2293118, "process_user_time": 1.763419, "process_kernel_time": 0.084115, "process_mem_max_rss": "105712", "process_in_blocks": "8", "command_success": false, "process_out_blocks": "0"}
[0m07:14:22.499552 [debug] [MainThread]: Command `dbt seed` failed at 07:14:22.499466 after 1.23 seconds
[0m07:14:22.501190 [debug] [MainThread]: Flushing usage events
[0m07:15:43.876253 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:15:43.892894 | da881506-73f0-43f9-9bb8-dbb2fc8a21b7 ==============================
[0m07:15:43.892894 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:15:43.893553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:15:43.961922 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:15:43.965689 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:15:43.969392 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ynh1dy2i'
[0m07:15:43.970461 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:15:43.971508 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:15:43.975570 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:15:43.976734 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15183538, "process_user_time": 0.763294, "process_kernel_time": 0.048954, "process_mem_max_rss": "105784", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:15:43.977605 [debug] [MainThread]: Command `dbt deps` succeeded at 07:15:43.977484 after 0.15 seconds
[0m07:15:43.978466 [debug] [MainThread]: Flushing usage events
[0m07:15:46.062079 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:15:46.067898 | 663e2758-2a5e-42a7-bf11-82a676bdafaf ==============================
[0m07:15:46.067898 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:15:46.068576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:15:46.199531 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:15:46.219417 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:15:46.223711 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:15:47.305655 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_customers' (models/staging/staging_customers.sql) depends on a node named 'src_resellerscsv' which was not found
[0m07:15:47.322460 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.3347031, "process_user_time": 1.770517, "process_kernel_time": 0.050099, "process_mem_max_rss": "105804", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:15:47.323577 [debug] [MainThread]: Command `dbt seed` failed at 07:15:47.323471 after 1.34 seconds
[0m07:15:47.326718 [debug] [MainThread]: Flushing usage events
[0m07:16:00.206291 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:16:00.210517 | 82da1cd3-ba78-45b1-b5e2-797615608b25 ==============================
[0m07:16:00.210517 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:16:00.211534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:16:00.279818 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:16:00.281968 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:16:00.287613 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6nfraqlu'
[0m07:16:00.290808 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:16:00.291787 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:16:00.292318 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:16:00.293116 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13785154, "process_user_time": 0.823453, "process_kernel_time": 0.049691, "process_mem_max_rss": "105764", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:16:00.294489 [debug] [MainThread]: Command `dbt deps` succeeded at 07:16:00.293992 after 0.14 seconds
[0m07:16:00.295175 [debug] [MainThread]: Flushing usage events
[0m07:16:01.594893 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:16:01.600865 | dba1734b-a490-4780-a8d5-389428ba04f7 ==============================
[0m07:16:01.600865 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:16:01.601769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:16:01.737001 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:16:01.751683 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:16:01.752655 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:16:02.787378 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_customers' (models/staging/staging_customers.sql) depends on a node named 'src_resellerscsv' which was not found
[0m07:16:02.789476 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2240148, "process_user_time": 1.78372, "process_kernel_time": 0.063309, "process_mem_max_rss": "105700", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:16:02.791172 [debug] [MainThread]: Command `dbt seed` failed at 07:16:02.791098 after 1.23 seconds
[0m07:16:02.792151 [debug] [MainThread]: Flushing usage events
[0m07:19:53.115700 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:19:53.120166 | f2d2a0e3-a3c1-4069-ba2f-438b2ca907fe ==============================
[0m07:19:53.120166 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:19:53.120811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'send_anonymous_usage_stats': 'True'}
[0m07:19:53.195994 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:19:53.204511 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:19:53.220744 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j6fz0j7e'
[0m07:19:53.223134 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:19:53.235301 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:19:53.246481 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:19:53.263287 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17019142, "process_user_time": 0.765796, "process_kernel_time": 0.05751, "process_mem_max_rss": "105532", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:19:53.264170 [debug] [MainThread]: Command `dbt deps` succeeded at 07:19:53.264044 after 0.18 seconds
[0m07:19:53.275000 [debug] [MainThread]: Flushing usage events
[0m07:19:55.231957 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:19:55.235999 | e66ed934-edaf-4138-b646-9320f04bb161 ==============================
[0m07:19:55.235999 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:19:55.236610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:19:55.360121 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:19:55.375455 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:19:55.376438 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:19:56.433354 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtcomp.staging_customers' (models/staging/staging_customers.sql) depends on a node named 'src_resellerscsv' which was not found
[0m07:19:56.437032 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 1.2356415, "process_user_time": 1.712167, "process_kernel_time": 0.065426, "process_mem_max_rss": "105536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:19:56.437652 [debug] [MainThread]: Command `dbt seed` failed at 07:19:56.437567 after 1.24 seconds
[0m07:19:56.438344 [debug] [MainThread]: Flushing usage events
[0m07:20:47.607082 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:20:47.611278 | ee44dfca-2d77-4148-9d9e-27ba4b259d8f ==============================
[0m07:20:47.611278 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:20:47.611792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:20:47.678141 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:20:47.679294 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:20:47.684237 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-eivpj8z5'
[0m07:20:47.685047 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:20:47.687236 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:20:47.692057 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:20:47.696829 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12208363, "process_user_time": 0.77372, "process_kernel_time": 0.037986, "process_mem_max_rss": "105520", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:20:47.697394 [debug] [MainThread]: Command `dbt deps` succeeded at 07:20:47.697331 after 0.12 seconds
[0m07:20:47.698263 [debug] [MainThread]: Flushing usage events
[0m07:20:49.725984 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:20:49.730757 | b07480f7-a247-4597-af28-3b893cdad4bf ==============================
[0m07:20:49.730757 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:20:49.731273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:20:49.859767 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:20:49.915224 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:20:49.919230 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:20:51.149339 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:20:51.154120 [info ] [MainThread]: 
[0m07:20:51.155467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:20:51.156738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:20:51.178113 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:20:51.180410 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:20:51.180773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:56.189365 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.009 seconds
[0m07:20:56.190769 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:20:56.191615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m07:20:56.194256 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m07:20:56.198527 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:20:56.198991 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m07:20:56.199311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:56.204053 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:20:56.204660 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:20:56.205112 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m07:20:56.205881 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:20:56.206715 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:20:56.207161 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:20:56.207593 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:20:56.208407 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m07:20:56.208869 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m07:20:56.212655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m07:20:56.213078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:20:56.217509 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:20:56.219311 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:20:56.219779 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:20:56.220189 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:20:56.220514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:56.220810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:01.225353 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:21:01.225699 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:21:01.227066 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:21:01.227559 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:21:01.226571 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:21:01.228734 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:21:01.229839 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:21:01.230928 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:21:01.231165 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:21:01.232587 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:21:01.231649 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:21:01.233075 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:21:01.237234 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:01.237707 [debug] [MainThread]: On master: BEGIN
[0m07:21:01.238129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:06.242508 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:21:06.243298 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.243945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:21:06.247578 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:21:06.249963 [debug] [MainThread]: On master: ROLLBACK
[0m07:21:06.250785 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.251546 [debug] [MainThread]: On master: BEGIN
[0m07:21:06.252984 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:21:06.253648 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.254063 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.254471 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.254945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:21:06.255308 [debug] [MainThread]: On master: Close
[0m07:21:06.255905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:21:06.256498 [info ] [MainThread]: 
[0m07:21:06.261454 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m07:21:06.262075 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m07:21:06.262510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m07:21:06.262803 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m07:21:06.263071 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m07:21:06.281159 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.281808 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m07:21:06.282291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:06.291669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:21:06.297358 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.297869 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m07:21:06.303419 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m07:21:06.350896 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.351581 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m07:21:06.352979 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m07:21:06.356657 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m07:21:06.368406 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:21:06.368872 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:21:06.369324 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:21:06.370344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:21:06.371802 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m07:21:06.373100 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.11s]
[0m07:21:06.375021 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m07:21:06.376171 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.376672 [debug] [MainThread]: On master: BEGIN
[0m07:21:06.376954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:21:06.381064 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:21:06.381771 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.382254 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:06.382704 [debug] [MainThread]: On master: COMMIT
[0m07:21:06.383234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:21:06.383585 [debug] [MainThread]: On master: Close
[0m07:21:06.383991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:06.384288 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m07:21:06.384538 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:21:06.384912 [info ] [MainThread]: 
[0m07:21:06.385417 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.23 seconds (15.23s).
[0m07:21:06.386127 [debug] [MainThread]: Command end result
[0m07:21:06.462134 [info ] [MainThread]: 
[0m07:21:06.466083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:21:06.467447 [info ] [MainThread]: 
[0m07:21:06.468265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:21:06.473477 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.775629, "process_user_time": 2.088432, "process_kernel_time": 0.096481, "process_mem_max_rss": "113848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:21:06.480585 [debug] [MainThread]: Command `dbt seed` succeeded at 07:21:06.480493 after 16.78 seconds
[0m07:21:06.482641 [debug] [MainThread]: Flushing usage events
[0m07:28:26.742320 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:28:26.746641 | 95652746-abd9-4761-86bc-e403a7278267 ==============================
[0m07:28:26.746641 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:28:26.748485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:28:26.877754 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:28:26.885614 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:28:26.900081 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vrhv3doy'
[0m07:28:26.901611 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:28:26.903510 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:28:26.904215 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:28:26.905239 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19622183, "process_user_time": 0.837671, "process_kernel_time": 0.077167, "process_mem_max_rss": "105512", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:28:26.905968 [debug] [MainThread]: Command `dbt deps` succeeded at 07:28:26.905827 after 0.20 seconds
[0m07:28:26.907447 [debug] [MainThread]: Flushing usage events
[0m07:28:28.784779 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:28:28.790055 | 46ae42d0-394d-40a0-ab6c-6e6be5b5e385 ==============================
[0m07:28:28.790055 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:28:28.790941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:28:28.929004 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:28:28.960890 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:28:28.969974 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:28:30.366608 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:28:30.368622 [info ] [MainThread]: 
[0m07:28:30.369296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:28:30.371535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:28:30.391908 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:28:30.392503 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:28:30.392884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:30.398339 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m07:28:30.399342 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:28:30.399953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m07:28:30.400538 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m07:28:30.404536 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:28:30.405026 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m07:28:30.405325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:35.411925 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:28:35.412696 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:28:35.413064 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m07:28:35.413749 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:28:35.414737 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:28:35.415288 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:28:35.415707 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:28:35.416721 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m07:28:35.417224 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m07:28:35.421231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev)
[0m07:28:35.421716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:28:35.428958 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:28:35.431151 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:28:35.431867 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:28:35.432863 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:28:35.433704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:35.437302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:35.445408 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m07:28:35.448270 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:28:35.448769 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:28:35.451446 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:28:35.452433 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:28:35.452835 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:28:40.446781 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m07:28:40.449905 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:28:40.450411 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:28:40.452703 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:28:40.453726 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:28:40.454201 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:28:40.459252 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.462873 [debug] [MainThread]: On master: BEGIN
[0m07:28:40.463297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:40.467891 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:28:40.468376 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.471344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:28:40.480199 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:28:40.481402 [debug] [MainThread]: On master: ROLLBACK
[0m07:28:40.481873 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.482176 [debug] [MainThread]: On master: BEGIN
[0m07:28:40.482668 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:28:40.483131 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.483619 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.484054 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.484511 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:40.484879 [debug] [MainThread]: On master: Close
[0m07:28:40.485339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:28:40.485746 [info ] [MainThread]: 
[0m07:28:40.490563 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m07:28:40.491219 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m07:28:40.491794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m07:28:40.492195 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m07:28:40.492527 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m07:28:40.510826 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.513171 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m07:28:40.513622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:40.517906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:28:40.518545 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.519007 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m07:28:40.522861 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m07:28:40.577385 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.578008 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m07:28:40.579268 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m07:28:40.582919 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m07:28:40.594798 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:28:40.595561 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:28:40.596312 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:28:40.597616 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:28:40.599146 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m07:28:40.600432 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.11s]
[0m07:28:40.601127 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m07:28:40.602294 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.602750 [debug] [MainThread]: On master: BEGIN
[0m07:28:40.603158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:28:40.607726 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:28:40.608383 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.608851 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:40.609255 [debug] [MainThread]: On master: COMMIT
[0m07:28:40.609722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:40.610330 [debug] [MainThread]: On master: Close
[0m07:28:40.610909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:40.611373 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:28:40.611850 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m07:28:40.612596 [info ] [MainThread]: 
[0m07:28:40.613078 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m07:28:40.615226 [debug] [MainThread]: Command end result
[0m07:28:40.690626 [info ] [MainThread]: 
[0m07:28:40.691484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:28:40.691954 [info ] [MainThread]: 
[0m07:28:40.692431 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:28:40.693335 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.941379, "process_user_time": 2.171701, "process_kernel_time": 0.090402, "process_mem_max_rss": "116080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:28:40.693928 [debug] [MainThread]: Command `dbt seed` succeeded at 07:28:40.693844 after 11.94 seconds
[0m07:28:40.694259 [debug] [MainThread]: Flushing usage events
[0m07:29:33.826441 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:33.850360 | a20a2d22-5680-4a03-a5a7-0ccd703623f0 ==============================
[0m07:29:33.850360 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:33.903406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:29:33.939705 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:29:33.944573 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:33.967606 | 2f3e6e1b-1905-4457-9616-bde8b06e5baa ==============================
[0m07:29:33.967606 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:29:33.975685 | 05f1da52-6f20-4e32-9c19-ffcce6fa97cc ==============================
[0m07:29:33.975685 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:33.977007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:33.978439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:33.987631 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:33.996903 | a0f0f4cc-9ffc-4578-9603-aa4a3ad15031 ==============================
[0m07:29:33.996903 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.002890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:34.000675 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:34.006882 | cdef319e-103c-4a18-bbce-ebea6a847037 ==============================
[0m07:29:34.006882 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.009901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:34.008839 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:29:34.012741 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:34.026133 | 29cfe65a-b874-4d52-b148-df26a544a3b6 ==============================
[0m07:29:34.026133 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.032735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 07:29:34.032347 | eec32e36-f78f-4817-a19e-2beeb4957f72 ==============================
[0m07:29:34.032347 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:34.037798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:34.380222 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.383830 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.424907 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.428927 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.435511 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.444353 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.448356 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.457237 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.463310 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:34.467647 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.467016 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.471263 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.485443 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.497829 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:34.557899 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.560268 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.564368 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.565364 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.569853 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.570582 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.581768 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.582463 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.584556 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.585464 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.594297 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.595650 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:29:34.595276 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:34.596330 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:29:35.980607 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:35.994124 [info ] [MainThread]: 
[0m07:29:36.060419 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.077728 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.082523 [info ] [MainThread]: 
[0m07:29:36.082316 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.086645 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.087147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.083874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.090272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.090534 [info ] [MainThread]: 
[0m07:29:36.091347 [info ] [MainThread]: 
[0m07:29:36.095944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.096967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.098219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.101391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.114085 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.115249 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.117405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.118839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.119835 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.120606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.128655 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m07:29:36.128603 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.129950 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m07:29:36.130888 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.133399 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.131926 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.136740 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.137516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:29:36.137905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.137333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:29:36.139376 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:29:36.138837 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.141309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.141407 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:29:36.145601 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.148687 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.149133 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:29:36.151478 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:29:36.151403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.152326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.157139 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m07:29:36.159851 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.160969 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:29:36.161568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:29:36.162258 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m07:29:36.162440 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.162578 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.163701 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.163498 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:29:36.163995 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:29:36.164653 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:29:36.165546 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:29:36.165837 [info ] [MainThread]: 
[0m07:29:36.166754 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.166852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.167313 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.167861 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.168257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.168932 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.169418 [debug] [ThreadPool]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_namespace_nspname_index"
DETAIL:  Key (nspname)=(dev) already exists.

[0m07:29:36.170126 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:29:36.170450 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.170871 [debug] [ThreadPool]: On create_sales_dw_dev: ROLLBACK
[0m07:29:36.172441 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:29:36.176555 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m07:29:36.177606 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:29:36.177973 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.176762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.178424 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:29:36.177763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m07:29:36.179987 [info ] [MainThread]: 
[0m07:29:36.181161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:36.181706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.181870 [debug] [MainThread]: Connection 'create_sales_dw_dev' was properly closed.
[0m07:29:36.182947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.182857 [info ] [MainThread]: 
[0m07:29:36.178496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:29:36.186096 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m07:29:36.185271 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m07:29:36.189653 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.190145 [error] [MainThread]: Encountered an error:
Database Error
  duplicate key value violates unique constraint "pg_namespace_nspname_index"
  DETAIL:  Key (nspname)=(dev) already exists.
[0m07:29:36.190775 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:29:36.191016 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.191728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4314363, "process_user_time": 2.587519, "process_kernel_time": 0.154381, "process_mem_max_rss": "111356", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:36.191895 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.192311 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.192300 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:29:36.192875 [debug] [MainThread]: Command `dbt run` failed at 07:29:36.192772 after 2.43 seconds
[0m07:29:36.192990 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.193391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.194118 [debug] [MainThread]: Flushing usage events
[0m07:29:36.185156 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.194388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.194362 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.195277 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.195735 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:29:36.196065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.196404 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:29:36.197162 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.197674 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:29:36.203914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m07:29:36.204666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:36.211309 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.220338 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.220345 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.219179 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.223244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.223634 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.223940 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.225153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.225556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.230620 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:36.231616 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.232249 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:36.232299 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m07:29:36.231109 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:36.233690 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.234215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.234974 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:36.235370 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:29:36.237636 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:36.237993 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:36.238425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:36.238750 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:36.239137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:36.239611 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:36.244328 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.247688 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:36.247014 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.248871 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.249321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.248153 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.250013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.253225 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.253819 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.254165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:36.259426 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:36.260587 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.261121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:36.264580 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:36.266002 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:36.266726 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.267274 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.267947 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:36.269016 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.270152 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.271277 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.272157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.272906 [debug] [MainThread]: On master: Close
[0m07:29:36.273592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:36.274622 [info ] [MainThread]: 
[0m07:29:36.282606 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m07:29:36.283293 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m07:29:36.283764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m07:29:36.284092 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m07:29:36.288992 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:36.289819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m07:29:36.290642 [info ] [MainThread]: 
[0m07:29:36.291323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:36.291778 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m07:29:36.292836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:36.316391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m07:29:36.316555 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:36.317195 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:36.317808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.319725 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:36.320295 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m07:29:36.320947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:36.324637 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m07:29:36.325969 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:36.329934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:36.330888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:36.336062 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.337996 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.338402 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:36.338846 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:36.342412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:36.341606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:36.348986 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:36.349717 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:36.350144 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:29:36.350979 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:36.351414 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:36.350541 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:36.353443 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:29:36.353692 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:36.354708 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:36.355627 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:36.356151 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:36.356487 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:36.361128 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.361725 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.362118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:36.368146 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:29:36.368807 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.369436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:36.372615 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:36.375209 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:36.375882 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.376340 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.377064 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:36.377701 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.378128 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.378480 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.378978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.379482 [debug] [MainThread]: On master: Close
[0m07:29:36.380089 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:36.380569 [info ] [MainThread]: 
[0m07:29:36.385718 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m07:29:36.386293 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m07:29:36.386845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m07:29:36.387665 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m07:29:36.393392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m07:29:36.399025 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m07:29:36.437110 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m07:29:36.439715 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.440726 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m07:29:36.441550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:36.452718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m07:29:36.453887 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.458539 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m07:29:36.472744 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.009 seconds
[0m07:29:36.479754 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.480808 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m07:29:36.486400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:36.500437 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:29:36.504289 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.511294 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:29:36.512467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:36.521963 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m07:29:36.524834 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:29:36.526916 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m07:29:36.528232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:29:36.529797 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m07:29:36.531995 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.14s]
[0m07:29:36.532690 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m07:29:36.534379 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.535490 [debug] [MainThread]: On master: BEGIN
[0m07:29:36.536153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:36.545384 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:29:36.545967 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.546480 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:36.546930 [debug] [MainThread]: On master: COMMIT
[0m07:29:36.547580 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:36.548158 [debug] [MainThread]: On master: Close
[0m07:29:36.548782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:36.549237 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:36.549644 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m07:29:36.549980 [info ] [MainThread]: 
[0m07:29:36.550324 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m07:29:36.550853 [debug] [MainThread]: Command end result
[0m07:29:36.551237 [info ] [MainThread]: 
[0m07:29:36.551801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:36.552281 [info ] [MainThread]: 
[0m07:29:36.552769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:36.553598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6290135, "process_user_time": 2.912001, "process_kernel_time": 0.181503, "process_mem_max_rss": "114904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:36.554107 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:36.554038 after 2.63 seconds
[0m07:29:36.554428 [debug] [MainThread]: Flushing usage events
[0m07:29:38.445145 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:38.450904 | 96793083-b1f1-4eee-af8e-9161573c79d8 ==============================
[0m07:29:38.450904 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:38.452501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m07:29:38.581761 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:38.592428 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:38.803430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:38.803889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:38.856991 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:38.858355 [info ] [MainThread]: 
[0m07:29:38.858835 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:38.860266 [debug] [MainThread]: Command end result
[0m07:29:38.860911 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45664746, "process_user_time": 0.942704, "process_kernel_time": 0.072592, "process_mem_max_rss": "97536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:38.861351 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:38.861294 after 0.46 seconds
[0m07:29:38.861663 [debug] [MainThread]: Flushing usage events
[0m07:29:41.144790 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:29:41.149209 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:41.152816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:41.153471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:41.159834 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.160303 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:41.160707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:41.158083 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.161727 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:41.162246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:41.165372 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.166171 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.166632 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.168791 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.169984 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.170599 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.199249 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:29:41.199983 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.200531 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:41.202676 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.202779 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.008 seconds
[0m07:29:41.205256 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:41.205243 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:41.205778 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:29:41.206236 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:41.206769 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.207916 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.210862 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.210281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:41.212144 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.212754 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.210935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:41.217196 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.217607 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.218065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:41.215810 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.218686 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.219393 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:41.219882 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:41.221701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:41.222614 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.223372 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.222217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:41.223923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:41.227994 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:41.229389 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:41.229218 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:41.230111 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.230121 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.230535 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.230883 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.231339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:41.231915 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.232492 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.232937 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.233512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.234004 [debug] [MainThread]: On master: Close
[0m07:29:41.233798 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.234548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:41.235176 [info ] [MainThread]: 
[0m07:29:41.235612 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.239579 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.240671 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m07:29:41.241331 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m07:29:41.242131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m07:29:41.242651 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m07:29:41.248472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m07:29:41.249769 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m07:29:41.255354 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:29:41.255748 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:29:41.258514 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:41.258977 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:41.259490 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:41.260212 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:41.262574 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.263691 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:41.263947 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:41.264451 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:41.265115 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:41.266244 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:41.270514 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.271146 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.271624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:41.274434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m07:29:41.276297 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:41.276328 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.276975 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m07:29:41.277422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:41.277371 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.278066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:41.281345 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:41.282437 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:41.283023 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.283423 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.283965 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:41.284499 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.284986 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.285435 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.285934 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.286403 [debug] [MainThread]: On master: Close
[0m07:29:41.287149 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:41.287742 [info ] [MainThread]: 
[0m07:29:41.293309 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m07:29:41.294336 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m07:29:41.295164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m07:29:41.298465 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m07:29:41.304001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m07:29:41.305380 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m07:29:41.328626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m07:29:41.339772 [debug] [Thread-1 (]: SQL status: BEGIN in 5.018 seconds
[0m07:29:41.341299 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.341819 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.343240 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m07:29:41.344378 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m07:29:41.345795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:41.353513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:29:41.354785 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m07:29:41.356199 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.363832 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.364583 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m07:29:41.364894 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m07:29:41.370714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:29:41.372235 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:29:41.383436 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:29:41.389694 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.391574 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:29:41.394794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:41.400105 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.402674 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m07:29:41.403082 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m07:29:41.406969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:29:41.409529 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:29:41.410154 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m07:29:41.410887 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:41.412746 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m07:29:41.414297 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 5.13s]
[0m07:29:41.415040 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m07:29:41.416459 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.417092 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.417113 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:29:41.417576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:41.417747 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.418361 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:29:41.419303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.422172 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:41.423493 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.423911 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.424778 [debug] [MainThread]: On master: COMMIT
[0m07:29:41.424802 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m07:29:41.428187 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:29:41.425553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:41.428626 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m07:29:41.429157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:41.428912 [debug] [MainThread]: On master: Close
[0m07:29:41.430676 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m07:29:41.431152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:41.431991 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m07:29:41.432521 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:41.432889 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m07:29:41.433302 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m07:29:41.433688 [info ] [MainThread]: 
[0m07:29:41.434270 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m07:29:41.434215 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:41.434895 [debug] [MainThread]: Command end result
[0m07:29:41.434878 [debug] [MainThread]: On master: BEGIN
[0m07:29:41.435292 [info ] [MainThread]: 
[0m07:29:41.435435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:41.435842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:41.436429 [info ] [MainThread]: 
[0m07:29:41.436964 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:41.437880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6773148, "process_user_time": 2.706075, "process_kernel_time": 0.193526, "process_mem_max_rss": "113048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:41.438520 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:41.438440 after 7.68 seconds
[0m07:29:41.438954 [debug] [MainThread]: Flushing usage events
[0m07:29:43.366404 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:43.370743 | 1b453061-20e1-448f-b18d-4be5d1f1d653 ==============================
[0m07:29:43.370743 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:43.371414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:43.375114 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:43.379319 | df13ceec-e77f-48af-bc53-0e5292d13745 ==============================
[0m07:29:43.379319 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:43.379862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:43.490095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:43.501920 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:43.502009 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:43.513187 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:43.713144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:43.713805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:43.713453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:43.715214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:43.756175 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:43.757578 [info ] [MainThread]: 
[0m07:29:43.758287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:43.759210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:43.765151 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:43.766444 [info ] [MainThread]: 
[0m07:29:43.767010 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:43.768476 [debug] [MainThread]: Command end result
[0m07:29:43.769346 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42291534, "process_user_time": 0.987886, "process_kernel_time": 0.067885, "process_mem_max_rss": "97956", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:43.770194 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:43.770107 after 0.42 seconds
[0m07:29:43.770733 [debug] [MainThread]: Flushing usage events
[0m07:29:43.781909 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:43.782576 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:43.783119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:43.789233 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:29:43.790495 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:43.794317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:43.794860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:43.799277 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:43.801170 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:43.801696 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:43.802333 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:43.802879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:43.803372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:43.807992 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:43.808660 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:43.809794 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:43.812176 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m07:29:43.813432 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:43.814106 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:46.172328 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:29:46.173316 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:46.173872 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:46.176438 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m07:29:46.177753 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:46.178461 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:46.183540 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.187261 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.190801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:46.253906 [debug] [ThreadPool]: SQL status: BEGIN in 5.032 seconds
[0m07:29:46.271927 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:46.284732 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:46.288338 [debug] [Thread-1 (]: SQL status: BEGIN in 5.011 seconds
[0m07:29:46.289179 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.289679 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m07:29:46.290040 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m07:29:46.291329 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:46.291639 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:46.292212 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:46.297158 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.298033 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m07:29:46.299167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:46.301813 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.305817 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.306496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:46.315948 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:29:46.316692 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:29:46.316688 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.317163 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.317663 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:29:46.318205 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:46.319713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:46.322137 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m07:29:46.324362 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m07:29:46.325630 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:46.328781 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:29:46.329394 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.329819 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m07:29:46.330145 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.330664 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:46.330738 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:46.332557 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m07:29:46.332916 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.334306 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 5.09s]
[0m07:29:46.334714 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.335217 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m07:29:46.335551 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.336015 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.336459 [debug] [MainThread]: On master: Close
[0m07:29:46.336960 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:46.336723 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.337375 [info ] [MainThread]: 
[0m07:29:46.337692 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.341207 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:46.345425 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m07:29:46.346456 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m07:29:46.346117 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:46.347150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m07:29:46.347494 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.347840 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m07:29:46.348140 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.352178 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.353351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m07:29:46.353897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.354480 [debug] [MainThread]: On master: Close
[0m07:29:46.354579 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m07:29:46.355148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:46.356273 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m07:29:46.356730 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:46.359284 [info ] [MainThread]: 
[0m07:29:46.359793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m07:29:46.360413 [debug] [MainThread]: Command end result
[0m07:29:46.360733 [info ] [MainThread]: 
[0m07:29:46.361102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:46.361420 [info ] [MainThread]: 
[0m07:29:46.365240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:46.370562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.475563, "process_user_time": 2.682901, "process_kernel_time": 0.168576, "process_mem_max_rss": "112544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:46.372369 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:46.372266 after 12.48 seconds
[0m07:29:46.372818 [debug] [MainThread]: Flushing usage events
[0m07:29:46.382369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m07:29:46.383491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.383796 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m07:29:46.384075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:46.388829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:29:46.389564 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.389966 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m07:29:46.391354 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:46.396532 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.397249 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m07:29:46.398124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:46.405507 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:29:46.405854 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.406304 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:29:46.407498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:46.411503 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m07:29:46.414728 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:29:46.415193 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m07:29:46.415673 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:46.417291 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m07:29:46.418628 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m07:29:46.419423 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m07:29:46.420735 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.421203 [debug] [MainThread]: On master: BEGIN
[0m07:29:46.421488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:46.427363 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:29:46.428078 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.428736 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.429179 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.429816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.432899 [debug] [MainThread]: On master: Close
[0m07:29:46.433420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:46.433751 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m07:29:46.434157 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:29:46.434593 [info ] [MainThread]: 
[0m07:29:46.434943 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m07:29:46.435597 [debug] [MainThread]: Command end result
[0m07:29:46.435983 [info ] [MainThread]: 
[0m07:29:46.436394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:46.436726 [info ] [MainThread]: 
[0m07:29:46.437082 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:46.437767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.736775, "process_user_time": 2.663996, "process_kernel_time": 0.165745, "process_mem_max_rss": "112580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:46.438208 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:46.438153 after 12.74 seconds
[0m07:29:46.438576 [debug] [MainThread]: Flushing usage events
[0m07:29:46.440616 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m07:29:46.443361 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.444064 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:46.444624 [debug] [MainThread]: On master: COMMIT
[0m07:29:46.446007 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:46.450245 [debug] [MainThread]: On master: Close
[0m07:29:46.450820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:46.451197 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m07:29:46.451633 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:29:46.452091 [info ] [MainThread]: 
[0m07:29:46.452464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m07:29:46.453063 [debug] [MainThread]: Command end result
[0m07:29:46.453439 [info ] [MainThread]: 
[0m07:29:46.453895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:46.454272 [info ] [MainThread]: 
[0m07:29:46.454669 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:46.455487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.586031, "process_user_time": 2.836276, "process_kernel_time": 0.176773, "process_mem_max_rss": "114608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:46.458622 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:46.458482 after 12.59 seconds
[0m07:29:46.459178 [debug] [MainThread]: Flushing usage events
[0m07:29:48.502232 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:48.507804 | b70abfa3-d667-413b-9bb6-67b8a7cd8b73 ==============================
[0m07:29:48.507804 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.509502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m07:29:48.516842 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:48.521995 | 648d185e-0b95-469b-b76b-0777ee112a50 ==============================
[0m07:29:48.521995 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.522609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m07:29:48.528283 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:48.538554 | 673b8ac0-6fdd-49ff-a3a9-3ecd27d976c4 ==============================
[0m07:29:48.538554 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.535054 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:29:48.539519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 07:29:48.540793 | 64bd2480-c37a-483d-90d1-d19e45933986 ==============================
[0m07:29:48.540793 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:48.541897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:48.650051 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.663811 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.664995 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.667673 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.684243 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.686887 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.695933 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:48.715909 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:48.816129 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m07:29:48.834283 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:48.842413 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:48.845704 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:48.848035 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:48.849208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:48.854343 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.855526 [debug] [MainThread]: On master: BEGIN
[0m07:29:48.858983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:48.871857 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:29:48.875291 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.879361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:48.884987 [debug] [MainThread]: SQL status: SELECT 4 in 0.003 seconds
[0m07:29:48.888283 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:48.890387 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.892793 [debug] [MainThread]: On master: BEGIN
[0m07:29:48.896216 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:29:48.897923 [debug] [MainThread]: On master: COMMIT
[0m07:29:48.899482 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:48.900743 [debug] [MainThread]: On master: COMMIT
[0m07:29:48.902457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:48.903869 [debug] [MainThread]: On master: Close
[0m07:29:48.905742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:48.907490 [info ] [MainThread]: 
[0m07:29:48.919130 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m07:29:48.920214 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m07:29:48.921236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m07:29:48.921784 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m07:29:48.926979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.927748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.930497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m07:29:48.931359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.932111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.932558 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m07:29:48.939262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.939936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.959776 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m07:29:48.962359 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:48.962632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:48.963317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:48.963306 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m07:29:48.965926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:48.975194 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:48.976640 [info ] [MainThread]: 
[0m07:29:48.977272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:48.978168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:48.986399 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:48.987827 [info ] [MainThread]: 
[0m07:29:48.988446 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:48.989888 [debug] [MainThread]: Command end result
[0m07:29:48.990658 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5173834, "process_user_time": 0.9798, "process_kernel_time": 0.05929, "process_mem_max_rss": "97580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:48.991202 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:48.991134 after 0.52 seconds
[0m07:29:48.991748 [debug] [MainThread]: Flushing usage events
[0m07:29:49.000704 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:49.002014 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:49.001504 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:49.003538 [info ] [MainThread]: 
[0m07:29:49.004157 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:49.004109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:49.005688 [debug] [MainThread]: Command end result
[0m07:29:49.006538 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53415614, "process_user_time": 1.009685, "process_kernel_time": 0.060824, "process_mem_max_rss": "97584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:49.007254 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:49.007147 after 0.53 seconds
[0m07:29:49.007751 [debug] [MainThread]: Flushing usage events
[0m07:29:49.017662 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:49.018977 [info ] [MainThread]: 
[0m07:29:49.019474 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:49.021082 [debug] [MainThread]: Command end result
[0m07:29:49.021969 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52163655, "process_user_time": 1.02789, "process_kernel_time": 0.052608, "process_mem_max_rss": "97500", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:49.022490 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:49.022421 after 0.52 seconds
[0m07:29:49.022827 [debug] [MainThread]: Flushing usage events
[0m07:29:51.197178 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:29:51.203988 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.204532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:51.208796 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m07:29:51.209855 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:51.210431 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.210742 [debug] [MainThread]: On master: BEGIN
[0m07:29:51.211310 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:29:51.211680 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.212138 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.212625 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.214191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:51.214613 [debug] [MainThread]: On master: Close
[0m07:29:51.215132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:51.218891 [info ] [MainThread]: 
[0m07:29:51.224060 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m07:29:51.224987 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m07:29:51.225895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m07:29:51.226326 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m07:29:51.231914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m07:29:51.233543 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m07:29:51.257502 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m07:29:51.259250 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.259686 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m07:29:51.259993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:51.264775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:29:51.265245 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.265583 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m07:29:51.266963 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:51.271774 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.272383 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m07:29:51.273122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:51.282179 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:29:51.282826 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.283247 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:29:51.284063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:29:51.288611 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m07:29:51.291987 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:29:51.292628 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m07:29:51.293491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:51.295254 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m07:29:51.296552 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m07:29:51.297279 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m07:29:51.298417 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.298892 [debug] [MainThread]: On master: BEGIN
[0m07:29:51.299387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:51.304319 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:51.307619 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.308288 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:51.308838 [debug] [MainThread]: On master: COMMIT
[0m07:29:51.309440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:51.310065 [debug] [MainThread]: On master: Close
[0m07:29:51.310714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:51.311205 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m07:29:51.311615 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:29:51.312018 [info ] [MainThread]: 
[0m07:29:51.312398 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.22 seconds (15.22s).
[0m07:29:51.313019 [debug] [MainThread]: Command end result
[0m07:29:51.313407 [info ] [MainThread]: 
[0m07:29:51.313827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:51.314206 [info ] [MainThread]: 
[0m07:29:51.314591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:51.315333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.473646, "process_user_time": 2.610602, "process_kernel_time": 0.188161, "process_mem_max_rss": "112564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:51.316079 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:51.316007 after 17.47 seconds
[0m07:29:51.316505 [debug] [MainThread]: Flushing usage events
[0m07:29:53.531090 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:53.535801 | 57545678-4e60-4baa-9470-83dc93a2e375 ==============================
[0m07:29:53.535801 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:53.536989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:53.559273 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:53.567730 | 219b2cfc-edbe-47e9-bc7e-d8b20933ff4c ==============================
[0m07:29:53.567730 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:53.569136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:29:53.670171 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:53.685549 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:53.713488 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:53.747973 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:53.840377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:53.840802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:53.893360 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:53.895144 [info ] [MainThread]: 
[0m07:29:53.895742 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:53.897139 [debug] [MainThread]: Command end result
[0m07:29:53.897801 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39876312, "process_user_time": 1.007807, "process_kernel_time": 0.062924, "process_mem_max_rss": "97712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:53.898249 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:53.898188 after 0.40 seconds
[0m07:29:53.898553 [debug] [MainThread]: Flushing usage events
[0m07:29:53.917061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:53.919894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:53.965693 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:53.967367 [info ] [MainThread]: 
[0m07:29:53.968112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:53.969049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:53.976505 [debug] [Thread-1 (]: SQL status: BEGIN in 5.011 seconds
[0m07:29:53.977646 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:53.978302 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m07:29:53.981253 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:29:53.988398 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:53.989933 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m07:29:53.992570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:53.996496 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:53.997220 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:53.997779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:54.002977 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:29:54.003662 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:54.003596 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:29:54.004186 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:29:54.005145 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:54.005288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:54.011147 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:29:54.012315 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m07:29:54.016059 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:29:54.013292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:29:54.014168 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:29:54.016550 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m07:29:54.017593 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:54.019631 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m07:29:54.021369 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 5.10s]
[0m07:29:54.020646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:29:54.022157 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m07:29:54.013882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:29:54.023343 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.023721 [debug] [MainThread]: On master: BEGIN
[0m07:29:54.024046 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:54.021340 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:54.024396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.025367 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:54.026018 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:54.026573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:54.021158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:29:54.027103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:54.029103 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:54.027097 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.030215 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.031275 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.029437 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:54.031962 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.032088 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:29:54.030742 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:29:54.033165 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:54.033201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:29:54.032542 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:29:54.033884 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:54.034255 [debug] [MainThread]: On master: Close
[0m07:29:54.033493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:54.034587 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:54.035777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:54.034886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:54.036879 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.037365 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:29:54.037259 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m07:29:54.038643 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m07:29:54.040282 [info ] [MainThread]: 
[0m07:29:54.038208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:54.041015 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m07:29:54.040475 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:29:54.039836 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:54.042121 [debug] [MainThread]: Command end result
[0m07:29:54.042595 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:29:54.043332 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:54.043298 [info ] [MainThread]: 
[0m07:29:54.043986 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:29:54.044793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:29:54.043985 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:54.045406 [info ] [MainThread]: 
[0m07:29:54.046414 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:54.046871 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:29:54.046859 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:29:54.048042 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:29:54.047425 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:54.048784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.711782, "process_user_time": 1.119041, "process_kernel_time": 0.062674, "process_mem_max_rss": "108808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:54.049364 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:29:54.049842 [debug] [MainThread]: Command `dbt run` succeeded at 07:29:54.049713 after 10.71 seconds
[0m07:29:54.050599 [debug] [MainThread]: Flushing usage events
[0m07:29:54.053257 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.056922 [debug] [MainThread]: On master: BEGIN
[0m07:29:54.061944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:54.067205 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:54.071442 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.075064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:54.079382 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m07:29:54.080844 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:54.081442 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.081813 [debug] [MainThread]: On master: BEGIN
[0m07:29:54.091606 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:29:54.096927 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.114005 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:54.130434 [debug] [MainThread]: On master: COMMIT
[0m07:29:54.152230 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:29:54.174379 [debug] [MainThread]: On master: Close
[0m07:29:54.177226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:29:54.178354 [info ] [MainThread]: 
[0m07:29:54.184407 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m07:29:54.185512 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m07:29:54.186186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m07:29:54.186654 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m07:29:54.193389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m07:29:54.195200 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m07:29:54.221875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m07:29:54.224288 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:54.225189 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m07:29:54.225602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:56.572641 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:56.577138 | 4605d570-99ca-4975-8640-9284e94893de ==============================
[0m07:29:56.577138 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:56.577929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:56.580297 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:29:56.584816 | c0855b65-f2ad-4645-a5aa-ef215c51c3ec ==============================
[0m07:29:56.584816 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:29:56.585265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:29:56.733202 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:56.739884 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:56.795848 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:56.828130 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:29:56.983174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:56.986890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:56.993879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:56.995020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:57.043553 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:57.044888 [info ] [MainThread]: 
[0m07:29:57.045412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:57.049005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:29:57.059726 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:29:57.070133 [info ] [MainThread]: 
[0m07:29:57.085469 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:29:57.095803 [debug] [MainThread]: Command end result
[0m07:29:57.096718 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.54790956, "process_user_time": 1.014418, "process_kernel_time": 0.066288, "process_mem_max_rss": "97588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:29:57.097232 [debug] [MainThread]: Command `dbt test` succeeded at 07:29:57.097170 after 0.55 seconds
[0m07:29:57.097584 [debug] [MainThread]: Flushing usage events
[0m07:29:57.111437 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:29:57.112130 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:29:57.113536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:59.054517 [debug] [ThreadPool]: SQL status: BEGIN in 5.020 seconds
[0m07:29:59.066526 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:29:59.071455 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:29:59.094241 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m07:29:59.107926 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:29:59.109787 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:29:59.115148 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:59.115956 [debug] [MainThread]: On master: BEGIN
[0m07:29:59.116407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:59.229667 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m07:29:59.231147 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.231654 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m07:29:59.233071 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:29:59.237344 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.239351 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m07:29:59.240110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:29:59.248888 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:29:59.250936 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.252210 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:29:59.253442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:29:59.257618 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m07:29:59.260533 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:29:59.261026 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m07:29:59.261713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:29:59.263982 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m07:29:59.268693 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.08s]
[0m07:29:59.271092 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m07:29:59.272348 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:59.272743 [debug] [MainThread]: On master: BEGIN
[0m07:29:59.273181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:02.135372 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.022 seconds
[0m07:30:02.152695 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:02.169544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:30:02.171985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:30:02.184012 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:02.187114 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:02.187649 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:02.188088 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:02.188501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:02.188889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:02.193615 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:02.197094 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:02.197657 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:02.199852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:02.200873 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:02.201271 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:04.134225 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m07:30:04.169210 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.183307 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:04.187944 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m07:30:04.189518 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:04.190085 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.190425 [debug] [MainThread]: On master: BEGIN
[0m07:30:04.190978 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:04.191786 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.192336 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.192844 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.193634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:04.194031 [debug] [MainThread]: On master: Close
[0m07:30:04.194464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:04.194779 [info ] [MainThread]: 
[0m07:30:04.199942 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m07:30:04.200588 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m07:30:04.201227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m07:30:04.201745 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m07:30:04.207681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m07:30:04.209420 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m07:30:04.233224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m07:30:04.234751 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.235342 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m07:30:04.235892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:04.240114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:30:04.240633 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.241253 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m07:30:04.244712 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:30:04.250211 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.252621 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m07:30:04.253529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:04.263007 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:30:04.263538 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.264011 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:30:04.265160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:04.269468 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m07:30:04.272449 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:30:04.272886 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m07:30:04.273409 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:30:04.275058 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m07:30:04.276647 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m07:30:04.277697 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m07:30:04.280427 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.280719 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:30:04.281280 [debug] [MainThread]: On master: BEGIN
[0m07:30:04.281691 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.282026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:04.282425 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.283068 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.283677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:04.284180 [debug] [MainThread]: On master: Close
[0m07:30:04.284822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:04.285201 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:04.285658 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m07:30:04.286293 [info ] [MainThread]: 
[0m07:30:04.286813 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m07:30:04.287042 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:04.287793 [debug] [MainThread]: Command end result
[0m07:30:04.288208 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.288687 [info ] [MainThread]: 
[0m07:30:04.289213 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:04.289885 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:04.290371 [debug] [MainThread]: On master: COMMIT
[0m07:30:04.290772 [info ] [MainThread]: 
[0m07:30:04.291518 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:04.292050 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:30:04.293608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.77187, "process_user_time": 1.136317, "process_kernel_time": 0.071789, "process_mem_max_rss": "106688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:04.294210 [debug] [MainThread]: On master: Close
[0m07:30:04.294799 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:04.294701 after 10.77 seconds
[0m07:30:04.295512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:04.296062 [debug] [MainThread]: Flushing usage events
[0m07:30:04.296693 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:04.300951 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m07:30:04.301437 [info ] [MainThread]: 
[0m07:30:04.301868 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.32 seconds (15.32s).
[0m07:30:04.302568 [debug] [MainThread]: Command end result
[0m07:30:04.302972 [info ] [MainThread]: 
[0m07:30:04.303419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:04.303738 [info ] [MainThread]: 
[0m07:30:04.304060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:04.304670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.882617, "process_user_time": 1.119602, "process_kernel_time": 0.077456, "process_mem_max_rss": "106428", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:04.305128 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:04.305078 after 15.88 seconds
[0m07:30:04.307496 [debug] [MainThread]: Flushing usage events
[0m07:30:06.555240 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:06.559510 | 804b3175-a98f-475d-98f8-f87a1d42c2e7 ==============================
[0m07:30:06.559510 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:06.560063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.602432 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:30:06.599748 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:06.623362 | a90e3f46-79f9-4eee-8405-45d1eb5946a8 ==============================
[0m07:30:06.623362 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:30:06.624430 | 92b76559-a9ac-4cd2-9959-9c8d7da9dcee ==============================
[0m07:30:06.624430 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:06.630976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.638081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.622222 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:06.653020 | 74ec24a7-ce0e-4073-b31b-3fa69a7d2a81 ==============================
[0m07:30:06.653020 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:06.653674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:06.783276 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.797227 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:06.812417 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.813746 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.818913 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:06.825081 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:06.831719 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:06.838848 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:07.002619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.003313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.003637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.004372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.016692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.017484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.040816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.042365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.065628 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.066750 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.067983 [info ] [MainThread]: 
[0m07:30:07.068071 [info ] [MainThread]: 
[0m07:30:07.069729 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:07.069809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:07.071387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:07.071299 [debug] [MainThread]: Command end result
[0m07:30:07.071391 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.072260 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5336574, "process_user_time": 1.001733, "process_kernel_time": 0.043421, "process_mem_max_rss": "97584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:07.072786 [info ] [MainThread]: 
[0m07:30:07.072891 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:07.072813 after 0.53 seconds
[0m07:30:07.073236 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:07.073390 [debug] [MainThread]: Flushing usage events
[0m07:30:07.074528 [debug] [MainThread]: Command end result
[0m07:30:07.075301 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53641236, "process_user_time": 0.971673, "process_kernel_time": 0.064442, "process_mem_max_rss": "97800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:07.076017 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:07.075926 after 0.54 seconds
[0m07:30:07.076490 [debug] [MainThread]: Flushing usage events
[0m07:30:07.089725 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:07.091559 [info ] [MainThread]: 
[0m07:30:07.092526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:07.093541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:07.095215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:07.095951 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:07.097260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.104312 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m07:30:07.105666 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:07.110407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:07.111204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:07.115818 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:07.118103 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:07.117721 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:07.118810 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:07.118379 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:07.119486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.119048 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:07.119624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:07.120412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.193103 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:30:07.193801 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:07.194366 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:07.196664 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m07:30:07.197992 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:07.198737 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:07.203594 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.204150 [debug] [MainThread]: On master: BEGIN
[0m07:30:07.204705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:12.125622 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:30:12.126554 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:12.127253 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:12.129401 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:12.130784 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:12.130896 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m07:30:12.131167 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m07:30:12.131713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:12.132362 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:12.131951 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:12.133440 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:12.137430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:12.139035 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m07:30:12.140376 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:12.141023 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:12.138085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:12.146159 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.146767 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.147222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:12.142780 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:12.147509 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:12.148133 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:12.148624 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:12.149102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:12.149613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:12.154644 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:12.155048 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:12.156097 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:12.156633 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:12.157108 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:12.157646 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:12.160039 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m07:30:12.160404 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:12.161655 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:12.162654 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:12.163245 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:12.163585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:12.168675 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.169212 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.169633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:12.174128 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:30:12.174971 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.175921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:12.180410 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m07:30:12.182140 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:12.182723 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.183173 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.183723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:12.184299 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.184811 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.185195 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.185836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.186363 [debug] [MainThread]: On master: Close
[0m07:30:12.187009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:12.187411 [info ] [MainThread]: 
[0m07:30:12.193846 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m07:30:12.194740 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m07:30:12.195491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m07:30:12.195995 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m07:30:12.201728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m07:30:12.209663 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m07:30:12.226515 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.238378 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m07:30:12.240069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:12.253025 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m07:30:12.254714 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:12.255304 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.255674 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.256192 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:12.262026 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.262487 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.262931 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.264056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.264386 [debug] [MainThread]: On master: Close
[0m07:30:12.265882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:12.266731 [info ] [MainThread]: 
[0m07:30:12.286270 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m07:30:12.287525 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m07:30:12.288975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m07:30:12.289546 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m07:30:12.295244 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m07:30:12.295943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m07:30:12.296631 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m07:30:12.304640 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.306633 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m07:30:12.308525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:12.316279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:30:12.318531 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.320153 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m07:30:12.324208 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m07:30:12.325344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m07:30:12.329152 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.329598 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m07:30:12.330865 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.331244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:12.331563 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m07:30:12.332499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:12.338793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:30:12.340947 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.341328 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m07:30:12.345657 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:30:12.346408 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.346830 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m07:30:12.347211 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:30:12.351883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.351942 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.356244 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m07:30:12.356601 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m07:30:12.359929 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:30:12.360700 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m07:30:12.361095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:30:12.362525 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:30:12.369007 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m07:30:12.371871 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:30:12.371976 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.18s]
[0m07:30:12.372462 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.373029 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m07:30:12.373412 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:30:12.374449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:12.374519 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.378717 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m07:30:12.379181 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.382333 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:30:12.382775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:12.383230 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m07:30:12.384109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:30:12.386468 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m07:30:12.389293 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.10s]
[0m07:30:12.389881 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:30:12.390654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m07:30:12.391133 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.391683 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.392305 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.392903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.392550 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.393409 [debug] [MainThread]: On master: Close
[0m07:30:12.393801 [debug] [MainThread]: On master: BEGIN
[0m07:30:12.394248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:12.394606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:12.394912 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:12.395449 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m07:30:12.396055 [info ] [MainThread]: 
[0m07:30:12.396442 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m07:30:12.397034 [debug] [MainThread]: Command end result
[0m07:30:12.398689 [info ] [MainThread]: 
[0m07:30:12.399173 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:12.399699 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:12.400058 [info ] [MainThread]: 
[0m07:30:12.400552 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.400956 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:12.401335 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:12.402031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8719764, "process_user_time": 1.176954, "process_kernel_time": 0.063755, "process_mem_max_rss": "106268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:12.402545 [debug] [MainThread]: On master: COMMIT
[0m07:30:12.403164 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:12.403072 after 5.87 seconds
[0m07:30:12.403819 [debug] [MainThread]: Flushing usage events
[0m07:30:12.404113 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:12.411469 [debug] [MainThread]: On master: Close
[0m07:30:12.415352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:12.415875 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m07:30:12.416162 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:12.416475 [info ] [MainThread]: 
[0m07:30:12.416883 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.37 seconds (15.37s).
[0m07:30:12.417617 [debug] [MainThread]: Command end result
[0m07:30:12.418135 [info ] [MainThread]: 
[0m07:30:12.418621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:12.419002 [info ] [MainThread]: 
[0m07:30:12.420893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:12.425225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.910179, "process_user_time": 1.170893, "process_kernel_time": 0.075083, "process_mem_max_rss": "106336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:12.428080 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:12.427955 after 15.91 seconds
[0m07:30:12.428637 [debug] [MainThread]: Flushing usage events
[0m07:30:14.602137 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:14.606537 | 4c9e0d3b-f27a-441a-8af3-d7a9d694035a ==============================
[0m07:30:14.606537 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:14.603408 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:30:14.607086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 07:30:14.608052 | d3db8edc-dffe-428d-8237-b53828089333 ==============================
[0m07:30:14.608052 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:14.609219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:14.638522 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:14.642872 | 34c5be74-73b2-409f-9d26-fa4841697583 ==============================
[0m07:30:14.642872 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:14.643362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:14.741577 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:14.740325 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:14.753991 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:14.758914 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:14.775377 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:14.793344 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:14.899108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:14.899731 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:14.910737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:14.911465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:14.939067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:14.939804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:14.973344 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:14.978394 [info ] [MainThread]: 
[0m07:30:14.985319 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:14.985791 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:14.988152 [info ] [MainThread]: 
[0m07:30:14.992387 [debug] [MainThread]: Command end result
[0m07:30:14.991572 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:14.997536 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.43055493, "process_user_time": 0.968631, "process_kernel_time": 0.047176, "process_mem_max_rss": "97596", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:15.004687 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:15.005206 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:15.004845 after 0.44 seconds
[0m07:30:15.005990 [info ] [MainThread]: 
[0m07:30:15.006050 [debug] [MainThread]: Flushing usage events
[0m07:30:15.008191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:15.006466 [debug] [MainThread]: Command end result
[0m07:30:15.010173 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44306204, "process_user_time": 0.978879, "process_kernel_time": 0.051782, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:15.011987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:15.013999 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:15.013885 after 0.45 seconds
[0m07:30:15.019974 [debug] [MainThread]: Flushing usage events
[0m07:30:15.041914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:15.044239 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:15.045117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:17.150293 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m07:30:17.151864 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.155890 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:17.166016 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m07:30:17.167990 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:17.168619 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.169345 [debug] [MainThread]: On master: BEGIN
[0m07:30:17.171818 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:30:17.172280 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.175933 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.179587 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.182615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:17.183053 [debug] [MainThread]: On master: Close
[0m07:30:17.183528 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:17.183936 [info ] [MainThread]: 
[0m07:30:17.189140 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m07:30:17.189761 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m07:30:17.190226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m07:30:17.190542 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m07:30:17.196262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m07:30:17.197541 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m07:30:17.223666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m07:30:17.225043 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.225452 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m07:30:17.225863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:17.230624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:17.232309 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.234352 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m07:30:17.243343 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.008 seconds
[0m07:30:17.248146 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.248622 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m07:30:17.249147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:17.261200 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:30:17.265352 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.265841 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:30:17.269817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:17.278120 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m07:30:17.282616 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:30:17.283175 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m07:30:17.283918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:30:17.286075 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m07:30:17.287953 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.10s]
[0m07:30:17.288826 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m07:30:17.290007 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.290408 [debug] [MainThread]: On master: BEGIN
[0m07:30:17.290764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:17.298220 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:30:17.298973 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.302862 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:17.303413 [debug] [MainThread]: On master: COMMIT
[0m07:30:17.304071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:17.306803 [debug] [MainThread]: On master: Close
[0m07:30:17.307431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:17.307909 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:17.308396 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m07:30:17.308918 [info ] [MainThread]: 
[0m07:30:17.309276 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m07:30:17.309850 [debug] [MainThread]: Command end result
[0m07:30:17.310130 [info ] [MainThread]: 
[0m07:30:17.310499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:17.310877 [info ] [MainThread]: 
[0m07:30:17.311210 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:17.312103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.801371, "process_user_time": 1.107668, "process_kernel_time": 0.071952, "process_mem_max_rss": "108432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:17.312800 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:17.312634 after 10.80 seconds
[0m07:30:17.313231 [debug] [MainThread]: Flushing usage events
[0m07:30:18.794090 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:18.798678 | fd492710-f048-493e-9613-ddf85196783a ==============================
[0m07:30:18.798678 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:18.799526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:30:18.927485 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:18.941328 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:19.145831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:19.146342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:19.197050 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:19.198496 [info ] [MainThread]: 
[0m07:30:19.199059 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:19.200610 [debug] [MainThread]: Command end result
[0m07:30:19.201519 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44298387, "process_user_time": 1.008424, "process_kernel_time": 0.068109, "process_mem_max_rss": "97480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:19.203049 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:19.202947 after 0.44 seconds
[0m07:30:19.204176 [debug] [MainThread]: Flushing usage events
[0m07:30:20.045651 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:30:20.048715 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:20.056491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:20.056989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:20.063938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:20.066131 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:20.066403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:20.065691 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:20.067071 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:20.067404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:25.073024 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:30:25.074806 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:25.075607 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:25.074124 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:30:25.077988 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:25.078577 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:25.079130 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:25.080413 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:25.080683 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m07:30:25.082280 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:25.081172 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:25.083607 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:25.090126 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.091872 [debug] [MainThread]: On master: BEGIN
[0m07:30:25.096096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:25.103602 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:30:25.106746 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.107741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:25.112778 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m07:30:25.114424 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:25.115081 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.115468 [debug] [MainThread]: On master: BEGIN
[0m07:30:25.116011 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:25.116642 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.117117 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.117602 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.118338 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:25.118861 [debug] [MainThread]: On master: Close
[0m07:30:25.119475 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:25.120309 [info ] [MainThread]: 
[0m07:30:25.130428 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m07:30:25.131140 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m07:30:25.131710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m07:30:25.132187 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m07:30:25.145797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m07:30:25.147151 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m07:30:25.169347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m07:30:25.174638 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.175371 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m07:30:25.177252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:25.181402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:30:25.182116 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.186107 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m07:30:25.190930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:30:25.195822 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.196339 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m07:30:25.197095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:25.205631 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:30:25.206119 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.206846 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:30:25.207928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:25.213406 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m07:30:25.216656 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:30:25.217020 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m07:30:25.217737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:30:25.219804 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m07:30:25.221146 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m07:30:25.221809 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m07:30:25.222974 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.225260 [debug] [MainThread]: On master: BEGIN
[0m07:30:25.225911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:25.232383 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:30:25.233104 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.233622 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:25.234030 [debug] [MainThread]: On master: COMMIT
[0m07:30:25.234846 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:25.235352 [debug] [MainThread]: On master: Close
[0m07:30:25.236807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:25.238849 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:30:25.239265 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m07:30:25.239742 [info ] [MainThread]: 
[0m07:30:25.244533 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m07:30:25.245423 [debug] [MainThread]: Command end result
[0m07:30:25.248867 [info ] [MainThread]: 
[0m07:30:25.249334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:25.249711 [info ] [MainThread]: 
[0m07:30:25.251411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:25.252656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.650894, "process_user_time": 1.103755, "process_kernel_time": 0.074796, "process_mem_max_rss": "108468", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:25.254668 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:25.254583 after 10.65 seconds
[0m07:30:25.256846 [debug] [MainThread]: Flushing usage events
[0m07:30:26.785636 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:26.790285 | 1d97d14c-fa04-4db1-ba4c-dd70f499d2d2 ==============================
[0m07:30:26.790285 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:26.790868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'send_anonymous_usage_stats': 'True'}
[0m07:30:26.802469 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:26.808684 | 7694b5cc-96fc-4678-adac-a28b4abd1d7c ==============================
[0m07:30:26.808684 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:26.809296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:26.979933 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:26.991908 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:26.999477 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:27.013191 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:27.163751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:27.164352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:27.180939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:27.182796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:27.227589 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:27.228842 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:27.230104 [info ] [MainThread]: 
[0m07:30:27.231277 [info ] [MainThread]: 
[0m07:30:27.231762 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:27.232349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:27.233841 [debug] [MainThread]: Command end result
[0m07:30:27.234759 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:27.234990 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48526797, "process_user_time": 1.025972, "process_kernel_time": 0.066647, "process_mem_max_rss": "97104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:27.235592 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:27.235516 after 0.49 seconds
[0m07:30:27.235947 [debug] [MainThread]: Flushing usage events
[0m07:30:27.258978 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:27.259855 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:27.261063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:27.271143 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m07:30:27.274672 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:27.278553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:27.279368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:27.283973 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:27.285835 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:27.286207 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:27.286627 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:27.293938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:27.289625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:32.298778 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:30:32.299209 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:30:32.302058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:32.302707 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:32.307862 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:32.307347 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:32.310264 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m07:30:32.311543 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:32.310538 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:32.313053 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:32.312168 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:32.313588 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:32.319240 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.324786 [debug] [MainThread]: On master: BEGIN
[0m07:30:32.328451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:32.344352 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m07:30:32.385487 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.386327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:32.394674 [debug] [MainThread]: SQL status: SELECT 12 in 0.007 seconds
[0m07:30:32.406143 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:32.407658 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.408219 [debug] [MainThread]: On master: BEGIN
[0m07:30:32.410893 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:30:32.411540 [debug] [MainThread]: On master: COMMIT
[0m07:30:32.413138 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.414419 [debug] [MainThread]: On master: COMMIT
[0m07:30:32.416698 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:32.419208 [debug] [MainThread]: On master: Close
[0m07:30:32.421253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:32.421848 [info ] [MainThread]: 
[0m07:30:32.427049 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m07:30:32.427703 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m07:30:32.428425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m07:30:32.429029 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m07:30:32.434556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m07:30:32.436158 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m07:30:32.462739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m07:30:32.464162 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:32.464575 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m07:30:32.464943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:32.469309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:30:32.469869 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:32.470215 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m07:30:33.337469 [debug] [Thread-1 (]: SQL status: SELECT 200000 in 0.867 seconds
[0m07:30:33.345234 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:33.345994 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m07:30:33.346741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:33.358131 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:30:33.358827 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:33.359350 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:30:33.365298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:30:33.372434 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m07:30:33.376628 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:30:33.377242 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m07:30:33.379455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:30:33.381559 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m07:30:33.383101 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 200000[0m in 0.95s]
[0m07:30:33.383775 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m07:30:33.385278 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:33.388034 [debug] [MainThread]: On master: BEGIN
[0m07:30:33.388365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:33.392630 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:30:33.393275 [debug] [MainThread]: On master: COMMIT
[0m07:30:33.393892 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:33.394268 [debug] [MainThread]: On master: COMMIT
[0m07:30:33.394706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:33.395191 [debug] [MainThread]: On master: Close
[0m07:30:33.395667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:33.395981 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m07:30:33.396341 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:33.396710 [info ] [MainThread]: 
[0m07:30:33.397137 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m07:30:33.398006 [debug] [MainThread]: Command end result
[0m07:30:33.398519 [info ] [MainThread]: 
[0m07:30:33.399073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:33.400085 [info ] [MainThread]: 
[0m07:30:33.401564 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:33.402998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.638004, "process_user_time": 1.201181, "process_kernel_time": 0.071865, "process_mem_max_rss": "107784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:33.404544 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:33.404448 after 6.64 seconds
[0m07:30:33.406543 [debug] [MainThread]: Flushing usage events
[0m07:30:35.786968 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:35.792313 | 8b5896ae-82aa-4d18-add8-64692f8ddc98 ==============================
[0m07:30:35.792313 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:35.793346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:35.836703 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:35.842996 | 155d2b26-0270-4697-835d-dead7fff6b33 ==============================
[0m07:30:35.842996 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:35.843947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m07:30:35.843627 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:35.850598 | 29916685-20d8-461d-b8a9-74c3afd13270 ==============================
[0m07:30:35.850598 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:35.853003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:35.930900 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:35.947207 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:35.983884 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:36.000064 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:36.007416 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:36.027698 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:36.175687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:36.176430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:36.233217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:36.235199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:36.241339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:36.242092 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:36.242471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:36.244123 [info ] [MainThread]: 
[0m07:30:36.248385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:36.251205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:36.274952 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:36.275717 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:36.276283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:36.281197 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:36.282812 [info ] [MainThread]: 
[0m07:30:36.283473 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:36.284643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:36.298437 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:36.299779 [info ] [MainThread]: 
[0m07:30:36.300318 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:36.302100 [debug] [MainThread]: Command end result
[0m07:30:36.302867 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4966318, "process_user_time": 1.082372, "process_kernel_time": 0.07429, "process_mem_max_rss": "97448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:36.303480 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:36.303378 after 0.50 seconds
[0m07:30:36.303844 [debug] [MainThread]: Flushing usage events
[0m07:30:36.309373 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:36.313745 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:36.314482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:36.322167 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m07:30:36.323424 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:36.327680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:30:36.328374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:30:36.332939 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:36.335377 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:36.336099 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:36.336606 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:36.337111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:36.337515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:36.342795 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:30:36.343383 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:30:36.347149 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:36.348383 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:36.349379 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:36.350319 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:36.353741 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.001 seconds
[0m07:30:36.354061 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:36.355276 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:36.356412 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:36.357125 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:36.357580 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:36.363709 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.364409 [debug] [MainThread]: On master: BEGIN
[0m07:30:36.364833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:36.370220 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:36.371449 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.371974 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:36.377060 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:30:36.379412 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:36.380179 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.380818 [debug] [MainThread]: On master: BEGIN
[0m07:30:36.381758 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:36.382381 [debug] [MainThread]: On master: COMMIT
[0m07:30:36.382904 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:36.383347 [debug] [MainThread]: On master: COMMIT
[0m07:30:36.383975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:36.384482 [debug] [MainThread]: On master: Close
[0m07:30:36.385298 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:36.385823 [info ] [MainThread]: 
[0m07:30:36.391582 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m07:30:36.392437 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m07:30:36.393053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m07:30:36.393607 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m07:30:36.409716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m07:30:36.411616 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m07:30:36.455637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m07:30:36.460033 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:30:36.461789 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m07:30:36.465875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:36.470585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:36.472154 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:30:36.474763 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m07:30:41.289746 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m07:30:41.292699 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:41.300152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:30:41.300748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:30:41.307427 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:41.309371 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:41.309924 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:41.310869 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:41.313129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:41.314807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:41.523623 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.047 seconds
[0m07:30:41.541200 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:30:41.545866 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:30:41.546271 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:30:41.563980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m07:30:41.565485 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m07:30:41.567294 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.17s]
[0m07:30:41.568260 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m07:30:41.569601 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:41.570056 [debug] [MainThread]: On master: BEGIN
[0m07:30:41.575887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:46.332776 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m07:30:46.335382 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m07:30:46.346176 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:46.350002 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:46.354367 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:46.355978 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:46.359364 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.001 seconds
[0m07:30:46.362268 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m07:30:46.365251 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:46.375820 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:46.374984 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:46.381099 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:46.390099 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.392008 [debug] [MainThread]: On master: BEGIN
[0m07:30:46.395191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:46.401420 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:30:46.403983 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.405180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:46.412031 [debug] [MainThread]: SQL status: SELECT 12 in 0.006 seconds
[0m07:30:46.414539 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:46.418542 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.419503 [debug] [MainThread]: On master: BEGIN
[0m07:30:46.420817 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:46.424497 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.425377 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.426106 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.428049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:46.428479 [debug] [MainThread]: On master: Close
[0m07:30:46.428991 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:46.430311 [info ] [MainThread]: 
[0m07:30:46.442463 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.445210 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m07:30:46.446024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_resellers_xml)
[0m07:30:46.446801 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.463109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.464534 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.503987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.505482 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.506002 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m07:30:46.506426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:46.515073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:30:46.519288 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.520930 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 

  

trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  



)


SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m07:30:46.584619 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m07:30:46.588599 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.589183 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.589748 [debug] [MainThread]: On master: COMMIT
[0m07:30:46.590436 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:46.592453 [debug] [MainThread]: On master: Close
[0m07:30:46.594029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:46.595042 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m07:30:46.595580 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:46.596039 [info ] [MainThread]: 
[0m07:30:46.596491 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m07:30:46.597217 [debug] [MainThread]: Command end result
[0m07:30:46.597600 [info ] [MainThread]: 
[0m07:30:46.598062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:46.598547 [info ] [MainThread]: 
[0m07:30:46.599087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:46.600000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.798289, "process_user_time": 1.201238, "process_kernel_time": 0.084853, "process_mem_max_rss": "107008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:46.600598 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:46.600518 after 10.80 seconds
[0m07:30:46.601098 [debug] [MainThread]: Flushing usage events
[0m07:30:46.853300 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.330 seconds
[0m07:30:46.879521 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:30:46.883465 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:30:46.884418 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:30:46.885483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:46.888434 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m07:30:46.890045 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 0[0m in 0.44s]
[0m07:30:46.892778 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:30:46.894384 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:46.900914 [debug] [MainThread]: On master: BEGIN
[0m07:30:46.901359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:49.034387 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:49.039290 | 6edd5f11-1e92-4f82-aa7e-56a9c187997f ==============================
[0m07:30:49.039290 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:49.039837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:49.196417 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:49.208858 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:49.440937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:49.445350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:49.503193 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:49.504579 [info ] [MainThread]: 
[0m07:30:49.505120 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:49.506518 [debug] [MainThread]: Command end result
[0m07:30:49.507255 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51441544, "process_user_time": 1.06013, "process_kernel_time": 0.07148, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:49.508011 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:49.507925 after 0.52 seconds
[0m07:30:49.508438 [debug] [MainThread]: Flushing usage events
[0m07:30:51.916807 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m07:30:51.921771 [debug] [MainThread]: On master: COMMIT
[0m07:30:51.923697 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:51.924122 [debug] [MainThread]: On master: COMMIT
[0m07:30:51.927909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:51.929548 [debug] [MainThread]: On master: Close
[0m07:30:51.932206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:51.934161 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:30:51.936379 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m07:30:51.937589 [info ] [MainThread]: 
[0m07:30:51.938083 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.69 seconds (15.69s).
[0m07:30:51.938736 [debug] [MainThread]: Command end result
[0m07:30:51.939504 [info ] [MainThread]: 
[0m07:30:51.941048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:51.942015 [info ] [MainThread]: 
[0m07:30:51.943683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:30:51.944913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.183777, "process_user_time": 1.173777, "process_kernel_time": 0.088781, "process_mem_max_rss": "108560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:51.946320 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:51.946226 after 16.19 seconds
[0m07:30:51.947640 [debug] [MainThread]: Flushing usage events
[0m07:30:54.184954 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:30:54.189329 | 407d8cf6-731d-49e0-87cf-940a80e51ea8 ==============================
[0m07:30:54.189329 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:54.190134 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:30:54.193766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}


============================== 07:30:54.194742 | 878eacd3-97a0-40f7-b6b6-ceeae7dde397 ==============================
[0m07:30:54.194742 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:30:54.195373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:30:54.326305 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:54.338034 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:54.345033 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:54.361350 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:30:54.507009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:54.507747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:54.527607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:54.528525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:54.577773 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:54.589263 [info ] [MainThread]: 
[0m07:30:54.595895 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:30:54.611806 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:30:54.622525 [debug] [MainThread]: Command end result
[0m07:30:54.622971 [info ] [MainThread]: 
[0m07:30:54.631696 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53043836, "process_user_time": 1.079981, "process_kernel_time": 0.079171, "process_mem_max_rss": "97712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:30:54.644904 [debug] [MainThread]: Command `dbt test` succeeded at 07:30:54.644748 after 0.54 seconds
[0m07:30:54.646229 [debug] [MainThread]: Flushing usage events
[0m07:30:54.636958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:54.651557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:30:54.688103 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:30:54.688625 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:30:54.688897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:59.712180 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.023 seconds
[0m07:30:59.722136 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:30:59.744114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:30:59.747068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:30:59.763773 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:59.764222 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:30:59.764530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:59.761579 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:59.765434 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:30:59.765838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:59.770144 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:30:59.771224 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:30:59.771874 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:30:59.770848 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:59.772778 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:30:59.773338 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:30:59.774743 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:30:59.775892 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:30:59.776104 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.002 seconds
[0m07:30:59.776590 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:30:59.777631 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:30:59.778867 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:30:59.784144 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.784776 [debug] [MainThread]: On master: BEGIN
[0m07:30:59.785139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:59.789913 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:59.790679 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.791112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:59.796232 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:30:59.798252 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:59.798822 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.799253 [debug] [MainThread]: On master: BEGIN
[0m07:30:59.799963 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:59.802889 [debug] [MainThread]: On master: COMMIT
[0m07:30:59.803406 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:59.803752 [debug] [MainThread]: On master: COMMIT
[0m07:30:59.804360 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:59.804808 [debug] [MainThread]: On master: Close
[0m07:30:59.805290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:30:59.805785 [info ] [MainThread]: 
[0m07:30:59.811249 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m07:30:59.812038 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m07:30:59.812682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m07:30:59.813077 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m07:30:59.818891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m07:30:59.820325 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m07:30:59.846095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m07:30:59.847758 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:30:59.848243 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m07:30:59.848710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:59.853305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:59.854072 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:30:59.854630 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m07:31:00.715847 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.861 seconds
[0m07:31:00.724139 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:31:00.724814 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m07:31:00.725628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:31:00.738158 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:31:00.739313 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:31:00.740143 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:31:00.747305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:31:00.756418 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m07:31:00.769740 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:31:00.772334 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m07:31:00.783333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:31:00.787232 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m07:31:00.804421 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1000000[0m in 0.99s]
[0m07:31:00.822264 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m07:31:00.840324 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:00.841659 [debug] [MainThread]: On master: BEGIN
[0m07:31:00.842499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:05.868242 [debug] [MainThread]: SQL status: BEGIN in 5.026 seconds
[0m07:31:05.873085 [debug] [MainThread]: On master: COMMIT
[0m07:31:05.873864 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:05.874428 [debug] [MainThread]: On master: COMMIT
[0m07:31:05.875243 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:05.875816 [debug] [MainThread]: On master: Close
[0m07:31:05.876486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:05.876836 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m07:31:05.877253 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:31:05.877965 [info ] [MainThread]: 
[0m07:31:05.878504 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.24 seconds (11.24s).
[0m07:31:05.879159 [debug] [MainThread]: Command end result
[0m07:31:05.879555 [info ] [MainThread]: 
[0m07:31:05.879973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:05.880401 [info ] [MainThread]: 
[0m07:31:05.880870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:31:05.881742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.75662, "process_user_time": 1.264347, "process_kernel_time": 0.09757, "process_mem_max_rss": "108204", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:05.882414 [debug] [MainThread]: Command `dbt run` succeeded at 07:31:05.882308 after 11.76 seconds
[0m07:31:05.882926 [debug] [MainThread]: Flushing usage events
[0m07:31:08.221150 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:31:08.225787 | 08fd3e3a-7374-4ef1-827b-14ea900e08f1 ==============================
[0m07:31:08.225787 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:31:08.226567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:31:08.227439 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:31:08.234389 | e27da26b-33a2-4f7c-959b-919ef6fd9fbe ==============================
[0m07:31:08.234389 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:31:08.235110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'send_anonymous_usage_stats': 'True'}
[0m07:31:08.389390 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:31:08.408407 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:31:08.412363 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:31:08.425501 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:31:08.569586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:08.570206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:08.580055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:08.582435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:08.630202 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:31:08.637749 [info ] [MainThread]: 
[0m07:31:08.639885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:08.656111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:31:08.676038 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:31:08.681633 [info ] [MainThread]: 
[0m07:31:08.695055 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:31:08.696928 [debug] [MainThread]: Command end result
[0m07:31:08.698057 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53455347, "process_user_time": 1.07603, "process_kernel_time": 0.067503, "process_mem_max_rss": "97732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:08.698763 [debug] [MainThread]: Command `dbt test` succeeded at 07:31:08.698683 after 0.54 seconds
[0m07:31:08.699229 [debug] [MainThread]: Flushing usage events
[0m07:31:08.712666 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:31:08.713792 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:31:08.714661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:13.725164 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m07:31:13.728052 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:31:13.732883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:31:13.733471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:31:13.738396 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:13.740695 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:31:13.741161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:13.740146 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:13.742099 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:31:13.742672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:18.742281 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:31:18.743169 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:18.743597 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:31:18.746009 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:31:18.747390 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:31:18.748135 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:31:18.751221 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:31:18.752873 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:18.753329 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:31:18.756156 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m07:31:18.757956 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:31:18.758619 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:31:18.763912 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.764455 [debug] [MainThread]: On master: BEGIN
[0m07:31:18.764858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:23.769292 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:31:23.773088 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.773816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:23.780015 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:31:23.782787 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:23.783456 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.783916 [debug] [MainThread]: On master: BEGIN
[0m07:31:23.784564 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:31:23.785282 [debug] [MainThread]: On master: COMMIT
[0m07:31:23.785810 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:23.786293 [debug] [MainThread]: On master: COMMIT
[0m07:31:23.786964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:23.787528 [debug] [MainThread]: On master: Close
[0m07:31:23.788138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:23.789168 [info ] [MainThread]: 
[0m07:31:23.794766 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m07:31:23.795500 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m07:31:23.796779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.fact_sales)
[0m07:31:23.797436 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m07:31:23.803681 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m07:31:23.805761 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m07:31:23.832524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m07:31:23.834392 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:23.834925 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m07:31:23.835469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:23.841053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:31:23.841910 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:23.842263 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m07:31:24.748350 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.906 seconds
[0m07:31:24.757324 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:24.758058 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m07:31:24.758940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:31:24.777884 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:31:24.778698 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:24.779288 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:31:24.835795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m07:31:24.847670 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m07:31:24.855833 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:31:24.866735 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m07:31:24.868531 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m07:31:24.873435 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m07:31:24.876434 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1000000[0m in 1.08s]
[0m07:31:24.880770 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m07:31:24.882414 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:24.883160 [debug] [MainThread]: On master: BEGIN
[0m07:31:24.883711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:24.888768 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:31:24.889291 [debug] [MainThread]: On master: COMMIT
[0m07:31:24.889767 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:24.890260 [debug] [MainThread]: On master: COMMIT
[0m07:31:24.891021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:24.891836 [debug] [MainThread]: On master: Close
[0m07:31:24.892471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:24.892917 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:31:24.893315 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m07:31:24.894306 [info ] [MainThread]: 
[0m07:31:24.895735 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.25 seconds (16.25s).
[0m07:31:24.901333 [debug] [MainThread]: Command end result
[0m07:31:24.902362 [info ] [MainThread]: 
[0m07:31:24.903021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:24.905073 [info ] [MainThread]: 
[0m07:31:24.905729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:31:24.906982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.744406, "process_user_time": 1.189776, "process_kernel_time": 0.100487, "process_mem_max_rss": "106284", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:24.907776 [debug] [MainThread]: Command `dbt run` succeeded at 07:31:24.907691 after 16.75 seconds
[0m07:31:24.908570 [debug] [MainThread]: Flushing usage events
[0m07:31:27.424750 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:31:27.429845 | 11916c1f-fa2e-48b8-b950-d3486c2ebede ==============================
[0m07:31:27.429845 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:31:27.430805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:31:27.576803 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:31:27.594983 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:31:27.749603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:27.750689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:27.805058 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:31:27.806325 [info ] [MainThread]: 
[0m07:31:27.809883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:27.812972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:31:27.813485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:31:27.840536 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:27.840970 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:27.841479 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:31:27.841941 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:31:27.842334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:27.842744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:27.847823 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:31:27.848423 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:31:27.848959 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:31:27.851256 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m07:31:27.852892 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:31:27.853744 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:31:32.847923 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:31:32.848887 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:31:32.849418 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:31:32.851707 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:31:32.853018 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:31:32.853798 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:31:32.858294 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.858810 [debug] [MainThread]: On master: BEGIN
[0m07:31:32.859094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:32.863410 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:31:32.865378 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.865852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:32.871739 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:31:32.873660 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:32.874308 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.874803 [debug] [MainThread]: On master: BEGIN
[0m07:31:32.875491 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:31:32.876559 [debug] [MainThread]: On master: COMMIT
[0m07:31:32.877945 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:32.879937 [debug] [MainThread]: On master: COMMIT
[0m07:31:32.884136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:32.884674 [debug] [MainThread]: On master: Close
[0m07:31:32.885789 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:31:32.886411 [info ] [MainThread]: 
[0m07:31:32.892116 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m07:31:32.892761 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m07:31:32.893245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m07:31:32.893784 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m07:31:32.899968 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.901660 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m07:31:32.911984 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.913570 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.914106 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m07:31:32.914728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:32.919289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:31:32.919969 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:31:32.920399 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m07:31:33.051122 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.130 seconds
[0m07:31:33.054433 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m07:31:33.059467 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m07:31:33.063048 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.17s]
[0m07:31:33.064188 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m07:31:33.066330 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:33.067384 [debug] [MainThread]: On master: BEGIN
[0m07:31:33.068144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:33.072471 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:31:33.073198 [debug] [MainThread]: On master: COMMIT
[0m07:31:33.073792 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:33.074114 [debug] [MainThread]: On master: COMMIT
[0m07:31:33.074781 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:33.075222 [debug] [MainThread]: On master: Close
[0m07:31:33.075839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:33.076287 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m07:31:33.076735 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:31:33.077228 [info ] [MainThread]: 
[0m07:31:33.077747 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m07:31:33.078471 [debug] [MainThread]: Command end result
[0m07:31:33.078914 [info ] [MainThread]: 
[0m07:31:33.079359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:31:33.079782 [info ] [MainThread]: 
[0m07:31:33.080087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:31:33.080852 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.737896, "process_user_time": 1.160837, "process_kernel_time": 0.090865, "process_mem_max_rss": "108584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:31:33.081554 [debug] [MainThread]: Command `dbt test` succeeded at 07:31:33.081441 after 5.74 seconds
[0m07:31:33.082094 [debug] [MainThread]: Flushing usage events
[0m07:41:47.532166 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:41:47.536697 | 8ae1332e-78ff-40fb-adac-a7f5ccb3a67a ==============================
[0m07:41:47.536697 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:41:47.537408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:41:47.622095 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m07:41:47.626239 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m07:41:47.630028 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q_75xlr9'
[0m07:41:47.630653 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m07:41:47.631955 [debug] [MainThread]: Creating symlink to local dependency.
[0m07:41:47.633700 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m07:41:47.639434 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14443754, "process_user_time": 0.859529, "process_kernel_time": 0.071203, "process_mem_max_rss": "105644", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m07:41:47.640066 [debug] [MainThread]: Command `dbt deps` succeeded at 07:41:47.639989 after 0.15 seconds
[0m07:41:47.640518 [debug] [MainThread]: Flushing usage events
[0m07:41:49.590189 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:41:49.594734 | 7196b9bc-5c78-4201-9997-25ae4c64e1f6 ==============================
[0m07:41:49.594734 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:41:49.595329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:41:49.761358 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:41:49.775188 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m07:41:49.776274 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:41:51.100813 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:41:51.102927 [info ] [MainThread]: 
[0m07:41:51.104269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:41:51.105854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:41:51.129649 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:41:51.135547 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:41:51.138180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:56.150548 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.012 seconds
[0m07:41:56.151853 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:41:56.152577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m07:41:56.153058 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m07:41:56.157192 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:41:56.166754 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m07:41:56.175444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:41:56.196375 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m07:41:56.209759 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:41:56.222897 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m07:41:56.237662 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m07:41:56.246224 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:41:56.248919 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m07:41:56.249370 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m07:41:56.250642 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m07:41:56.252062 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m07:41:56.256225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m07:41:56.256907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:41:56.263299 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:41:56.263656 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:41:56.264026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:56.261652 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:41:56.264714 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:41:56.265211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:41:56.268630 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:41:56.269112 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:41:56.269442 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:41:56.272789 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:41:56.274111 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:41:56.274943 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:42:01.271213 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:42:01.272213 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:01.272773 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:42:01.275076 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:42:01.276208 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:42:01.276668 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:42:01.280526 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:01.281100 [debug] [MainThread]: On master: BEGIN
[0m07:42:01.281476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:06.286003 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:42:06.289088 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:06.289731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:06.293141 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:42:06.294451 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:06.295060 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:06.295408 [debug] [MainThread]: On master: BEGIN
[0m07:42:06.295971 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:42:06.296379 [debug] [MainThread]: On master: COMMIT
[0m07:42:06.296765 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:06.297051 [debug] [MainThread]: On master: COMMIT
[0m07:42:06.297424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:42:06.297699 [debug] [MainThread]: On master: Close
[0m07:42:06.298184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:42:06.298498 [info ] [MainThread]: 
[0m07:42:06.303195 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m07:42:06.303910 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m07:42:06.304423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m07:42:06.304875 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m07:42:06.305418 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m07:42:06.324106 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:06.324758 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m07:42:06.325298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:11.340980 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m07:42:11.345182 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:11.345801 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m07:42:11.349484 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m07:42:11.399733 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:11.401452 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m07:42:11.403280 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m07:42:11.408013 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m07:42:11.426906 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:42:11.427554 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m07:42:11.427960 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m07:42:11.428855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:42:11.430235 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m07:42:11.431572 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 5.13s]
[0m07:42:11.432400 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m07:42:11.433842 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.439834 [debug] [MainThread]: On master: BEGIN
[0m07:42:11.440305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:42:11.444466 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:42:11.445167 [debug] [MainThread]: On master: COMMIT
[0m07:42:11.446392 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.447591 [debug] [MainThread]: On master: COMMIT
[0m07:42:11.448469 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:42:11.449110 [debug] [MainThread]: On master: Close
[0m07:42:11.449830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:11.450351 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m07:42:11.450796 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:42:11.451243 [info ] [MainThread]: 
[0m07:42:11.451570 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 20.35 seconds (20.35s).
[0m07:42:11.452049 [debug] [MainThread]: Command end result
[0m07:42:11.492228 [info ] [MainThread]: 
[0m07:42:11.492769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:42:11.493137 [info ] [MainThread]: 
[0m07:42:11.493584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:42:11.494540 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 21.941936, "process_user_time": 2.188063, "process_kernel_time": 0.09298, "process_mem_max_rss": "115844", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:42:11.495223 [debug] [MainThread]: Command `dbt seed` succeeded at 07:42:11.495092 after 21.94 seconds
[0m07:42:11.495709 [debug] [MainThread]: Flushing usage events
[0m07:42:54.443993 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.450718 | 5c597959-ca93-43be-8347-d9afed16aa34 ==============================
[0m07:42:54.450718 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.452224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.454824 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:42:54.456217 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.463226 | ce5c36ee-6e9f-4b44-b157-6d7669238d47 ==============================
[0m07:42:54.463226 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:42:54.462658 | cdb004fa-d0c9-4acd-b981-d86b75641af4 ==============================
[0m07:42:54.462658 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.465154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.465584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.503099 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:42:54.498098 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.509256 | 0403c1ef-1ac8-4759-a5a7-4dc6573a39d1 ==============================
[0m07:42:54.509256 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:42:54.510414 | baf094c0-0c3f-422c-ba15-d227e1b3cae6 ==============================
[0m07:42:54.510414 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.510848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.511528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.526928 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.540479 | ac96a499-a39f-438f-9bae-0d4ff0a0959b ==============================
[0m07:42:54.540479 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.541677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.543118 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:42:54.557852 | 93eb18b8-d3ac-4066-8e1b-73615522eafb ==============================
[0m07:42:54.557852 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:42:54.563505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.602648 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.632431 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.667137 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.680194 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.699091 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.703136 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.735065 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.736604 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.768586 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.786558 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.799211 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.802304 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.802304 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.802421 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.803516 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.804629 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.815462 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:54.825248 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.830267 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.838753 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:42:54.892975 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.894175 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.924248 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.925553 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.931896 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.933484 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:54.934966 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:42:54.936158 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m07:42:56.163936 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.167124 [info ] [MainThread]: 
[0m07:42:56.172204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.173656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.206069 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.209769 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.211781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.234556 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.236630 [info ] [MainThread]: 
[0m07:42:56.240039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.242170 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.251144 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.254911 [info ] [MainThread]: 
[0m07:42:56.256485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.257586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.268042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.269188 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.269255 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.271141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.274731 [info ] [MainThread]: 
[0m07:42:56.277570 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.280233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.283847 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m07:42:56.286818 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.289741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:42:56.291645 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:42:56.291775 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.295657 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.296344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.296899 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.297355 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:42:56.298140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.302020 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m07:42:56.303549 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.304804 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:42:56.305233 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.306203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:42:56.308410 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.308788 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.309344 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:42:56.309798 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:42:56.310432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.310955 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.311442 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:42:56.313772 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.313490 [info ] [MainThread]: 
[0m07:42:56.316908 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.314864 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.318301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.319005 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.319421 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m07:42:56.321112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.319489 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:42:56.322885 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m07:42:56.324004 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:42:56.323565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.323966 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.328972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m07:42:56.328226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m07:42:56.330340 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:42:56.329915 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m07:42:56.331494 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.332015 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:42:56.329148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:42:56.339282 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m07:42:56.341081 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.338743 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.343219 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.342645 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.343698 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m07:42:56.343915 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.344422 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:42:56.344624 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.344827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.345544 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:42:56.345178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.345935 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.346530 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:42:56.345673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.347045 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.347224 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:42:56.347923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.351124 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:42:56.352047 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.352113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m07:42:56.352797 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:42:56.356593 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m07:42:56.358271 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:42:56.359915 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:42:56.353016 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:42:56.360329 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.362926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.363412 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.363762 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.364152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.364505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.379755 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.381230 [info ] [MainThread]: 
[0m07:42:56.381933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.382868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.388649 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:42:56.390224 [info ] [MainThread]: 
[0m07:42:56.391033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:56.391933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:42:56.401606 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.402253 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.402787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.408562 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:42:56.409983 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.411258 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:42:56.411825 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:42:56.412304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.413729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:42:56.417558 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m07:42:56.418891 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:42:56.414190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:42:56.419337 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.421818 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.422598 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.423137 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.423320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:42:56.423585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.423933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.428601 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:42:56.423814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:42:56.429231 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.429811 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:42:56.428615 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.430903 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:42:56.431531 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:42:56.432255 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:42:56.431997 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:42:56.432549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:56.433037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:56.433524 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:42:56.434475 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:42:56.437888 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:42:56.438717 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:42:56.439349 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:42:56.441930 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:42:56.442981 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:42:56.443498 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.226158 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m07:43:01.229949 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:01.246700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:01.260228 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:01.278864 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.301242 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:01.274120 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.304052 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:01.304683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:01.303615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:01.309790 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.310154 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:43:01.310666 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.311225 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.311774 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.312455 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.314659 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m07:43:01.314954 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.315942 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.316761 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.317296 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.317680 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.323027 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.323692 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.324143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.329014 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.329760 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.330198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:01.333215 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:01.334369 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:01.335263 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.335826 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.336547 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:01.337081 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.337558 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.338062 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.338664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.339304 [debug] [MainThread]: On master: Close
[0m07:43:01.340104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:01.341101 [info ] [MainThread]: 
[0m07:43:01.346261 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m07:43:01.346974 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m07:43:01.347617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_date)
[0m07:43:01.348176 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m07:43:01.350623 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m07:43:01.352773 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:43:01.353283 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m07:43:01.354052 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m07:43:01.354358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m07:43:01.355237 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:43:01.357204 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m07:43:01.356448 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m07:43:01.358571 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.358750 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m07:43:01.359407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.359659 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.359917 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m07:43:01.359914 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m07:43:01.361278 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:01.360630 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m07:43:01.362050 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:01.363584 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.364407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.366258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m07:43:01.366206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:01.370633 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.369354 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:01.373291 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.367337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:01.373293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.373907 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.374439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.376046 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.376748 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:01.375006 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:01.366807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:01.377195 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:01.377964 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.377830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:01.378365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:01.377340 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.378686 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.381086 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.382236 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.380699 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.382500 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:01.383224 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.382487 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.383928 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.383472 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:01.383141 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.384421 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.384034 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:01.384323 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.384542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:01.385739 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.385433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:01.387107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:01.387795 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m07:43:01.390858 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:43:01.391859 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.392536 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.393207 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.394111 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.394454 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.395092 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.395149 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.395749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.396217 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m07:43:01.397275 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.398352 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.398620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:01.399080 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.400239 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:43:01.401573 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.402650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:01.404031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:01.405791 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.407615 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:43:01.407849 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m07:43:01.408875 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:01.409718 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.410149 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.410750 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:01.411294 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.411703 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.412062 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.412505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.412879 [debug] [MainThread]: On master: Close
[0m07:43:01.413498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:01.414026 [info ] [MainThread]: 
[0m07:43:01.418881 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m07:43:01.419515 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m07:43:01.420100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m07:43:01.420553 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m07:43:01.426552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m07:43:01.427958 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m07:43:01.428709 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:01.434862 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:01.437778 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:01.440708 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m07:43:01.442085 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m07:43:01.442673 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:01.446311 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:01.446863 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:01.447256 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:01.450778 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:01.451812 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.452108 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:01.452694 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.452958 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:01.457269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.457747 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m07:43:01.460475 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:01.463106 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.463591 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m07:43:01.463973 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.464522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:01.468070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:01.639728 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.230 seconds
[0m07:43:01.644435 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.644996 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:43:01.645697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:01.655728 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m07:43:01.656349 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.656906 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m07:43:01.661105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:43:01.666070 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m07:43:01.669401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m07:43:01.669980 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m07:43:01.670629 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:01.672485 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m07:43:01.673906 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.33s]
[0m07:43:01.674628 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m07:43:01.675859 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.676350 [debug] [MainThread]: On master: BEGIN
[0m07:43:01.676734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:01.681378 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:01.682126 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.682682 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:01.683131 [debug] [MainThread]: On master: COMMIT
[0m07:43:01.683878 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:01.684347 [debug] [MainThread]: On master: Close
[0m07:43:01.685013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:01.685537 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m07:43:01.685990 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:01.686533 [info ] [MainThread]: 
[0m07:43:01.687240 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m07:43:01.688079 [debug] [MainThread]: Command end result
[0m07:43:01.688596 [info ] [MainThread]: 
[0m07:43:01.689414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:01.689999 [info ] [MainThread]: 
[0m07:43:01.690527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:01.691540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.295577, "process_user_time": 2.482066, "process_kernel_time": 0.128978, "process_mem_max_rss": "112516", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:01.692276 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:01.692149 after 7.30 seconds
[0m07:43:01.692794 [debug] [MainThread]: Flushing usage events
[0m07:43:04.152611 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:04.157861 | cbc5105f-ea92-462e-ad77-530758ce709d ==============================
[0m07:43:04.157861 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:04.160320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:04.289807 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:04.301536 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:04.432007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:04.432949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:04.509357 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:04.513108 [info ] [MainThread]: 
[0m07:43:04.517549 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:04.524382 [debug] [MainThread]: Command end result
[0m07:43:04.536506 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41001612, "process_user_time": 1.016585, "process_kernel_time": 0.068989, "process_mem_max_rss": "97980", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:04.543046 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:04.542937 after 0.42 seconds
[0m07:43:04.543501 [debug] [MainThread]: Flushing usage events
[0m07:43:06.383116 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m07:43:06.383939 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:06.385188 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:06.385057 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.385997 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:06.386558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:06.389370 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:06.390649 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:06.390744 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:06.391138 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:06.392301 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:06.393126 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.395971 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:06.395895 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.396755 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.396975 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:06.397086 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.397609 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:06.397568 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:06.397719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:06.398299 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.398803 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.399339 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.400254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.400285 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:06.400859 [debug] [MainThread]: On master: Close
[0m07:43:06.401772 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:06.401623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:06.402640 [info ] [MainThread]: 
[0m07:43:06.402664 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:06.408297 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.408782 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m07:43:06.411034 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.411515 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m07:43:06.411843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:06.412767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_resellers)
[0m07:43:06.413530 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m07:43:06.420025 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m07:43:06.422628 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m07:43:06.447739 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m07:43:06.450128 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.450774 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m07:43:06.451414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:06.457477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:06.459693 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.460565 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m07:43:06.463901 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:43:06.464556 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:43:06.465204 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.465846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:06.469285 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.469618 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:06.470770 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m07:43:06.471656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:06.471829 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:06.472641 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.473198 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.474611 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:43:06.478717 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.479512 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.479861 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m07:43:06.480016 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.478928 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m07:43:06.480486 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.481010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.480919 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.481367 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m07:43:06.481721 [debug] [MainThread]: On master: Close
[0m07:43:06.481938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:06.482805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:06.482887 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:43:06.483636 [info ] [MainThread]: 
[0m07:43:06.484673 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.485407 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m07:43:06.485544 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m07:43:06.489639 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m07:43:06.491549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.494670 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:06.499761 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m07:43:06.508093 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.511439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.514994 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m07:43:06.511422 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m07:43:06.541830 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m07:43:06.523156 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.530626 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m07:43:06.534084 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m07:43:06.542375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_customers)
[0m07:43:06.543509 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m07:43:06.544343 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:43:06.543905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:06.553547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m07:43:06.548646 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.556611 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.557188 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.564540 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m07:43:06.565013 [debug] [MainThread]: On master: Close
[0m07:43:06.565725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:06.555932 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m07:43:06.572906 [info ] [MainThread]: 
[0m07:43:06.574249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m07:43:06.575748 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m07:43:06.580542 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:43:06.581480 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m07:43:06.581870 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.582483 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m07:43:06.583083 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m07:43:06.583625 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.584037 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m07:43:06.584564 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.584844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.585172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.585147 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m07:43:06.586067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m07:43:06.586657 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m07:43:06.590607 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:06.591300 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.591878 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.592094 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m07:43:06.592542 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.593351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m07:43:06.595423 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m07:43:06.596697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.596891 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m07:43:06.597641 [debug] [MainThread]: On master: Close
[0m07:43:06.598201 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m07:43:06.598155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:06.598725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.601072 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m07:43:06.601555 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:06.603366 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m07:43:06.603713 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.18s]
[0m07:43:06.603799 [info ] [MainThread]: 
[0m07:43:06.604792 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m07:43:06.605205 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m07:43:06.606472 [debug] [MainThread]: Command end result
[0m07:43:06.607577 [info ] [MainThread]: 
[0m07:43:06.607434 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.608367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.608791 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.609201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m07:43:06.609887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.609049 [info ] [MainThread]: 
[0m07:43:06.610765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.611692 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.612045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.213801, "process_user_time": 2.544189, "process_kernel_time": 0.141624, "process_mem_max_rss": "114912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.612179 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m07:43:06.613022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:06.612684 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.612583 after 12.21 seconds
[0m07:43:06.614883 [debug] [MainThread]: Flushing usage events
[0m07:43:06.618376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:43:06.618980 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m07:43:06.619523 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.620077 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m07:43:06.620381 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.620991 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.621435 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.622479 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.622047 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:06.623079 [debug] [MainThread]: On master: Close
[0m07:43:06.623947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m07:43:06.624732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.625649 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.626155 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:06.626397 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m07:43:06.626615 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m07:43:06.627013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:06.627152 [info ] [MainThread]: 
[0m07:43:06.629204 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m07:43:06.630628 [debug] [MainThread]: Command end result
[0m07:43:06.631203 [info ] [MainThread]: 
[0m07:43:06.631924 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.632803 [info ] [MainThread]: 
[0m07:43:06.633483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:06.633846 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.633884 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.634830 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.635439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.181967, "process_user_time": 2.529536, "process_kernel_time": 0.153151, "process_mem_max_rss": "112940", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.636043 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m07:43:06.636718 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m07:43:06.637021 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.636892 after 12.18 seconds
[0m07:43:06.637955 [debug] [MainThread]: Flushing usage events
[0m07:43:06.638459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:06.638766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:06.655215 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:43:06.657677 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.658177 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m07:43:06.658195 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.659246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.663549 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m07:43:06.665006 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m07:43:06.665421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:06.673942 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m07:43:06.676654 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m07:43:06.677421 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:06.683878 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:43:06.684050 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m07:43:06.684735 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.686492 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m07:43:06.687057 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m07:43:06.687939 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m07:43:06.689348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.690058 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.694435 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m07:43:06.694923 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.698804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.703368 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m07:43:06.704405 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m07:43:06.704796 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:06.705730 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.706138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:43:06.706612 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.708965 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m07:43:06.709601 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.711686 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m07:43:06.713580 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:43:06.714744 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m07:43:06.715621 [debug] [MainThread]: On master: Close
[0m07:43:06.716829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.717517 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:06.718038 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m07:43:06.718205 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.718553 [info ] [MainThread]: 
[0m07:43:06.719213 [debug] [MainThread]: On master: BEGIN
[0m07:43:06.719559 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.34 seconds (10.34s).
[0m07:43:06.719908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:06.720465 [debug] [MainThread]: Command end result
[0m07:43:06.721104 [info ] [MainThread]: 
[0m07:43:06.723041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.724999 [info ] [MainThread]: 
[0m07:43:06.727627 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.728807 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.249657, "process_user_time": 2.57156, "process_kernel_time": 0.134593, "process_mem_max_rss": "112868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.729604 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.729333 after 12.25 seconds
[0m07:43:06.731001 [debug] [MainThread]: Flushing usage events
[0m07:43:06.731448 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:43:06.736695 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.740626 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:06.741402 [debug] [MainThread]: On master: COMMIT
[0m07:43:06.742239 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:06.742847 [debug] [MainThread]: On master: Close
[0m07:43:06.743426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:06.743758 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:06.745186 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m07:43:06.750695 [info ] [MainThread]: 
[0m07:43:06.751501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m07:43:06.752300 [debug] [MainThread]: Command end result
[0m07:43:06.752709 [info ] [MainThread]: 
[0m07:43:06.756742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:06.757340 [info ] [MainThread]: 
[0m07:43:06.757805 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:06.758632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.29691, "process_user_time": 2.510037, "process_kernel_time": 0.143926, "process_mem_max_rss": "112992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:06.762987 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:06.762661 after 12.30 seconds
[0m07:43:06.764381 [debug] [MainThread]: Flushing usage events
[0m07:43:08.306129 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:08.310264 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:08.338272 | 2cd208a0-1aed-4e10-b190-fe8c4f9d7f98 ==============================
[0m07:43:08.338272 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:43:08.341910 | e59392b9-9b70-4786-b11d-68682f2b500a ==============================
[0m07:43:08.341910 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:08.339705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.344455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.341161 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:08.352086 | afb138d1-b114-4f2a-96b1-2d9487d4327b ==============================
[0m07:43:08.352086 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:08.354785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.391356 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:08.396138 | e92aa486-bdda-4b47-94f8-08072dc647d8 ==============================
[0m07:43:08.396138 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:08.396991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:43:08.489751 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.504244 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.507948 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.521083 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.521730 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.539993 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:08.542967 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.558959 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:08.753133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.753968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.771714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.772549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.795907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.796515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.796642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:08.797167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:08.816093 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.817473 [info ] [MainThread]: 
[0m07:43:08.817862 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:08.819191 [debug] [MainThread]: Command end result
[0m07:43:08.819845 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5632611, "process_user_time": 1.071279, "process_kernel_time": 0.067854, "process_mem_max_rss": "97492", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:08.820288 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:08.820225 after 0.56 seconds
[0m07:43:08.820641 [debug] [MainThread]: Flushing usage events
[0m07:43:08.839515 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.840922 [info ] [MainThread]: 
[0m07:43:08.842104 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:08.842770 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.846696 [debug] [MainThread]: Command end result
[0m07:43:08.848007 [info ] [MainThread]: 
[0m07:43:08.848923 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59029436, "process_user_time": 1.095207, "process_kernel_time": 0.071933, "process_mem_max_rss": "97464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:08.850361 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:08.849879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:08.850545 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:08.850424 after 0.59 seconds
[0m07:43:08.851636 [debug] [MainThread]: Flushing usage events
[0m07:43:08.851659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:08.851910 [info ] [MainThread]: 
[0m07:43:08.853616 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:08.858966 [debug] [MainThread]: Command end result
[0m07:43:08.860676 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5114069, "process_user_time": 1.099004, "process_kernel_time": 0.07989, "process_mem_max_rss": "97448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:08.865242 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:08.865062 after 0.52 seconds
[0m07:43:08.866659 [debug] [MainThread]: Flushing usage events
[0m07:43:08.876331 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:08.880693 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:08.881251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:08.887606 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:43:08.888950 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:08.893695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:08.894316 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:08.901016 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:08.901530 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:08.901831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:08.898938 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:08.902547 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:08.903197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:08.909593 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:43:08.910638 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:08.911270 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:08.913726 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:08.915135 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:08.915977 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:09.388144 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:09.392477 | bc44e88b-02c6-4e7b-ba20-8e2ade1d8883 ==============================
[0m07:43:09.392477 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:09.393025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:09.590985 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:09.602505 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:09.726741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:09.727281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:09.777857 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:09.779214 [info ] [MainThread]: 
[0m07:43:09.779865 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:09.781482 [debug] [MainThread]: Command end result
[0m07:43:09.782373 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42655504, "process_user_time": 1.047517, "process_kernel_time": 0.074169, "process_mem_max_rss": "97840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:09.783102 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:09.782967 after 0.43 seconds
[0m07:43:09.783732 [debug] [MainThread]: Flushing usage events
[0m07:43:11.408565 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m07:43:11.409270 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.409955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:11.413852 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m07:43:11.415188 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:11.415879 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.416408 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.416970 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:11.417475 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.417950 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.418352 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.418892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:11.419301 [debug] [MainThread]: On master: Close
[0m07:43:11.419791 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:11.420320 [info ] [MainThread]: 
[0m07:43:11.421924 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m07:43:11.422612 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.423098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:11.426107 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m07:43:11.426963 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m07:43:11.427172 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m07:43:11.427745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m07:43:11.428334 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m07:43:11.429038 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:11.432936 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.433505 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.434254 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m07:43:11.434285 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:11.435036 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.435511 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.435637 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m07:43:11.436111 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.439965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:11.440848 [debug] [MainThread]: On master: Close
[0m07:43:11.441825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:11.442587 [info ] [MainThread]: 
[0m07:43:11.448022 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m07:43:11.448771 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m07:43:11.449400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m07:43:11.450045 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m07:43:11.455323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m07:43:11.457036 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m07:43:11.460128 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m07:43:11.461395 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.461786 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m07:43:11.462118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:11.467024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:43:11.467770 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.468458 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m07:43:11.469990 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:11.474695 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.475235 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m07:43:11.476068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:11.479689 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m07:43:11.481687 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:11.482147 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m07:43:11.482554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:11.486723 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:43:11.487351 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.487766 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m07:43:11.488929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:11.493616 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m07:43:11.496877 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m07:43:11.497564 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m07:43:11.498259 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:11.500088 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m07:43:11.501619 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m07:43:11.502221 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m07:43:11.503319 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.503853 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.504312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:11.509357 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:11.509984 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.510443 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.510812 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.511341 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:11.511755 [debug] [MainThread]: On master: Close
[0m07:43:11.512235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:11.513473 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m07:43:11.513851 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:11.514239 [info ] [MainThread]: 
[0m07:43:11.514794 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.24 seconds (15.24s).
[0m07:43:11.515515 [debug] [MainThread]: Command end result
[0m07:43:11.515936 [info ] [MainThread]: 
[0m07:43:11.516437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:11.516794 [info ] [MainThread]: 
[0m07:43:11.517230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:11.518113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.121145, "process_user_time": 2.592564, "process_kernel_time": 0.132014, "process_mem_max_rss": "114472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:11.518759 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:11.518680 after 17.12 seconds
[0m07:43:11.519225 [debug] [MainThread]: Flushing usage events
[0m07:43:13.207054 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:13.207055 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:13.211478 | e35c2293-cdb4-497a-b96e-52027dd1b238 ==============================
[0m07:43:13.211478 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:43:13.211539 | 532c6c75-882e-4e49-aeee-666c941193f5 ==============================
[0m07:43:13.211539 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:13.212123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m07:43:13.212243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:13.351119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:13.351453 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:13.363578 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:13.363578 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:13.499012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:13.499635 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:13.500761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:13.501295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:13.550608 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:13.555799 [info ] [MainThread]: 
[0m07:43:13.559715 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:13.559490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:13.563053 [info ] [MainThread]: 
[0m07:43:13.567654 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:13.569013 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:13.574200 [debug] [MainThread]: Command end result
[0m07:43:13.575576 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39877766, "process_user_time": 1.02668, "process_kernel_time": 0.06093, "process_mem_max_rss": "97968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:13.576130 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:13.576069 after 0.40 seconds
[0m07:43:13.579614 [debug] [MainThread]: Flushing usage events
[0m07:43:13.610242 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:13.610939 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:13.611682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:13.909977 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:43:13.910991 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:13.911570 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:13.913881 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m07:43:13.915102 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:13.915601 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:13.919999 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:13.920818 [debug] [MainThread]: On master: BEGIN
[0m07:43:13.921241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:16.494773 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m07:43:16.501922 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.502711 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m07:43:16.504343 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:16.509382 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.510044 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m07:43:16.510797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:16.519840 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:43:16.520550 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.524423 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m07:43:16.525698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:16.530638 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m07:43:16.533722 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m07:43:16.534281 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m07:43:16.535089 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:16.537761 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m07:43:16.542685 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.09s]
[0m07:43:16.543549 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m07:43:16.545103 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:16.546062 [debug] [MainThread]: On master: BEGIN
[0m07:43:16.546622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:16.552198 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:16.552882 [debug] [MainThread]: On master: COMMIT
[0m07:43:16.553455 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:16.553976 [debug] [MainThread]: On master: COMMIT
[0m07:43:16.554659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:16.555212 [debug] [MainThread]: On master: Close
[0m07:43:16.556319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:16.557053 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m07:43:16.557610 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:16.558237 [info ] [MainThread]: 
[0m07:43:16.558817 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.24 seconds (20.24s).
[0m07:43:16.559586 [debug] [MainThread]: Command end result
[0m07:43:16.559896 [info ] [MainThread]: 
[0m07:43:16.560239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:16.560710 [info ] [MainThread]: 
[0m07:43:16.561139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:16.561862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.088888, "process_user_time": 2.471779, "process_kernel_time": 0.144862, "process_mem_max_rss": "112500", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:16.562303 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:16.562243 after 22.09 seconds
[0m07:43:16.562631 [debug] [MainThread]: Flushing usage events
[0m07:43:18.299983 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:18.304207 | 9d00274f-8816-40fb-be32-7fec8627b0cf ==============================
[0m07:43:18.304207 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:18.304807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m07:43:18.330875 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:18.337884 | 84b8326f-ab56-431c-be26-a2ae00429659 ==============================
[0m07:43:18.337884 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:18.339786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:18.451280 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:18.473228 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:18.538234 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:18.550152 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:18.624721 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.013 seconds
[0m07:43:18.628397 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:18.633793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:18.634358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:18.641931 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:18.643914 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:18.645283 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:18.645879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:18.644612 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:18.646968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:18.654997 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:43:18.655843 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:18.656596 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:18.658719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:18.659452 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:18.660910 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:18.659839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:18.661653 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:18.708476 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:18.710307 [info ] [MainThread]: 
[0m07:43:18.711146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:18.711351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:18.711910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:18.712059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:18.735454 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:18.735985 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:18.736349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:18.778115 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:18.793297 [info ] [MainThread]: 
[0m07:43:18.800662 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:18.811478 [debug] [MainThread]: Command end result
[0m07:43:18.820527 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52646166, "process_user_time": 1.099811, "process_kernel_time": 0.07878, "process_mem_max_rss": "97720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:18.822415 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:18.822281 after 0.53 seconds
[0m07:43:18.822955 [debug] [MainThread]: Flushing usage events
[0m07:43:18.929622 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m07:43:18.930435 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:18.931144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:18.935437 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m07:43:18.937116 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:18.937837 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:18.938291 [debug] [MainThread]: On master: BEGIN
[0m07:43:18.939120 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:18.940114 [debug] [MainThread]: On master: COMMIT
[0m07:43:18.941706 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:18.942489 [debug] [MainThread]: On master: COMMIT
[0m07:43:18.943217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:18.943811 [debug] [MainThread]: On master: Close
[0m07:43:18.944431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:18.946353 [info ] [MainThread]: 
[0m07:43:18.952110 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m07:43:18.952858 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m07:43:18.953696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m07:43:18.954287 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m07:43:18.960680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m07:43:18.962161 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m07:43:18.986235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m07:43:18.988146 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:18.988756 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m07:43:18.989353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:18.995158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:18.995937 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:18.996661 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m07:43:18.999253 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:43:19.004151 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:19.004823 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m07:43:19.005997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:19.015677 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:43:19.019132 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:19.020084 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m07:43:19.024890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:19.029836 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m07:43:19.033410 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m07:43:19.034095 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m07:43:19.034866 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:19.037283 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m07:43:19.039318 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m07:43:19.040530 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m07:43:19.042259 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:19.042699 [debug] [MainThread]: On master: BEGIN
[0m07:43:19.042986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:19.047779 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:19.048623 [debug] [MainThread]: On master: COMMIT
[0m07:43:19.049147 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:19.049637 [debug] [MainThread]: On master: COMMIT
[0m07:43:19.050141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:19.051289 [debug] [MainThread]: On master: Close
[0m07:43:19.052154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:19.052851 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m07:43:19.053423 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:19.054018 [info ] [MainThread]: 
[0m07:43:19.054501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.20 seconds (10.20s).
[0m07:43:19.055370 [debug] [MainThread]: Command end result
[0m07:43:19.055937 [info ] [MainThread]: 
[0m07:43:19.056791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:19.057386 [info ] [MainThread]: 
[0m07:43:19.057966 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:19.059163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.826896, "process_user_time": 1.216736, "process_kernel_time": 0.083983, "process_mem_max_rss": "108212", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:19.059899 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:19.059801 after 10.83 seconds
[0m07:43:19.060397 [debug] [MainThread]: Flushing usage events
[0m07:43:21.229630 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:21.234084 | c71831f3-a53c-4c7d-b5f3-9e0a3333be0c ==============================
[0m07:43:21.234084 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:21.234905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'send_anonymous_usage_stats': 'True'}
[0m07:43:21.267229 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:21.272830 | ddfad5a2-e768-4b3b-afac-1f411b5f85db ==============================
[0m07:43:21.272830 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:21.273633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:21.370342 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:21.385903 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:21.404261 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:21.415582 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:21.611282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:21.611854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:21.613923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:21.614413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:21.661010 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:21.662401 [info ] [MainThread]: 
[0m07:43:21.663227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:21.663161 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:21.664301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:21.664815 [info ] [MainThread]: 
[0m07:43:21.665396 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:21.666895 [debug] [MainThread]: Command end result
[0m07:43:21.668114 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46876478, "process_user_time": 1.028863, "process_kernel_time": 0.089201, "process_mem_max_rss": "97852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:21.668853 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:21.668731 after 0.47 seconds
[0m07:43:21.669294 [debug] [MainThread]: Flushing usage events
[0m07:43:21.689660 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:21.690664 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:21.691356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:21.710695 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.019 seconds
[0m07:43:21.712025 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:21.716526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:21.717278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:21.721709 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:21.723955 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:21.724691 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:21.726288 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:21.727390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:21.728013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:21.734748 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:43:21.735850 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:21.736457 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:21.738816 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:21.740338 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:21.741006 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:23.659928 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m07:43:23.660826 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:23.661308 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:23.663711 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m07:43:23.665010 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:23.665648 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:23.670269 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.670841 [debug] [MainThread]: On master: BEGIN
[0m07:43:23.671377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:23.676471 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:23.677385 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.678507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:23.684341 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m07:43:23.685824 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:23.686394 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.686789 [debug] [MainThread]: On master: BEGIN
[0m07:43:23.687411 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:23.688419 [debug] [MainThread]: On master: COMMIT
[0m07:43:23.691709 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:23.693114 [debug] [MainThread]: On master: COMMIT
[0m07:43:23.695915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:23.696797 [debug] [MainThread]: On master: Close
[0m07:43:23.697443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:23.698260 [info ] [MainThread]: 
[0m07:43:23.725806 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m07:43:23.731481 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m07:43:23.737916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_product)
[0m07:43:23.738325 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m07:43:23.761829 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.025 seconds
[0m07:43:23.777214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m07:43:23.779902 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:23.792125 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m07:43:23.796100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:23.796844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:23.806854 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:23.809084 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:23.810877 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:23.814729 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:23.816900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:23.818722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:23.828103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m07:43:23.830861 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:23.831306 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m07:43:23.831738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:26.738125 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:26.740852 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:26.741286 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:26.743730 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m07:43:26.744958 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:26.745611 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:26.750590 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.751194 [debug] [MainThread]: On master: BEGIN
[0m07:43:26.754552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:26.759798 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:26.760877 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.761808 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:26.765785 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m07:43:26.767262 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:26.768071 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.768548 [debug] [MainThread]: On master: BEGIN
[0m07:43:26.769078 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:26.769670 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.770134 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.770509 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.770922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:26.771388 [debug] [MainThread]: On master: Close
[0m07:43:26.771980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:26.772491 [info ] [MainThread]: 
[0m07:43:26.779366 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m07:43:26.782841 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m07:43:26.783488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m07:43:26.783989 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m07:43:26.789915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m07:43:26.791332 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m07:43:26.817209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m07:43:26.821327 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.821957 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m07:43:26.822454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:26.826962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:43:26.828342 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.829880 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m07:43:26.833033 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m07:43:26.839109 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.839900 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m07:43:26.840929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:26.856975 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:43:26.857757 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.858177 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m07:43:26.859177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:26.863927 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m07:43:26.867194 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m07:43:26.867843 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m07:43:26.868577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:26.870309 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m07:43:26.871692 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.09s]
[0m07:43:26.876086 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m07:43:26.877616 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.878523 [debug] [MainThread]: On master: BEGIN
[0m07:43:26.883688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:26.889214 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:26.892018 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.892501 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:26.892958 [debug] [MainThread]: On master: COMMIT
[0m07:43:26.893516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:26.894056 [debug] [MainThread]: On master: Close
[0m07:43:26.894776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:26.895333 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:26.895804 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m07:43:26.896626 [info ] [MainThread]: 
[0m07:43:26.897261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m07:43:26.898090 [debug] [MainThread]: Command end result
[0m07:43:26.898685 [info ] [MainThread]: 
[0m07:43:26.899295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:26.899755 [info ] [MainThread]: 
[0m07:43:26.900319 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:26.901345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.663426, "process_user_time": 1.187193, "process_kernel_time": 0.094934, "process_mem_max_rss": "108604", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:26.901976 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:26.901901 after 5.66 seconds
[0m07:43:26.902423 [debug] [MainThread]: Flushing usage events
[0m07:43:28.406539 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:28.428332 | a32bddac-7e98-4d6b-bfee-7a9bde5214f1 ==============================
[0m07:43:28.428332 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:28.435696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}
[0m07:43:28.433389 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:28.453185 | 534922bb-929e-4825-8a10-06511152ddf0 ==============================
[0m07:43:28.453185 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:28.456795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:28.604252 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:28.612840 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:28.626289 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:28.629451 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:28.796940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:28.797760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:28.804350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:28.806065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:28.830474 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:43:28.832115 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:28.833620 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:28.838405 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m07:43:28.834715 [debug] [ThreadPool]: SQL status: BEGIN in 5.018 seconds
[0m07:43:28.843924 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.845545 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:28.846465 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m07:43:28.846732 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m07:43:28.847090 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:28.850129 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:28.851523 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:28.851896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:43:28.853504 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:28.858037 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:28.859626 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.859768 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:28.860436 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m07:43:28.863253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:28.865917 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:28.866520 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.868217 [debug] [MainThread]: On master: BEGIN
[0m07:43:28.870339 [info ] [MainThread]: 
[0m07:43:28.869352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:28.871344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:28.874321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:28.876546 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:43:28.877604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.878898 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:43:28.878724 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m07:43:28.883191 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.885068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:28.886847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:43:28.897891 [debug] [MainThread]: SQL status: SELECT 8 in 0.009 seconds
[0m07:43:28.903357 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m07:43:28.921663 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:28.917431 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:28.909236 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:28.941893 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m07:43:28.949741 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m07:43:28.946064 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.949016 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:28.954890 [debug] [MainThread]: On master: BEGIN
[0m07:43:28.955817 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:43:28.957905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:28.965395 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:28.971136 [debug] [MainThread]: On master: COMMIT
[0m07:43:28.972209 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.969008 [info ] [MainThread]: 
[0m07:43:28.972685 [debug] [MainThread]: On master: COMMIT
[0m07:43:28.976704 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:28.976413 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m07:43:28.978953 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:28.981444 [debug] [MainThread]: On master: Close
[0m07:43:28.983021 [debug] [MainThread]: Command end result
[0m07:43:28.983305 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:28.984044 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.026 seconds
[0m07:43:28.987034 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:28.984602 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 5.25s]
[0m07:43:28.985820 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6332844, "process_user_time": 1.090404, "process_kernel_time": 0.059106, "process_mem_max_rss": "97572", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:28.985381 [info ] [MainThread]: 
[0m07:43:28.990876 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m07:43:28.991527 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:28.991397 after 0.64 seconds
[0m07:43:28.994300 [debug] [MainThread]: Flushing usage events
[0m07:43:28.997068 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:28.994861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:28.998136 [debug] [MainThread]: On master: BEGIN
[0m07:43:29.000642 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m07:43:29.006102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:29.007917 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m07:43:28.997607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:29.009656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m07:43:29.008648 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:29.012292 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m07:43:29.012020 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:29.014181 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:43:29.012999 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:29.019799 [debug] [MainThread]: On master: COMMIT
[0m07:43:29.019104 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:29.020455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m07:43:29.021552 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:29.020865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:29.023308 [debug] [MainThread]: On master: COMMIT
[0m07:43:29.022019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:29.025041 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:29.025851 [debug] [MainThread]: On master: Close
[0m07:43:29.026346 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m07:43:29.027626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:29.032738 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m07:43:29.033443 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m07:43:29.034176 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:29.036711 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:43:29.038537 [info ] [MainThread]: 
[0m07:43:29.037440 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:29.039767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.48 seconds (15.48s).
[0m07:43:29.040898 [debug] [MainThread]: Command end result
[0m07:43:29.041695 [info ] [MainThread]: 
[0m07:43:29.042294 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:29.042850 [info ] [MainThread]: 
[0m07:43:29.042460 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m07:43:29.043452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:29.044734 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:29.045920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.867247, "process_user_time": 1.187586, "process_kernel_time": 0.085619, "process_mem_max_rss": "106532", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:29.047288 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:29.047176 after 15.87 seconds
[0m07:43:29.047819 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:29.048452 [debug] [MainThread]: Flushing usage events
[0m07:43:29.059700 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m07:43:29.068244 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:29.071109 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m07:43:29.072949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:30.761586 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:30.765908 | 2df29df3-4942-4872-ad8c-13475de5a69d ==============================
[0m07:43:30.765908 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:30.766590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:43:30.785894 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:30.790862 | f22fce2f-44b9-4a25-b17b-c2230d4e30a1 ==============================
[0m07:43:30.790862 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:30.791467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'send_anonymous_usage_stats': 'True'}
[0m07:43:30.915900 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:30.930344 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:30.942292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:30.961813 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:31.107187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:31.107862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:31.115379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:31.116862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:31.161422 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:31.168901 [info ] [MainThread]: 
[0m07:43:31.175932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:31.191094 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:31.202274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:31.202290 [info ] [MainThread]: 
[0m07:43:31.210557 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:31.226254 [debug] [MainThread]: Command end result
[0m07:43:31.236360 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.53341943, "process_user_time": 1.025451, "process_kernel_time": 0.077639, "process_mem_max_rss": "97456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:31.237047 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:31.236985 after 0.53 seconds
[0m07:43:31.237423 [debug] [MainThread]: Flushing usage events
[0m07:43:31.264642 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:31.265341 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:31.265938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:31.271625 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m07:43:31.272993 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:31.276913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:31.277626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:31.281860 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:31.283701 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:31.284219 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:31.284673 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:31.285067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:31.285446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:34.031809 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m07:43:34.032946 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:34.033695 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:34.037049 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:34.039089 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:34.039847 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:34.045102 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.045732 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.048631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:34.052867 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:43:34.053370 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.053932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:34.058112 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m07:43:34.062875 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:34.063496 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.063837 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.064438 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:34.064930 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.065254 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.065515 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.065955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:34.066274 [debug] [MainThread]: On master: Close
[0m07:43:34.066713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:34.067071 [info ] [MainThread]: 
[0m07:43:34.072168 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m07:43:34.072890 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m07:43:34.074540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_customers)
[0m07:43:34.075523 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m07:43:34.084247 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m07:43:34.088748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m07:43:34.089211 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.090152 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m07:43:34.091414 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m07:43:34.092137 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:43:34.100415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.101131 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m07:43:34.102212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:34.112704 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:43:34.113426 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.114005 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m07:43:34.115633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m07:43:34.117591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:43:34.122647 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m07:43:34.126204 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m07:43:34.126692 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.127430 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m07:43:34.127295 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m07:43:34.128000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:34.129451 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:43:34.131556 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m07:43:34.132979 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.12s]
[0m07:43:34.134303 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m07:43:34.134798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:43:34.136140 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.136885 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.136785 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m07:43:34.137264 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.137736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:34.140964 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:43:34.151970 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.158341 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m07:43:34.166239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:34.183869 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:43:34.201894 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.216764 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m07:43:34.241145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m07:43:34.248938 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m07:43:34.251992 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m07:43:34.252476 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m07:43:34.253223 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m07:43:34.254981 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m07:43:34.256705 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 0.18s]
[0m07:43:34.257704 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m07:43:34.258947 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.262074 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.262819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:34.271400 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:43:34.272330 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.272863 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.276845 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.277453 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:34.277802 [debug] [MainThread]: On master: Close
[0m07:43:34.278466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:34.279285 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:34.279714 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m07:43:34.281573 [info ] [MainThread]: 
[0m07:43:34.281933 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m07:43:34.282682 [debug] [MainThread]: Command end result
[0m07:43:34.282992 [info ] [MainThread]: 
[0m07:43:34.283327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:34.283894 [info ] [MainThread]: 
[0m07:43:34.284621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:34.285445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9070973, "process_user_time": 1.242337, "process_kernel_time": 0.086203, "process_mem_max_rss": "106804", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:34.287370 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:34.287282 after 5.91 seconds
[0m07:43:34.293760 [debug] [MainThread]: Flushing usage events
[0m07:43:36.209101 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:36.209067 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:36.214546 | 64559345-979d-4972-8202-887186db33b0 ==============================
[0m07:43:36.214546 [info ] [MainThread]: Running with dbt=1.8.2


============================== 07:43:36.214359 | c2ed7db9-ce4c-4088-be73-1309f2c59e56 ==============================
[0m07:43:36.214359 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:36.215275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m07:43:36.216066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:36.290888 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:36.291619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:36.292172 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:36.292550 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m07:43:36.293441 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:36.293906 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:36.294828 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:36.296013 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:36.296305 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m07:43:36.296924 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:36.298013 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:36.299420 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:36.304964 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:36.305689 [debug] [MainThread]: On master: BEGIN
[0m07:43:36.306129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:36.410866 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:36.416097 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:36.428711 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:36.433880 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:36.596993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:36.597737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:36.602763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:36.603411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:36.659062 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:36.659836 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:36.660544 [info ] [MainThread]: 
[0m07:43:36.661818 [info ] [MainThread]: 
[0m07:43:36.662475 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:36.662831 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:36.663963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:36.665029 [debug] [MainThread]: Command end result
[0m07:43:36.669202 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49327853, "process_user_time": 1.120243, "process_kernel_time": 0.066864, "process_mem_max_rss": "97584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:36.669981 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:36.669904 after 0.49 seconds
[0m07:43:36.671379 [debug] [MainThread]: Flushing usage events
[0m07:43:36.690680 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:36.691918 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:36.692444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:36.701591 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m07:43:36.702694 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:36.706406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:43:36.707076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:43:36.711748 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:36.713842 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:36.714294 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:36.714676 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:36.715050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:36.715535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:39.142106 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m07:43:39.144758 [debug] [MainThread]: On master: COMMIT
[0m07:43:39.145307 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:39.146144 [debug] [MainThread]: On master: COMMIT
[0m07:43:39.146842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:39.147292 [debug] [MainThread]: On master: Close
[0m07:43:39.147815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:39.148164 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m07:43:39.148516 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:39.148942 [info ] [MainThread]: 
[0m07:43:39.149357 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.44 seconds (20.44s).
[0m07:43:39.149989 [debug] [MainThread]: Command end result
[0m07:43:39.150277 [info ] [MainThread]: 
[0m07:43:39.150667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:39.151047 [info ] [MainThread]: 
[0m07:43:39.151427 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:39.152470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.885977, "process_user_time": 1.201503, "process_kernel_time": 0.096323, "process_mem_max_rss": "106572", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:39.153358 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:39.153256 after 20.89 seconds
[0m07:43:39.153894 [debug] [MainThread]: Flushing usage events
[0m07:43:41.313088 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m07:43:41.317454 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.321898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:41.327695 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:43:41.331138 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:41.331988 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.332518 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.335194 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:41.337058 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.338108 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.339206 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.340009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:41.340787 [debug] [MainThread]: On master: Close
[0m07:43:41.341556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:41.342226 [info ] [MainThread]: 
[0m07:43:41.385318 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m07:43:41.389403 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m07:43:41.399149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_product)
[0m07:43:41.418927 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m07:43:41.440900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m07:43:41.442219 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m07:43:41.471623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m07:43:41.470162 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:41.475528 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.477136 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN


============================== 07:43:41.477360 | f1e21e31-e7cc-4bc3-ade8-9bdba2401844 ==============================
[0m07:43:41.477360 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:41.479251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:41.479665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:41.487307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:43:41.487999 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.488675 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m07:43:41.497217 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.008 seconds
[0m07:43:41.502381 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.502976 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m07:43:41.500114 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:43:41.503818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds


============================== 07:43:41.506246 | f20a60c9-2123-497f-93d5-c369d41b6f07 ==============================
[0m07:43:41.506246 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:41.509144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:41.517046 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:43:41.518300 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.519334 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m07:43:41.521235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:41.527227 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m07:43:41.532299 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m07:43:41.533687 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m07:43:41.537043 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:41.539128 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m07:43:41.540917 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.14s]
[0m07:43:41.541936 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m07:43:41.543346 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.543915 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.544715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:41.550935 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:41.551603 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.552235 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.552759 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.556303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:41.557373 [debug] [MainThread]: On master: Close
[0m07:43:41.558185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:41.559120 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:41.562073 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m07:43:41.563239 [info ] [MainThread]: 
[0m07:43:41.564791 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m07:43:41.569093 [debug] [MainThread]: Command end result
[0m07:43:41.569766 [info ] [MainThread]: 
[0m07:43:41.573139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:41.573983 [info ] [MainThread]: 
[0m07:43:41.577018 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:41.580330 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.905666, "process_user_time": 1.203821, "process_kernel_time": 0.077534, "process_mem_max_rss": "106792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:41.582297 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:41.582172 after 10.91 seconds
[0m07:43:41.583387 [debug] [MainThread]: Flushing usage events
[0m07:43:41.638777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:41.653145 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:41.673466 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:41.686492 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:41.720942 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:43:41.722229 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:41.724945 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:41.727175 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:43:41.729017 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:41.729804 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:41.728718 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:43:41.735679 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:41.736827 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m07:43:41.738348 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:41.737255 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:41.739246 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:41.746104 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.746827 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.747281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:41.753650 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:43:41.754386 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.754937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:41.760059 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m07:43:41.762201 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:41.763038 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.768001 [debug] [MainThread]: On master: BEGIN
[0m07:43:41.769485 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:41.770961 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.772257 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:41.773545 [debug] [MainThread]: On master: COMMIT
[0m07:43:41.774591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:41.775156 [debug] [MainThread]: On master: Close
[0m07:43:41.776020 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:41.777170 [info ] [MainThread]: 
[0m07:43:41.784810 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m07:43:41.785647 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m07:43:41.789910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m07:43:41.791122 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m07:43:41.797491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m07:43:41.799691 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m07:43:41.844484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m07:43:41.908803 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:41.914215 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m07:43:41.915692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:41.916833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:41.917655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:41.937120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:41.940722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:41.981168 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:41.983927 [info ] [MainThread]: 
[0m07:43:41.985187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:41.986216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:42.001722 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:42.003160 [info ] [MainThread]: 
[0m07:43:42.003712 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:42.005398 [debug] [MainThread]: Command end result
[0m07:43:42.006187 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5412945, "process_user_time": 1.122387, "process_kernel_time": 0.07496, "process_mem_max_rss": "97604", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:42.007014 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:42.006926 after 0.54 seconds
[0m07:43:42.007453 [debug] [MainThread]: Flushing usage events
[0m07:43:42.010539 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:42.011278 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:42.011854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:43.574998 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:43.579497 | f0af2f71-aafa-4994-8789-b2df949d1d25 ==============================
[0m07:43:43.579497 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:43.580139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:43.702807 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:43.719690 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:43.905683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:43.906425 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:43.960377 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:43.961773 [info ] [MainThread]: 
[0m07:43:43.962326 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:43.963925 [debug] [MainThread]: Command end result
[0m07:43:43.964827 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4201588, "process_user_time": 1.034661, "process_kernel_time": 0.055509, "process_mem_max_rss": "98088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:43.965448 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:43.965364 after 0.42 seconds
[0m07:43:43.965868 [debug] [MainThread]: Flushing usage events
[0m07:43:46.939527 [debug] [Thread-1 (]: SQL status: BEGIN in 5.024 seconds
[0m07:43:46.947204 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:46.949148 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m07:43:47.017465 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.005 seconds
[0m07:43:47.019395 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:47.025082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:47.025836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:47.032150 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:47.034695 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:47.035386 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:47.036047 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:47.036761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:47.037452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:47.044553 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:43:47.045376 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:43:47.046578 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:47.048041 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:47.048688 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:47.049546 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:43:47.052963 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m07:43:47.053385 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m07:43:47.055316 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:47.056816 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:43:47.057649 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:43:47.058152 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:43:47.067295 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.068035 [debug] [MainThread]: On master: BEGIN
[0m07:43:47.068729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:47.075817 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:43:47.076723 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.077464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:47.083412 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:43:47.086217 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:47.086899 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.087386 [debug] [MainThread]: On master: BEGIN
[0m07:43:47.088157 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:47.089253 [debug] [MainThread]: On master: COMMIT
[0m07:43:47.089969 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:47.090995 [debug] [MainThread]: On master: COMMIT
[0m07:43:47.091722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:47.092252 [debug] [MainThread]: On master: Close
[0m07:43:47.093069 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:43:47.093788 [info ] [MainThread]: 
[0m07:43:47.100717 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m07:43:47.101641 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m07:43:47.102443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_channel)
[0m07:43:47.103165 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m07:43:47.110791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m07:43:47.112604 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m07:43:47.144439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m07:43:47.145847 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:47.146253 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m07:43:47.146792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:48.242145 [debug] [Thread-1 (]: SQL status: SELECT 259023 in 1.291 seconds
[0m07:43:48.252501 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:48.253177 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m07:43:48.253967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:48.266006 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:43:48.266679 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:48.267073 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m07:43:48.272802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:43:48.277163 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m07:43:48.280171 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m07:43:48.280631 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m07:43:48.281312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:48.283576 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m07:43:48.285249 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259023[0m in 6.49s]
[0m07:43:48.286277 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m07:43:48.288158 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:48.288802 [debug] [MainThread]: On master: BEGIN
[0m07:43:48.289190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:48.293967 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:48.294797 [debug] [MainThread]: On master: COMMIT
[0m07:43:48.295351 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:48.295870 [debug] [MainThread]: On master: COMMIT
[0m07:43:48.296881 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:48.297445 [debug] [MainThread]: On master: Close
[0m07:43:48.298149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:48.298665 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:48.299269 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m07:43:48.299838 [info ] [MainThread]: 
[0m07:43:48.300366 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.64 seconds (11.64s).
[0m07:43:48.301067 [debug] [MainThread]: Command end result
[0m07:43:48.301383 [info ] [MainThread]: 
[0m07:43:48.301833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:48.302315 [info ] [MainThread]: 
[0m07:43:48.302862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:48.303821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.126955, "process_user_time": 1.280448, "process_kernel_time": 0.083373, "process_mem_max_rss": "108592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:48.304484 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:48.304340 after 12.13 seconds
[0m07:43:48.304912 [debug] [MainThread]: Flushing usage events
[0m07:43:50.643645 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:50.650415 | e66ea3bc-7dc5-498e-a702-530cd98e51d1 ==============================
[0m07:43:50.650415 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:50.651044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:50.798302 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:50.812917 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:51.020940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:51.021568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:51.077341 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:51.079538 [info ] [MainThread]: 
[0m07:43:51.080239 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:51.082554 [debug] [MainThread]: Command end result
[0m07:43:51.083439 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48083976, "process_user_time": 1.054085, "process_kernel_time": 0.066765, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:51.084101 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:51.083986 after 0.48 seconds
[0m07:43:51.084500 [debug] [MainThread]: Flushing usage events
[0m07:43:52.159155 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m07:43:52.160270 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.161008 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m07:43:52.164737 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m07:43:52.169567 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.170045 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m07:43:52.170763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:52.185027 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:43:52.185898 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.189698 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m07:43:52.191089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:43:52.195539 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m07:43:52.198793 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m07:43:52.199280 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m07:43:52.199914 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:43:52.203030 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m07:43:52.204778 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.10s]
[0m07:43:52.205467 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m07:43:52.206974 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:52.207414 [debug] [MainThread]: On master: BEGIN
[0m07:43:52.207741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:52.212347 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:52.212991 [debug] [MainThread]: On master: COMMIT
[0m07:43:52.213365 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:52.213799 [debug] [MainThread]: On master: COMMIT
[0m07:43:52.214323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:52.214798 [debug] [MainThread]: On master: Close
[0m07:43:52.215282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:52.215620 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m07:43:52.215902 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:43:52.216266 [info ] [MainThread]: 
[0m07:43:52.217050 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m07:43:52.217947 [debug] [MainThread]: Command end result
[0m07:43:52.218329 [info ] [MainThread]: 
[0m07:43:52.218775 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:52.219105 [info ] [MainThread]: 
[0m07:43:52.219411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:43:52.220206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.784707, "process_user_time": 1.249406, "process_kernel_time": 0.093832, "process_mem_max_rss": "106420", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:52.220750 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:52.220674 after 10.79 seconds
[0m07:43:52.221116 [debug] [MainThread]: Flushing usage events
[0m07:43:54.723495 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:54.729747 | 71b9d206-843c-4ec5-92e1-1f4dfd762e09 ==============================
[0m07:43:54.729747 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:54.731498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:43:54.733361 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:54.739417 | 286d024a-44ea-47f5-b5b1-b546a7a66ae5 ==============================
[0m07:43:54.739417 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:54.740268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:54.749684 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:43:54.760674 | a6d102fb-e54e-43ea-856d-6934ad55a092 ==============================
[0m07:43:54.760674 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:43:54.762314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:55.051889 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:55.058965 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:55.072283 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:55.078914 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:55.087936 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:55.111635 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:43:55.233854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:55.236279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:55.256093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:55.256892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:55.271462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:55.272522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:55.312803 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:55.315732 [info ] [MainThread]: 
[0m07:43:55.316765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:55.318109 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:55.318762 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:55.324282 [info ] [MainThread]: 
[0m07:43:55.325563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:55.327290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:43:55.328072 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:43:55.330160 [info ] [MainThread]: 
[0m07:43:55.330973 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:55.332742 [debug] [MainThread]: Command end result
[0m07:43:55.333680 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.62375444, "process_user_time": 1.202804, "process_kernel_time": 0.059435, "process_mem_max_rss": "97432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:43:55.334366 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:55.334266 after 0.62 seconds
[0m07:43:55.334791 [debug] [MainThread]: Flushing usage events
[0m07:43:55.348755 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:55.352892 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:55.353331 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:43:55.353897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:55.354192 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:43:55.354811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:55.364190 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m07:43:55.365383 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:43:55.369470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:43:55.369987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:43:55.374553 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:43:55.376555 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:55.377128 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:43:55.377628 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:43:55.378035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:55.378379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:55.383749 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:55.386423 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:43:55.388433 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:43:55.393530 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m07:43:55.395745 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:43:55.396765 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:00.362044 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.007 seconds
[0m07:44:00.363465 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:44:00.367581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:44:00.368229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:44:00.376753 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:00.378614 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:00.379088 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:00.379544 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:00.379879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:00.380394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:00.382701 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:44:00.383470 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:00.384080 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:00.385714 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:44:00.386347 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:00.387614 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:00.386884 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:00.388113 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:00.388120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:00.391378 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:00.392899 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:00.393364 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.393636 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:00.394086 [debug] [MainThread]: On master: BEGIN
[0m07:44:00.394903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:00.399608 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:44:00.400319 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.400746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:00.406082 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:44:00.408586 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:00.409433 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.409934 [debug] [MainThread]: On master: BEGIN
[0m07:44:00.410606 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:00.411206 [debug] [MainThread]: On master: COMMIT
[0m07:44:00.411570 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:00.411931 [debug] [MainThread]: On master: COMMIT
[0m07:44:00.412350 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:00.412852 [debug] [MainThread]: On master: Close
[0m07:44:00.413456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:00.413970 [info ] [MainThread]: 
[0m07:44:00.419551 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m07:44:00.420357 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m07:44:00.421116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_transactions_main)
[0m07:44:00.424364 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m07:44:00.442800 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m07:44:00.452413 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m07:44:00.487686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m07:44:00.489359 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:44:00.490071 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m07:44:00.490541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:00.496672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:44:00.497338 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:44:00.497865 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m07:44:05.384780 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m07:44:05.387963 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:05.388718 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:05.393077 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m07:44:05.394457 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:05.394965 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:05.400092 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.400645 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.400990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:05.406982 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:44:05.408814 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.409690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:05.417847 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m07:44:05.419940 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:05.420618 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.421125 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.421827 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:05.422618 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.423231 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.424238 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.425411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:05.425925 [debug] [MainThread]: On master: Close
[0m07:44:05.426645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:05.427105 [info ] [MainThread]: 
[0m07:44:05.434706 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.435353 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m07:44:05.436799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m07:44:05.439074 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.454867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.456285 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.495006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.497101 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.497556 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m07:44:05.497854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:05.502262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:44:05.506726 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.509064 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 

  

trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  



)


SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m07:44:05.677931 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 5.180 seconds
[0m07:44:05.702475 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:44:05.703085 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m07:44:05.703618 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m07:44:05.706048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:44:05.707803 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m07:44:05.709402 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 5.29s]
[0m07:44:05.710187 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m07:44:05.711935 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.712374 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.712681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:05.717193 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:44:05.717856 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.718390 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.718827 [debug] [MainThread]: On master: COMMIT
[0m07:44:05.719583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:05.720154 [debug] [MainThread]: On master: Close
[0m07:44:05.720814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:05.721262 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m07:44:05.721699 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:44:05.722111 [info ] [MainThread]: 
[0m07:44:05.722472 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m07:44:05.723169 [debug] [MainThread]: Command end result
[0m07:44:05.723681 [info ] [MainThread]: 
[0m07:44:05.724273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:05.724720 [info ] [MainThread]: 
[0m07:44:05.725098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:05.725799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.030321, "process_user_time": 1.397085, "process_kernel_time": 0.089372, "process_mem_max_rss": "107052", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:05.726209 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:05.726154 after 11.03 seconds
[0m07:44:05.726546 [debug] [MainThread]: Flushing usage events
[0m07:44:05.931112 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.421 seconds
[0m07:44:05.942870 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:44:05.943456 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m07:44:05.943792 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m07:44:05.944717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:44:05.946751 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m07:44:05.948554 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 0[0m in 0.51s]
[0m07:44:05.950120 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m07:44:05.951726 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:05.956491 [debug] [MainThread]: On master: BEGIN
[0m07:44:05.959134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:07.706673 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:07.710974 | 353a48dd-2a57-4434-9eba-61d771e7df57 ==============================
[0m07:44:07.710974 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:07.712727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:07.845758 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:07.856259 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:08.025691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:08.026269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:08.083336 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:08.084791 [info ] [MainThread]: 
[0m07:44:08.085419 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:44:08.086796 [debug] [MainThread]: Command end result
[0m07:44:08.087353 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41148338, "process_user_time": 1.065715, "process_kernel_time": 0.056907, "process_mem_max_rss": "97720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:08.087770 [debug] [MainThread]: Command `dbt test` succeeded at 07:44:08.087714 after 0.41 seconds
[0m07:44:08.088051 [debug] [MainThread]: Flushing usage events
[0m07:44:10.966876 [debug] [MainThread]: SQL status: BEGIN in 5.008 seconds
[0m07:44:10.967952 [debug] [MainThread]: On master: COMMIT
[0m07:44:10.969647 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:10.970149 [debug] [MainThread]: On master: COMMIT
[0m07:44:10.970693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:10.971290 [debug] [MainThread]: On master: Close
[0m07:44:10.972038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:10.973743 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m07:44:10.974694 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:44:10.975666 [info ] [MainThread]: 
[0m07:44:10.976557 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 15.65 seconds (15.65s).
[0m07:44:10.978027 [debug] [MainThread]: Command end result
[0m07:44:10.978685 [info ] [MainThread]: 
[0m07:44:10.979862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:10.982590 [info ] [MainThread]: 
[0m07:44:10.983185 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:10.984171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.298986, "process_user_time": 1.383166, "process_kernel_time": 0.095995, "process_mem_max_rss": "108972", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:10.984776 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:10.984715 after 16.30 seconds
[0m07:44:10.985259 [debug] [MainThread]: Flushing usage events
[0m07:44:12.885707 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:12.907366 | 64cd8491-b891-4608-ba63-21b23e9ac22d ==============================
[0m07:44:12.907366 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:12.897934 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m07:44:12.920164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}


============================== 07:44:12.929423 | de389399-e7a2-4bcd-81ca-f397941cf11f ==============================
[0m07:44:12.929423 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:12.931775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:13.098022 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:13.104445 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:13.109742 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:13.124144 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:13.257850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:13.258425 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:13.277141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:13.277764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:13.313594 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:13.315416 [info ] [MainThread]: 
[0m07:44:13.316141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:13.318205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:44:13.331606 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:13.333412 [info ] [MainThread]: 
[0m07:44:13.336848 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:44:13.338553 [debug] [MainThread]: Command end result
[0m07:44:13.339405 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51890063, "process_user_time": 1.065538, "process_kernel_time": 0.064586, "process_mem_max_rss": "97468", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:13.343251 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:44:13.351650 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:44:13.351034 [debug] [MainThread]: Command `dbt test` succeeded at 07:44:13.350869 after 0.53 seconds
[0m07:44:13.352297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:13.352592 [debug] [MainThread]: Flushing usage events
[0m07:44:18.363658 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m07:44:18.367376 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:44:18.373496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m07:44:18.374031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:44:18.378600 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:18.380340 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:18.380776 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:18.381237 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:18.381602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:18.382002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:18.387150 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:44:18.388096 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:18.388667 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:18.391122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:18.392380 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:18.393109 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:23.393810 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:44:23.396807 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:23.399085 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:23.401441 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m07:44:23.403579 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:23.405151 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:23.410524 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:23.411096 [debug] [MainThread]: On master: BEGIN
[0m07:44:23.411478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:28.422719 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m07:44:28.427103 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:28.431269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:28.436468 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:44:28.438208 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:28.438882 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:28.439282 [debug] [MainThread]: On master: BEGIN
[0m07:44:28.439805 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:28.440133 [debug] [MainThread]: On master: COMMIT
[0m07:44:28.445078 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:28.445600 [debug] [MainThread]: On master: COMMIT
[0m07:44:28.446176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:28.446546 [debug] [MainThread]: On master: Close
[0m07:44:28.446986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:28.447318 [info ] [MainThread]: 
[0m07:44:28.452415 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m07:44:28.453127 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m07:44:28.453896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m07:44:28.454747 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m07:44:28.460698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m07:44:28.461990 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m07:44:28.490919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m07:44:28.492458 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:28.492848 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m07:44:28.493197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:33.505810 [debug] [Thread-1 (]: SQL status: BEGIN in 5.013 seconds
[0m07:44:33.511259 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:33.511890 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m07:44:34.198437 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.686 seconds
[0m07:44:34.206051 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:34.209702 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m07:44:34.211868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:44:34.226018 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:44:34.226738 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:34.227135 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m07:44:34.234209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m07:44:34.239010 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m07:44:34.241917 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m07:44:34.242324 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m07:44:34.242826 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:44:34.244532 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m07:44:34.245762 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1000000[0m in 5.79s]
[0m07:44:34.246484 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m07:44:34.248343 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:34.249048 [debug] [MainThread]: On master: BEGIN
[0m07:44:34.251598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:34.257998 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:44:34.259257 [debug] [MainThread]: On master: COMMIT
[0m07:44:34.260094 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:34.261738 [debug] [MainThread]: On master: COMMIT
[0m07:44:34.262488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:34.263468 [debug] [MainThread]: On master: Close
[0m07:44:34.264161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:34.264654 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:44:34.267837 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m07:44:34.268618 [info ] [MainThread]: 
[0m07:44:34.269197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.95 seconds (20.95s).
[0m07:44:34.269825 [debug] [MainThread]: Command end result
[0m07:44:34.270255 [info ] [MainThread]: 
[0m07:44:34.270875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:34.271522 [info ] [MainThread]: 
[0m07:44:34.272109 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:34.275182 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.457815, "process_user_time": 1.172803, "process_kernel_time": 0.094386, "process_mem_max_rss": "108548", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:34.275812 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:34.275726 after 21.46 seconds
[0m07:44:34.278079 [debug] [MainThread]: Flushing usage events
[0m07:44:36.356724 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:36.361456 | df0efe30-2c52-4d73-9831-d3d15fc31a71 ==============================
[0m07:44:36.361456 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:36.362154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:44:36.384094 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:36.390947 | 0ab2ae64-bcea-4bc1-9a2e-98368949942f ==============================
[0m07:44:36.390947 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:36.391462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:44:36.502352 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:36.525406 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:36.529712 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:36.545917 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:36.687658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:36.688519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:36.707335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:36.710019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:36.739672 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:36.740975 [info ] [MainThread]: 
[0m07:44:36.741563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:36.742430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m07:44:36.801215 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m07:44:36.805531 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:36.811400 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m07:44:36.830056 [info ] [MainThread]: 
[0m07:44:36.830323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:36.831164 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:44:36.833436 [debug] [MainThread]: Command end result
[0m07:44:36.834390 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49132922, "process_user_time": 1.041072, "process_kernel_time": 0.076891, "process_mem_max_rss": "97712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:36.834915 [debug] [MainThread]: Command `dbt test` succeeded at 07:44:36.834847 after 0.49 seconds
[0m07:44:36.835268 [debug] [MainThread]: Flushing usage events
[0m07:44:36.838040 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m07:44:36.842026 [debug] [ThreadPool]: On list_sales_dw: Close
[0m07:44:36.847132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m07:44:36.848303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:44:36.853784 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:36.856085 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:36.860089 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:36.860744 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:36.861224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:36.861780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:36.870307 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m07:44:36.872035 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:36.872591 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:36.876032 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m07:44:36.877277 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:36.881210 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:44:41.874147 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m07:44:41.876936 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:41.879323 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:44:41.884334 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:44:41.885747 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:44:41.887015 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:44:41.891649 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:41.892113 [debug] [MainThread]: On master: BEGIN
[0m07:44:41.892418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:46.897697 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m07:44:46.898887 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:46.899453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:46.908077 [debug] [MainThread]: SQL status: SELECT 12 in 0.008 seconds
[0m07:44:46.911943 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:46.912857 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:46.913232 [debug] [MainThread]: On master: BEGIN
[0m07:44:46.915071 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:46.915546 [debug] [MainThread]: On master: COMMIT
[0m07:44:46.916061 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:46.916394 [debug] [MainThread]: On master: COMMIT
[0m07:44:46.917027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:46.917836 [debug] [MainThread]: On master: Close
[0m07:44:46.918645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:44:46.920316 [info ] [MainThread]: 
[0m07:44:46.935495 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m07:44:46.938353 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m07:44:46.939497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m07:44:46.941333 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m07:44:46.947519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m07:44:46.948698 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m07:44:46.977792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m07:44:46.987040 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:46.989139 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m07:44:46.989596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:51.998382 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m07:44:52.004160 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.004656 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m07:44:52.902661 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 0.897 seconds
[0m07:44:52.910206 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.912914 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m07:44:52.913608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:44:52.924079 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:44:52.924630 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.925045 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m07:44:52.936138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m07:44:52.951827 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m07:44:52.957425 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m07:44:52.959050 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m07:44:52.959788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m07:44:52.962226 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m07:44:52.963856 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1000000[0m in 6.02s]
[0m07:44:52.964750 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m07:44:52.969082 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:52.969688 [debug] [MainThread]: On master: BEGIN
[0m07:44:52.970123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:52.974637 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:44:52.975268 [debug] [MainThread]: On master: COMMIT
[0m07:44:52.975614 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:52.975870 [debug] [MainThread]: On master: COMMIT
[0m07:44:52.976236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:52.976775 [debug] [MainThread]: On master: Close
[0m07:44:52.978135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:52.978510 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m07:44:52.978914 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m07:44:52.983229 [info ] [MainThread]: 
[0m07:44:52.983590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.24 seconds (16.24s).
[0m07:44:52.984090 [debug] [MainThread]: Command end result
[0m07:44:52.984340 [info ] [MainThread]: 
[0m07:44:52.984639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:52.984893 [info ] [MainThread]: 
[0m07:44:52.985161 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:44:52.985706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.664019, "process_user_time": 1.185941, "process_kernel_time": 0.078459, "process_mem_max_rss": "108384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:44:52.986095 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:52.986044 after 16.66 seconds
[0m07:44:52.986383 [debug] [MainThread]: Flushing usage events
[0m07:44:55.308103 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 07:44:55.313160 | 91ae94d0-a007-4b34-8893-03f67f025e57 ==============================
[0m07:44:55.313160 [info ] [MainThread]: Running with dbt=1.8.2
[0m07:44:55.313786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m07:44:55.449546 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:55.465063 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m07:44:55.696250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:55.696768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:55.751601 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m07:44:55.753100 [info ] [MainThread]: 
[0m07:44:55.753809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:55.757376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m07:44:55.757941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m07:44:55.785806 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:55.786167 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:44:55.786566 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m07:44:55.786930 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m07:44:55.787321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:55.787687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:55.793058 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:44:55.796775 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m07:44:55.797375 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m07:44:55.799557 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.002 seconds
[0m07:44:55.800883 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m07:44:55.801462 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m07:45:00.798290 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m07:45:00.801243 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m07:45:00.803105 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m07:45:00.806431 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m07:45:00.808333 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m07:45:00.809235 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m07:45:00.814406 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:00.815095 [debug] [MainThread]: On master: BEGIN
[0m07:45:00.815544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:05.827112 [debug] [MainThread]: SQL status: BEGIN in 5.012 seconds
[0m07:45:05.836163 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:05.837005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:05.845639 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m07:45:05.849411 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:05.854364 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:05.854885 [debug] [MainThread]: On master: BEGIN
[0m07:45:05.855916 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:45:05.858147 [debug] [MainThread]: On master: COMMIT
[0m07:45:05.859963 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:05.864132 [debug] [MainThread]: On master: COMMIT
[0m07:45:05.864838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:05.865302 [debug] [MainThread]: On master: Close
[0m07:45:05.870477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:45:05.871805 [info ] [MainThread]: 
[0m07:45:05.879595 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m07:45:05.880203 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m07:45:05.880672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m07:45:05.881038 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m07:45:05.886994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.888330 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m07:45:05.899273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.901049 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.901682 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m07:45:05.902267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:05.906899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:45:05.907563 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m07:45:05.907898 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m07:45:06.038581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.130 seconds
[0m07:45:06.041760 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m07:45:06.042555 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m07:45:06.043335 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.16s]
[0m07:45:06.044110 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m07:45:06.045793 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:06.053205 [debug] [MainThread]: On master: BEGIN
[0m07:45:06.056133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:45:06.064672 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:45:06.065344 [debug] [MainThread]: On master: COMMIT
[0m07:45:06.066212 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:06.068239 [debug] [MainThread]: On master: COMMIT
[0m07:45:06.073448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:06.076501 [debug] [MainThread]: On master: Close
[0m07:45:06.077179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:06.077528 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m07:45:06.077851 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m07:45:06.078458 [info ] [MainThread]: 
[0m07:45:06.079060 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m07:45:06.082385 [debug] [MainThread]: Command end result
[0m07:45:06.082940 [info ] [MainThread]: 
[0m07:45:06.083356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:45:06.083634 [info ] [MainThread]: 
[0m07:45:06.083928 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:45:06.084572 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.808046, "process_user_time": 1.109126, "process_kernel_time": 0.090664, "process_mem_max_rss": "108536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:45:06.088278 [debug] [MainThread]: Command `dbt test` succeeded at 07:45:06.088196 after 10.81 seconds
[0m07:45:06.088650 [debug] [MainThread]: Flushing usage events
[0m08:44:01.894300 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:44:01.899202 | 3b60a20c-60d4-45d3-85ce-823e17e531b4 ==============================
[0m08:44:01.899202 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:44:01.899997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:01.978461 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m08:44:01.980589 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m08:44:01.989568 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tcwrieop'
[0m08:44:01.990438 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m08:44:01.991420 [debug] [MainThread]: Creating symlink to local dependency.
[0m08:44:01.992119 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m08:44:01.993196 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13621387, "process_user_time": 0.813473, "process_kernel_time": 0.068039, "process_mem_max_rss": "105500", "process_in_blocks": "8", "process_out_blocks": "8"}
[0m08:44:01.993929 [debug] [MainThread]: Command `dbt deps` succeeded at 08:44:01.993830 after 0.14 seconds
[0m08:44:01.994354 [debug] [MainThread]: Flushing usage events
[0m08:44:03.993524 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:44:04.000100 | e37326f8-98d1-4312-9b5a-b6d55aea6715 ==============================
[0m08:44:04.000100 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:44:04.000592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m08:44:04.132135 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:44:04.150068 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:44:04.151118 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:44:05.459928 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:44:05.466770 [info ] [MainThread]: 
[0m08:44:05.467344 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:44:05.469479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:44:05.530027 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:44:05.530666 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:44:05.531395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:05.537666 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m08:44:05.538893 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:44:05.540855 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m08:44:05.546538 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m08:44:05.551762 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:44:05.552204 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m08:44:05.552617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:05.558088 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:44:05.564455 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:44:05.568363 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m08:44:05.569224 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:44:05.569989 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:44:05.570427 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:44:05.570851 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:44:05.571616 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:44:05.571935 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m08:44:05.575872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m08:44:05.576363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:44:05.580989 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:44:05.583509 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:44:05.584021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:05.583052 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:44:05.585006 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:44:05.585487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:05.588743 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:44:05.589457 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:44:05.589961 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:44:05.592022 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:44:05.593028 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:44:05.593417 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:44:10.598096 [debug] [ThreadPool]: SQL status: BEGIN in 5.013 seconds
[0m08:44:10.598787 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:44:10.599150 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:44:10.601217 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:44:10.602286 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:44:10.602810 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:44:10.606523 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.606960 [debug] [MainThread]: On master: BEGIN
[0m08:44:10.607292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:10.611196 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:44:10.611924 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.612518 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:44:10.615687 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m08:44:10.616994 [debug] [MainThread]: On master: ROLLBACK
[0m08:44:10.617661 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.618029 [debug] [MainThread]: On master: BEGIN
[0m08:44:10.620704 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:44:10.621163 [debug] [MainThread]: On master: COMMIT
[0m08:44:10.621714 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:10.622072 [debug] [MainThread]: On master: COMMIT
[0m08:44:10.622541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:44:10.622859 [debug] [MainThread]: On master: Close
[0m08:44:10.623354 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:10.623771 [info ] [MainThread]: 
[0m08:44:10.628624 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m08:44:10.629341 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m08:44:10.630105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now seed.dbtcomp.geography)
[0m08:44:10.630678 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m08:44:10.631279 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m08:44:10.649332 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:10.649853 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m08:44:10.650125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:15.654565 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m08:44:15.659287 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:15.660235 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m08:44:15.662845 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m08:44:15.719552 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:15.727391 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m08:44:15.755818 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m08:44:15.788162 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m08:44:15.804877 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:44:15.806484 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:44:15.806809 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:44:15.807904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:44:15.809766 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m08:44:15.810956 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 5.18s]
[0m08:44:15.811635 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m08:44:15.818047 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:15.820763 [debug] [MainThread]: On master: BEGIN
[0m08:44:15.822249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:44:20.844019 [debug] [MainThread]: SQL status: BEGIN in 5.022 seconds
[0m08:44:20.861673 [debug] [MainThread]: On master: COMMIT
[0m08:44:20.864659 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:20.870851 [debug] [MainThread]: On master: COMMIT
[0m08:44:20.871692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:44:20.872005 [debug] [MainThread]: On master: Close
[0m08:44:20.872401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:20.873948 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:44:20.874300 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m08:44:20.874691 [info ] [MainThread]: 
[0m08:44:20.875005 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.41 seconds (15.41s).
[0m08:44:20.875509 [debug] [MainThread]: Command end result
[0m08:44:20.929167 [info ] [MainThread]: 
[0m08:44:20.929664 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:20.929957 [info ] [MainThread]: 
[0m08:44:20.930265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:44:20.930990 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.975616, "process_user_time": 2.138979, "process_kernel_time": 0.090436, "process_mem_max_rss": "113976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:44:20.931547 [debug] [MainThread]: Command `dbt seed` succeeded at 08:44:20.931449 after 16.98 seconds
[0m08:44:20.931896 [debug] [MainThread]: Flushing usage events
[0m08:45:07.665672 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.671613 | b337152c-07f5-47d2-9fd9-a1b41714f4e8 ==============================
[0m08:45:07.671613 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.667089 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:07.672646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:07.673595 | 3d3a7197-dfef-4be9-adfe-6ba10ab47fec ==============================
[0m08:45:07.673595 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.674633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.671845 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.682461 | a29ecc18-c19e-4eac-afdf-82c84801c419 ==============================
[0m08:45:07.682461 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.683281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.703053 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.707970 | 6b3fd7d7-afea-4c62-a096-63b720af5d94 ==============================
[0m08:45:07.707970 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.708904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.724072 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:07.725699 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:07.729998 | d605b212-3ad8-4835-bf1a-8005a4bda428 ==============================
[0m08:45:07.729998 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.732784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:07.733190 | 59b4fdcb-394c-4a7b-bb1e-32e95b0f649c ==============================
[0m08:45:07.733190 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.724998 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:07.734426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:07.735421 | 8a0e33c2-638e-457e-8511-f279dd918bc2 ==============================
[0m08:45:07.735421 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:07.741699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:07.815426 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.832592 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.834258 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.854963 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.861186 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.870208 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.879232 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.889602 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.894488 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.902111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:07.901782 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.953817 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:07.955979 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.962484 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:07.977279 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:07.971501 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:07.987877 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:07.998049 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:08.003093 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.003849 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.036983 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.037774 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.064387 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.065372 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.079518 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.080378 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:08.106160 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:45:08.106976 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:45:09.151973 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.158003 [info ] [MainThread]: 
[0m08:45:09.161411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.166129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.168056 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.173169 [info ] [MainThread]: 
[0m08:45:09.174117 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.174993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.192841 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.193812 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.194955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.201370 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.202633 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.202643 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m08:45:09.203393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.204521 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.206693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:45:09.211745 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:45:09.213812 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m08:45:09.215025 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.219842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:45:09.220735 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:45:09.220864 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.223982 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:45:09.224893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.225777 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.226415 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:45:09.228254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.233393 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:45:09.236136 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:45:09.237043 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.237489 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.238229 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:45:09.239693 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:45:09.241142 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m08:45:09.242331 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:45:09.242910 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:45:09.243233 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:45:09.244309 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:45:09.244750 [debug] [ThreadPool]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_namespace_nspname_index"
DETAIL:  Key (nspname)=(dev) already exists.

[0m08:45:09.246467 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:45:09.246664 [debug] [ThreadPool]: On create_sales_dw_dev: ROLLBACK
[0m08:45:09.248276 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro create_schema
[0m08:45:09.249817 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m08:45:09.251780 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:45:09.252744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev_raw)
[0m08:45:09.256869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:09.253328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:09.263209 [debug] [MainThread]: Connection 'create_sales_dw_dev' was properly closed.
[0m08:45:09.267944 [info ] [MainThread]: 
[0m08:45:09.261857 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.269451 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m08:45:09.270178 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.273494 [error] [MainThread]: Encountered an error:
Database Error
  duplicate key value violates unique constraint "pg_namespace_nspname_index"
  DETAIL:  Key (nspname)=(dev) already exists.
[0m08:45:09.267669 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.276189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6480398, "process_user_time": 2.042435, "process_kernel_time": 0.109076, "process_mem_max_rss": "111768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:09.278473 [debug] [MainThread]: Command `dbt run` failed at 08:45:09.278275 after 1.65 seconds
[0m08:45:09.277626 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.274488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.279382 [debug] [MainThread]: Flushing usage events
[0m08:45:09.277063 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.282305 [info ] [MainThread]: 
[0m08:45:09.288061 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m08:45:09.283972 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.289200 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.288684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.291266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.293999 [info ] [MainThread]: 
[0m08:45:09.294224 [info ] [MainThread]: 
[0m08:45:09.290755 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.296078 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.297301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.296284 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.297357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.298021 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:09.301896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.301522 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m08:45:09.301379 [info ] [MainThread]: 
[0m08:45:09.304121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.304218 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.305314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.306678 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:09.305757 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:45:09.307811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.308416 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:09.309599 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:09.311497 [info ] [MainThread]: 
[0m08:45:09.309942 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:09.313878 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.312355 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:09.314886 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:09.316167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:09.318655 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:09.322868 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.323433 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.324049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.326245 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.326608 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.327069 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.327590 [debug] [MainThread]: On master: BEGIN
[0m08:45:09.327713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.328107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:09.328650 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.329231 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.329752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.335979 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.336581 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:09.337701 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.338267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.338432 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.342567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:09.344675 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:09.345128 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:09.345614 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.346592 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.347014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.343181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:09.348202 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.351078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:09.351805 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.352343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.351231 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.353143 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.353610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.353921 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:09.355374 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:09.351775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:09.358915 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:45:09.359619 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.360210 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:09.356773 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.360426 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.361173 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.361397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:09.361710 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.362470 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:09.362236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.363911 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:09.363114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.364997 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:09.362081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:09.369270 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:09.370058 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.370500 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:09.368419 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.370841 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:45:09.371136 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:09.371849 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:09.371658 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:09.372328 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:09.372081 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:09.372414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.373027 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:09.372998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.374214 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:09.374616 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:09.375085 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:09.376036 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:09.377163 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:09.381428 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.382005 [debug] [MainThread]: On master: BEGIN
[0m08:45:09.382368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:14.335246 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:45:14.343160 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m08:45:14.339112 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m08:45:14.352806 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.361402 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:45:14.359397 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:14.367703 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:14.366988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.380081 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m08:45:14.378771 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.389849 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:45:14.391123 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:14.384857 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m08:45:14.392548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:14.392462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:14.391626 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.393483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:14.390945 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.395420 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:14.393801 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.394878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.397283 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.393639 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.396119 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:14.393094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:14.395913 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:14.393182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:14.398139 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:14.401417 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.400804 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.398886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.402197 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.401621 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.403252 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.403302 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.403434 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.402781 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:14.402879 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:14.399029 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:14.404991 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.404468 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:45:14.404210 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:14.405025 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.405517 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:14.405606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:14.405938 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.403666 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:45:14.407129 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.405104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:14.407674 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.406450 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.404385 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:14.406324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:14.405921 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:14.408399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.409062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:14.408185 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:14.409144 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:14.410320 [debug] [MainThread]: On master: Close
[0m08:45:14.410330 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:14.411502 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.406847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:14.412185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.410987 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:14.411990 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:14.412874 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.414460 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.414039 [info ] [MainThread]: 
[0m08:45:14.415444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.414792 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.416170 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:14.417974 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:14.418340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.418836 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:14.418814 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.419292 [debug] [MainThread]: On master: Close
[0m08:45:14.420235 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.420266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.419910 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.421069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:14.420887 [info ] [MainThread]: 
[0m08:45:14.421405 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:14.421454 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.422618 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m08:45:14.426227 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.426651 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:14.426722 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:14.426768 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m08:45:14.427137 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.428064 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:14.428677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_geography)
[0m08:45:14.428196 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.428354 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m08:45:14.429076 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:14.431017 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m08:45:14.431774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:14.432169 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.432042 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m08:45:14.433169 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.434017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_transactions)
[0m08:45:14.433990 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.434799 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m08:45:14.435099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.435705 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:45:14.435659 [debug] [MainThread]: On master: Close
[0m08:45:14.436980 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:14.436756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.437807 [info ] [MainThread]: 
[0m08:45:14.437842 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.438468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m08:45:14.438728 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.440256 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:14.441209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m08:45:14.441441 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.442066 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m08:45:14.442209 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.443938 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m08:45:14.447410 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m08:45:14.448004 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m08:45:14.447471 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.449041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_channels)
[0m08:45:14.449622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.450060 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m08:45:14.450655 [debug] [MainThread]: On master: Close
[0m08:45:14.454924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:14.456363 [info ] [MainThread]: 
[0m08:45:14.459033 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m08:45:14.461627 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m08:45:14.464438 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m08:45:14.467091 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m08:45:14.467839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m08:45:14.469364 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m08:45:14.469702 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m08:45:14.470430 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m08:45:14.471048 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:14.471677 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m08:45:14.472088 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.472218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.472657 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m08:45:14.473087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.477614 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m08:45:14.477948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:45:14.478549 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.478973 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m08:45:14.479351 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m08:45:14.485012 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:14.490294 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m08:45:14.492131 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.492889 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m08:45:14.493488 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:14.493991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:14.494310 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m08:45:14.503041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.502640 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:45:14.503809 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m08:45:14.504182 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.504820 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:45:14.505439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.505951 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m08:45:14.505944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:14.506379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:14.510174 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m08:45:14.512666 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:45:14.513036 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m08:45:14.513750 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:14.513867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m08:45:14.515796 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m08:45:14.516336 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.517463 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:45:14.518399 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m08:45:14.518087 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m08:45:14.519738 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.520029 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:14.525718 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.528852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:14.530347 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.531237 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m08:45:14.533206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:14.538047 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:45:14.538777 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.539644 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.541346 [debug] [MainThread]: On master: COMMIT
[0m08:45:14.542345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:14.544461 [debug] [MainThread]: On master: Close
[0m08:45:14.545941 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:45:14.546510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:14.546951 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.547361 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:14.547878 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:45:14.548282 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m08:45:14.548899 [info ] [MainThread]: 
[0m08:45:14.549310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:14.549436 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m08:45:14.554116 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m08:45:14.554769 [debug] [MainThread]: Command end result
[0m08:45:14.557786 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:45:14.558185 [info ] [MainThread]: 
[0m08:45:14.558724 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m08:45:14.559159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:14.560084 [info ] [MainThread]: 
[0m08:45:14.559814 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:14.560556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:14.562431 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m08:45:14.563202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8749895, "process_user_time": 2.205819, "process_kernel_time": 0.1125, "process_mem_max_rss": "113768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:14.564773 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m08:45:14.565376 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:14.565281 after 6.88 seconds
[0m08:45:14.566100 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m08:45:14.566521 [debug] [MainThread]: Flushing usage events
[0m08:45:14.567856 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:14.574686 [debug] [MainThread]: On master: BEGIN
[0m08:45:14.575251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:16.526133 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:16.530482 | 11929ba8-225f-473e-917a-ba866f43ce49 ==============================
[0m08:45:16.530482 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:16.531256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:16.663283 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:16.675749 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:16.832462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:16.832984 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:16.930859 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:16.933848 [info ] [MainThread]: 
[0m08:45:16.934703 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:16.936144 [debug] [MainThread]: Command end result
[0m08:45:16.936847 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46505287, "process_user_time": 0.977407, "process_kernel_time": 0.057792, "process_mem_max_rss": "97708", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:16.937304 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:16.937239 after 0.47 seconds
[0m08:45:16.937675 [debug] [MainThread]: Flushing usage events
[0m08:45:19.412932 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:45:19.413886 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:19.414637 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:19.417503 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m08:45:19.417830 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:45:19.418139 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m08:45:19.418486 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:19.419238 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:19.419676 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:19.419962 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:19.420435 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:19.420742 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:19.422309 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m08:45:19.423529 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:19.423825 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:19.424608 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:19.424972 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:19.425626 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:19.429392 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.429959 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.430421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:19.430764 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.431425 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.431914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:19.445203 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m08:45:19.446592 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.448385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:19.452847 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m08:45:19.454272 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:19.454853 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.455258 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.455723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:19.456291 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.456653 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.456954 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.457405 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.457909 [debug] [MainThread]: On master: Close
[0m08:45:19.458476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:19.458896 [info ] [MainThread]: 
[0m08:45:19.464175 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m08:45:19.464993 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m08:45:19.466200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_products)
[0m08:45:19.467012 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m08:45:19.472936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m08:45:19.474464 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m08:45:19.480984 [debug] [Thread-1 (]: SQL status: BEGIN in 5.008 seconds
[0m08:45:19.485982 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.487612 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m08:45:19.494105 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.005 seconds
[0m08:45:19.500536 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.501271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m08:45:19.501717 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m08:45:19.502886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:19.504721 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.507307 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m08:45:19.508082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:19.509491 [debug] [Thread-1 (]: SQL status: BEGIN in 5.006 seconds
[0m08:45:19.510224 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.510791 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m08:45:19.512136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:19.515907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:45:19.516974 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.517539 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m08:45:19.517601 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.518214 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m08:45:19.519049 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:19.519049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:19.519557 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:45:19.523854 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.525235 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.525738 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:45:19.526087 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m08:45:19.527068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.527343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:45:19.532370 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m08:45:19.532728 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:45:19.535674 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:45:19.536287 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m08:45:19.536165 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.536894 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:45:19.536997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:19.539716 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m08:45:19.538090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:19.541657 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 5.11s]
[0m08:45:19.541424 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:45:19.542552 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m08:45:19.543092 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.543678 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:45:19.544760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.544421 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.546518 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m08:45:19.549879 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.549958 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m08:45:19.550606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:19.553349 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:45:19.553896 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:45:19.554459 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m08:45:19.554814 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m08:45:19.556086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:19.555989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:19.558516 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m08:45:19.561532 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m08:45:19.561662 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m08:45:19.561920 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m08:45:19.562823 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m08:45:19.563238 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.563360 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 5.11s]
[0m08:45:19.563830 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.564521 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.564546 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m08:45:19.564732 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.565166 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.565668 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.566120 [debug] [MainThread]: On master: Close
[0m08:45:19.566477 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.567324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:19.566682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:19.567806 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:19.567747 [debug] [MainThread]: On master: BEGIN
[0m08:45:19.568722 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m08:45:19.569460 [info ] [MainThread]: 
[0m08:45:19.569171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:19.569913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m08:45:19.572032 [debug] [MainThread]: Command end result
[0m08:45:19.572634 [info ] [MainThread]: 
[0m08:45:19.573051 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:19.573578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:19.573971 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.574394 [info ] [MainThread]: 
[0m08:45:19.574860 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.575311 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:19.575899 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.576739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.94065, "process_user_time": 2.172738, "process_kernel_time": 0.114831, "process_mem_max_rss": "113476", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:19.577294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.577724 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:19.577641 after 11.94 seconds
[0m08:45:19.578111 [debug] [MainThread]: On master: Close
[0m08:45:19.578538 [debug] [MainThread]: Flushing usage events
[0m08:45:19.579138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:19.582761 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:45:19.583525 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m08:45:19.584003 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.585795 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:19.586391 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:19.586785 [info ] [MainThread]: 
[0m08:45:19.587182 [debug] [MainThread]: On master: COMMIT
[0m08:45:19.588609 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m08:45:19.589222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:19.589830 [debug] [MainThread]: Command end result
[0m08:45:19.590348 [debug] [MainThread]: On master: Close
[0m08:45:19.590965 [info ] [MainThread]: 
[0m08:45:19.592439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:19.591825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:19.594775 [info ] [MainThread]: 
[0m08:45:19.595493 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:19.596143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:19.597811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.930618, "process_user_time": 2.206321, "process_kernel_time": 0.121061, "process_mem_max_rss": "114868", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:19.596958 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m08:45:19.598649 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:19.598548 after 11.93 seconds
[0m08:45:19.599247 [info ] [MainThread]: 
[0m08:45:19.599832 [debug] [MainThread]: Flushing usage events
[0m08:45:19.600234 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m08:45:19.605693 [debug] [MainThread]: Command end result
[0m08:45:19.607756 [info ] [MainThread]: 
[0m08:45:19.610353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:19.612013 [info ] [MainThread]: 
[0m08:45:19.612462 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:19.614304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.923954, "process_user_time": 2.199038, "process_kernel_time": 0.120605, "process_mem_max_rss": "114604", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:19.615210 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:19.615052 after 11.92 seconds
[0m08:45:19.620397 [debug] [MainThread]: Flushing usage events
[0m08:45:21.616322 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:21.630700 | 2095bcdb-aab2-4cfd-9f59-e76c0bae1317 ==============================
[0m08:45:21.630700 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.633927 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:21.647745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 08:45:21.665483 | 981d1098-8900-4d80-a96e-3d18e7dbe8ca ==============================
[0m08:45:21.665483 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.676759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.677424 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:21.667674 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:21.683612 | e7ad6824-8b26-4d2e-8ec0-dad816bfa8b0 ==============================
[0m08:45:21.683612 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:21.684590 | 7654ebac-b5a9-48bb-85c2-88f8cb5b5c02 ==============================
[0m08:45:21.684590 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.685956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.686697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.683334 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:21.689919 | 5bdafeab-0b72-4934-8b3b-b683646e8187 ==============================
[0m08:45:21.689919 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:21.693695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:21.881351 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.889321 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.895891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.898052 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.899248 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.900265 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:21.903462 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.918969 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.921148 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:21.924017 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:22.140189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.140878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.142615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.143660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.146585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.146819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.147389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.147580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.156164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:22.156980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:22.190506 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.190962 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.191964 [info ] [MainThread]: 
[0m08:45:22.192513 [info ] [MainThread]: 
[0m08:45:22.192858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:22.193365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:22.193740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:22.194312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:22.202591 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.204027 [info ] [MainThread]: 
[0m08:45:22.204508 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.204975 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:22.206425 [info ] [MainThread]: 
[0m08:45:22.207864 [debug] [MainThread]: Command end result
[0m08:45:22.208749 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:22.208271 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:22.209971 [info ] [MainThread]: 
[0m08:45:22.209035 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6345057, "process_user_time": 1.021847, "process_kernel_time": 0.065827, "process_mem_max_rss": "97648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:22.210552 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:22.210767 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:22.210680 after 0.64 seconds
[0m08:45:22.211316 [debug] [MainThread]: Flushing usage events
[0m08:45:22.211693 [debug] [MainThread]: Command end result
[0m08:45:22.212056 [debug] [MainThread]: Command end result
[0m08:45:22.216841 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6345827, "process_user_time": 0.986313, "process_kernel_time": 0.062719, "process_mem_max_rss": "97452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:22.217283 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6396271, "process_user_time": 1.008569, "process_kernel_time": 0.073773, "process_mem_max_rss": "97588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:22.217508 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:22.217588 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:22.218795 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:22.218679 after 0.64 seconds
[0m08:45:22.218499 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:22.217687 after 0.64 seconds
[0m08:45:22.219285 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:22.220634 [debug] [MainThread]: Flushing usage events
[0m08:45:22.219969 [debug] [MainThread]: Flushing usage events
[0m08:45:22.219721 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:22.222291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.223046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.229581 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:45:22.231005 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:22.233411 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m08:45:22.235422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:22.236489 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:22.241821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:22.236180 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:22.241691 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:22.242337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:22.248991 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:22.250203 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:22.250526 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:22.251999 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:22.252236 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:22.255287 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:22.255603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:22.255987 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:22.257262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.257437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:22.260378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:22.265389 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:45:22.266255 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:22.267377 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:22.266809 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:45:22.268949 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:22.269534 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:22.269858 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:22.271286 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:22.271954 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:22.272214 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m08:45:22.274082 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:22.274585 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:22.278932 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.279578 [debug] [MainThread]: On master: BEGIN
[0m08:45:22.279862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:22.284817 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:45:22.285536 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.286074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:22.290258 [debug] [MainThread]: SQL status: SELECT 4 in 0.003 seconds
[0m08:45:22.291816 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:22.292738 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.293442 [debug] [MainThread]: On master: BEGIN
[0m08:45:22.294092 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:22.294906 [debug] [MainThread]: On master: COMMIT
[0m08:45:22.295348 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.295770 [debug] [MainThread]: On master: COMMIT
[0m08:45:22.296310 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:22.296850 [debug] [MainThread]: On master: Close
[0m08:45:22.297713 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:22.298975 [info ] [MainThread]: 
[0m08:45:22.305773 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m08:45:22.306764 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m08:45:22.307698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_resellers)
[0m08:45:22.308249 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m08:45:22.313940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m08:45:22.315616 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m08:45:22.339325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m08:45:22.340919 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.341428 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m08:45:22.341895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:22.349460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:45:22.352604 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.353166 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m08:45:22.355393 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:22.362088 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.363214 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m08:45:22.364053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:22.373386 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:45:22.374085 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.374626 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:45:22.375867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:45:22.380463 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m08:45:22.384058 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:45:22.384554 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m08:45:22.388572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:22.390377 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m08:45:22.391910 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:45:22.392969 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m08:45:22.394291 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:22.397024 [debug] [MainThread]: On master: BEGIN
[0m08:45:22.397558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:24.436355 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m08:45:24.437242 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.437662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:24.441373 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m08:45:24.447598 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:24.448308 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.448857 [debug] [MainThread]: On master: BEGIN
[0m08:45:24.449731 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:24.450709 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.451202 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.451544 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.451979 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:24.452326 [debug] [MainThread]: On master: Close
[0m08:45:24.452808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:24.453224 [info ] [MainThread]: 
[0m08:45:24.458328 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m08:45:24.459115 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m08:45:24.459688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m08:45:24.460077 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m08:45:24.465568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m08:45:24.467327 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m08:45:24.494789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m08:45:24.496111 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.496590 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m08:45:24.500379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:24.506193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:45:24.506721 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.507309 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m08:45:24.580553 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m08:45:24.581317 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.581956 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.582643 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.585043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:24.585497 [debug] [MainThread]: On master: Close
[0m08:45:24.586081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:24.586725 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m08:45:24.587318 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:24.587953 [info ] [MainThread]: 
[0m08:45:24.588393 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m08:45:24.589073 [debug] [MainThread]: Command end result
[0m08:45:24.589525 [info ] [MainThread]: 
[0m08:45:24.589950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:24.590379 [info ] [MainThread]: 
[0m08:45:24.592733 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:24.594185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.959631, "process_user_time": 2.212354, "process_kernel_time": 0.1076, "process_mem_max_rss": "112564", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:24.597364 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:24.597237 after 16.96 seconds
[0m08:45:24.598022 [debug] [MainThread]: Flushing usage events
[0m08:45:24.715212 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.207 seconds
[0m08:45:24.719848 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.720344 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:45:24.720924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:24.732084 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:45:24.733031 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.733640 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:45:24.735306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:24.739703 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m08:45:24.742577 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:45:24.743011 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m08:45:24.743866 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:24.746031 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m08:45:24.747559 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.29s]
[0m08:45:24.748254 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m08:45:24.749390 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.749974 [debug] [MainThread]: On master: BEGIN
[0m08:45:24.752790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:24.757639 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:45:24.758684 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.759272 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:24.759845 [debug] [MainThread]: On master: COMMIT
[0m08:45:24.760640 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:24.761243 [debug] [MainThread]: On master: Close
[0m08:45:24.762064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:24.762598 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:24.763066 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m08:45:24.764036 [info ] [MainThread]: 
[0m08:45:24.766359 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.47 seconds (15.47s).
[0m08:45:24.768701 [debug] [MainThread]: Command end result
[0m08:45:24.769102 [info ] [MainThread]: 
[0m08:45:24.769590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:24.770022 [info ] [MainThread]: 
[0m08:45:24.770840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:24.772997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.08785, "process_user_time": 2.190526, "process_kernel_time": 0.111002, "process_mem_max_rss": "114312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:24.774578 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:24.774482 after 17.09 seconds
[0m08:45:24.776392 [debug] [MainThread]: Flushing usage events
[0m08:45:26.597254 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:26.602439 | adc01582-ef65-4d77-b02c-4f5589a51cea ==============================
[0m08:45:26.602439 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:26.602956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'send_anonymous_usage_stats': 'True'}
[0m08:45:26.622345 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:26.622423 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:26.626839 | 854f63b5-f447-41cc-80e2-0770d25c293b ==============================
[0m08:45:26.626839 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:26.626594 | f238eab5-ae11-468d-bdfe-7e0f3fac58f6 ==============================
[0m08:45:26.626594 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:26.627352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:26.627745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:26.723877 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:26.737709 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:26.749644 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:26.759192 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:26.761362 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:26.773585 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:26.947877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:26.948433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:26.956634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:26.957283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:26.963440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:26.964536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:27.001751 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:27.003062 [info ] [MainThread]: 
[0m08:45:27.003633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:27.005128 [debug] [MainThread]: Command end result
[0m08:45:27.004265 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:27.005808 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.41988182, "process_user_time": 0.97913, "process_kernel_time": 0.063038, "process_mem_max_rss": "97852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.006923 [info ] [MainThread]: 
[0m08:45:27.007480 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:27.007402 after 0.42 seconds
[0m08:45:27.008006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:27.008420 [debug] [MainThread]: Flushing usage events
[0m08:45:27.009141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:27.015800 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:27.017069 [info ] [MainThread]: 
[0m08:45:27.017495 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:27.018796 [debug] [MainThread]: Command end result
[0m08:45:27.019429 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4336909, "process_user_time": 0.961536, "process_kernel_time": 0.054255, "process_mem_max_rss": "97576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.019951 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:27.019888 after 0.43 seconds
[0m08:45:27.020304 [debug] [MainThread]: Flushing usage events
[0m08:45:27.032232 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:27.034316 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:27.036315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:27.046940 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m08:45:27.048200 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:27.054463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:27.055246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:27.059923 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:27.061876 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:27.065197 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:27.065872 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:27.066456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:27.066986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:27.072509 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:45:27.073267 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:27.073763 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:27.076071 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:45:27.081663 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:27.083142 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:27.270469 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:45:27.273395 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m08:45:27.280833 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:27.293555 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:27.280184 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:27.296389 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:27.297679 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m08:45:27.305004 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:27.320314 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:27.298283 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:45:27.321673 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:27.322181 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:27.333459 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.340170 [debug] [MainThread]: On master: BEGIN
[0m08:45:27.340628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:27.344819 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:27.345455 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.345920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:27.349999 [debug] [MainThread]: SQL status: SELECT 5 in 0.004 seconds
[0m08:45:27.351311 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:27.351770 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.352039 [debug] [MainThread]: On master: BEGIN
[0m08:45:27.352569 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:27.353134 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.353470 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.353727 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.354073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:27.354424 [debug] [MainThread]: On master: Close
[0m08:45:27.354857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:27.355253 [info ] [MainThread]: 
[0m08:45:27.360343 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m08:45:27.361011 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m08:45:27.361522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m08:45:27.361870 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m08:45:27.367768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m08:45:27.369173 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m08:45:27.391013 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m08:45:27.396764 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.397219 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m08:45:27.397566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:27.402444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:45:27.402247 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:45:27.403026 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.403355 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.403731 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m08:45:27.404122 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.404648 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.404989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:27.405291 [debug] [MainThread]: On master: Close
[0m08:45:27.405815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:27.406368 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:45:27.406631 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:27.410402 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m08:45:27.411401 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.411901 [info ] [MainThread]: 
[0m08:45:27.412498 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m08:45:27.412964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m08:45:27.413820 [debug] [MainThread]: Command end result
[0m08:45:27.414096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:45:27.414467 [info ] [MainThread]: 
[0m08:45:27.422320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:27.422991 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:45:27.423384 [info ] [MainThread]: 
[0m08:45:27.423922 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.424418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:27.424891 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:45:27.425625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.843418, "process_user_time": 1.118195, "process_kernel_time": 0.075553, "process_mem_max_rss": "106588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.426446 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:27.426322 after 5.84 seconds
[0m08:45:27.426772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:27.427227 [debug] [MainThread]: Flushing usage events
[0m08:45:27.431456 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m08:45:27.434714 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:45:27.435288 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m08:45:27.435858 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:27.437549 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m08:45:27.438934 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:45:27.439498 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m08:45:27.440575 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.441010 [debug] [MainThread]: On master: BEGIN
[0m08:45:27.441347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:27.445739 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:27.446449 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.446891 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:27.447250 [debug] [MainThread]: On master: COMMIT
[0m08:45:27.447637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:27.447917 [debug] [MainThread]: On master: Close
[0m08:45:27.448348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:27.448784 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:27.449073 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m08:45:27.449510 [info ] [MainThread]: 
[0m08:45:27.450073 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m08:45:27.450861 [debug] [MainThread]: Command end result
[0m08:45:27.451299 [info ] [MainThread]: 
[0m08:45:27.451783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:27.452141 [info ] [MainThread]: 
[0m08:45:27.452510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:27.453142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.870431, "process_user_time": 1.109145, "process_kernel_time": 0.087963, "process_mem_max_rss": "108624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:27.453615 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:27.453550 after 5.87 seconds
[0m08:45:27.454045 [debug] [MainThread]: Flushing usage events
[0m08:45:29.429478 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:29.434453 | 8e90d895-edfd-44a8-ad98-2502dac7f558 ==============================
[0m08:45:29.434453 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:29.431944 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:29.432357 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:45:29.438411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.435303 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:29.439481 | 4641a42d-3914-4e28-ad9d-b2dc4a83b760 ==============================
[0m08:45:29.439481 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:29.439367 | c3059f8d-e345-49ca-a856-1ecb6d0869d3 ==============================
[0m08:45:29.439367 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:45:29.439709 | c5ea504b-1fc5-4a90-9b52-b39935817591 ==============================
[0m08:45:29.439709 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:29.440309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.440724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.440905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:29.618036 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.650795 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.655532 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.653383 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.658228 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:29.670715 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.672916 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.675878 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:29.811123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.812385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.821748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.822580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.824746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.825222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.833899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:29.834407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:29.868292 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.870498 [info ] [MainThread]: 
[0m08:45:29.871281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:29.872226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:29.876817 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.878205 [info ] [MainThread]: 
[0m08:45:29.878427 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.878612 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:29.878781 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:29.880424 [info ] [MainThread]: 
[0m08:45:29.881025 [info ] [MainThread]: 
[0m08:45:29.882385 [debug] [MainThread]: Command end result
[0m08:45:29.882741 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:29.883391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:29.883587 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48855743, "process_user_time": 1.012436, "process_kernel_time": 0.053445, "process_mem_max_rss": "97444", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:29.884115 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:29.884047 after 0.49 seconds
[0m08:45:29.884350 [debug] [MainThread]: Command end result
[0m08:45:29.884673 [debug] [MainThread]: Flushing usage events
[0m08:45:29.884999 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48017237, "process_user_time": 1.011215, "process_kernel_time": 0.060191, "process_mem_max_rss": "97500", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:29.885005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:29.885615 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:29.885527 after 0.48 seconds
[0m08:45:29.886018 [debug] [MainThread]: Flushing usage events
[0m08:45:29.900523 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:29.901229 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:29.901676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:29.907758 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:29.908486 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:29.909011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:32.075380 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:45:32.094012 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:32.099878 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:32.105883 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:32.118581 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:32.126345 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:32.134704 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:32.135251 [debug] [MainThread]: On master: BEGIN
[0m08:45:32.135520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:34.911794 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m08:45:34.914841 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:34.915148 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m08:45:34.916466 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:34.918981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:45:34.920108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:34.919667 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:45:34.924134 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:34.926053 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.926626 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:34.927084 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:34.920624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:34.927522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:34.927868 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.927945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:34.929621 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:34.930526 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:34.931224 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:34.932316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:34.934046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:34.935220 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:34.935808 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.937931 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:34.938621 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:45:34.939230 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:34.939658 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:34.940487 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:34.941751 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:34.941656 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:34.942275 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:34.942922 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:34.943772 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:37.153481 [debug] [MainThread]: SQL status: BEGIN in 5.018 seconds
[0m08:45:37.170763 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:37.175360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:37.192461 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m08:45:37.194140 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:37.194711 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:37.195023 [debug] [MainThread]: On master: BEGIN
[0m08:45:37.195559 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:37.196125 [debug] [MainThread]: On master: COMMIT
[0m08:45:37.196549 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:37.196950 [debug] [MainThread]: On master: COMMIT
[0m08:45:37.197558 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:37.197972 [debug] [MainThread]: On master: Close
[0m08:45:37.198541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:37.199023 [info ] [MainThread]: 
[0m08:45:37.204082 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m08:45:37.204765 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m08:45:37.205269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_channels)
[0m08:45:37.205680 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m08:45:37.211110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m08:45:37.212382 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m08:45:37.234141 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m08:45:37.235695 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:37.236198 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m08:45:37.236580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:39.939560 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:45:39.939688 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m08:45:39.940481 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:39.941109 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:39.940953 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:39.941851 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:39.943442 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:45:39.944690 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:39.943836 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.001 seconds
[0m08:45:39.945191 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:39.945878 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:39.946489 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:39.949524 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:39.950032 [debug] [MainThread]: On master: BEGIN
[0m08:45:39.950382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:39.950876 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:39.951321 [debug] [MainThread]: On master: BEGIN
[0m08:45:39.951663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:42.248369 [debug] [Thread-1 (]: SQL status: BEGIN in 5.012 seconds
[0m08:45:42.249871 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.251532 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m08:45:42.253292 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:45:42.258991 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.262383 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m08:45:42.263560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:42.273037 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:45:42.276817 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.277599 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:45:42.279020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:42.284134 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m08:45:42.287595 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:45:42.288106 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m08:45:42.289062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:45:42.291460 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m08:45:42.293019 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.09s]
[0m08:45:42.293954 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m08:45:42.295621 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:42.296376 [debug] [MainThread]: On master: BEGIN
[0m08:45:42.297007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:42.303382 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:45:42.304601 [debug] [MainThread]: On master: COMMIT
[0m08:45:42.305442 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:42.308442 [debug] [MainThread]: On master: COMMIT
[0m08:45:42.309608 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:42.310416 [debug] [MainThread]: On master: Close
[0m08:45:42.311094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:42.311589 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m08:45:42.312666 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:45:42.313686 [info ] [MainThread]: 
[0m08:45:42.314673 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m08:45:42.317583 [debug] [MainThread]: Command end result
[0m08:45:42.319431 [info ] [MainThread]: 
[0m08:45:42.320247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:42.320603 [info ] [MainThread]: 
[0m08:45:42.320937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:42.323011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.760237, "process_user_time": 1.07008, "process_kernel_time": 0.070466, "process_mem_max_rss": "108156", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:42.323751 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:42.323685 after 15.76 seconds
[0m08:45:42.324076 [debug] [MainThread]: Flushing usage events
[0m08:45:43.769640 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:43.782354 | 82b5ff9f-e12f-4c8d-9e82-d72d342a682a ==============================
[0m08:45:43.782354 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:43.784507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:43.786252 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:43.804789 | 605d8265-03a7-40ab-8845-04b5711d53b6 ==============================
[0m08:45:43.804789 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:43.811817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:43.937509 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:43.948004 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:43.951236 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:43.964334 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:44.104065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:44.104991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:44.113705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:44.114311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:44.158110 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:44.159499 [info ] [MainThread]: 
[0m08:45:44.160353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:44.160903 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:44.161780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:45:44.162278 [info ] [MainThread]: 
[0m08:45:44.162704 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:44.164010 [debug] [MainThread]: Command end result
[0m08:45:44.165567 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.42781204, "process_user_time": 0.964383, "process_kernel_time": 0.042279, "process_mem_max_rss": "97704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:44.166509 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:44.166435 after 0.43 seconds
[0m08:45:44.166941 [debug] [MainThread]: Flushing usage events
[0m08:45:44.184715 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:45:44.190698 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:45:44.191770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:44.206341 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m08:45:44.212587 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:45:44.242970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:45:44.251477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:45:44.261421 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:44.267789 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:45:44.267042 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:44.269289 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:45:44.269793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:44.268477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:44.275482 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:45:44.276194 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:45:44.276985 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:45:44.279437 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:45:44.281553 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:45:44.282120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:45:44.956193 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m08:45:44.956505 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:45:44.956966 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.957526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:44.957422 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.958273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:44.961895 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m08:45:44.962453 [debug] [MainThread]: SQL status: SELECT 8 in 0.003 seconds
[0m08:45:44.963747 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:44.964438 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.964844 [debug] [MainThread]: On master: BEGIN
[0m08:45:44.965734 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:44.965672 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:44.966309 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.966795 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.966848 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.967218 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.967523 [debug] [MainThread]: On master: BEGIN
[0m08:45:44.967762 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:44.968327 [debug] [MainThread]: On master: Close
[0m08:45:44.968405 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:44.968964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:44.969505 [info ] [MainThread]: 
[0m08:45:44.969413 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.973400 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:44.973823 [debug] [MainThread]: On master: COMMIT
[0m08:45:44.974571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:44.975141 [debug] [MainThread]: On master: Close
[0m08:45:44.975106 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m08:45:44.975753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:44.975898 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m08:45:44.976282 [info ] [MainThread]: 
[0m08:45:44.976596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m08:45:44.977167 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m08:45:44.981440 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m08:45:44.982086 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m08:45:44.982723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m08:45:44.983245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m08:45:44.983413 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m08:45:44.984811 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m08:45:44.989035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m08:45:44.990118 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m08:45:45.009445 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m08:45:45.019571 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.015066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m08:45:45.021767 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:45.020037 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m08:45:45.025854 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m08:45:45.028009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:45.028147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:45.039074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m08:45:45.050323 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.061047 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m08:45:45.076371 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.011 seconds
[0m08:45:45.086369 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.087243 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m08:45:45.087955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:45.098899 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:45:45.099405 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.099702 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:45:45.100519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:45.104376 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m08:45:45.107080 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:45:45.107513 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m08:45:45.108126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:45.109834 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m08:45:45.111272 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 0.13s]
[0m08:45:45.111892 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m08:45:45.112962 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:45.113423 [debug] [MainThread]: On master: BEGIN
[0m08:45:45.113873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:45.118031 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:45.118589 [debug] [MainThread]: On master: COMMIT
[0m08:45:45.119086 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:45.119689 [debug] [MainThread]: On master: COMMIT
[0m08:45:45.120347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:45.120831 [debug] [MainThread]: On master: Close
[0m08:45:45.121488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:45.122650 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:45.123036 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m08:45:45.123410 [info ] [MainThread]: 
[0m08:45:45.123767 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.24 seconds (15.24s).
[0m08:45:45.124341 [debug] [MainThread]: Command end result
[0m08:45:45.124606 [info ] [MainThread]: 
[0m08:45:45.124907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:45.125183 [info ] [MainThread]: 
[0m08:45:45.125464 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:45.126049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.726643, "process_user_time": 1.159169, "process_kernel_time": 0.057705, "process_mem_max_rss": "108244", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:45.126509 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:45.126449 after 15.73 seconds
[0m08:45:45.126855 [debug] [MainThread]: Flushing usage events
[0m08:45:46.779358 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:46.783744 | 1f18775b-c8b7-4972-be84-e4e39f15e0fb ==============================
[0m08:45:46.783744 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:46.784309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:46.907266 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:46.918384 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:47.040872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:47.041485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:47.132616 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:47.137393 [info ] [MainThread]: 
[0m08:45:47.140406 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:47.142192 [debug] [MainThread]: Command end result
[0m08:45:47.143286 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.39295503, "process_user_time": 1.020569, "process_kernel_time": 0.048062, "process_mem_max_rss": "97964", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:47.144024 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:47.143945 after 0.39 seconds
[0m08:45:47.144596 [debug] [MainThread]: Flushing usage events
[0m08:45:49.277693 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m08:45:49.278422 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:45:49.278996 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:45:49.281220 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m08:45:49.282485 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:45:49.283091 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:45:49.287661 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.290051 [debug] [MainThread]: On master: BEGIN
[0m08:45:49.290403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:49.294370 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:49.294945 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.295409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:49.299600 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m08:45:49.301166 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:49.301750 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.302169 [debug] [MainThread]: On master: BEGIN
[0m08:45:49.302716 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:45:49.303161 [debug] [MainThread]: On master: COMMIT
[0m08:45:49.303495 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:49.303901 [debug] [MainThread]: On master: COMMIT
[0m08:45:49.304417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:49.304777 [debug] [MainThread]: On master: Close
[0m08:45:49.305288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:49.305625 [info ] [MainThread]: 
[0m08:45:49.310466 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m08:45:49.311115 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m08:45:49.311588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m08:45:49.311914 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m08:45:49.317298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m08:45:49.318614 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m08:45:49.344695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m08:45:49.354779 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:49.358729 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m08:45:49.359446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:50.042474 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m08:45:50.053496 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.056829 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m08:45:50.069247 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.012 seconds
[0m08:45:50.073693 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.074249 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m08:45:50.074899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:50.086107 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:45:50.086728 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.087057 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:45:50.088024 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:50.092229 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m08:45:50.095298 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:45:50.095756 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m08:45:50.096282 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:50.097844 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m08:45:50.099079 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 5.12s]
[0m08:45:50.099789 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m08:45:50.100807 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:50.101206 [debug] [MainThread]: On master: BEGIN
[0m08:45:50.101481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:50.105741 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:45:50.106424 [debug] [MainThread]: On master: COMMIT
[0m08:45:50.106811 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:50.107095 [debug] [MainThread]: On master: COMMIT
[0m08:45:50.107499 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:50.108183 [debug] [MainThread]: On master: Close
[0m08:45:50.108893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:50.109367 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m08:45:50.109840 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:50.110298 [info ] [MainThread]: 
[0m08:45:50.110752 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.24 seconds (20.24s).
[0m08:45:50.111346 [debug] [MainThread]: Command end result
[0m08:45:50.111739 [info ] [MainThread]: 
[0m08:45:50.112197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:50.112552 [info ] [MainThread]: 
[0m08:45:50.112972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:50.113823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.715036, "process_user_time": 1.151216, "process_kernel_time": 0.061546, "process_mem_max_rss": "106408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:50.114438 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:50.114362 after 20.72 seconds
[0m08:45:50.114895 [debug] [MainThread]: Flushing usage events
[0m08:45:51.765976 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:51.776197 | a13bc293-0422-4cd9-ba7f-1162ad1cc5a2 ==============================
[0m08:45:51.776197 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:51.777680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:51.928332 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:51.946102 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:52.102393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:52.103019 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:52.154202 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:52.155989 [info ] [MainThread]: 
[0m08:45:52.159655 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:52.161048 [debug] [MainThread]: Command end result
[0m08:45:52.165733 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4416743, "process_user_time": 0.947574, "process_kernel_time": 0.056033, "process_mem_max_rss": "97464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:52.167089 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:52.166987 after 0.44 seconds
[0m08:45:52.169484 [debug] [MainThread]: Flushing usage events
[0m08:45:54.368741 [debug] [Thread-1 (]: SQL status: BEGIN in 5.009 seconds
[0m08:45:54.376462 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.376894 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m08:45:54.380405 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m08:45:54.385398 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.392465 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m08:45:54.393361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:45:54.405713 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:45:54.406238 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.406728 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:45:54.407971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:45:54.412084 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m08:45:54.415415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:45:54.416010 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m08:45:54.416662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:45:54.418459 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m08:45:54.420169 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 5.11s]
[0m08:45:54.420864 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m08:45:54.422042 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:54.425574 [debug] [MainThread]: On master: BEGIN
[0m08:45:54.427367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:54.435668 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:45:54.436194 [debug] [MainThread]: On master: COMMIT
[0m08:45:54.436548 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:54.436851 [debug] [MainThread]: On master: COMMIT
[0m08:45:54.437288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:45:54.437617 [debug] [MainThread]: On master: Close
[0m08:45:54.438032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:54.438429 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:45:54.438850 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m08:45:54.439380 [info ] [MainThread]: 
[0m08:45:54.439941 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m08:45:54.440689 [debug] [MainThread]: Command end result
[0m08:45:54.441037 [info ] [MainThread]: 
[0m08:45:54.441382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:54.441663 [info ] [MainThread]: 
[0m08:45:54.442066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:54.442813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.705673, "process_user_time": 1.11085, "process_kernel_time": 0.069491, "process_mem_max_rss": "108456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:54.443288 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:54.443229 after 10.71 seconds
[0m08:45:54.443616 [debug] [MainThread]: Flushing usage events
[0m08:45:55.831699 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:45:55.835997 | 5c426349-4a8e-4739-8e0b-fe9c1f25cde8 ==============================
[0m08:45:55.835997 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:45:55.836708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:55.974421 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:45:55.996981 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:45:56.216956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:56.217433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:56.269409 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:45:56.271467 [info ] [MainThread]: 
[0m08:45:56.271888 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:56.273164 [debug] [MainThread]: Command end result
[0m08:45:56.274795 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4737666, "process_user_time": 0.969209, "process_kernel_time": 0.072357, "process_mem_max_rss": "97580", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:45:56.275345 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:56.275277 after 0.47 seconds
[0m08:45:56.276437 [debug] [MainThread]: Flushing usage events
[0m08:50:55.532739 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:50:55.537282 | 91732b1d-af7e-4453-8212-ba57ff90d9e9 ==============================
[0m08:50:55.537282 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:50:55.537842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --add-package /usr/local/airflow/dbt-utils-main --source local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:50:55.607662 [info ] [MainThread]: Found duplicate package in packages.yml, removing: {'local': '/usr/local/airflow/dbt-utils-main'}
[0m08:50:55.609042 [info ] [MainThread]: Added new package /usr/local/airflow/dbt-utils-main@ to /usr/local/airflow/dbt/packages.yml
[0m08:50:55.612470 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-skb5yair'
[0m08:50:55.612978 [info ] [MainThread]: Installing /usr/local/airflow/dbt-utils-main
[0m08:50:55.614030 [debug] [MainThread]: Creating symlink to local dependency.
[0m08:50:55.615370 [info ] [MainThread]: Installed from <local @ /usr/local/airflow/dbt-utils-main>
[0m08:50:55.616216 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11728054, "process_user_time": 0.798966, "process_kernel_time": 0.076092, "process_mem_max_rss": "105528", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:50:55.616776 [debug] [MainThread]: Command `dbt deps` succeeded at 08:50:55.616711 after 0.12 seconds
[0m08:50:55.620263 [debug] [MainThread]: Flushing usage events
[0m08:50:57.624215 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:50:57.628431 | 50e44598-f511-4d88-a8c8-672d0bf881ca ==============================
[0m08:50:57.628431 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:50:57.629054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:50:57.770964 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:50:57.784494 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m08:50:57.787779 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:50:59.145056 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:50:59.146794 [info ] [MainThread]: 
[0m08:50:59.147361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:50:59.148119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:50:59.171187 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:50:59.171918 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:50:59.172319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:04.198291 [debug] [ThreadPool]: SQL status: SELECT 8 in 5.026 seconds
[0m08:51:04.199589 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:51:04.202935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev_raw)
[0m08:51:04.203377 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev_raw"
"
[0m08:51:04.214331 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:51:04.215264 [debug] [ThreadPool]: On create_sales_dw_dev_raw: BEGIN
[0m08:51:04.215623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:04.232496 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m08:51:04.237019 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:51:04.246888 [debug] [ThreadPool]: On create_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev_raw"} */
create schema if not exists "dev_raw"
[0m08:51:04.251479 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m08:51:04.254499 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:51:04.258802 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev_raw"
[0m08:51:04.260103 [debug] [ThreadPool]: On create_sales_dw_dev_raw: COMMIT
[0m08:51:04.261468 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:51:04.261840 [debug] [ThreadPool]: On create_sales_dw_dev_raw: Close
[0m08:51:04.265338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev_raw, now list_sales_dw_dev_raw)
[0m08:51:04.265839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:51:04.270882 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:51:04.272684 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:51:04.273154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:51:04.275571 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:51:04.276557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:04.278833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:09.287733 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m08:51:09.288406 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:51:09.293012 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:51:09.288739 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:51:09.296951 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:51:09.300647 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:51:09.306675 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m08:51:09.306976 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:51:09.323863 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:51:09.309719 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:51:09.331679 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:51:09.337469 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:51:09.344911 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:09.351518 [debug] [MainThread]: On master: BEGIN
[0m08:51:09.355715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:14.360527 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:51:14.361274 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.361885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:51:14.368077 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:51:14.369325 [debug] [MainThread]: On master: ROLLBACK
[0m08:51:14.369908 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.370255 [debug] [MainThread]: On master: BEGIN
[0m08:51:14.370787 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:51:14.371209 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.371600 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.371961 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.372432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:51:14.372810 [debug] [MainThread]: On master: Close
[0m08:51:14.373339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:51:14.373725 [info ] [MainThread]: 
[0m08:51:14.382513 [debug] [Thread-1 (]: Began running node seed.dbtcomp.geography
[0m08:51:14.384072 [info ] [Thread-1 (]: 1 of 1 START seed file dev_raw.geography ....................................... [RUN]
[0m08:51:14.384593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now seed.dbtcomp.geography)
[0m08:51:14.384933 [debug] [Thread-1 (]: Began compiling node seed.dbtcomp.geography
[0m08:51:14.385311 [debug] [Thread-1 (]: Began executing node seed.dbtcomp.geography
[0m08:51:14.403063 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.403701 [debug] [Thread-1 (]: On seed.dbtcomp.geography: BEGIN
[0m08:51:14.404135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:14.408464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:51:14.409008 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.409358 [debug] [Thread-1 (]: On seed.dbtcomp.geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "seed.dbtcomp.geography"} */

    create table "sales_dw"."dev_raw"."geography" ("id" integer,"cityname" text,"countryname" text,"regionname" text)
  
[0m08:51:14.411768 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.002 seconds
[0m08:51:14.462504 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.463235 [debug] [Thread-1 (]: On seed.dbtcomp.geography: 
          insert into "sales_dw"."dev_raw"."geography" ("id", "cityname", "countryname", "regionname") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m08:51:14.464846 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.001 seconds
[0m08:51:14.468795 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtcomp.geography"
[0m08:51:14.481436 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:51:14.482469 [debug] [Thread-1 (]: Using postgres connection "seed.dbtcomp.geography"
[0m08:51:14.486187 [debug] [Thread-1 (]: On seed.dbtcomp.geography: COMMIT
[0m08:51:14.492240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:51:14.494241 [debug] [Thread-1 (]: On seed.dbtcomp.geography: Close
[0m08:51:14.495672 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dev_raw.geography ................................... [[32mINSERT 100[0m in 0.11s]
[0m08:51:14.496374 [debug] [Thread-1 (]: Finished running node seed.dbtcomp.geography
[0m08:51:14.497784 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.498279 [debug] [MainThread]: On master: BEGIN
[0m08:51:14.498645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:51:14.502667 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:51:14.503240 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.503673 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:14.504066 [debug] [MainThread]: On master: COMMIT
[0m08:51:14.504648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:51:14.505095 [debug] [MainThread]: On master: Close
[0m08:51:14.505664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:14.506035 [debug] [MainThread]: Connection 'seed.dbtcomp.geography' was properly closed.
[0m08:51:14.506401 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:51:14.506848 [info ] [MainThread]: 
[0m08:51:14.507229 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.36 seconds (15.36s).
[0m08:51:14.507862 [debug] [MainThread]: Command end result
[0m08:51:14.555805 [info ] [MainThread]: 
[0m08:51:14.556327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:51:14.557580 [info ] [MainThread]: 
[0m08:51:14.559597 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:51:14.561121 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 17.002092, "process_user_time": 2.162056, "process_kernel_time": 0.091937, "process_mem_max_rss": "114976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:51:14.561714 [debug] [MainThread]: Command `dbt seed` succeeded at 08:51:14.561640 after 17.00 seconds
[0m08:51:14.562668 [debug] [MainThread]: Flushing usage events
[0m08:52:01.439860 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.445004 | dae8daf1-004d-4cef-a15b-37589930ffed ==============================
[0m08:52:01.445004 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.447005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_geography', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.443451 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.448960 | 707990cf-1b15-4dd7-aaee-3bed9192b8d4 ==============================
[0m08:52:01.448960 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.453129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_date', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.491891 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.498794 | 5b06b25d-3d27-4326-ada7-ae963c3f3c9a ==============================
[0m08:52:01.498794 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.499696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.499578 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.508786 | 9d71d3e8-f47c-4ae1-848f-b03e879f215e ==============================
[0m08:52:01.508786 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.504413 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:01.510988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models src_channels', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}


============================== 08:52:01.511981 | 567ae55d-8f83-4e34-911b-89b6a5f34c2b ==============================
[0m08:52:01.511981 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.513461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models src_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.515882 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.521120 | bc694e70-e507-4f75-958d-598093d8ce61 ==============================
[0m08:52:01.521120 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.524143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.525178 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:01.533687 | 78dd5b0b-4239-4cfd-8aed-e30285c53b97 ==============================
[0m08:52:01.533687 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:01.536424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models src_resellers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:01.620888 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.622017 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.639432 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.641868 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.697719 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.700067 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.701090 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.717966 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.723303 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.728808 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.729221 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.726711 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:01.726433 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.731420 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.751509 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.755069 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.752888 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.787860 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:01.843918 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.845291 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.853423 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.854690 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.887485 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.888466 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.906839 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.907461 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:52:01.908214 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:01.908126 [debug] [MainThread]: previous checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m08:52:03.100472 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.109114 [info ] [MainThread]: 
[0m08:52:03.117002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.120533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.188132 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.193401 [info ] [MainThread]: 
[0m08:52:03.196098 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.198913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.199339 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.201475 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.203304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.219189 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.219508 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.221256 [info ] [MainThread]: 
[0m08:52:03.221373 [info ] [MainThread]: 
[0m08:52:03.222141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.222401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.223243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.223375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.226142 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.226737 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.227274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.235874 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m08:52:03.238743 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.239674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:52:03.240787 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:52:03.246166 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.246159 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.246686 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:52:03.247698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.247915 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.248617 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.248337 [info ] [MainThread]: 
[0m08:52:03.248596 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.249121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.249502 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.249479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.249900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.250562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.252923 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:52:03.253856 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.254698 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:52:03.255885 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:52:03.257227 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.256303 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m08:52:03.257769 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.258173 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.258765 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.259381 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:52:03.259736 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:52:03.261056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now create_sales_dw_dev)
[0m08:52:03.263682 [debug] [ThreadPool]: Creating schema "database: "sales_dw"
schema: "dev"
"
[0m08:52:03.263777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m08:52:03.268659 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.264700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:03.269620 [debug] [ThreadPool]: On create_sales_dw_dev: BEGIN
[0m08:52:03.270472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.268893 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.271942 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.272433 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.272904 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.273252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.273789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.274849 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:52:03.275492 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.275868 [debug] [ThreadPool]: On create_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "create_sales_dw_dev"} */
create schema if not exists "dev"
[0m08:52:03.276099 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.276435 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:52:03.276751 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.280794 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.280947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.282363 [debug] [ThreadPool]: Using postgres connection "create_sales_dw_dev"
[0m08:52:03.284299 [debug] [ThreadPool]: On create_sales_dw_dev: COMMIT
[0m08:52:03.285993 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:52:03.287328 [debug] [ThreadPool]: On create_sales_dw_dev: Close
[0m08:52:03.291367 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m08:52:03.293416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sales_dw_dev, now list_sales_dw_dev)
[0m08:52:03.294927 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.294303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:03.302715 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.306260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:03.310525 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.306407 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.312017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.313462 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.315544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.307056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:03.317415 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.321188 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:52:03.319749 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.322861 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.322435 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.323659 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:03.323430 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.324491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.325977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.327969 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:52:03.331978 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:03.333385 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:52:03.336666 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:03.336719 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.338005 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:03.340661 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:52:03.342225 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:03.343044 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:03.374472 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.376132 [info ] [MainThread]: 
[0m08:52:03.377013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.378125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.389901 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:03.391876 [info ] [MainThread]: 
[0m08:52:03.392689 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:03.393719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:03.400691 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.401397 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.401918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.407147 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m08:52:03.408291 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:03.414177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:03.416574 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:03.418032 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:03.421610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.415831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:03.422905 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.433565 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:03.429315 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.438007 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:03.447334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:03.435019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:03.461421 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m08:52:03.461878 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:03.462242 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:03.465450 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:03.468433 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:03.467489 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m08:52:03.472327 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:03.472612 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:03.474156 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:03.479224 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m08:52:03.480479 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:03.484398 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:03.494256 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.494872 [debug] [MainThread]: On master: BEGIN
[0m08:52:03.495192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:03.499724 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:52:03.500341 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.500939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:03.504106 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:52:03.505345 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:03.505926 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.506301 [debug] [MainThread]: On master: BEGIN
[0m08:52:03.506792 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:03.507286 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.507680 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.508039 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.508761 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:03.509212 [debug] [MainThread]: On master: Close
[0m08:52:03.512455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:03.514227 [info ] [MainThread]: 
[0m08:52:03.519616 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_resellers
[0m08:52:03.520298 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_resellers .................................. [RUN]
[0m08:52:03.521041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_resellers)
[0m08:52:03.521675 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_resellers
[0m08:52:03.526961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_resellers"
[0m08:52:03.529407 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_resellers
[0m08:52:03.551054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_resellers"
[0m08:52:03.553541 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.554005 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: BEGIN
[0m08:52:03.554387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:03.559114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:52:03.562868 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.564027 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */

  create view "sales_dw"."dev"."src_resellers__dbt_tmp"
    
    
  as (
    WITH raw_resellers AS (

    SELECT * FROM "sales_dw"."import"."resellers"
)

SELECT reseller_id, reseller_name, commission_pct , loaded_timestamp

FROM raw_resellers
  );
[0m08:52:03.565920 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:03.570921 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.571603 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
alter table "sales_dw"."dev"."src_resellers__dbt_tmp" rename to "src_resellers"
[0m08:52:03.572394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:03.581761 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:52:03.582516 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.582992 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: COMMIT
[0m08:52:03.584110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:03.588654 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_resellers__dbt_backup"
[0m08:52:03.592039 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_resellers"
[0m08:52:03.592618 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_resellers"} */
drop view if exists "sales_dw"."dev"."src_resellers__dbt_backup" cascade
[0m08:52:03.593266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:03.595285 [debug] [Thread-1 (]: On model.dbtcomp.src_resellers: Close
[0m08:52:03.597051 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_resellers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:03.598083 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_resellers
[0m08:52:03.599447 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.599953 [debug] [MainThread]: On master: BEGIN
[0m08:52:03.600361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:03.605348 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:03.606057 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.606483 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:03.606860 [debug] [MainThread]: On master: COMMIT
[0m08:52:03.607423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:03.607811 [debug] [MainThread]: On master: Close
[0m08:52:03.608287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:03.608641 [debug] [MainThread]: Connection 'model.dbtcomp.src_resellers' was properly closed.
[0m08:52:03.608975 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:03.609380 [info ] [MainThread]: 
[0m08:52:03.613368 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m08:52:03.614488 [debug] [MainThread]: Command end result
[0m08:52:03.615178 [info ] [MainThread]: 
[0m08:52:03.615721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:03.616163 [info ] [MainThread]: 
[0m08:52:03.616575 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:03.617435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1340606, "process_user_time": 2.448304, "process_kernel_time": 0.140393, "process_mem_max_rss": "112832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:03.617920 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:03.617862 after 2.13 seconds
[0m08:52:03.618315 [debug] [MainThread]: Flushing usage events
[0m08:52:05.147324 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:05.151732 | 7dcdfa8e-f47d-41df-961f-ef2c6de09ba6 ==============================
[0m08:52:05.151732 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:05.152306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models src_resellers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:05.157506 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:05.161980 | f9e0a131-04fd-43c8-bd56-a8be9e9a7949 ==============================
[0m08:52:05.161980 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:05.162621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_resellers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:05.277947 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:05.288559 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:05.288694 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:05.299588 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:05.519652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:05.520230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:05.524964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:05.525530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:05.566355 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:05.567829 [info ] [MainThread]: 
[0m08:52:05.569982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:05.571366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:05.576369 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:05.577657 [info ] [MainThread]: 
[0m08:52:05.578239 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:05.579952 [debug] [MainThread]: Command end result
[0m08:52:05.580802 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46300045, "process_user_time": 0.968029, "process_kernel_time": 0.065339, "process_mem_max_rss": "97704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:05.581490 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:05.581414 after 0.46 seconds
[0m08:52:05.581955 [debug] [MainThread]: Flushing usage events
[0m08:52:05.597291 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:05.598024 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:05.598634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:05.604319 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m08:52:05.605751 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:05.609955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:05.610522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:05.615464 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:05.617913 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:05.618624 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:05.619273 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:05.619951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:05.623681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:05.629325 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:52:05.630033 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:05.630627 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:05.633055 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:05.634655 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:05.635285 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:08.218591 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.015 seconds
[0m08:52:08.225264 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:08.257518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:08.264063 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.014 seconds
[0m08:52:08.269014 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:08.259696 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:08.271757 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.273867 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.275104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:08.274542 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:08.278257 [debug] [ThreadPool]: SQL status: BEGIN in 5.004 seconds
[0m08:52:08.275525 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:08.279092 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:08.279500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:08.275760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:08.280133 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.280642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.282219 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.281429 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.284414 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.286642 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:08.286044 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:08.287667 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:52:08.284913 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.287359 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:08.288734 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.288324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:08.289620 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:08.289861 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.289262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.291405 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:08.291786 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:52:08.291724 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:52:08.293184 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:08.294289 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:52:08.294520 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:08.294959 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.293306 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:08.295656 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.294140 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.296680 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.298097 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.299228 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.299678 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.301118 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.301797 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.302292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:08.307626 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:08.308332 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.308839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:08.311696 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.312779 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:08.313184 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.313541 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.314073 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:08.314548 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.314993 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.315282 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.315669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.316020 [debug] [MainThread]: On master: Close
[0m08:52:08.316594 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:08.316982 [info ] [MainThread]: 
[0m08:52:08.322768 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_date
[0m08:52:08.323557 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_date ...................................... [RUN]
[0m08:52:08.324130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_date)
[0m08:52:08.324619 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_date
[0m08:52:08.324843 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:52:08.328696 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.329442 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.331061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_date"
[0m08:52:08.331806 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:52:08.332006 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.332644 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.333005 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_date
[0m08:52:08.333531 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:08.333595 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.336015 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.337176 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:08.338520 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:08.339713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:08.341511 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.342374 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.344431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:08.346054 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.346812 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.348544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:08.360968 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:52:08.361822 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.362637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:08.366331 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m08:52:08.367601 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:08.368450 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.368448 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_date"
[0m08:52:08.368865 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.370031 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:08.371583 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.372654 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.372518 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.373574 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.374387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.374037 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: BEGIN
[0m08:52:08.375122 [debug] [MainThread]: On master: Close
[0m08:52:08.375671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:08.376556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:08.377380 [info ] [MainThread]: 
[0m08:52:08.381987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:52:08.383021 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.383644 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_channels
[0m08:52:08.383762 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */

  
    

  create  table "sales_dw"."dev"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS date_key,
       datum AS date_actual,
       EXTRACT(EPOCH FROM datum) AS epoch,
       TO_CHAR(datum, 'fmDDth') AS day_suffix,
       TO_CHAR(datum, 'Day') AS day_name,
       EXTRACT(ISODOW FROM datum) AS day_of_week,
       EXTRACT(DAY FROM datum) AS day_of_month,
       datum - DATE_TRUNC('quarter', datum)::DATE + 1 AS day_of_quarter,
       EXTRACT(DOY FROM datum) AS day_of_year,
       TO_CHAR(datum, 'W')::INT AS week_of_month,
       EXTRACT(WEEK FROM datum) AS week_of_year,
       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '"-W"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,
       EXTRACT(MONTH FROM datum) AS month_actual,
       TO_CHAR(datum, 'Month') AS month_name,
       TO_CHAR(datum, 'Mon') AS month_name_abbreviated,
       EXTRACT(QUARTER FROM datum) AS quarter_actual,
       CASE
           WHEN EXTRACT(QUARTER FROM datum) = 1 THEN 'First'
           WHEN EXTRACT(QUARTER FROM datum) = 2 THEN 'Second'
           WHEN EXTRACT(QUARTER FROM datum) = 3 THEN 'Third'
           WHEN EXTRACT(QUARTER FROM datum) = 4 THEN 'Fourth'
           END AS quarter_name,
       EXTRACT(ISOYEAR FROM datum) AS year_actual,
       datum + (1 - EXTRACT(ISODOW FROM datum))::INT AS first_day_of_week,
       datum + (7 - EXTRACT(ISODOW FROM datum))::INT AS last_day_of_week,
       datum + (1 - EXTRACT(DAY FROM datum))::INT AS first_day_of_month,
       (DATE_TRUNC('MONTH', datum) + INTERVAL '1 MONTH - 1 day')::DATE AS last_day_of_month,
       DATE_TRUNC('quarter', datum)::DATE AS first_day_of_quarter,
       (DATE_TRUNC('quarter', datum) + INTERVAL '3 MONTH - 1 day')::DATE AS last_day_of_quarter,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-01-01', 'YYYY-MM-DD') AS first_day_of_year,
       TO_DATE(EXTRACT(YEAR FROM datum) || '-12-31', 'YYYY-MM-DD') AS last_day_of_year,
       TO_CHAR(datum, 'mmyyyy') AS mmyyyy,
       TO_CHAR(datum, 'mmddyyyy') AS mmddyyyy,
       CASE
           WHEN EXTRACT(ISODOW FROM datum) IN (6, 7) THEN TRUE
           ELSE FALSE
           END AS weekend_indr
FROM (SELECT '1970-01-01'::DATE + SEQUENCE.DAY AS datum
      FROM GENERATE_SERIES(0, 29219) AS SEQUENCE (DAY)
      GROUP BY SEQUENCE.DAY) DQ
ORDER BY 1
  );
  
[0m08:52:08.384473 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_channels ................................... [RUN]
[0m08:52:08.385238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_channels)
[0m08:52:08.386032 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_channels
[0m08:52:08.392121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_channels"
[0m08:52:08.394134 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_channels
[0m08:52:08.422025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_channels"
[0m08:52:08.423358 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.424217 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: BEGIN
[0m08:52:08.425048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:08.430941 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.009 seconds
[0m08:52:08.432665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:52:08.432716 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:08.433668 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.434416 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */

  create view "sales_dw"."dev"."src_channels__dbt_tmp"
    
    
  as (
    WITH raw_channels AS (

    SELECT * FROM "sales_dw"."import"."channels"
)

select channel_id, channel_name , loaded_timestamp

from raw_channels
  );
[0m08:52:08.437242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:08.438383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:08.442551 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.443136 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
alter table "sales_dw"."dev"."src_channels__dbt_tmp" rename to "src_channels"
[0m08:52:08.444756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:08.439301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:08.446755 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:08.451358 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:08.455120 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:08.456132 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:52:08.455769 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:08.456869 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.457424 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: COMMIT
[0m08:52:08.456337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:08.457275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:08.458869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.465294 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_channels__dbt_backup"
[0m08:52:08.469062 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_channels"
[0m08:52:08.469704 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_channels"} */
drop view if exists "sales_dw"."dev"."src_channels__dbt_backup" cascade
[0m08:52:08.470498 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:08.472571 [debug] [Thread-1 (]: On model.dbtcomp.src_channels: Close
[0m08:52:08.473894 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_channels .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m08:52:08.474654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_channels
[0m08:52:08.475936 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.476386 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.476686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:08.481566 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:08.482264 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.482687 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.483088 [debug] [MainThread]: On master: COMMIT
[0m08:52:08.483551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:08.483867 [debug] [MainThread]: On master: Close
[0m08:52:08.484279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:08.484550 [debug] [MainThread]: Connection 'model.dbtcomp.src_channels' was properly closed.
[0m08:52:08.484942 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:08.485517 [info ] [MainThread]: 
[0m08:52:08.486003 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m08:52:08.486922 [debug] [MainThread]: Command end result
[0m08:52:08.487424 [info ] [MainThread]: 
[0m08:52:08.487957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:08.488579 [info ] [MainThread]: 
[0m08:52:08.489525 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:08.493440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0279374, "process_user_time": 2.430308, "process_kernel_time": 0.141004, "process_mem_max_rss": "114732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:08.494058 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:08.493987 after 7.03 seconds
[0m08:52:08.494901 [debug] [MainThread]: Flushing usage events
[0m08:52:08.602756 [debug] [Thread-1 (]: SQL status: SELECT 29220 in 0.218 seconds
[0m08:52:08.608612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.611082 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
alter table "sales_dw"."dev"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:52:08.614759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:08.624764 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:52:08.625408 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.629759 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: COMMIT
[0m08:52:08.635178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:52:08.641196 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_date__dbt_backup"
[0m08:52:08.645766 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_date"
[0m08:52:08.646331 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_date"} */
drop table if exists "sales_dw"."dev"."dim_date__dbt_backup" cascade
[0m08:52:08.651163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:52:08.653139 [debug] [Thread-1 (]: On model.dbtcomp.dim_date: Close
[0m08:52:08.654806 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_date ................................. [[32mSELECT 29220[0m in 0.33s]
[0m08:52:08.656025 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_date
[0m08:52:08.657716 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:08.658552 [debug] [MainThread]: On master: BEGIN
[0m08:52:08.659096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:10.334493 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:10.334496 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:10.339501 | 0f121535-3716-4cbd-9b43-bd7ec4fc3791 ==============================
[0m08:52:10.339501 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:10.339691 | 8b5c9c29-6692-417d-8f65-c5c4a7470fee ==============================
[0m08:52:10.339691 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:10.340389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_channels', 'send_anonymous_usage_stats': 'True'}
[0m08:52:10.340844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_channels', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:10.482898 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:10.492758 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:10.494582 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:10.506403 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:10.631535 [debug] [ThreadPool]: SQL status: BEGIN in 5.012 seconds
[0m08:52:10.640253 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:10.663527 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:10.679350 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:10.681003 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:10.682335 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:10.686787 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.687407 [debug] [MainThread]: On master: BEGIN
[0m08:52:10.688819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:10.695978 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:52:10.698831 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.699861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:10.703741 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m08:52:10.706746 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:10.707996 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.708999 [debug] [MainThread]: On master: BEGIN
[0m08:52:10.710404 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:10.711818 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.712483 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.713504 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.714917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:10.716132 [debug] [MainThread]: On master: Close
[0m08:52:10.717345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:10.718422 [info ] [MainThread]: 
[0m08:52:10.729628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:10.729553 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_resellers
[0m08:52:10.729950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:10.730121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:10.730651 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_resellers .............................. [RUN]
[0m08:52:10.731160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:10.739311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_resellers)
[0m08:52:10.742403 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_resellers
[0m08:52:10.748039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_resellers"
[0m08:52:10.749418 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_resellers
[0m08:52:10.771481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_resellers"
[0m08:52:10.775293 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.775884 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: BEGIN
[0m08:52:10.776293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:10.776830 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:10.778570 [info ] [MainThread]: 
[0m08:52:10.780761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:10.781505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:52:10.782368 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.782407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:10.782945 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */

  create view "sales_dw"."dev"."staging_resellers__dbt_tmp"
    
    
  as (
    with resellers as (

SELECT reseller_id, reseller_name, commission_pct, row_number() over (partition by reseller_id order by loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_resellers"

)
select reseller_id, reseller_name, commission_pct

from resellers

where rn = 1
  );
[0m08:52:10.785136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:10.789798 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.790531 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
alter table "sales_dw"."dev"."staging_resellers__dbt_tmp" rename to "staging_resellers"
[0m08:52:10.790432 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:10.791286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:10.791851 [info ] [MainThread]: 
[0m08:52:10.795483 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:10.796971 [debug] [MainThread]: Command end result
[0m08:52:10.797988 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50043535, "process_user_time": 1.011002, "process_kernel_time": 0.081286, "process_mem_max_rss": "97336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:10.798627 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:10.798556 after 0.50 seconds
[0m08:52:10.799001 [debug] [MainThread]: Flushing usage events
[0m08:52:10.800577 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:52:10.801068 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.801619 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: COMMIT
[0m08:52:10.802663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:10.805609 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:10.806676 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:10.807146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:10.807549 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_resellers__dbt_backup"
[0m08:52:10.811378 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_resellers"
[0m08:52:10.812127 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_resellers"} */
drop view if exists "sales_dw"."dev"."staging_resellers__dbt_backup" cascade
[0m08:52:10.813010 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:10.813430 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m08:52:10.815965 [debug] [Thread-1 (]: On model.dbtcomp.staging_resellers: Close
[0m08:52:10.818162 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_resellers ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:10.817632 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:10.818930 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_resellers
[0m08:52:10.821562 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.823582 [debug] [MainThread]: On master: BEGIN
[0m08:52:10.823665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:10.824075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:10.824369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:10.829334 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:10.832296 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.829409 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:10.832910 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:10.831853 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:10.833794 [debug] [MainThread]: On master: COMMIT
[0m08:52:10.833367 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:10.834765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:10.834769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:10.835235 [debug] [MainThread]: On master: Close
[0m08:52:10.835935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:10.834168 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:10.836660 [debug] [MainThread]: Connection 'model.dbtcomp.staging_resellers' was properly closed.
[0m08:52:10.837152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:10.837680 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:10.838527 [info ] [MainThread]: 
[0m08:52:10.838919 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m08:52:10.839437 [debug] [MainThread]: Command end result
[0m08:52:10.839720 [info ] [MainThread]: 
[0m08:52:10.840093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:10.840564 [info ] [MainThread]: 
[0m08:52:10.841141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:10.840988 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:52:10.842009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.713923, "process_user_time": 1.110071, "process_kernel_time": 0.082227, "process_mem_max_rss": "106620", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:10.842532 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:10.842468 after 5.71 seconds
[0m08:52:10.842358 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:10.843008 [debug] [MainThread]: Flushing usage events
[0m08:52:10.843532 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:10.850834 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:10.855159 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:10.856181 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:12.438846 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:12.443432 | 428d811b-13de-474a-bdb5-ee2da4b085a1 ==============================
[0m08:52:12.443432 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:12.444076 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:12.447997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_salesagent', 'send_anonymous_usage_stats': 'True'}


============================== 08:52:12.448768 | 57d17c59-06ff-4d5c-bb1f-bc99c8517ce2 ==============================
[0m08:52:12.448768 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:12.452642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_resellers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:12.579181 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:12.589093 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:12.590278 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:12.606423 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:12.800503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:12.801044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:12.811464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:12.812212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:12.855731 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:12.856957 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:12.857637 [info ] [MainThread]: 
[0m08:52:12.858191 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:12.858409 [info ] [MainThread]: 
[0m08:52:12.859625 [debug] [MainThread]: Command end result
[0m08:52:12.860212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:12.860461 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.45197383, "process_user_time": 1.022577, "process_kernel_time": 0.062035, "process_mem_max_rss": "97224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:12.861230 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:12.861078 after 0.45 seconds
[0m08:52:12.861328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:12.861682 [debug] [MainThread]: Flushing usage events
[0m08:52:12.885319 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:12.886088 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:12.887479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:13.296336 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:52:13.296040 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m08:52:13.297087 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:13.297511 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:13.297607 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:13.298064 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:13.299889 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m08:52:13.300226 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:13.301048 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:13.301858 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:13.302277 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:13.302973 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:13.306537 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.307030 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.307291 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.307417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:13.307777 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.308169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:13.312224 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.314938 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.315905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:13.322056 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m08:52:13.323471 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:13.324003 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.324366 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.324887 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:13.325395 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.325754 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.326083 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.326559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.326943 [debug] [MainThread]: On master: Close
[0m08:52:13.327533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:13.327961 [info ] [MainThread]: 
[0m08:52:13.333430 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_transactions
[0m08:52:13.334109 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_transactions ............................... [RUN]
[0m08:52:13.334620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.src_transactions)
[0m08:52:13.335011 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_transactions
[0m08:52:13.340557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_transactions"
[0m08:52:13.342353 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_transactions
[0m08:52:13.355094 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m08:52:13.355762 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.356107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:13.359326 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m08:52:13.360941 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:13.361409 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.361779 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.362315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:13.362938 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.363359 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.363827 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.364311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.364652 [debug] [MainThread]: On master: Close
[0m08:52:13.364625 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_transactions"
[0m08:52:13.365211 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:13.365817 [info ] [MainThread]: 
[0m08:52:13.367039 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.367567 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: BEGIN
[0m08:52:13.368030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.371171 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_products
[0m08:52:13.371852 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_products ................................... [RUN]
[0m08:52:13.372628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.372698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_products)
[0m08:52:13.374737 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.374880 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_products
[0m08:52:13.375700 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */

  create view "sales_dw"."dev"."src_transactions__dbt_tmp"
    
    
  as (
    WITH raw_transactions AS (

    SELECT * FROM "sales_dw"."import"."transactions"
)

SELECT customer_id, product_id, amount, qty, channel_id, bought_date, transaction_id, loaded_timestamp

FROM raw_transactions
  );
[0m08:52:13.379939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:13.381148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_products"
[0m08:52:13.385258 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_products
[0m08:52:13.388918 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.392173 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
alter table "sales_dw"."dev"."src_transactions__dbt_tmp" rename to "src_transactions"
[0m08:52:13.393077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:13.402046 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:52:13.402721 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.403233 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: COMMIT
[0m08:52:13.404080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.408099 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_products"
[0m08:52:13.408606 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_transactions__dbt_backup"
[0m08:52:13.409606 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.410078 [debug] [Thread-1 (]: On model.dbtcomp.src_products: BEGIN
[0m08:52:13.410538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.411846 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_transactions"
[0m08:52:13.412420 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_transactions"} */
drop view if exists "sales_dw"."dev"."src_transactions__dbt_backup" cascade
[0m08:52:13.413129 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:13.414988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:13.415144 [debug] [Thread-1 (]: On model.dbtcomp.src_transactions: Close
[0m08:52:13.415668 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.416283 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */

  create view "sales_dw"."dev"."src_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (

    SELECT * FROM "sales_dw"."import"."products"
)

SELECT product_id, name AS product_name, price AS product_price, city AS product_city, loaded_timestamp

FROM raw_products
  );
[0m08:52:13.416694 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_transactions .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:13.417357 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_transactions
[0m08:52:13.417744 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:13.418483 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.418952 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.419301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:13.422498 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.423117 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
alter table "sales_dw"."dev"."src_products__dbt_tmp" rename to "src_products"
[0m08:52:13.423896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:13.423949 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.424595 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.424976 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.425357 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.426001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.426389 [debug] [MainThread]: On master: Close
[0m08:52:13.426891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.427347 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:13.427844 [debug] [MainThread]: Connection 'model.dbtcomp.src_transactions' was properly closed.
[0m08:52:13.428352 [info ] [MainThread]: 
[0m08:52:13.428806 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.21 seconds (10.21s).
[0m08:52:13.429666 [debug] [MainThread]: Command end result
[0m08:52:13.430127 [info ] [MainThread]: 
[0m08:52:13.430764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:13.431288 [info ] [MainThread]: 
[0m08:52:13.431796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:13.432671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.980136, "process_user_time": 2.380946, "process_kernel_time": 0.148934, "process_mem_max_rss": "112852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:13.433030 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:52:13.433343 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:13.433261 after 11.98 seconds
[0m08:52:13.433614 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.433764 [debug] [MainThread]: Flushing usage events
[0m08:52:13.434111 [debug] [Thread-1 (]: On model.dbtcomp.src_products: COMMIT
[0m08:52:13.435141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.440007 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_products__dbt_backup"
[0m08:52:13.443494 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_products"
[0m08:52:13.444259 [debug] [Thread-1 (]: On model.dbtcomp.src_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_products"} */
drop view if exists "sales_dw"."dev"."src_products__dbt_backup" cascade
[0m08:52:13.444952 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:13.448164 [debug] [Thread-1 (]: On model.dbtcomp.src_products: Close
[0m08:52:13.449690 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_products .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m08:52:13.450364 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_products
[0m08:52:13.451713 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.452119 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.452596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:13.457459 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.458127 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.458706 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.459476 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.460178 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.460692 [debug] [MainThread]: On master: Close
[0m08:52:13.461185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.461585 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:13.461925 [debug] [MainThread]: Connection 'model.dbtcomp.src_products' was properly closed.
[0m08:52:13.462550 [info ] [MainThread]: 
[0m08:52:13.462667 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:52:13.463501 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m08:52:13.463522 [debug] [ThreadPool]: SQL status: BEGIN in 5.007 seconds
[0m08:52:13.464402 [debug] [MainThread]: Command end result
[0m08:52:13.463970 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:13.464792 [info ] [MainThread]: 
[0m08:52:13.464508 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:13.465328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:13.465036 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:13.465795 [info ] [MainThread]: 
[0m08:52:13.465585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:13.466271 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:13.467056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.006065, "process_user_time": 2.38702, "process_kernel_time": 0.138377, "process_mem_max_rss": "113048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:13.467744 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:13.467631 after 12.01 seconds
[0m08:52:13.467800 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m08:52:13.468176 [debug] [MainThread]: Flushing usage events
[0m08:52:13.468089 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:13.468991 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:13.470040 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:13.471168 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:13.471887 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:13.478063 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.478679 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.479024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:13.484134 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:13.484795 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.485148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:13.489084 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m08:52:13.490799 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:13.491385 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.491728 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.492233 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:13.492700 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.493023 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.493334 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.493776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.494068 [debug] [MainThread]: On master: Close
[0m08:52:13.494639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:13.494991 [info ] [MainThread]: 
[0m08:52:13.500580 [debug] [Thread-1 (]: Began running node model.dbtcomp.src_customers
[0m08:52:13.501190 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.src_customers .................................. [RUN]
[0m08:52:13.501645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.src_customers)
[0m08:52:13.501996 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.src_customers
[0m08:52:13.507744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.src_customers"
[0m08:52:13.508928 [debug] [Thread-1 (]: Began executing node model.dbtcomp.src_customers
[0m08:52:13.532307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.src_customers"
[0m08:52:13.533628 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:13.534075 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: BEGIN
[0m08:52:13.534583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.666441 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:52:13.667356 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.667860 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:13.668310 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.669270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:13.669868 [debug] [MainThread]: On master: Close
[0m08:52:13.670510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.670937 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:13.671398 [debug] [MainThread]: Connection 'model.dbtcomp.dim_date' was properly closed.
[0m08:52:13.671891 [info ] [MainThread]: 
[0m08:52:13.672292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.48 seconds (10.48s).
[0m08:52:13.673117 [debug] [MainThread]: Command end result
[0m08:52:13.673546 [info ] [MainThread]: 
[0m08:52:13.673995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:13.674377 [info ] [MainThread]: 
[0m08:52:13.674711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:13.675342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.268839, "process_user_time": 2.372603, "process_kernel_time": 0.133937, "process_mem_max_rss": "115000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:13.675799 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:13.675724 after 12.27 seconds
[0m08:52:13.676136 [debug] [MainThread]: Flushing usage events
[0m08:52:15.321077 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:15.339696 | 6909844e-580e-4c38-8128-208cf9c5a8a6 ==============================
[0m08:52:15.339696 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.354708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_transactions', 'send_anonymous_usage_stats': 'True'}
[0m08:52:15.367567 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:15.352337 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:15.381377 | abfa8cfd-3ea3-4c47-b2c8-2887f4af8ba7 ==============================
[0m08:52:15.381377 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.382479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_product', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 08:52:15.383651 | b367dd38-3f3a-4da9-a2b2-3811a319d4d4 ==============================
[0m08:52:15.383651 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.384401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models src_products', 'send_anonymous_usage_stats': 'True'}
[0m08:52:15.385703 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:15.391384 | 154f80e4-549d-465b-b15b-bc04afd1a236 ==============================
[0m08:52:15.391384 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:15.392515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_date', 'send_anonymous_usage_stats': 'True'}
[0m08:52:15.510552 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.524580 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.526156 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.528823 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.534060 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:15.544394 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.545147 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.548687 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:15.725996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.726859 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.739451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.740016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.740179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:15.741977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.742177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.742721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:15.792472 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.793114 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.793956 [info ] [MainThread]: 
[0m08:52:15.795261 [info ] [MainThread]: 
[0m08:52:15.795666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:15.795827 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:15.796080 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.796877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:15.797769 [debug] [MainThread]: Command end result
[0m08:52:15.798885 [info ] [MainThread]: 
[0m08:52:15.798591 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:15.798912 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.495521, "process_user_time": 1.00886, "process_kernel_time": 0.059701, "process_mem_max_rss": "97588", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:15.799913 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:15.799794 after 0.50 seconds
[0m08:52:15.799489 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:15.800492 [info ] [MainThread]: 
[0m08:52:15.800664 [debug] [MainThread]: Flushing usage events
[0m08:52:15.801257 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:15.801872 [debug] [MainThread]: Command end result
[0m08:52:15.803416 [debug] [MainThread]: Command end result
[0m08:52:15.806741 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52122235, "process_user_time": 0.999842, "process_kernel_time": 0.058517, "process_mem_max_rss": "97340", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:15.807391 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.51763344, "process_user_time": 1.004929, "process_kernel_time": 0.058111, "process_mem_max_rss": "97460", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:15.807499 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:15.807406 after 0.52 seconds
[0m08:52:15.808697 [debug] [MainThread]: Flushing usage events
[0m08:52:15.808730 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:15.808620 after 0.52 seconds
[0m08:52:15.809794 [debug] [MainThread]: Flushing usage events
[0m08:52:15.825812 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:15.827544 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:15.829535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:15.843389 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:15.844269 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:15.844970 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:15.847742 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m08:52:15.849868 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:15.850805 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:15.855484 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:15.856459 [debug] [MainThread]: On master: BEGIN
[0m08:52:15.857571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:17.899119 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m08:52:17.904073 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:17.908853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:17.909237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:17.953570 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:17.942414 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:17.961899 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:17.962424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:17.956443 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:17.967806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:18.313081 [debug] [MainThread]: SQL status: BEGIN in 5.006 seconds
[0m08:52:18.314095 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.314685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:18.318658 [debug] [MainThread]: SQL status: SELECT 5 in 0.003 seconds
[0m08:52:18.320228 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:18.320916 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.321400 [debug] [MainThread]: On master: BEGIN
[0m08:52:18.321957 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:18.324053 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.324846 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.328467 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.329323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:18.329996 [debug] [MainThread]: On master: Close
[0m08:52:18.330886 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:18.331411 [info ] [MainThread]: 
[0m08:52:18.337708 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_geography
[0m08:52:18.338509 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_geography ................................. [RUN]
[0m08:52:18.339442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_geography)
[0m08:52:18.339882 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_geography
[0m08:52:18.345714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_geography"
[0m08:52:18.348464 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_geography
[0m08:52:18.374133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_geography"
[0m08:52:18.392016 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.400603 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: BEGIN
[0m08:52:18.402657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:18.424645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m08:52:18.431882 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.439926 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */

  
    

  create  table "sales_dw"."dev"."dim_geography__dbt_tmp"
  
  
    as
  
  (
    

SELECT
      id AS geography_key,
      cityname as city_name,
      countryname as country_name,
      regionname as region_name
FROM
      "sales_dw"."dev_raw"."geography"
  );
  
[0m08:52:18.443120 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m08:52:18.447684 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.448347 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
alter table "sales_dw"."dev"."dim_geography__dbt_tmp" rename to "dim_geography"
[0m08:52:18.449110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:18.460286 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:52:18.460894 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.461308 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: COMMIT
[0m08:52:18.462038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:18.466561 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_geography__dbt_backup"
[0m08:52:18.469944 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_geography"
[0m08:52:18.470633 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_geography"} */
drop table if exists "sales_dw"."dev"."dim_geography__dbt_backup" cascade
[0m08:52:18.471312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:52:18.473094 [debug] [Thread-1 (]: On model.dbtcomp.dim_geography: Close
[0m08:52:18.475187 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_geography ............................ [[32mSELECT 100[0m in 0.14s]
[0m08:52:18.475844 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_geography
[0m08:52:18.477831 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.478965 [debug] [MainThread]: On master: BEGIN
[0m08:52:18.479440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:18.484076 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:18.487380 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.487906 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.488633 [debug] [MainThread]: On master: COMMIT
[0m08:52:18.492814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:18.493394 [debug] [MainThread]: On master: Close
[0m08:52:18.494010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:18.494433 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:18.495087 [debug] [MainThread]: Connection 'model.dbtcomp.dim_geography' was properly closed.
[0m08:52:18.495560 [info ] [MainThread]: 
[0m08:52:18.497555 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.38 seconds (15.38s).
[0m08:52:18.498198 [debug] [MainThread]: Command end result
[0m08:52:18.498743 [info ] [MainThread]: 
[0m08:52:18.499594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:18.500090 [info ] [MainThread]: 
[0m08:52:18.500594 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:18.501399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.095757, "process_user_time": 2.336571, "process_kernel_time": 0.129809, "process_mem_max_rss": "115064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:18.502025 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:18.501960 after 17.10 seconds
[0m08:52:18.502602 [debug] [MainThread]: Flushing usage events
[0m08:52:18.539230 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m08:52:18.540468 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.541053 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */

  create view "sales_dw"."dev"."src_customers__dbt_tmp"
    
    
  as (
    with raw_customers as (

    SELECT * from "sales_dw"."import"."customers"
)

select customer_id, first_name , last_name , email

from raw_customers
  );
[0m08:52:18.546232 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:18.551417 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.552170 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
alter table "sales_dw"."dev"."src_customers__dbt_tmp" rename to "src_customers"
[0m08:52:18.553258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:18.562510 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m08:52:18.563435 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.564029 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: COMMIT
[0m08:52:18.565176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:18.570499 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."src_customers__dbt_backup"
[0m08:52:18.574014 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.src_customers"
[0m08:52:18.574719 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.src_customers"} */
drop view if exists "sales_dw"."dev"."src_customers__dbt_backup" cascade
[0m08:52:18.575475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:18.577386 [debug] [Thread-1 (]: On model.dbtcomp.src_customers: Close
[0m08:52:18.579140 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.src_customers ............................. [[32mCREATE VIEW[0m in 5.08s]
[0m08:52:18.580032 [debug] [Thread-1 (]: Finished running node model.dbtcomp.src_customers
[0m08:52:18.581383 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:18.581827 [debug] [MainThread]: On master: BEGIN
[0m08:52:18.582192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:20.435040 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:20.446021 | 1f84825c-bbb2-4aa4-929d-0c3ad36f18ec ==============================
[0m08:52:20.446021 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:20.450841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_geography', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:20.601393 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:20.612228 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:20.738779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:20.739349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:20.790194 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:20.791408 [info ] [MainThread]: 
[0m08:52:20.791831 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:20.793099 [debug] [MainThread]: Command end result
[0m08:52:20.793761 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.3920621, "process_user_time": 0.989137, "process_kernel_time": 0.061318, "process_mem_max_rss": "97968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:20.794271 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:20.794193 after 0.39 seconds
[0m08:52:20.794660 [debug] [MainThread]: Flushing usage events
[0m08:52:20.840041 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.011 seconds
[0m08:52:20.841415 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:20.845292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:20.845846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:20.850504 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:20.856293 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:20.860777 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:20.861432 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:20.862022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:20.862656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:20.864027 [debug] [MainThread]: SQL status: BEGIN in 5.007 seconds
[0m08:52:20.864804 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:20.865253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:20.869870 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m08:52:20.871408 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:20.871928 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:20.872411 [debug] [MainThread]: On master: BEGIN
[0m08:52:20.872975 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:20.873559 [debug] [MainThread]: On master: COMMIT
[0m08:52:20.873986 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:20.874257 [debug] [MainThread]: On master: COMMIT
[0m08:52:20.874701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:20.875170 [debug] [MainThread]: On master: Close
[0m08:52:20.875802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:20.876221 [info ] [MainThread]: 
[0m08:52:20.881437 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_channels
[0m08:52:20.882008 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_channels ............................... [RUN]
[0m08:52:20.882478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_channels)
[0m08:52:20.882845 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_channels
[0m08:52:20.888222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_channels"
[0m08:52:20.902840 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_channels
[0m08:52:20.961790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_channels"
[0m08:52:20.971864 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:20.974689 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: BEGIN
[0m08:52:20.975127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:22.975654 [debug] [ThreadPool]: SQL status: BEGIN in 5.008 seconds
[0m08:52:22.982084 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:22.982585 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:22.984529 [debug] [ThreadPool]: SQL status: BEGIN in 5.022 seconds
[0m08:52:22.986081 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:52:22.987285 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:22.989383 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:22.988802 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:22.990189 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:22.991623 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:52:22.992653 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:22.993170 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:22.997849 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:22.999603 [debug] [MainThread]: On master: BEGIN
[0m08:52:23.000528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:23.591224 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m08:52:23.592425 [debug] [MainThread]: On master: COMMIT
[0m08:52:23.592975 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:23.593352 [debug] [MainThread]: On master: COMMIT
[0m08:52:23.594008 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:23.594490 [debug] [MainThread]: On master: Close
[0m08:52:23.595057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:23.595513 [debug] [MainThread]: Connection 'model.dbtcomp.src_customers' was properly closed.
[0m08:52:23.595911 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:23.596306 [info ] [MainThread]: 
[0m08:52:23.596703 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.20 seconds (20.20s).
[0m08:52:23.597410 [debug] [MainThread]: Command end result
[0m08:52:23.597752 [info ] [MainThread]: 
[0m08:52:23.598186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:23.598620 [info ] [MainThread]: 
[0m08:52:23.599098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:23.599901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.1232, "process_user_time": 2.418255, "process_kernel_time": 0.14296, "process_mem_max_rss": "114992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:23.600426 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:23.600356 after 22.12 seconds
[0m08:52:23.600828 [debug] [MainThread]: Flushing usage events
[0m08:52:25.413998 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:25.418566 | 5da9845e-3c18-482b-8223-cbb2807a50a3 ==============================
[0m08:52:25.418566 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:25.419093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models src_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:25.559172 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:25.574054 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:25.726756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:25.727320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:25.808038 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:25.818848 [info ] [MainThread]: 
[0m08:52:25.819578 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:25.821341 [debug] [MainThread]: Command end result
[0m08:52:25.822155 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44253334, "process_user_time": 0.968626, "process_kernel_time": 0.067321, "process_mem_max_rss": "97364", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:25.822823 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:25.822750 after 0.44 seconds
[0m08:52:25.826089 [debug] [MainThread]: Flushing usage events
[0m08:52:25.867787 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:25.868560 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:25.869156 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:25.876743 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:25.879743 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:25.880577 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:25.882443 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m08:52:25.883761 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:25.882745 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:25.884999 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:25.884241 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:25.885652 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:25.890965 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:25.891463 [debug] [MainThread]: On master: BEGIN
[0m08:52:25.891776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:25.979915 [debug] [Thread-1 (]: SQL status: BEGIN in 5.005 seconds
[0m08:52:25.981617 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:25.982632 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */

  create view "sales_dw"."dev"."staging_channels__dbt_tmp"
    
    
  as (
    with staging_channels as (
select channel_id, channel_name
from "sales_dw"."dev"."src_channels"
)
select channel_id as channel_key, channel_id as original_channel_id, channel_name
from staging_channels
  );
[0m08:52:25.984504 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:25.989298 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:25.990004 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
alter table "sales_dw"."dev"."staging_channels__dbt_tmp" rename to "staging_channels"
[0m08:52:25.993972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:26.003008 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:52:26.003737 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:26.004247 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: COMMIT
[0m08:52:26.005561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:26.013221 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_channels__dbt_backup"
[0m08:52:26.020975 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_channels"
[0m08:52:26.021642 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_channels"} */
drop view if exists "sales_dw"."dev"."staging_channels__dbt_backup" cascade
[0m08:52:26.022285 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:26.024127 [debug] [Thread-1 (]: On model.dbtcomp.staging_channels: Close
[0m08:52:26.025717 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_channels .......................... [[32mCREATE VIEW[0m in 5.14s]
[0m08:52:26.026467 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_channels
[0m08:52:26.027821 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.028475 [debug] [MainThread]: On master: BEGIN
[0m08:52:26.028986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:26.034146 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:26.034793 [debug] [MainThread]: On master: COMMIT
[0m08:52:26.035363 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.035794 [debug] [MainThread]: On master: COMMIT
[0m08:52:26.036301 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:26.037024 [debug] [MainThread]: On master: Close
[0m08:52:26.037824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:26.038263 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:26.038589 [debug] [MainThread]: Connection 'model.dbtcomp.staging_channels' was properly closed.
[0m08:52:26.038885 [info ] [MainThread]: 
[0m08:52:26.039271 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.26 seconds (15.26s).
[0m08:52:26.039964 [debug] [MainThread]: Command end result
[0m08:52:26.040393 [info ] [MainThread]: 
[0m08:52:26.041002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:26.041424 [info ] [MainThread]: 
[0m08:52:26.041768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:26.042521 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.738683, "process_user_time": 1.165577, "process_kernel_time": 0.085927, "process_mem_max_rss": "108584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:26.043173 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:26.043063 after 15.74 seconds
[0m08:52:26.043682 [debug] [MainThread]: Flushing usage events
[0m08:52:28.004657 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m08:52:28.006325 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:28.007061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:28.011690 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m08:52:28.013320 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:28.014587 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:28.017890 [debug] [MainThread]: On master: BEGIN
[0m08:52:28.018657 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:28.019868 [debug] [MainThread]: On master: COMMIT
[0m08:52:28.023650 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:28.024060 [debug] [MainThread]: On master: COMMIT
[0m08:52:28.024618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:28.024998 [debug] [MainThread]: On master: Close
[0m08:52:28.025511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:28.025944 [info ] [MainThread]: 
[0m08:52:28.033846 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_salesagent
[0m08:52:28.037619 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_salesagent ................................ [RUN]
[0m08:52:28.038474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_salesagent)
[0m08:52:28.038933 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_salesagent
[0m08:52:28.044490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_salesagent"
[0m08:52:28.057497 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_salesagent
[0m08:52:28.130961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_salesagent"
[0m08:52:28.134440 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:28.135998 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: BEGIN
[0m08:52:28.136558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:28.549795 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:28.554252 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:28.567617 | 4bd07d48-11ec-49c8-8c28-b979deac1fe9 ==============================
[0m08:52:28.567617 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:28.567007 | aeaaee82-e17d-4ed1-be67-687d1abe4616 ==============================
[0m08:52:28.567007 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:28.568889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_channel', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:28.571002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_channels', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:28.736519 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:28.738422 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:28.752196 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:28.756247 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:28.945351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:28.945935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:28.952055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:28.953015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:28.996601 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:28.997998 [info ] [MainThread]: 
[0m08:52:28.998629 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:29.000380 [debug] [MainThread]: Command end result
[0m08:52:29.000897 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:29.001649 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.49612743, "process_user_time": 1.003881, "process_kernel_time": 0.052411, "process_mem_max_rss": "97856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:29.002853 [info ] [MainThread]: 
[0m08:52:29.003569 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:29.003465 after 0.50 seconds
[0m08:52:29.004055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:29.004435 [debug] [MainThread]: Flushing usage events
[0m08:52:29.005179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:29.029256 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:29.030042 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:29.031130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:29.037883 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m08:52:29.039400 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:29.045088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:52:29.045852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:52:29.050712 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:29.052515 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:29.053469 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:29.061596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:29.059521 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:29.062344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:29.068466 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:52:29.069170 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:29.070796 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:29.073116 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m08:52:29.074239 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:29.074823 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:30.902594 [debug] [MainThread]: SQL status: BEGIN in 5.011 seconds
[0m08:52:30.914007 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:30.934039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:30.960936 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m08:52:30.963855 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:30.964505 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:30.964961 [debug] [MainThread]: On master: BEGIN
[0m08:52:30.965712 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:30.966305 [debug] [MainThread]: On master: COMMIT
[0m08:52:30.966833 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:30.967199 [debug] [MainThread]: On master: COMMIT
[0m08:52:30.967747 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:30.968261 [debug] [MainThread]: On master: Close
[0m08:52:30.968818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:30.970515 [info ] [MainThread]: 
[0m08:52:30.975540 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_product
[0m08:52:30.976119 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_product ................................ [RUN]
[0m08:52:30.976600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.staging_product)
[0m08:52:30.976929 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_product
[0m08:52:30.982345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_product"
[0m08:52:30.983634 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_product
[0m08:52:31.006468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_product"
[0m08:52:31.007654 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.008001 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: BEGIN
[0m08:52:31.008392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:31.012572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:31.013153 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.013556 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */

  create view "sales_dw"."dev"."staging_product__dbt_tmp"
    
    
  as (
    with products as (

SELECT  product_id, product_name, g.id as geography_key, product_price, row_number() over (partition by product_id order by e.loaded_timestamp desc ) as rn 
from "sales_dw"."dev"."src_products" e
join "sales_dw"."dev_raw"."geography" g on g.cityname = e.product_city

)

select product_id, product_name, geography_key, product_price::numeric AS product_price

from products

where rn = 1
  );
[0m08:52:31.015453 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:52:31.020347 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.020899 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
alter table "sales_dw"."dev"."staging_product__dbt_tmp" rename to "staging_product"
[0m08:52:31.021660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:31.030469 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:52:31.030952 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.031284 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: COMMIT
[0m08:52:31.032002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:31.036410 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_product__dbt_backup"
[0m08:52:31.039424 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_product"
[0m08:52:31.039840 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_product"} */
drop view if exists "sales_dw"."dev"."staging_product__dbt_backup" cascade
[0m08:52:31.040429 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:31.042184 [debug] [Thread-1 (]: On model.dbtcomp.staging_product: Close
[0m08:52:31.043510 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_product ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m08:52:31.044206 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_product
[0m08:52:31.045504 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:31.045999 [debug] [MainThread]: On master: BEGIN
[0m08:52:31.046448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:31.051132 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:31.051821 [debug] [MainThread]: On master: COMMIT
[0m08:52:31.052442 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:31.052955 [debug] [MainThread]: On master: COMMIT
[0m08:52:31.053564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:31.054001 [debug] [MainThread]: On master: Close
[0m08:52:31.054509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:31.055741 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:31.056114 [debug] [MainThread]: Connection 'model.dbtcomp.staging_product' was properly closed.
[0m08:52:31.056538 [info ] [MainThread]: 
[0m08:52:31.056929 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.26 seconds (15.26s).
[0m08:52:31.057542 [debug] [MainThread]: Command end result
[0m08:52:31.057898 [info ] [MainThread]: 
[0m08:52:31.058407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:31.058796 [info ] [MainThread]: 
[0m08:52:31.059176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:31.059933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.740901, "process_user_time": 1.136009, "process_kernel_time": 0.0908, "process_mem_max_rss": "106192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:31.060507 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:31.060441 after 15.74 seconds
[0m08:52:31.060891 [debug] [MainThread]: Flushing usage events
[0m08:52:32.511455 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:32.511460 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:32.515925 | ed0de2d2-4b37-45ed-8361-468cf9b441ae ==============================
[0m08:52:32.515925 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:32.515889 | 83f98b3c-1153-4d0f-bf86-891b266c23ae ==============================
[0m08:52:32.515889 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:32.516584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_product', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:32.516745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_product', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:32.642752 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:32.644439 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:32.653854 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:32.655587 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:32.840195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:32.840873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:32.854210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:32.854873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:32.886848 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:32.888201 [info ] [MainThread]: 
[0m08:52:32.888831 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:32.889576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:32.902490 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:32.903705 [info ] [MainThread]: 
[0m08:52:32.904140 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:32.905658 [debug] [MainThread]: Command end result
[0m08:52:32.906468 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4251155, "process_user_time": 0.966464, "process_kernel_time": 0.060028, "process_mem_max_rss": "97732", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:32.907026 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:32.906952 after 0.43 seconds
[0m08:52:32.907415 [debug] [MainThread]: Flushing usage events
[0m08:52:32.911557 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:32.912077 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:32.912633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:33.151714 [debug] [Thread-1 (]: SQL status: BEGIN in 5.015 seconds
[0m08:52:33.161154 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.172097 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */

  
    

  create  table "sales_dw"."dev"."dim_salesagent__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    reseller_id AS sales_agent_key,
    reseller_id AS original_reseller_id,
    reseller_name,
    commission_pct
FROM
    "sales_dw"."dev"."staging_resellers"
UNION ALL
SELECT
    0 AS sales_agent_key,
    NULL AS original_reseller_id,
    'Direct Sales' AS reseller_name,
    NULL AS commission_pct
  );
  
[0m08:52:33.206663 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.024 seconds
[0m08:52:33.211801 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.212459 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
alter table "sales_dw"."dev"."dim_salesagent__dbt_tmp" rename to "dim_salesagent"
[0m08:52:33.213185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:33.224595 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:52:33.225439 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.226081 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: COMMIT
[0m08:52:33.227133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:33.231545 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_salesagent__dbt_backup"
[0m08:52:33.234415 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_salesagent"
[0m08:52:33.234906 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_salesagent"} */
drop table if exists "sales_dw"."dev"."dim_salesagent__dbt_backup" cascade
[0m08:52:33.235590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:52:33.237595 [debug] [Thread-1 (]: On model.dbtcomp.dim_salesagent: Close
[0m08:52:33.239250 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_salesagent ........................... [[32mSELECT 5[0m in 5.20s]
[0m08:52:33.239937 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_salesagent
[0m08:52:33.241054 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:33.241524 [debug] [MainThread]: On master: BEGIN
[0m08:52:33.241919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:33.245746 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:52:33.246281 [debug] [MainThread]: On master: COMMIT
[0m08:52:33.246642 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:33.246949 [debug] [MainThread]: On master: COMMIT
[0m08:52:33.247327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:33.247694 [debug] [MainThread]: On master: Close
[0m08:52:33.248139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:33.248526 [debug] [MainThread]: Connection 'model.dbtcomp.dim_salesagent' was properly closed.
[0m08:52:33.248944 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:33.249362 [info ] [MainThread]: 
[0m08:52:33.249704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.39 seconds (20.39s).
[0m08:52:33.250204 [debug] [MainThread]: Command end result
[0m08:52:33.250514 [info ] [MainThread]: 
[0m08:52:33.250844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:33.251111 [info ] [MainThread]: 
[0m08:52:33.251392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:33.252216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.844524, "process_user_time": 1.185545, "process_kernel_time": 0.074727, "process_mem_max_rss": "108356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:33.252741 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:33.252678 after 20.85 seconds
[0m08:52:33.253126 [debug] [MainThread]: Flushing usage events
[0m08:52:34.071542 [debug] [ThreadPool]: SQL status: BEGIN in 5.009 seconds
[0m08:52:34.072267 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:34.072802 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:34.074894 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:34.076306 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:34.076960 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:34.080811 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:34.081347 [debug] [MainThread]: On master: BEGIN
[0m08:52:34.081784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:35.547305 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:35.552084 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:35.556395 | 7d641c8a-865a-4866-ad78-480d6b2ee92a ==============================
[0m08:52:35.556395 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:35.556773 | 4cf13838-e885-4841-a687-676430403612 ==============================
[0m08:52:35.556773 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:35.557319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_salesagent', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:35.557854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_customers', 'send_anonymous_usage_stats': 'True'}
[0m08:52:35.709236 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:35.718132 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:35.723157 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:35.734152 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:35.923620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:35.924249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:35.942369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:35.943041 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:35.970897 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:35.972135 [info ] [MainThread]: 
[0m08:52:35.972840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:35.974351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:35.998186 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:35.999353 [info ] [MainThread]: 
[0m08:52:35.999663 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:35.999935 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:36.000864 [debug] [MainThread]: Command end result
[0m08:52:36.001294 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:36.002007 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5500316, "process_user_time": 0.949932, "process_kernel_time": 0.066924, "process_mem_max_rss": "97452", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:36.002385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:36.002882 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:36.002791 after 0.55 seconds
[0m08:52:36.003756 [debug] [MainThread]: Flushing usage events
[0m08:52:37.922506 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.010 seconds
[0m08:52:37.926200 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:37.930104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:37.930569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:37.939287 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:37.941630 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:37.942182 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:37.942568 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:37.943155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:37.943834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:39.086492 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:52:39.088033 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.089713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:39.095196 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m08:52:39.096969 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:39.097617 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.098412 [debug] [MainThread]: On master: BEGIN
[0m08:52:39.099981 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:39.100596 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.102468 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.104448 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.105143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:39.105607 [debug] [MainThread]: On master: Close
[0m08:52:39.106244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:39.106692 [info ] [MainThread]: 
[0m08:52:39.111475 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_channel
[0m08:52:39.112148 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_channel ................................... [RUN]
[0m08:52:39.112784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_channel)
[0m08:52:39.113209 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_channel
[0m08:52:39.118988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_channel"
[0m08:52:39.120313 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_channel
[0m08:52:39.164276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_channel"
[0m08:52:39.166475 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.167776 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: BEGIN
[0m08:52:39.169264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:39.188757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m08:52:39.206005 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.218422 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */

  
    

  create  table "sales_dw"."dev"."dim_channel__dbt_tmp"
  
  
    as
  
  (
    


select channel_key, original_channel_id, channel_name
from "sales_dw"."dev"."staging_channels"
  );
  
[0m08:52:39.223884 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m08:52:39.234670 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.235217 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
alter table "sales_dw"."dev"."dim_channel__dbt_tmp" rename to "dim_channel"
[0m08:52:39.236452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:52:39.246520 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:52:39.247491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.248936 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: COMMIT
[0m08:52:39.251366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:52:39.260126 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_channel__dbt_backup"
[0m08:52:39.266571 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_channel"
[0m08:52:39.270492 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_channel"} */
drop table if exists "sales_dw"."dev"."dim_channel__dbt_backup" cascade
[0m08:52:39.271091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:52:39.273711 [debug] [Thread-1 (]: On model.dbtcomp.dim_channel: Close
[0m08:52:39.275049 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_channel .............................. [[32mSELECT 3[0m in 0.16s]
[0m08:52:39.275654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_channel
[0m08:52:39.276853 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.278931 [debug] [MainThread]: On master: BEGIN
[0m08:52:39.279793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:39.286979 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:52:39.287653 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.291084 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:39.291601 [debug] [MainThread]: On master: COMMIT
[0m08:52:39.292084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:39.292400 [debug] [MainThread]: On master: Close
[0m08:52:39.292948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:39.293379 [debug] [MainThread]: Connection 'model.dbtcomp.dim_channel' was properly closed.
[0m08:52:39.293731 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:39.294174 [info ] [MainThread]: 
[0m08:52:39.297151 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m08:52:39.298095 [debug] [MainThread]: Command end result
[0m08:52:39.298630 [info ] [MainThread]: 
[0m08:52:39.299050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:39.299442 [info ] [MainThread]: 
[0m08:52:39.299758 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:39.300439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.782278, "process_user_time": 1.127121, "process_kernel_time": 0.075413, "process_mem_max_rss": "108344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:39.300872 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:39.300815 after 10.78 seconds
[0m08:52:39.301202 [debug] [MainThread]: Flushing usage events
[0m08:52:41.007947 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.006 seconds
[0m08:52:41.009638 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:41.016594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:41.017174 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:41.021135 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:41.023240 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:41.026988 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:41.028847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:41.027503 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:41.029917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:41.034323 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:52:41.037288 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:52:41.045169 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:41.038678 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:41.060725 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:41.048239 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:41.065670 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:41.066888 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:41.067136 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m08:52:41.068260 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:41.067529 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:41.072733 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:41.083062 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.089566 [debug] [MainThread]: On master: BEGIN
[0m08:52:41.090264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:41.099627 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:52:41.100122 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.107897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:41.122823 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m08:52:41.125707 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:41.128558 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.130856 [debug] [MainThread]: On master: BEGIN
[0m08:52:41.131459 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:41.132000 [debug] [MainThread]: On master: COMMIT
[0m08:52:41.132398 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:41.132814 [debug] [MainThread]: On master: COMMIT
[0m08:52:41.133398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:41.133851 [debug] [MainThread]: On master: Close
[0m08:52:41.134371 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:41.134719 [info ] [MainThread]: 
[0m08:52:41.140195 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_customers
[0m08:52:41.140864 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.staging_customers .............................. [RUN]
[0m08:52:41.141384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_customers)
[0m08:52:41.144038 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_customers
[0m08:52:41.157850 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_customers"
[0m08:52:41.159180 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_customers
[0m08:52:41.181528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_customers"
[0m08:52:41.184497 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:41.187508 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: BEGIN
[0m08:52:41.187836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:41.600865 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:41.608541 | 9450df36-883e-4d18-9b7a-3f9178e54333 ==============================
[0m08:52:41.608541 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:41.609833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_channel', 'send_anonymous_usage_stats': 'True'}
[0m08:52:41.748824 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:41.766635 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:41.925469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:41.926160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:42.020731 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:42.022069 [info ] [MainThread]: 
[0m08:52:42.023637 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:42.027538 [debug] [MainThread]: Command end result
[0m08:52:42.030652 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.48244596, "process_user_time": 0.989695, "process_kernel_time": 0.066517, "process_mem_max_rss": "97716", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:42.031561 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:42.031477 after 0.48 seconds
[0m08:52:42.032365 [debug] [MainThread]: Flushing usage events
[0m08:52:42.959606 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m08:52:42.977996 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:42.978510 [debug] [ThreadPool]: SQL status: BEGIN in 5.035 seconds
[0m08:52:42.978859 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:42.982366 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:42.983201 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:42.984584 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:42.985757 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:42.986103 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m08:52:42.987933 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:42.986782 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:42.988576 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:42.993352 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:42.993905 [debug] [MainThread]: On master: BEGIN
[0m08:52:42.994406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:46.194452 [debug] [Thread-1 (]: SQL status: BEGIN in 5.007 seconds
[0m08:52:46.197731 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.198344 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */

  create view "sales_dw"."dev"."staging_customers__dbt_tmp"
    
    
  as (
    WITH 

customers_main AS (

    SELECT 
    
    customer_id, 
    first_name, 
    last_name, 
    email 
    
    
    FROM "sales_dw"."dev"."src_customers"

),

customers_xml AS (


    SELECT 
    customer_first_name, 
    customer_last_name, 
    customer_email,
    reseller_id,
    transaction_id
    
    FROM "sales_dw"."staging"."resellerxmlextracted"
), 

customers AS (



select reseller_id, transaction_id as customer_id, customer_first_name, customer_last_name, customer_email  from customers_xml

union

select 0 as reseller_id, customer_id, first_name, last_name, email  from customers_main
)

select 

  md5(cast(coalesce(cast(c.reseller_id as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) as customer_key,
 
 customer_first_name, 
 customer_last_name, 
 customer_email, 
 s.sales_agent_key

from customers c
left join "sales_dw"."dev"."dim_salesagent" s on c.reseller_id = s.original_reseller_id
  );
[0m08:52:46.200617 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:52:46.205256 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.205676 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
alter table "sales_dw"."dev"."staging_customers__dbt_tmp" rename to "staging_customers"
[0m08:52:46.206339 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:46.215165 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m08:52:46.215709 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.216014 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: COMMIT
[0m08:52:46.216861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:52:46.223629 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_customers__dbt_backup"
[0m08:52:46.226766 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_customers"
[0m08:52:46.227253 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_customers"} */
drop view if exists "sales_dw"."dev"."staging_customers__dbt_backup" cascade
[0m08:52:46.227908 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:52:46.229677 [debug] [Thread-1 (]: On model.dbtcomp.staging_customers: Close
[0m08:52:46.231291 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.staging_customers ......................... [[32mCREATE VIEW[0m in 5.09s]
[0m08:52:46.231959 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_customers
[0m08:52:46.233054 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:46.233537 [debug] [MainThread]: On master: BEGIN
[0m08:52:46.233893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:46.244309 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m08:52:46.246102 [debug] [MainThread]: On master: COMMIT
[0m08:52:46.247825 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:46.248170 [debug] [MainThread]: On master: COMMIT
[0m08:52:46.248559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:46.249430 [debug] [MainThread]: On master: Close
[0m08:52:46.249863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:46.251485 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:46.256746 [debug] [MainThread]: Connection 'model.dbtcomp.staging_customers' was properly closed.
[0m08:52:46.257291 [info ] [MainThread]: 
[0m08:52:46.257713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m08:52:46.269167 [debug] [MainThread]: Command end result
[0m08:52:46.283575 [info ] [MainThread]: 
[0m08:52:46.292763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:46.296965 [info ] [MainThread]: 
[0m08:52:46.301420 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:46.302252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.82806, "process_user_time": 1.121846, "process_kernel_time": 0.060859, "process_mem_max_rss": "108232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:46.302788 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:46.302727 after 10.83 seconds
[0m08:52:46.303141 [debug] [MainThread]: Flushing usage events
[0m08:52:48.001608 [debug] [MainThread]: SQL status: BEGIN in 5.010 seconds
[0m08:52:48.004029 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.007740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:48.014431 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m08:52:48.016722 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:48.022994 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.023418 [debug] [MainThread]: On master: BEGIN
[0m08:52:48.026498 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:48.028227 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.030599 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.032065 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.033992 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:48.035058 [debug] [MainThread]: On master: Close
[0m08:52:48.036882 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:48.038414 [info ] [MainThread]: 
[0m08:52:48.045931 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_product
[0m08:52:48.048857 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_product ................................... [RUN]
[0m08:52:48.049696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.dim_product)
[0m08:52:48.050284 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_product
[0m08:52:48.056330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_product"
[0m08:52:48.057809 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_product
[0m08:52:48.084341 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_product"
[0m08:52:48.085776 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.086259 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: BEGIN
[0m08:52:48.086598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:48.091016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:48.091552 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.095140 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */

  
    

  create  table "sales_dw"."dev"."dim_product__dbt_tmp"
  
  
    as
  
  (
    


select product_id as product_key, product_id as original_product_id, product_name, geography_key , product_price


FROM "sales_dw"."dev"."staging_product"
  );
  
[0m08:52:48.103289 [debug] [Thread-1 (]: SQL status: SELECT 1980 in 0.008 seconds
[0m08:52:48.111612 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.113536 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
alter table "sales_dw"."dev"."dim_product__dbt_tmp" rename to "dim_product"
[0m08:52:48.114471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:48.126706 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:52:48.127429 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.127929 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: COMMIT
[0m08:52:48.131446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:52:48.136289 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_product__dbt_backup"
[0m08:52:48.139062 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_product"
[0m08:52:48.139496 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_product"} */
drop table if exists "sales_dw"."dev"."dim_product__dbt_backup" cascade
[0m08:52:48.140708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:52:48.142478 [debug] [Thread-1 (]: On model.dbtcomp.dim_product: Close
[0m08:52:48.146183 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_product .............................. [[32mSELECT 1980[0m in 0.10s]
[0m08:52:48.148222 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_product
[0m08:52:48.149486 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.150228 [debug] [MainThread]: On master: BEGIN
[0m08:52:48.152168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:48.157244 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:52:48.163778 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.164188 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:48.164502 [debug] [MainThread]: On master: COMMIT
[0m08:52:48.165039 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:48.165460 [debug] [MainThread]: On master: Close
[0m08:52:48.165922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:48.166250 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:52:48.166540 [debug] [MainThread]: Connection 'model.dbtcomp.dim_product' was properly closed.
[0m08:52:48.167254 [info ] [MainThread]: 
[0m08:52:48.167761 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.28 seconds (15.28s).
[0m08:52:48.168586 [debug] [MainThread]: Command end result
[0m08:52:48.168997 [info ] [MainThread]: 
[0m08:52:48.169425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:48.169782 [info ] [MainThread]: 
[0m08:52:48.170287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:48.171099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.691328, "process_user_time": 1.107276, "process_kernel_time": 0.060839, "process_mem_max_rss": "108680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:48.171630 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:48.171552 after 15.69 seconds
[0m08:52:48.172024 [debug] [MainThread]: Flushing usage events
[0m08:52:48.731684 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:48.736658 | 87cb58d6-b180-41e6-a3f6-2f81624af051 ==============================
[0m08:52:48.736658 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:48.737651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:48.756483 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:48.762206 | 5d50dec7-314c-469c-a41c-2fa3efb4ffd3 ==============================
[0m08:52:48.762206 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:48.765109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models dim_customer', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:48.924950 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:48.932692 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:48.939818 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:48.951534 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:49.109878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:49.114129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:49.120243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:49.122853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:49.163651 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:49.165845 [info ] [MainThread]: 
[0m08:52:49.166701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:49.170389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:49.186782 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:49.188110 [info ] [MainThread]: 
[0m08:52:49.188525 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:49.189912 [debug] [MainThread]: Command end result
[0m08:52:49.190659 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50067466, "process_user_time": 1.008505, "process_kernel_time": 0.071106, "process_mem_max_rss": "97328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:49.191221 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:49.191150 after 0.50 seconds
[0m08:52:49.191714 [debug] [MainThread]: Flushing usage events
[0m08:52:49.195072 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:49.196960 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:49.197487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:49.205935 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m08:52:49.207254 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:49.211261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:49.211772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:49.216005 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:49.218256 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:49.218877 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:49.219304 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:49.219666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:49.220221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:49.225679 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:52:49.226926 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:49.227401 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:49.229948 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m08:52:49.231147 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:49.231785 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:50.657713 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:50.663043 | 46a62866-4a89-4b2b-8a6c-2eb7a0398529 ==============================
[0m08:52:50.663043 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:50.663660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_product', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:50.787062 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:50.832725 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:50.953847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:50.954342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:51.008974 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:51.011249 [info ] [MainThread]: 
[0m08:52:51.012074 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:51.014124 [debug] [MainThread]: Command end result
[0m08:52:51.014835 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.38641712, "process_user_time": 0.993445, "process_kernel_time": 0.052128, "process_mem_max_rss": "97096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:51.015425 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:51.015343 after 0.39 seconds
[0m08:52:51.015851 [debug] [MainThread]: Flushing usage events
[0m08:52:54.225269 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:52:54.227627 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:54.228154 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:54.230971 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:54.232430 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:54.233043 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:54.236985 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.237602 [debug] [MainThread]: On master: BEGIN
[0m08:52:54.238245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:54.242265 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:52:54.242751 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.243270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:54.248479 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:52:54.250933 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:54.251727 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.252375 [debug] [MainThread]: On master: BEGIN
[0m08:52:54.253030 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:54.253726 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.254093 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:54.254387 [debug] [MainThread]: On master: COMMIT
[0m08:52:54.254812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:54.255315 [debug] [MainThread]: On master: Close
[0m08:52:54.255862 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:54.256250 [info ] [MainThread]: 
[0m08:52:54.265561 [debug] [Thread-1 (]: Began running node model.dbtcomp.dim_customer
[0m08:52:54.269242 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.dim_customer .................................. [RUN]
[0m08:52:54.269997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.dim_customer)
[0m08:52:54.270546 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.dim_customer
[0m08:52:54.276376 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.dim_customer"
[0m08:52:54.277673 [debug] [Thread-1 (]: Began executing node model.dbtcomp.dim_customer
[0m08:52:54.304118 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.dim_customer"
[0m08:52:54.305491 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:54.306024 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: BEGIN
[0m08:52:54.306450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:54.310694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:52:54.311303 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:54.311890 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */

  
    

  create  table "sales_dw"."dev"."dim_customer__dbt_tmp"
  
  
    as
  
  (
    

select customer_key, customer_first_name, customer_last_name, customer_email, sales_agent_key
from "sales_dw"."dev"."staging_customers"
  );
  
[0m08:52:55.424488 [debug] [Thread-1 (]: SQL status: SELECT 259565 in 1.112 seconds
[0m08:52:55.431008 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:55.432450 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
alter table "sales_dw"."dev"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m08:52:55.433800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:52:55.445790 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m08:52:55.446467 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:55.446833 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: COMMIT
[0m08:52:55.453862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m08:52:55.458370 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."dim_customer__dbt_backup"
[0m08:52:55.463891 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.dim_customer"
[0m08:52:55.465039 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.dim_customer"} */
drop table if exists "sales_dw"."dev"."dim_customer__dbt_backup" cascade
[0m08:52:55.468180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m08:52:55.471233 [debug] [Thread-1 (]: On model.dbtcomp.dim_customer: Close
[0m08:52:55.473210 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.dim_customer ............................. [[32mSELECT 259565[0m in 1.20s]
[0m08:52:55.474464 [debug] [Thread-1 (]: Finished running node model.dbtcomp.dim_customer
[0m08:52:55.476870 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.477625 [debug] [MainThread]: On master: BEGIN
[0m08:52:55.483022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:55.500394 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m08:52:55.500987 [debug] [MainThread]: On master: COMMIT
[0m08:52:55.501312 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:55.501639 [debug] [MainThread]: On master: COMMIT
[0m08:52:55.505568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:55.513869 [debug] [MainThread]: On master: Close
[0m08:52:55.522266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:55.535020 [debug] [MainThread]: Connection 'model.dbtcomp.dim_customer' was properly closed.
[0m08:52:55.535498 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:52:55.535842 [info ] [MainThread]: 
[0m08:52:55.536193 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m08:52:55.536698 [debug] [MainThread]: Command end result
[0m08:52:55.549176 [info ] [MainThread]: 
[0m08:52:55.556279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:55.566346 [info ] [MainThread]: 
[0m08:52:55.568123 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:55.568791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8559675, "process_user_time": 1.161541, "process_kernel_time": 0.078249, "process_mem_max_rss": "108532", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:55.569313 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:55.569242 after 6.86 seconds
[0m08:52:55.569644 [debug] [MainThread]: Flushing usage events
[0m08:52:57.719633 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:57.725988 | a6272302-24a8-4d18-a1ed-1e303f687577 ==============================
[0m08:52:57.725988 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:57.727731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_resellers_xml', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:57.729325 [debug] [MainThread]: Got an exception trying to initialize tracking
[0m08:52:57.729758 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:52:57.735725 | 7ad2674c-6814-46d5-887c-826962bb9bf3 ==============================
[0m08:52:57.735725 [info ] [MainThread]: Running with dbt=1.8.2


============================== 08:52:57.735876 | b238c5ba-5870-4850-9fff-5ee59f6bd1ce ==============================
[0m08:52:57.735876 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:52:57.737394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions_main', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:57.737744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models dim_customer', 'send_anonymous_usage_stats': 'True'}
[0m08:52:57.890022 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:57.905919 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:57.917128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:57.930287 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:52:57.933084 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:57.947008 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:52:58.070585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:58.071244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:58.089230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:58.089995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:58.101865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:58.102387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:58.135609 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:58.138292 [info ] [MainThread]: 
[0m08:52:58.139818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:58.140665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:58.145017 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:58.148342 [info ] [MainThread]: 
[0m08:52:58.152627 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:52:58.152256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:58.153715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:52:58.153991 [info ] [MainThread]: 
[0m08:52:58.154457 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:52:58.155862 [debug] [MainThread]: Command end result
[0m08:52:58.156673 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4584398, "process_user_time": 0.989345, "process_kernel_time": 0.060959, "process_mem_max_rss": "97316", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:52:58.157392 [debug] [MainThread]: Command `dbt test` succeeded at 08:52:58.157274 after 0.46 seconds
[0m08:52:58.157845 [debug] [MainThread]: Flushing usage events
[0m08:52:58.167801 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:58.168469 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:58.169023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:58.174868 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m08:52:58.176421 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:52:58.177565 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:52:58.178127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:58.178061 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:52:58.183301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:52:58.183909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:52:58.191609 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:58.193513 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:58.196342 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:52:58.197493 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:52:58.198443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:58.199376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:58.209827 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:52:58.211249 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:52:58.210799 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m08:52:58.229233 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:52:58.230841 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:52:58.215326 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:52:58.238973 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:52:58.245607 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m08:52:58.248836 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:52:58.265021 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:52:58.252844 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:52:58.269167 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:52:58.282181 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:58.282728 [debug] [MainThread]: On master: BEGIN
[0m08:52:58.283085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:03.190316 [debug] [ThreadPool]: SQL status: SELECT 10 in 5.012 seconds
[0m08:53:03.196516 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:53:03.203288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:53:03.203866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:53:03.208328 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:03.210109 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:03.210595 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:03.210988 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:03.211352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:03.211683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:03.216198 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:53:03.216742 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:53:03.217007 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:03.217665 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:03.218126 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:03.218695 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:03.221008 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:53:03.221294 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m08:53:03.222220 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:03.223222 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:03.223713 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:03.224135 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:03.229791 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.230356 [debug] [MainThread]: On master: BEGIN
[0m08:53:03.230668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:03.291855 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m08:53:03.292541 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.293040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:03.297666 [debug] [MainThread]: SQL status: SELECT 12 in 0.004 seconds
[0m08:53:03.299586 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:03.300151 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.300658 [debug] [MainThread]: On master: BEGIN
[0m08:53:03.301410 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:03.302050 [debug] [MainThread]: On master: COMMIT
[0m08:53:03.302553 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:03.302864 [debug] [MainThread]: On master: COMMIT
[0m08:53:03.303277 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:03.303591 [debug] [MainThread]: On master: Close
[0m08:53:03.304029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:03.304436 [info ] [MainThread]: 
[0m08:53:03.309237 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:03.309821 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_resellers_xml ...... [RUN]
[0m08:53:03.310323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_resellers_xml)
[0m08:53:03.310832 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:03.326558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:03.327964 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:03.363723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:03.373186 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:03.374747 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: BEGIN
[0m08:53:03.375087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:08.244226 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m08:53:08.249469 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:08.252552 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:08.273076 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:08.278377 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:08.279067 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:08.279429 [debug] [MainThread]: On master: BEGIN
[0m08:53:08.280004 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:08.280413 [debug] [MainThread]: On master: COMMIT
[0m08:53:08.280987 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:08.284035 [debug] [MainThread]: On master: COMMIT
[0m08:53:08.285038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:08.285967 [debug] [MainThread]: On master: Close
[0m08:53:08.289465 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:08.290014 [info ] [MainThread]: 
[0m08:53:08.295088 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions_main
[0m08:53:08.295761 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dev.staging_transactions_main ............... [RUN]
[0m08:53:08.296336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions_main)
[0m08:53:08.296905 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions_main
[0m08:53:08.312979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions_main"
[0m08:53:08.314548 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions_main
[0m08:53:08.348272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions_main"
[0m08:53:08.352266 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m08:53:08.352777 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: BEGIN
[0m08:53:08.353198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:08.384311 [debug] [Thread-1 (]: SQL status: BEGIN in 5.009 seconds
[0m08:53:08.384966 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:08.385423 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_resellers_xml"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_resellers_xml"
  
  
    as
  
  (
    

WITH 



trans_xml AS (
  SELECT
    md5(cast(coalesce(cast(reseller_id as TEXT), '') || '-' || coalesce(cast(transaction_id as TEXT), '') as TEXT)) AS customer_key,
    reseller_id,
    transaction_id,
    product_name,
    total_amount,
    no_purchased_postcards,
    date_bought,
    sales_channel,
    office_location,
    loaded_timestamp
  FROM
    "sales_dw"."staging"."resellerxmlextracted"


  

)
SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  t.reseller_id,
  to_char(
    date_bought,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  total_amount::numeric,
  no_purchased_postcards,
  e.product_price::numeric,
  e.geography_key,
  s.commission_pct * total_amount::numeric AS commisionpaid,
  s.commission_pct,
  loaded_timestamp
FROM
  trans_xml t
  JOIN "sales_dw"."dev"."dim_product"
  e
  ON t.product_name = e.product_name
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.sales_channel = C.channel_name
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  JOIN "sales_dw"."dev"."dim_salesagent"
  s
  ON t.reseller_id = s.original_reseller_id
  );
  
  
[0m08:53:09.652358 [debug] [Thread-1 (]: SQL status: SELECT 159565 in 1.266 seconds
[0m08:53:09.664144 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m08:53:09.664722 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_resellers_xml"
[0m08:53:09.665059 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: COMMIT
[0m08:53:09.683038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m08:53:09.684562 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_resellers_xml: Close
[0m08:53:09.685919 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_resellers_xml . [[32mSELECT 159565[0m in 6.37s]
[0m08:53:09.686564 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_resellers_xml
[0m08:53:09.687767 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:09.688191 [debug] [MainThread]: On master: BEGIN
[0m08:53:09.688470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:09.693073 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:53:09.693707 [debug] [MainThread]: On master: COMMIT
[0m08:53:09.694121 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:09.694589 [debug] [MainThread]: On master: COMMIT
[0m08:53:09.695164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:09.695743 [debug] [MainThread]: On master: Close
[0m08:53:09.696322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:09.696691 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:09.697146 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_resellers_xml' was properly closed.
[0m08:53:09.697571 [info ] [MainThread]: 
[0m08:53:09.697989 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 11.56 seconds (11.56s).
[0m08:53:09.698683 [debug] [MainThread]: Command end result
[0m08:53:09.699091 [info ] [MainThread]: 
[0m08:53:09.699562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:09.700022 [info ] [MainThread]: 
[0m08:53:09.700452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:09.701228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.016149, "process_user_time": 1.151426, "process_kernel_time": 0.060495, "process_mem_max_rss": "106932", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:09.701890 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:09.701768 after 12.02 seconds
[0m08:53:09.702330 [debug] [MainThread]: Flushing usage events
[0m08:53:11.897347 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:11.902078 | 77a16e79-fcf9-4f86-80ca-a374149f1417 ==============================
[0m08:53:11.902078 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:11.904160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'log_path': '/usr/local/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_resellers_xml', 'send_anonymous_usage_stats': 'True'}
[0m08:53:12.044384 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:12.092378 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:12.269074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:12.269686 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:12.328097 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:12.329747 [info ] [MainThread]: 
[0m08:53:12.330275 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:53:12.331853 [debug] [MainThread]: Command end result
[0m08:53:12.332591 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.46872792, "process_user_time": 1.060409, "process_kernel_time": 0.064609, "process_mem_max_rss": "97472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:12.333294 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:12.333177 after 0.47 seconds
[0m08:53:12.335186 [debug] [MainThread]: Flushing usage events
[0m08:53:13.357232 [debug] [Thread-1 (]: SQL status: BEGIN in 5.004 seconds
[0m08:53:13.359989 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m08:53:13.360776 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions_main"} */

      
  
    

  create  table "sales_dw"."dev"."staging_transactions_main"
  
  
    as
  
  (
    


WITH 

  

trans_main AS (
  SELECT
    md5(cast(coalesce(cast(0 as TEXT), '') || '-' || coalesce(cast(customer_id as TEXT), '') as TEXT)) AS customer_key,
    customer_id,
    transaction_id,
    product_id,
    amount,
    qty,
    channel_id,
    bought_date,
    loaded_timestamp
  FROM
    "sales_dw"."import"."transactions"

  

)

SELECT
  t.customer_key,
  transaction_id,
  e.product_key,
  C.channel_key,
  0 AS reseller_id,
  to_char(
    bought_date,
    'YYYYMMDD'
  ) :: INT AS bought_date_key,
  amount::numeric AS total_amount,
  qty,
  e.product_price::numeric,
  e.geography_key,
  NULL::numeric AS commissionpaid,
  NULL::numeric AS commissionpct,
  loaded_timestamp


FROM
  trans_main t
  JOIN "sales_dw"."dev"."dim_product" e
  ON t.product_id = e.product_key
  JOIN "sales_dw"."dev"."dim_channel" C
  ON t.channel_id = C.channel_key
  JOIN "sales_dw"."dev"."dim_customer"
  cu
  ON t.customer_key = cu.customer_key
  );
  
  
[0m08:53:18.301740 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 4.939 seconds
[0m08:53:18.312770 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m08:53:18.313529 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions_main"
[0m08:53:18.316603 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: COMMIT
[0m08:53:18.323801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m08:53:18.329735 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions_main: Close
[0m08:53:18.331269 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dev.staging_transactions_main .......... [[32mSELECT 1000000[0m in 10.03s]
[0m08:53:18.331905 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions_main
[0m08:53:18.334609 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:18.335172 [debug] [MainThread]: On master: BEGIN
[0m08:53:18.335533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:18.341311 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:53:18.346762 [debug] [MainThread]: On master: COMMIT
[0m08:53:18.347119 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:18.347416 [debug] [MainThread]: On master: COMMIT
[0m08:53:18.348001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:18.348427 [debug] [MainThread]: On master: Close
[0m08:53:18.348812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:18.349073 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions_main' was properly closed.
[0m08:53:18.350112 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:18.352068 [info ] [MainThread]: 
[0m08:53:18.352518 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 20.20 seconds (20.20s).
[0m08:53:18.355993 [debug] [MainThread]: Command end result
[0m08:53:18.356373 [info ] [MainThread]: 
[0m08:53:18.356777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:18.359012 [info ] [MainThread]: 
[0m08:53:18.359371 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:18.360124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.660213, "process_user_time": 1.108354, "process_kernel_time": 0.077024, "process_mem_max_rss": "106948", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:18.360743 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:18.360642 after 20.66 seconds
[0m08:53:18.361168 [debug] [MainThread]: Flushing usage events
[0m08:53:19.863148 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:19.867460 | 683a7d1e-c411-4c4c-8c19-bb44dd3f6337 ==============================
[0m08:53:19.867460 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:19.867976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json run --target dev --models staging_transactions', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:53:19.888100 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:19.894659 | f57f0280-71ce-42c5-b038-982ec158e7fc ==============================
[0m08:53:19.894659 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:19.895996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions_main', 'send_anonymous_usage_stats': 'True'}
[0m08:53:20.000095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:20.014336 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:20.031324 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:20.045882 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:20.170177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:20.170810 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:20.189889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:20.190462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:20.228350 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:20.231520 [info ] [MainThread]: 
[0m08:53:20.238162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:53:20.242899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:53:20.256121 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:20.257313 [info ] [MainThread]: 
[0m08:53:20.265267 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:53:20.281531 [debug] [MainThread]: Command end result
[0m08:53:20.281345 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:53:20.282390 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44837013, "process_user_time": 0.999615, "process_kernel_time": 0.055534, "process_mem_max_rss": "97904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:20.282936 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:20.282874 after 0.45 seconds
[0m08:53:20.282527 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:53:20.286341 [debug] [MainThread]: Flushing usage events
[0m08:53:20.287058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:20.303307 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m08:53:20.307426 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:53:20.316556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev_raw)
[0m08:53:20.317315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:53:20.322021 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:20.324216 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:20.325407 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:20.326015 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:20.326503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:20.326989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:25.332950 [debug] [ThreadPool]: SQL status: BEGIN in 5.006 seconds
[0m08:53:25.336988 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:53:25.341118 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:25.340494 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:25.342081 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:25.342607 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:25.346629 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m08:53:25.346952 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.002 seconds
[0m08:53:25.348114 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:25.349460 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:25.350094 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:25.350430 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:25.356834 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:25.357311 [debug] [MainThread]: On master: BEGIN
[0m08:53:25.357705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:30.362481 [debug] [MainThread]: SQL status: BEGIN in 5.005 seconds
[0m08:53:30.364862 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:30.365472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:30.371924 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:30.376974 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:30.377496 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:30.377863 [debug] [MainThread]: On master: BEGIN
[0m08:53:30.378444 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:30.381757 [debug] [MainThread]: On master: COMMIT
[0m08:53:30.382346 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:30.382884 [debug] [MainThread]: On master: COMMIT
[0m08:53:30.383426 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:30.383784 [debug] [MainThread]: On master: Close
[0m08:53:30.384285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:30.384766 [info ] [MainThread]: 
[0m08:53:30.389856 [debug] [Thread-1 (]: Began running node model.dbtcomp.staging_transactions
[0m08:53:30.390561 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging_transactions .......................... [RUN]
[0m08:53:30.391056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now model.dbtcomp.staging_transactions)
[0m08:53:30.391791 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.staging_transactions
[0m08:53:30.397898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.staging_transactions"
[0m08:53:30.399095 [debug] [Thread-1 (]: Began executing node model.dbtcomp.staging_transactions
[0m08:53:30.425065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.staging_transactions"
[0m08:53:30.429711 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:30.430133 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: BEGIN
[0m08:53:30.430484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:30.434612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:53:30.435159 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:30.435480 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */

  
    

  create  table "sales_dw"."dev"."staging_transactions__dbt_tmp"
  
  
    as
  
  (
    


SELECT * FROM "sales_dw"."dev"."staging_transactions_main"

UNION ALL

SELECT * FROM "sales_dw"."dev"."staging_transactions_resellers_xml"
  );
  
[0m08:53:31.277472 [debug] [Thread-1 (]: SQL status: SELECT 1159565 in 0.842 seconds
[0m08:53:31.288845 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:31.289350 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
alter table "sales_dw"."dev"."staging_transactions__dbt_tmp" rename to "staging_transactions"
[0m08:53:31.297056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:53:31.307037 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m08:53:31.307517 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:31.307867 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: COMMIT
[0m08:53:31.315406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m08:53:31.320257 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."staging_transactions__dbt_backup"
[0m08:53:31.325086 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.staging_transactions"
[0m08:53:31.325501 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.staging_transactions"} */
drop table if exists "sales_dw"."dev"."staging_transactions__dbt_backup" cascade
[0m08:53:31.325967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:53:31.327601 [debug] [Thread-1 (]: On model.dbtcomp.staging_transactions: Close
[0m08:53:31.328952 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging_transactions ..................... [[32mSELECT 1159565[0m in 0.94s]
[0m08:53:31.329576 [debug] [Thread-1 (]: Finished running node model.dbtcomp.staging_transactions
[0m08:53:31.330796 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:31.333429 [debug] [MainThread]: On master: BEGIN
[0m08:53:31.333919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:31.339255 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:53:31.339924 [debug] [MainThread]: On master: COMMIT
[0m08:53:31.340376 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:31.340683 [debug] [MainThread]: On master: COMMIT
[0m08:53:31.341114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:31.341579 [debug] [MainThread]: On master: Close
[0m08:53:31.342328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:31.343374 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:31.344235 [debug] [MainThread]: Connection 'model.dbtcomp.staging_transactions' was properly closed.
[0m08:53:31.344702 [info ] [MainThread]: 
[0m08:53:31.350309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.11 seconds (11.11s).
[0m08:53:31.351124 [debug] [MainThread]: Command end result
[0m08:53:31.354268 [info ] [MainThread]: 
[0m08:53:31.355226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:31.358648 [info ] [MainThread]: 
[0m08:53:31.359379 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:31.360271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.556844, "process_user_time": 1.126689, "process_kernel_time": 0.069856, "process_mem_max_rss": "106704", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:31.362245 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:31.362155 after 11.56 seconds
[0m08:53:31.362688 [debug] [MainThread]: Flushing usage events
[0m08:53:32.991685 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:32.996325 | 7f9c5985-362b-4fb5-afbc-e6b248c9e4d2 ==============================
[0m08:53:32.996325 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:32.996984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json run --target dev --models fact_sales', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:53:33.016137 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:33.020719 | 0fa62556-5509-4266-90f5-1f58dcb040bd ==============================
[0m08:53:33.020719 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:33.021270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt --no-write-json test --target dev --models staging_transactions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:53:33.129805 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:33.146812 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:33.153782 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:33.164947 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:33.390244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:33.391282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:33.392786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:33.393906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:33.438061 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:33.439347 [info ] [MainThread]: 
[0m08:53:33.441518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:53:33.442312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw'
[0m08:53:33.449598 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:33.451085 [info ] [MainThread]: 
[0m08:53:33.451633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:53:33.453123 [debug] [MainThread]: Command end result
[0m08:53:33.453878 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.47780925, "process_user_time": 0.96405, "process_kernel_time": 0.070076, "process_mem_max_rss": "97328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:33.454388 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:33.454325 after 0.48 seconds
[0m08:53:33.454862 [debug] [MainThread]: Flushing usage events
[0m08:53:33.466871 [debug] [ThreadPool]: Using postgres connection "list_sales_dw"
[0m08:53:33.467479 [debug] [ThreadPool]: On list_sales_dw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw"} */

    select distinct nspname from pg_namespace
  
[0m08:53:33.467902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:33.473359 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m08:53:33.474294 [debug] [ThreadPool]: On list_sales_dw: Close
[0m08:53:33.477795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sales_dw, now list_sales_dw_dev)
[0m08:53:33.478360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:53:33.483057 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:33.484649 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:33.485027 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:33.485334 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:33.485775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:53:33.486350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:33.491726 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m08:53:33.492341 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:33.492817 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:33.494989 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m08:53:33.496299 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:33.496849 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:38.491420 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:53:38.492334 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:38.492746 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:38.495074 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:53:38.496344 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:38.496901 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:38.500997 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:38.501577 [debug] [MainThread]: On master: BEGIN
[0m08:53:38.501985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:43.506113 [debug] [MainThread]: SQL status: BEGIN in 5.004 seconds
[0m08:53:43.509674 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:43.510128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:43.515512 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:43.519406 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:43.520315 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:43.520778 [debug] [MainThread]: On master: BEGIN
[0m08:53:43.522806 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:43.523415 [debug] [MainThread]: On master: COMMIT
[0m08:53:43.523890 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:43.524434 [debug] [MainThread]: On master: COMMIT
[0m08:53:43.525389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:43.527037 [debug] [MainThread]: On master: Close
[0m08:53:43.530961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:43.531465 [info ] [MainThread]: 
[0m08:53:43.537175 [debug] [Thread-1 (]: Began running node model.dbtcomp.fact_sales
[0m08:53:43.537898 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.fact_sales .................................... [RUN]
[0m08:53:43.538410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev_raw, now model.dbtcomp.fact_sales)
[0m08:53:43.539035 [debug] [Thread-1 (]: Began compiling node model.dbtcomp.fact_sales
[0m08:53:43.545159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtcomp.fact_sales"
[0m08:53:43.546811 [debug] [Thread-1 (]: Began executing node model.dbtcomp.fact_sales
[0m08:53:43.572348 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtcomp.fact_sales"
[0m08:53:43.575270 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:43.575954 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: BEGIN
[0m08:53:43.584828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:43.589388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:53:43.589924 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:43.591281 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */

  
    

  create  table "sales_dw"."dev"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    customer_key,
    transaction_id,
    product_key,
    channel_key,
    reseller_id,
    bought_date_key,
    geography_key,
    total_amount,
    qty,
    commissionpct,
    commissionpaid,
    product_price
FROM
    "sales_dw"."dev"."staging_transactions"
  );
  
[0m08:53:44.839798 [debug] [Thread-1 (]: SQL status: SELECT 1159565 in 1.246 seconds
[0m08:53:44.853712 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:44.854376 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
alter table "sales_dw"."dev"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m08:53:44.855243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:53:44.869046 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m08:53:44.869657 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:44.870051 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: COMMIT
[0m08:53:44.873533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:53:44.880625 [debug] [Thread-1 (]: Applying DROP to: "sales_dw"."dev"."fact_sales__dbt_backup"
[0m08:53:44.883799 [debug] [Thread-1 (]: Using postgres connection "model.dbtcomp.fact_sales"
[0m08:53:44.884922 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "model.dbtcomp.fact_sales"} */
drop table if exists "sales_dw"."dev"."fact_sales__dbt_backup" cascade
[0m08:53:44.886163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:53:44.888908 [debug] [Thread-1 (]: On model.dbtcomp.fact_sales: Close
[0m08:53:44.891836 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.fact_sales ............................... [[32mSELECT 1159565[0m in 1.35s]
[0m08:53:44.892654 [debug] [Thread-1 (]: Finished running node model.dbtcomp.fact_sales
[0m08:53:44.893836 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:44.894221 [debug] [MainThread]: On master: BEGIN
[0m08:53:44.894529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:44.903300 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:53:44.903993 [debug] [MainThread]: On master: COMMIT
[0m08:53:44.904382 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:44.904656 [debug] [MainThread]: On master: COMMIT
[0m08:53:44.905294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:44.905707 [debug] [MainThread]: On master: Close
[0m08:53:44.906132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:44.906574 [debug] [MainThread]: Connection 'list_sales_dw_dev' was properly closed.
[0m08:53:44.907048 [debug] [MainThread]: Connection 'model.dbtcomp.fact_sales' was properly closed.
[0m08:53:44.907426 [info ] [MainThread]: 
[0m08:53:44.907768 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m08:53:44.908323 [debug] [MainThread]: Command end result
[0m08:53:44.908591 [info ] [MainThread]: 
[0m08:53:44.908941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:44.909226 [info ] [MainThread]: 
[0m08:53:44.909516 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:44.910223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.952638, "process_user_time": 1.083116, "process_kernel_time": 0.081763, "process_mem_max_rss": "106552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:44.910688 [debug] [MainThread]: Command `dbt run` succeeded at 08:53:44.910613 after 11.95 seconds
[0m08:53:44.911062 [debug] [MainThread]: Flushing usage events
[0m08:53:47.182365 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:53:47.186654 | f2a97572-e692-4ced-87d9-d8a72d91a372 ==============================
[0m08:53:47.186654 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:53:47.187425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt --no-write-json test --target dev --models fact_sales', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:53:47.321384 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:53:47.400384 [debug] [MainThread]: checksum: 653514bb72edc871e4e17aa6d7f8b1b0c7572de7cff8697d014b18656695cc44, vars: {}, profile: , target: dev, version: 1.8.2
[0m08:53:47.564076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:53:47.564758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:53:47.619023 [info ] [MainThread]: Found 19 models, 1 test, 1 seed, 6 sources, 531 macros
[0m08:53:47.620580 [info ] [MainThread]: 
[0m08:53:47.621282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:53:47.625165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev_raw'
[0m08:53:47.625864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_dw_dev'
[0m08:53:47.662435 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:47.662839 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:47.663648 [debug] [ThreadPool]: On list_sales_dw_dev_raw: BEGIN
[0m08:53:47.664083 [debug] [ThreadPool]: On list_sales_dw_dev: BEGIN
[0m08:53:47.664477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:47.664861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:52.669916 [debug] [ThreadPool]: SQL status: BEGIN in 5.005 seconds
[0m08:53:52.674416 [debug] [ThreadPool]: SQL status: BEGIN in 5.010 seconds
[0m08:53:52.675945 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev"
[0m08:53:52.675405 [debug] [ThreadPool]: Using postgres connection "list_sales_dw_dev_raw"
[0m08:53:52.676398 [debug] [ThreadPool]: On list_sales_dw_dev: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:53:52.676920 [debug] [ThreadPool]: On list_sales_dw_dev_raw: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "list_sales_dw_dev_raw"} */
select
      'sales_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_raw'
    union all
    select
      'sales_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_raw'
  
[0m08:53:52.678916 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.002 seconds
[0m08:53:52.679173 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m08:53:52.680449 [debug] [ThreadPool]: On list_sales_dw_dev: ROLLBACK
[0m08:53:52.681533 [debug] [ThreadPool]: On list_sales_dw_dev_raw: ROLLBACK
[0m08:53:52.682045 [debug] [ThreadPool]: On list_sales_dw_dev: Close
[0m08:53:52.682434 [debug] [ThreadPool]: On list_sales_dw_dev_raw: Close
[0m08:53:52.688490 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.689036 [debug] [MainThread]: On master: BEGIN
[0m08:53:52.689501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:52.693746 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:53:52.694312 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.694732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:52.699841 [debug] [MainThread]: SQL status: SELECT 12 in 0.005 seconds
[0m08:53:52.701639 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:52.702160 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.702471 [debug] [MainThread]: On master: BEGIN
[0m08:53:52.702961 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:53:52.703454 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.703923 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.704489 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.705065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:52.705480 [debug] [MainThread]: On master: Close
[0m08:53:52.706010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:52.706424 [info ] [MainThread]: 
[0m08:53:52.711231 [debug] [Thread-1 (]: Began running node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.711774 [info ] [Thread-1 (]: 1 of 1 START test total_amount_is_non_negative ................................. [RUN]
[0m08:53:52.712315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sales_dw_dev, now test.dbtcomp.total_amount_is_non_negative)
[0m08:53:52.712748 [debug] [Thread-1 (]: Began compiling node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.718630 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.720205 [debug] [Thread-1 (]: Began executing node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.731875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.739789 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.740556 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: BEGIN
[0m08:53:52.742582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:53:52.754948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m08:53:52.756677 [debug] [Thread-1 (]: Using postgres connection "test.dbtcomp.total_amount_is_non_negative"
[0m08:53:52.757359 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbtcomp", "target_name": "dev", "node_id": "test.dbtcomp.total_amount_is_non_negative"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from "sales_dw"."dev"."fact_sales"

where total_amount <= 0.00
      
    ) dbt_internal_test
[0m08:53:52.951194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.189 seconds
[0m08:53:52.957011 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: ROLLBACK
[0m08:53:52.957743 [debug] [Thread-1 (]: On test.dbtcomp.total_amount_is_non_negative: Close
[0m08:53:52.958470 [info ] [Thread-1 (]: 1 of 1 PASS total_amount_is_non_negative ....................................... [[32mPASS[0m in 0.25s]
[0m08:53:52.959179 [debug] [Thread-1 (]: Finished running node test.dbtcomp.total_amount_is_non_negative
[0m08:53:52.960981 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.962689 [debug] [MainThread]: On master: BEGIN
[0m08:53:52.963154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:52.968363 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:53:52.972760 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.973310 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:52.973695 [debug] [MainThread]: On master: COMMIT
[0m08:53:52.974121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:53:52.974418 [debug] [MainThread]: On master: Close
[0m08:53:52.974926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:52.975257 [debug] [MainThread]: Connection 'list_sales_dw_dev_raw' was properly closed.
[0m08:53:52.975542 [debug] [MainThread]: Connection 'test.dbtcomp.total_amount_is_non_negative' was properly closed.
[0m08:53:52.975854 [info ] [MainThread]: 
[0m08:53:52.976177 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m08:53:52.981740 [debug] [MainThread]: Command end result
[0m08:53:52.982172 [info ] [MainThread]: 
[0m08:53:52.982610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:53:52.982968 [info ] [MainThread]: 
[0m08:53:52.983285 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:53:52.984083 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.830804, "process_user_time": 1.125108, "process_kernel_time": 0.078018, "process_mem_max_rss": "110584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:53:52.984805 [debug] [MainThread]: Command `dbt test` succeeded at 08:53:52.984674 after 5.83 seconds
[0m08:53:52.985235 [debug] [MainThread]: Flushing usage events
